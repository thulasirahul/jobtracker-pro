var cp=Object.defineProperty;var Id=n=>{throw TypeError(n)};var hp=(n,e,t)=>e in n?cp(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Un=(n,e,t)=>hp(n,typeof e!="symbol"?e+"":e,t),Lu=(n,e,t)=>e.has(n)||Id("Cannot "+t);var T=(n,e,t)=>(Lu(n,e,"read from private field"),t?t.call(n):e.get(n)),Fe=(n,e,t)=>e.has(n)?Id("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Oe=(n,e,t,i)=>(Lu(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),Pe=(n,e,t)=>(Lu(n,e,"access private method"),t);var Mo=(n,e,t,i)=>({set _(o){Oe(n,e,o,t)},get _(){return T(n,e,i)}});function _mergeNamespaces(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const o in i)if(o!=="default"&&!(o in n)){const a=Object.getOwnPropertyDescriptor(i,o);a&&Object.defineProperty(n,o,a.get?a:{enumerable:!0,get:()=>i[o]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function getAugmentedNamespace(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var o=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:function(){return n[i]}})}),t}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),R=Symbol.iterator;function w(re){return re===null||typeof re!="object"?null:(re=R&&re[R]||re["@@iterator"],typeof re=="function"?re:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,X={};function b(re,Y,I){this.props=re,this.context=Y,this.refs=X,this.updater=I||V}b.prototype.isReactComponent={},b.prototype.setState=function(re,Y){if(typeof re!="object"&&typeof re!="function"&&re!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,re,Y,"setState")},b.prototype.forceUpdate=function(re){this.updater.enqueueForceUpdate(this,re,"forceUpdate")};function K(){}K.prototype=b.prototype;function Z(re,Y,I){this.props=re,this.context=Y,this.refs=X,this.updater=I||V}var oe=Z.prototype=new K;oe.constructor=Z,U(oe,b.prototype),oe.isPureReactComponent=!0;var te=Array.isArray,H=Object.prototype.hasOwnProperty,J={current:null},y={key:!0,ref:!0,__self:!0,__source:!0};function g(re,Y,I){var S,ee={},le=null,ce=null;if(Y!=null)for(S in Y.ref!==void 0&&(ce=Y.ref),Y.key!==void 0&&(le=""+Y.key),Y)H.call(Y,S)&&!y.hasOwnProperty(S)&&(ee[S]=Y[S]);var he=arguments.length-2;if(he===1)ee.children=I;else if(1<he){for(var Ee=Array(he),be=0;be<he;be++)Ee[be]=arguments[be+2];ee.children=Ee}if(re&&re.defaultProps)for(S in he=re.defaultProps,he)ee[S]===void 0&&(ee[S]=he[S]);return{$$typeof:n,type:re,key:le,ref:ce,props:ee,_owner:J.current}}function E(re,Y){return{$$typeof:n,type:re.type,key:Y,ref:re.ref,props:re.props,_owner:re._owner}}function W(re){return typeof re=="object"&&re!==null&&re.$$typeof===n}function v(re){var Y={"=":"=0",":":"=2"};return"$"+re.replace(/[=:]/g,function(I){return Y[I]})}var D=/\/+/g;function C(re,Y){return typeof re=="object"&&re!==null&&re.key!=null?v(""+re.key):Y.toString(36)}function we(re,Y,I,S,ee){var le=typeof re;(le==="undefined"||le==="boolean")&&(re=null);var ce=!1;if(re===null)ce=!0;else switch(le){case"string":case"number":ce=!0;break;case"object":switch(re.$$typeof){case n:case e:ce=!0}}if(ce)return ce=re,ee=ee(ce),re=S===""?"."+C(ce,0):S,te(ee)?(I="",re!=null&&(I=re.replace(D,"$&/")+"/"),we(ee,Y,I,"",function(be){return be})):ee!=null&&(W(ee)&&(ee=E(ee,I+(!ee.key||ce&&ce.key===ee.key?"":(""+ee.key).replace(D,"$&/")+"/")+re)),Y.push(ee)),1;if(ce=0,S=S===""?".":S+":",te(re))for(var he=0;he<re.length;he++){le=re[he];var Ee=S+C(le,he);ce+=we(le,Y,I,Ee,ee)}else if(Ee=w(re),typeof Ee=="function")for(re=Ee.call(re),he=0;!(le=re.next()).done;)le=le.value,Ee=S+C(le,he++),ce+=we(le,Y,I,Ee,ee);else if(le==="object")throw Y=String(re),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(re).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return ce}function ve(re,Y,I){if(re==null)return re;var S=[],ee=0;return we(re,S,"","",function(le){return Y.call(I,le,ee++)}),S}function Re(re){if(re._status===-1){var Y=re._result;Y=Y(),Y.then(function(I){(re._status===0||re._status===-1)&&(re._status=1,re._result=I)},function(I){(re._status===0||re._status===-1)&&(re._status=2,re._result=I)}),re._status===-1&&(re._status=0,re._result=Y)}if(re._status===1)return re._result.default;throw re._result}var _e={current:null},ge={transition:null},ie={ReactCurrentDispatcher:_e,ReactCurrentBatchConfig:ge,ReactCurrentOwner:J};function fe(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:ve,forEach:function(re,Y,I){ve(re,function(){Y.apply(this,arguments)},I)},count:function(re){var Y=0;return ve(re,function(){Y++}),Y},toArray:function(re){return ve(re,function(Y){return Y})||[]},only:function(re){if(!W(re))throw Error("React.Children.only expected to receive a single React element child.");return re}},react_production_min.Component=b,react_production_min.Fragment=t,react_production_min.Profiler=o,react_production_min.PureComponent=Z,react_production_min.StrictMode=i,react_production_min.Suspense=d,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ie,react_production_min.act=fe,react_production_min.cloneElement=function(re,Y,I){if(re==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+re+".");var S=U({},re.props),ee=re.key,le=re.ref,ce=re._owner;if(Y!=null){if(Y.ref!==void 0&&(le=Y.ref,ce=J.current),Y.key!==void 0&&(ee=""+Y.key),re.type&&re.type.defaultProps)var he=re.type.defaultProps;for(Ee in Y)H.call(Y,Ee)&&!y.hasOwnProperty(Ee)&&(S[Ee]=Y[Ee]===void 0&&he!==void 0?he[Ee]:Y[Ee])}var Ee=arguments.length-2;if(Ee===1)S.children=I;else if(1<Ee){he=Array(Ee);for(var be=0;be<Ee;be++)he[be]=arguments[be+2];S.children=he}return{$$typeof:n,type:re.type,key:ee,ref:le,props:S,_owner:ce}},react_production_min.createContext=function(re){return re={$$typeof:u,_currentValue:re,_currentValue2:re,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},re.Provider={$$typeof:a,_context:re},re.Consumer=re},react_production_min.createElement=g,react_production_min.createFactory=function(re){var Y=g.bind(null,re);return Y.type=re,Y},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(re){return{$$typeof:f,render:re}},react_production_min.isValidElement=W,react_production_min.lazy=function(re){return{$$typeof:_,_payload:{_status:-1,_result:re},_init:Re}},react_production_min.memo=function(re,Y){return{$$typeof:p,type:re,compare:Y===void 0?null:Y}},react_production_min.startTransition=function(re){var Y=ge.transition;ge.transition={};try{re()}finally{ge.transition=Y}},react_production_min.unstable_act=fe,react_production_min.useCallback=function(re,Y){return _e.current.useCallback(re,Y)},react_production_min.useContext=function(re){return _e.current.useContext(re)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(re){return _e.current.useDeferredValue(re)},react_production_min.useEffect=function(re,Y){return _e.current.useEffect(re,Y)},react_production_min.useId=function(){return _e.current.useId()},react_production_min.useImperativeHandle=function(re,Y,I){return _e.current.useImperativeHandle(re,Y,I)},react_production_min.useInsertionEffect=function(re,Y){return _e.current.useInsertionEffect(re,Y)},react_production_min.useLayoutEffect=function(re,Y){return _e.current.useLayoutEffect(re,Y)},react_production_min.useMemo=function(re,Y){return _e.current.useMemo(re,Y)},react_production_min.useReducer=function(re,Y,I){return _e.current.useReducer(re,Y,I)},react_production_min.useRef=function(re){return _e.current.useRef(re)},react_production_min.useState=function(re){return _e.current.useState(re)},react_production_min.useSyncExternalStore=function(re,Y,I){return _e.current.useSyncExternalStore(re,Y,I)},react_production_min.useTransition=function(){return _e.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var n=requireReact(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(f,d,p){var _,R={},w=null,V=null;p!==void 0&&(w=""+p),d.key!==void 0&&(w=""+d.key),d.ref!==void 0&&(V=d.ref);for(_ in d)i.call(d,_)&&!a.hasOwnProperty(_)&&(R[_]=d[_]);if(f&&f.defaultProps)for(_ in d=f.defaultProps,d)R[_]===void 0&&(R[_]=d[_]);return{$$typeof:e,type:f,key:w,ref:V,props:R,_owner:o.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=u,reactJsxRuntime_production_min.jsxs=u,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(n){function e(ge,ie){var fe=ge.length;ge.push(ie);e:for(;0<fe;){var re=fe-1>>>1,Y=ge[re];if(0<o(Y,ie))ge[re]=ie,ge[fe]=Y,fe=re;else break e}}function t(ge){return ge.length===0?null:ge[0]}function i(ge){if(ge.length===0)return null;var ie=ge[0],fe=ge.pop();if(fe!==ie){ge[0]=fe;e:for(var re=0,Y=ge.length,I=Y>>>1;re<I;){var S=2*(re+1)-1,ee=ge[S],le=S+1,ce=ge[le];if(0>o(ee,fe))le<Y&&0>o(ce,ee)?(ge[re]=ce,ge[le]=fe,re=le):(ge[re]=ee,ge[S]=fe,re=S);else if(le<Y&&0>o(ce,fe))ge[re]=ce,ge[le]=fe,re=le;else break e}}return ie}function o(ge,ie){var fe=ge.sortIndex-ie.sortIndex;return fe!==0?fe:ge.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var u=Date,f=u.now();n.unstable_now=function(){return u.now()-f}}var d=[],p=[],_=1,R=null,w=3,V=!1,U=!1,X=!1,b=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function oe(ge){for(var ie=t(p);ie!==null;){if(ie.callback===null)i(p);else if(ie.startTime<=ge)i(p),ie.sortIndex=ie.expirationTime,e(d,ie);else break;ie=t(p)}}function te(ge){if(X=!1,oe(ge),!U)if(t(d)!==null)U=!0,Re(H);else{var ie=t(p);ie!==null&&_e(te,ie.startTime-ge)}}function H(ge,ie){U=!1,X&&(X=!1,K(g),g=-1),V=!0;var fe=w;try{for(oe(ie),R=t(d);R!==null&&(!(R.expirationTime>ie)||ge&&!v());){var re=R.callback;if(typeof re=="function"){R.callback=null,w=R.priorityLevel;var Y=re(R.expirationTime<=ie);ie=n.unstable_now(),typeof Y=="function"?R.callback=Y:R===t(d)&&i(d),oe(ie)}else i(d);R=t(d)}if(R!==null)var I=!0;else{var S=t(p);S!==null&&_e(te,S.startTime-ie),I=!1}return I}finally{R=null,w=fe,V=!1}}var J=!1,y=null,g=-1,E=5,W=-1;function v(){return!(n.unstable_now()-W<E)}function D(){if(y!==null){var ge=n.unstable_now();W=ge;var ie=!0;try{ie=y(!0,ge)}finally{ie?C():(J=!1,y=null)}}else J=!1}var C;if(typeof Z=="function")C=function(){Z(D)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,ve=we.port2;we.port1.onmessage=D,C=function(){ve.postMessage(null)}}else C=function(){b(D,0)};function Re(ge){y=ge,J||(J=!0,C())}function _e(ge,ie){g=b(function(){ge(n.unstable_now())},ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ge){ge.callback=null},n.unstable_continueExecution=function(){U||V||(U=!0,Re(H))},n.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<ge?Math.floor(1e3/ge):5},n.unstable_getCurrentPriorityLevel=function(){return w},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(ge){switch(w){case 1:case 2:case 3:var ie=3;break;default:ie=w}var fe=w;w=ie;try{return ge()}finally{w=fe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ge,ie){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var fe=w;w=ge;try{return ie()}finally{w=fe}},n.unstable_scheduleCallback=function(ge,ie,fe){var re=n.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?re+fe:re):fe=re,ge){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=fe+Y,ge={id:_++,callback:ie,priorityLevel:ge,startTime:fe,expirationTime:Y,sortIndex:-1},fe>re?(ge.sortIndex=fe,e(p,ge),t(d)===null&&ge===t(p)&&(X?(K(g),g=-1):X=!0,_e(te,fe-re))):(ge.sortIndex=Y,e(d,ge),U||V||(U=!0,Re(H))),ge},n.unstable_shouldYield=v,n.unstable_wrapCallback=function(ge){var ie=w;return function(){var fe=w;w=ie;try{return ge.apply(this,arguments)}finally{w=fe}}}}(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var n=requireReact(),e=requireScheduler();function t(r){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+r,l=1;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function a(r,s){u(r,s),u(r+"Capture",s)}function u(r,s){for(o[r]=s,r=0;r<s.length;r++)i.add(s[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_={},R={};function w(r){return d.call(R,r)?!0:d.call(_,r)?!1:p.test(r)?R[r]=!0:(_[r]=!0,!1)}function V(r,s,l,h){if(l!==null&&l.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return h?!1:l!==null?!l.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function U(r,s,l,h){if(s===null||typeof s>"u"||V(r,s,l,h))return!0;if(h)return!1;if(l!==null)switch(l.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function X(r,s,l,h,m,P,ne){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=h,this.attributeNamespace=m,this.mustUseProperty=l,this.propertyName=r,this.type=s,this.sanitizeURL=P,this.removeEmptyString=ne}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){b[r]=new X(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var s=r[0];b[s]=new X(s,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){b[r]=new X(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){b[r]=new X(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){b[r]=new X(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){b[r]=new X(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){b[r]=new X(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){b[r]=new X(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){b[r]=new X(r,5,!1,r.toLowerCase(),null,!1,!1)});var K=/[\-:]([a-z])/g;function Z(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var s=r.replace(K,Z);b[s]=new X(s,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var s=r.replace(K,Z);b[s]=new X(s,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var s=r.replace(K,Z);b[s]=new X(s,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){b[r]=new X(r,1,!1,r.toLowerCase(),null,!1,!1)}),b.xlinkHref=new X("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){b[r]=new X(r,1,!1,r.toLowerCase(),null,!0,!0)});function oe(r,s,l,h){var m=b.hasOwnProperty(s)?b[s]:null;(m!==null?m.type!==0:h||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(U(s,l,m,h)&&(l=null),h||m===null?w(s)&&(l===null?r.removeAttribute(s):r.setAttribute(s,""+l)):m.mustUseProperty?r[m.propertyName]=l===null?m.type===3?!1:"":l:(s=m.attributeName,h=m.attributeNamespace,l===null?r.removeAttribute(s):(m=m.type,l=m===3||m===4&&l===!0?"":""+l,h?r.setAttributeNS(h,s,l):r.setAttribute(s,l))))}var te=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,H=Symbol.for("react.element"),J=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),v=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),we=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),Re=Symbol.for("react.lazy"),_e=Symbol.for("react.offscreen"),ge=Symbol.iterator;function ie(r){return r===null||typeof r!="object"?null:(r=ge&&r[ge]||r["@@iterator"],typeof r=="function"?r:null)}var fe=Object.assign,re;function Y(r){if(re===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);re=s&&s[1]||""}return`
`+re+r}var I=!1;function S(r,s){if(!r||I)return"";I=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(Ge){var h=Ge}Reflect.construct(r,[],s)}else{try{s.call()}catch(Ge){h=Ge}r.call(s.prototype)}else{try{throw Error()}catch(Ge){h=Ge}r()}}catch(Ge){if(Ge&&h&&typeof Ge.stack=="string"){for(var m=Ge.stack.split(`
`),P=h.stack.split(`
`),ne=m.length-1,ye=P.length-1;1<=ne&&0<=ye&&m[ne]!==P[ye];)ye--;for(;1<=ne&&0<=ye;ne--,ye--)if(m[ne]!==P[ye]){if(ne!==1||ye!==1)do if(ne--,ye--,0>ye||m[ne]!==P[ye]){var Ie=`
`+m[ne].replace(" at new "," at ");return r.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",r.displayName)),Ie}while(1<=ne&&0<=ye);break}}}finally{I=!1,Error.prepareStackTrace=l}return(r=r?r.displayName||r.name:"")?Y(r):""}function ee(r){switch(r.tag){case 5:return Y(r.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return r=S(r.type,!1),r;case 11:return r=S(r.type.render,!1),r;case 1:return r=S(r.type,!0),r;default:return""}}function le(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case y:return"Fragment";case J:return"Portal";case E:return"Profiler";case g:return"StrictMode";case C:return"Suspense";case we:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case v:return(r.displayName||"Context")+".Consumer";case W:return(r._context.displayName||"Context")+".Provider";case D:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ve:return s=r.displayName||null,s!==null?s:le(r.type)||"Memo";case Re:s=r._payload,r=r._init;try{return le(r(s))}catch{}}return null}function ce(r){var s=r.type;switch(r.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=s.render,r=r.displayName||r.name||"",s.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(s);case 8:return s===g?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function he(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Ee(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function be(r){var s=Ee(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),h=""+r[s];if(!r.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,P=l.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return m.call(this)},set:function(ne){h=""+ne,P.call(this,ne)}}),Object.defineProperty(r,s,{enumerable:l.enumerable}),{getValue:function(){return h},setValue:function(ne){h=""+ne},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function Be(r){r._valueTracker||(r._valueTracker=be(r))}function ze(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var l=s.getValue(),h="";return r&&(h=Ee(r)?r.checked?"true":"false":r.value),r=h,r!==l?(s.setValue(r),!0):!1}function Ke(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Xe(r,s){var l=s.checked;return fe({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??r._wrapperState.initialChecked})}function Ze(r,s){var l=s.defaultValue==null?"":s.defaultValue,h=s.checked!=null?s.checked:s.defaultChecked;l=he(s.value!=null?s.value:l),r._wrapperState={initialChecked:h,initialValue:l,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function xe(r,s){s=s.checked,s!=null&&oe(r,"checked",s,!1)}function De(r,s){xe(r,s);var l=he(s.value),h=s.type;if(l!=null)h==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+l):r.value!==""+l&&(r.value=""+l);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}s.hasOwnProperty("value")?me(r,s.type,l):s.hasOwnProperty("defaultValue")&&me(r,s.type,he(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(r.defaultChecked=!!s.defaultChecked)}function se(r,s,l){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var h=s.type;if(!(h!=="submit"&&h!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+r._wrapperState.initialValue,l||s===r.value||(r.value=s),r.defaultValue=s}l=r.name,l!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,l!==""&&(r.name=l)}function me(r,s,l){(s!=="number"||Ke(r.ownerDocument)!==r)&&(l==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+l&&(r.defaultValue=""+l))}var Te=Array.isArray;function Ce(r,s,l,h){if(r=r.options,s){s={};for(var m=0;m<l.length;m++)s["$"+l[m]]=!0;for(l=0;l<r.length;l++)m=s.hasOwnProperty("$"+r[l].value),r[l].selected!==m&&(r[l].selected=m),m&&h&&(r[l].defaultSelected=!0)}else{for(l=""+he(l),s=null,m=0;m<r.length;m++){if(r[m].value===l){r[m].selected=!0,h&&(r[m].defaultSelected=!0);return}s!==null||r[m].disabled||(s=r[m])}s!==null&&(s.selected=!0)}}function $e(r,s){if(s.dangerouslySetInnerHTML!=null)throw Error(t(91));return fe({},s,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function et(r,s){var l=s.value;if(l==null){if(l=s.children,s=s.defaultValue,l!=null){if(s!=null)throw Error(t(92));if(Te(l)){if(1<l.length)throw Error(t(93));l=l[0]}s=l}s==null&&(s=""),l=s}r._wrapperState={initialValue:he(l)}}function Qe(r,s){var l=he(s.value),h=he(s.defaultValue);l!=null&&(l=""+l,l!==r.value&&(r.value=l),s.defaultValue==null&&r.defaultValue!==l&&(r.defaultValue=l)),h!=null&&(r.defaultValue=""+h)}function Se(r){var s=r.textContent;s===r._wrapperState.initialValue&&s!==""&&s!==null&&(r.value=s)}function rt(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nt(r,s){return r==null||r==="http://www.w3.org/1999/xhtml"?rt(s):r==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var mn,fn=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,l,h,m){MSApp.execUnsafeLocalFunction(function(){return r(s,l,h,m)})}:r}(function(r,s){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=s;else{for(mn=mn||document.createElement("div"),mn.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=mn.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;s.firstChild;)r.appendChild(s.firstChild)}});function Rn(r,s){if(s){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=s;return}}r.textContent=s}var Ut={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hn=["Webkit","ms","Moz","O"];Object.keys(Ut).forEach(function(r){hn.forEach(function(s){s=s+r.charAt(0).toUpperCase()+r.substring(1),Ut[s]=Ut[r]})});function bn(r,s,l){return s==null||typeof s=="boolean"||s===""?"":l||typeof s!="number"||s===0||Ut.hasOwnProperty(r)&&Ut[r]?(""+s).trim():s+"px"}function kn(r,s){r=r.style;for(var l in s)if(s.hasOwnProperty(l)){var h=l.indexOf("--")===0,m=bn(l,s[l],h);l==="float"&&(l="cssFloat"),h?r.setProperty(l,m):r[l]=m}}var Ye=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ve(r,s){if(s){if(Ye[r]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(t(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(t(61))}if(s.style!=null&&typeof s.style!="object")throw Error(t(62))}}function Ne(r,s){if(r.indexOf("-")===-1)return typeof s.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dt=null;function In(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Pn=null,pe=null,We=null;function pt(r){if(r=Eo(r)){if(typeof Pn!="function")throw Error(t(280));var s=r.stateNode;s&&(s=pa(s),Pn(r.stateNode,r.type,s))}}function Lt(r){pe?We?We.push(r):We=[r]:pe=r}function un(){if(pe){var r=pe,s=We;if(We=pe=null,pt(r),s)for(r=0;r<s.length;r++)pt(s[r])}}function kt(r,s){return r(s)}function de(){}var ae=!1;function Ae(r,s,l){if(ae)return r(s,l);ae=!0;try{return kt(r,s,l)}finally{ae=!1,(pe!==null||We!==null)&&(de(),un())}}function Me(r,s){var l=r.stateNode;if(l===null)return null;var h=pa(l);if(h===null)return null;l=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(t(231,s,typeof l));return l}var Ue=!1;if(f)try{var qe={};Object.defineProperty(qe,"passive",{get:function(){Ue=!0}}),window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,qe)}catch{Ue=!1}function tt(r,s,l,h,m,P,ne,ye,Ie){var Ge=Array.prototype.slice.call(arguments,3);try{s.apply(l,Ge)}catch(It){this.onError(It)}}var Wt=!1,Bt=null,Et=!1,An=null,Gt={onError:function(r){Wt=!0,Bt=r}};function Kt(r,s,l,h,m,P,ne,ye,Ie){Wt=!1,Bt=null,tt.apply(Gt,arguments)}function gn(r,s,l,h,m,P,ne,ye,Ie){if(Kt.apply(this,arguments),Wt){if(Wt){var Ge=Bt;Wt=!1,Bt=null}else throw Error(t(198));Et||(Et=!0,An=Ge)}}function vn(r){var s=r,l=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(l=s.return),r=s.return;while(r)}return s.tag===3?l:null}function xn(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function Dn(r){if(vn(r)!==r)throw Error(t(188))}function Gn(r){var s=r.alternate;if(!s){if(s=vn(r),s===null)throw Error(t(188));return s!==r?null:r}for(var l=r,h=s;;){var m=l.return;if(m===null)break;var P=m.alternate;if(P===null){if(h=m.return,h!==null){l=h;continue}break}if(m.child===P.child){for(P=m.child;P;){if(P===l)return Dn(m),r;if(P===h)return Dn(m),s;P=P.sibling}throw Error(t(188))}if(l.return!==h.return)l=m,h=P;else{for(var ne=!1,ye=m.child;ye;){if(ye===l){ne=!0,l=m,h=P;break}if(ye===h){ne=!0,h=m,l=P;break}ye=ye.sibling}if(!ne){for(ye=P.child;ye;){if(ye===l){ne=!0,l=P,h=m;break}if(ye===h){ne=!0,h=P,l=m;break}ye=ye.sibling}if(!ne)throw Error(t(189))}}if(l.alternate!==h)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?r:s}function On(r){return r=Gn(r),r!==null?hr(r):null}function hr(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var s=hr(r);if(s!==null)return s;r=r.sibling}return null}var _r=e.unstable_scheduleCallback,Ar=e.unstable_cancelCallback,Xi=e.unstable_shouldYield,fl=e.unstable_requestPaint,Bn=e.unstable_now,zo=e.unstable_getCurrentPriorityLevel,Yi=e.unstable_ImmediatePriority,Si=e.unstable_UserBlockingPriority,Fr=e.unstable_NormalPriority,to=e.unstable_LowPriority,Wo=e.unstable_IdlePriority,Qi=null,Cr=null;function $o(r){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Qi,r,void 0,(r.current.flags&128)===128)}catch{}}var gr=Math.clz32?Math.clz32:qo,no=Math.log,Ho=Math.LN2;function qo(r){return r>>>=0,r===0?32:31-(no(r)/Ho|0)|0}var gs=64,ys=4194304;function wi(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Ji(r,s){var l=r.pendingLanes;if(l===0)return 0;var h=0,m=r.suspendedLanes,P=r.pingedLanes,ne=l&268435455;if(ne!==0){var ye=ne&~m;ye!==0?h=wi(ye):(P&=ne,P!==0&&(h=wi(P)))}else ne=l&~m,ne!==0?h=wi(ne):P!==0&&(h=wi(P));if(h===0)return 0;if(s!==0&&s!==h&&(s&m)===0&&(m=h&-h,P=s&-s,m>=P||m===16&&(P&4194240)!==0))return s;if((h&4)!==0&&(h|=l&16),s=r.entangledLanes,s!==0)for(r=r.entanglements,s&=h;0<s;)l=31-gr(s),m=1<<l,h|=r[l],s&=~m;return h}function pl(r,s){switch(r){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function di(r,s){for(var l=r.suspendedLanes,h=r.pingedLanes,m=r.expirationTimes,P=r.pendingLanes;0<P;){var ne=31-gr(P),ye=1<<ne,Ie=m[ne];Ie===-1?((ye&l)===0||(ye&h)!==0)&&(m[ne]=pl(ye,s)):Ie<=s&&(r.expiredLanes|=ye),P&=~ye}}function xr(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Zi(){var r=gs;return gs<<=1,(gs&4194240)===0&&(gs=64),r}function bi(r){for(var s=[],l=0;31>l;l++)s.push(r);return s}function Ci(r,s,l){r.pendingLanes|=s,s!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,s=31-gr(s),r[s]=l}function jn(r,s){var l=r.pendingLanes&~s;r.pendingLanes=s,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=s,r.mutableReadLanes&=s,r.entangledLanes&=s,s=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<l;){var m=31-gr(l),P=1<<m;s[m]=0,h[m]=-1,r[m]=-1,l&=~P}}function xi(r,s){var l=r.entangledLanes|=s;for(r=r.entanglements;l;){var h=31-gr(l),m=1<<h;m&s|r[h]&s&&(r[h]|=s),l&=~m}}var Vn=0;function ki(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var Go,Es,Ko,Xo,Yo,ro=!1,ri=[],ar=null,qr=null,Gr=null,Di=new Map,Or=new Map,ii=[],ml="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qo(r,s){switch(r){case"focusin":case"focusout":ar=null;break;case"dragenter":case"dragleave":qr=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":Di.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Or.delete(s.pointerId)}}function Tr(r,s,l,h,m,P){return r===null||r.nativeEvent!==P?(r={blockedOn:s,domEventName:l,eventSystemFlags:h,nativeEvent:P,targetContainers:[m]},s!==null&&(s=Eo(s),s!==null&&Es(s)),r):(r.eventSystemFlags|=h,s=r.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),r)}function _l(r,s,l,h,m){switch(s){case"focusin":return ar=Tr(ar,r,s,l,h,m),!0;case"dragenter":return qr=Tr(qr,r,s,l,h,m),!0;case"mouseover":return Gr=Tr(Gr,r,s,l,h,m),!0;case"pointerover":var P=m.pointerId;return Di.set(P,Tr(Di.get(P)||null,r,s,l,h,m)),!0;case"gotpointercapture":return P=m.pointerId,Or.set(P,Tr(Or.get(P)||null,r,s,l,h,m)),!0}return!1}function Jo(r){var s=is(r.target);if(s!==null){var l=vn(s);if(l!==null){if(s=l.tag,s===13){if(s=xn(l),s!==null){r.blockedOn=s,Yo(r.priority,function(){Ko(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function fi(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var l=vs(r.domEventName,r.eventSystemFlags,s[0],r.nativeEvent);if(l===null){l=r.nativeEvent;var h=new l.constructor(l.type,l);Dt=h,l.target.dispatchEvent(h),Dt=null}else return s=Eo(l),s!==null&&Es(s),r.blockedOn=l,!1;s.shift()}return!0}function es(r,s,l){fi(r)&&l.delete(s)}function Zo(){ro=!1,ar!==null&&fi(ar)&&(ar=null),qr!==null&&fi(qr)&&(qr=null),Gr!==null&&fi(Gr)&&(Gr=null),Di.forEach(es),Or.forEach(es)}function Kr(r,s){r.blockedOn===s&&(r.blockedOn=null,ro||(ro=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Zo)))}function Xr(r){function s(m){return Kr(m,r)}if(0<ri.length){Kr(ri[0],r);for(var l=1;l<ri.length;l++){var h=ri[l];h.blockedOn===r&&(h.blockedOn=null)}}for(ar!==null&&Kr(ar,r),qr!==null&&Kr(qr,r),Gr!==null&&Kr(Gr,r),Di.forEach(s),Or.forEach(s),l=0;l<ii.length;l++)h=ii[l],h.blockedOn===r&&(h.blockedOn=null);for(;0<ii.length&&(l=ii[0],l.blockedOn===null);)Jo(l),l.blockedOn===null&&ii.shift()}var pi=te.ReactCurrentBatchConfig,Vi=!0;function Hn(r,s,l,h){var m=Vn,P=pi.transition;pi.transition=null;try{Vn=1,io(r,s,l,h)}finally{Vn=m,pi.transition=P}}function gl(r,s,l,h){var m=Vn,P=pi.transition;pi.transition=null;try{Vn=4,io(r,s,l,h)}finally{Vn=m,pi.transition=P}}function io(r,s,l,h){if(Vi){var m=vs(r,s,l,h);if(m===null)bl(r,s,h,ts,l),Qo(r,h);else if(_l(m,r,s,l,h))h.stopPropagation();else if(Qo(r,h),s&4&&-1<ml.indexOf(r)){for(;m!==null;){var P=Eo(m);if(P!==null&&Go(P),P=vs(r,s,l,h),P===null&&bl(r,s,h,ts,l),P===m)break;m=P}m!==null&&h.stopPropagation()}else bl(r,s,h,null,l)}}var ts=null;function vs(r,s,l,h){if(ts=null,r=In(h),r=is(r),r!==null)if(s=vn(r),s===null)r=null;else if(l=s.tag,l===13){if(r=xn(s),r!==null)return r;r=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null);return ts=r,null}function so(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zo()){case Yi:return 1;case Si:return 4;case Fr:case to:return 16;case Wo:return 536870912;default:return 16}default:return 16}}var kr=null,As=null,Pr=null;function oo(){if(Pr)return Pr;var r,s=As,l=s.length,h,m="value"in kr?kr.value:kr.textContent,P=m.length;for(r=0;r<l&&s[r]===m[r];r++);var ne=l-r;for(h=1;h<=ne&&s[l-h]===m[P-h];h++);return Pr=m.slice(r,1<h?1-h:void 0)}function Ts(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function si(){return!0}function ao(){return!1}function lr(r){function s(l,h,m,P,ne){this._reactName=l,this._targetInst=m,this.type=h,this.nativeEvent=P,this.target=ne,this.currentTarget=null;for(var ye in r)r.hasOwnProperty(ye)&&(l=r[ye],this[ye]=l?l(P):P[ye]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?si:ao,this.isPropagationStopped=ao,this}return fe(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=si)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=si)},persist:function(){},isPersistent:si}),s}var Yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ps=lr(Yr),oi=fe({},Yr,{view:0,detail:0}),yl=lr(oi),Rs,mi,Mi,ns=fe({},oi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ai,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Mi&&(Mi&&r.type==="mousemove"?(Rs=r.screenX-Mi.screenX,mi=r.screenY-Mi.screenY):mi=Rs=0,Mi=r),Rs)},movementY:function(r){return"movementY"in r?r.movementY:mi}}),Is=lr(ns),lo=fe({},ns,{dataTransfer:0}),ea=lr(lo),Ss=fe({},oi,{relatedTarget:0}),ws=lr(Ss),ta=fe({},Yr,{animationName:0,elapsedTime:0,pseudoElement:0}),_i=lr(ta),na=fe({},Yr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),ra=lr(na),ia=fe({},Yr,{data:0}),uo=lr(ia),bs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oa(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=sa[r])?!!s[r]:!1}function ai(){return oa}var c=fe({},oi,{key:function(r){if(r.key){var s=bs[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=Ts(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?yr[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ai,charCode:function(r){return r.type==="keypress"?Ts(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ts(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),A=lr(c),j=fe({},ns,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ue=lr(j),Le=fe({},oi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ai}),Je=lr(Le),qt=fe({},Yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ln=lr(qt),er=fe({},ns,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Mn=lr(er),rr=[9,13,27,32],Jn=f&&"CompositionEvent"in window,Lr=null;f&&"documentMode"in document&&(Lr=document.documentMode);var Dr=f&&"TextEvent"in window&&!Lr,rs=f&&(!Jn||Lr&&8<Lr&&11>=Lr),Cs=" ",Ec=!1;function vc(r,s){switch(r){case"keyup":return rr.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ac(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var xs=!1;function af(r,s){switch(r){case"compositionend":return Ac(s);case"keypress":return s.which!==32?null:(Ec=!0,Cs);case"textInput":return r=s.data,r===Cs&&Ec?null:r;default:return null}}function lf(r,s){if(xs)return r==="compositionend"||!Jn&&vc(r,s)?(r=oo(),Pr=As=kr=null,xs=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return rs&&s.locale!=="ko"?null:s.data;default:return null}}var uf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tc(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!uf[r.type]:s==="textarea"}function Pc(r,s,l,h){Lt(h),s=ha(s,"onChange"),0<s.length&&(l=new Ps("onChange","change",null,l,h),r.push({event:l,listeners:s}))}var co=null,ho=null;function cf(r){Bc(r,0)}function aa(r){var s=Ns(r);if(ze(s))return r}function hf(r,s){if(r==="change")return s}var Rc=!1;if(f){var El;if(f){var vl="oninput"in document;if(!vl){var Ic=document.createElement("div");Ic.setAttribute("oninput","return;"),vl=typeof Ic.oninput=="function"}El=vl}else El=!1;Rc=El&&(!document.documentMode||9<document.documentMode)}function Sc(){co&&(co.detachEvent("onpropertychange",wc),ho=co=null)}function wc(r){if(r.propertyName==="value"&&aa(ho)){var s=[];Pc(s,ho,r,In(r)),Ae(cf,s)}}function df(r,s,l){r==="focusin"?(Sc(),co=s,ho=l,co.attachEvent("onpropertychange",wc)):r==="focusout"&&Sc()}function ff(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return aa(ho)}function pf(r,s){if(r==="click")return aa(s)}function mf(r,s){if(r==="input"||r==="change")return aa(s)}function _f(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Qr=typeof Object.is=="function"?Object.is:_f;function fo(r,s){if(Qr(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var l=Object.keys(r),h=Object.keys(s);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var m=l[h];if(!d.call(s,m)||!Qr(r[m],s[m]))return!1}return!0}function bc(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Cc(r,s){var l=bc(r);r=0;for(var h;l;){if(l.nodeType===3){if(h=r+l.textContent.length,r<=s&&h>=s)return{node:l,offset:s-r};r=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=bc(l)}}function xc(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?xc(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function kc(){for(var r=window,s=Ke();s instanceof r.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)r=s.contentWindow;else break;s=Ke(r.document)}return s}function Al(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}function gf(r){var s=kc(),l=r.focusedElem,h=r.selectionRange;if(s!==l&&l&&l.ownerDocument&&xc(l.ownerDocument.documentElement,l)){if(h!==null&&Al(l)){if(s=h.start,r=h.end,r===void 0&&(r=s),"selectionStart"in l)l.selectionStart=s,l.selectionEnd=Math.min(r,l.value.length);else if(r=(s=l.ownerDocument||document)&&s.defaultView||window,r.getSelection){r=r.getSelection();var m=l.textContent.length,P=Math.min(h.start,m);h=h.end===void 0?P:Math.min(h.end,m),!r.extend&&P>h&&(m=h,h=P,P=m),m=Cc(l,P);var ne=Cc(l,h);m&&ne&&(r.rangeCount!==1||r.anchorNode!==m.node||r.anchorOffset!==m.offset||r.focusNode!==ne.node||r.focusOffset!==ne.offset)&&(s=s.createRange(),s.setStart(m.node,m.offset),r.removeAllRanges(),P>h?(r.addRange(s),r.extend(ne.node,ne.offset)):(s.setEnd(ne.node,ne.offset),r.addRange(s)))}}for(s=[],r=l;r=r.parentNode;)r.nodeType===1&&s.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<s.length;l++)r=s[l],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var yf=f&&"documentMode"in document&&11>=document.documentMode,ks=null,Tl=null,po=null,Pl=!1;function Dc(r,s,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Pl||ks==null||ks!==Ke(h)||(h=ks,"selectionStart"in h&&Al(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),po&&fo(po,h)||(po=h,h=ha(Tl,"onSelect"),0<h.length&&(s=new Ps("onSelect","select",null,s,l),r.push({event:s,listeners:h}),s.target=ks)))}function la(r,s){var l={};return l[r.toLowerCase()]=s.toLowerCase(),l["Webkit"+r]="webkit"+s,l["Moz"+r]="moz"+s,l}var Ds={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionend:la("Transition","TransitionEnd")},Rl={},Vc={};f&&(Vc=document.createElement("div").style,"AnimationEvent"in window||(delete Ds.animationend.animation,delete Ds.animationiteration.animation,delete Ds.animationstart.animation),"TransitionEvent"in window||delete Ds.transitionend.transition);function ua(r){if(Rl[r])return Rl[r];if(!Ds[r])return r;var s=Ds[r],l;for(l in s)if(s.hasOwnProperty(l)&&l in Vc)return Rl[r]=s[l];return r}var Mc=ua("animationend"),Nc=ua("animationiteration"),Fc=ua("animationstart"),Oc=ua("transitionend"),Lc=new Map,Uc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(r,s){Lc.set(r,s),a(s,[r])}for(var Il=0;Il<Uc.length;Il++){var Sl=Uc[Il],Ef=Sl.toLowerCase(),vf=Sl[0].toUpperCase()+Sl.slice(1);Ni(Ef,"on"+vf)}Ni(Mc,"onAnimationEnd"),Ni(Nc,"onAnimationIteration"),Ni(Fc,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(Oc,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Af=new Set("cancel close invalid load scroll toggle".split(" ").concat(mo));function jc(r,s,l){var h=r.type||"unknown-event";r.currentTarget=l,gn(h,s,void 0,r),r.currentTarget=null}function Bc(r,s){s=(s&4)!==0;for(var l=0;l<r.length;l++){var h=r[l],m=h.event;h=h.listeners;e:{var P=void 0;if(s)for(var ne=h.length-1;0<=ne;ne--){var ye=h[ne],Ie=ye.instance,Ge=ye.currentTarget;if(ye=ye.listener,Ie!==P&&m.isPropagationStopped())break e;jc(m,ye,Ge),P=Ie}else for(ne=0;ne<h.length;ne++){if(ye=h[ne],Ie=ye.instance,Ge=ye.currentTarget,ye=ye.listener,Ie!==P&&m.isPropagationStopped())break e;jc(m,ye,Ge),P=Ie}}}if(Et)throw r=An,Et=!1,An=null,r}function Wn(r,s){var l=s[Ml];l===void 0&&(l=s[Ml]=new Set);var h=r+"__bubble";l.has(h)||(zc(s,r,2,!1),l.add(h))}function wl(r,s,l){var h=0;s&&(h|=4),zc(l,r,h,s)}var ca="_reactListening"+Math.random().toString(36).slice(2);function _o(r){if(!r[ca]){r[ca]=!0,i.forEach(function(l){l!=="selectionchange"&&(Af.has(l)||wl(l,!1,r),wl(l,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[ca]||(s[ca]=!0,wl("selectionchange",!1,s))}}function zc(r,s,l,h){switch(so(s)){case 1:var m=Hn;break;case 4:m=gl;break;default:m=io}l=m.bind(null,s,l,r),m=void 0,!Ue||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),h?m!==void 0?r.addEventListener(s,l,{capture:!0,passive:m}):r.addEventListener(s,l,!0):m!==void 0?r.addEventListener(s,l,{passive:m}):r.addEventListener(s,l,!1)}function bl(r,s,l,h,m){var P=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var ne=h.tag;if(ne===3||ne===4){var ye=h.stateNode.containerInfo;if(ye===m||ye.nodeType===8&&ye.parentNode===m)break;if(ne===4)for(ne=h.return;ne!==null;){var Ie=ne.tag;if((Ie===3||Ie===4)&&(Ie=ne.stateNode.containerInfo,Ie===m||Ie.nodeType===8&&Ie.parentNode===m))return;ne=ne.return}for(;ye!==null;){if(ne=is(ye),ne===null)return;if(Ie=ne.tag,Ie===5||Ie===6){h=P=ne;continue e}ye=ye.parentNode}}h=h.return}Ae(function(){var Ge=P,It=In(l),Ct=[];e:{var vt=Lc.get(r);if(vt!==void 0){var dn=Ps,yn=r;switch(r){case"keypress":if(Ts(l)===0)break e;case"keydown":case"keyup":dn=A;break;case"focusin":yn="focus",dn=ws;break;case"focusout":yn="blur",dn=ws;break;case"beforeblur":case"afterblur":dn=ws;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dn=Is;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dn=ea;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dn=Je;break;case Mc:case Nc:case Fc:dn=_i;break;case Oc:dn=Ln;break;case"scroll":dn=yl;break;case"wheel":dn=Mn;break;case"copy":case"cut":case"paste":dn=ra;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dn=ue}var En=(s&4)!==0,Qn=!En&&r==="scroll",je=En?vt!==null?vt+"Capture":null:vt;En=[];for(var ke=Ge,He;ke!==null;){He=ke;var Nt=He.stateNode;if(He.tag===5&&Nt!==null&&(He=Nt,je!==null&&(Nt=Me(ke,je),Nt!=null&&En.push(go(ke,Nt,He)))),Qn)break;ke=ke.return}0<En.length&&(vt=new dn(vt,yn,null,l,It),Ct.push({event:vt,listeners:En}))}}if((s&7)===0){e:{if(vt=r==="mouseover"||r==="pointerover",dn=r==="mouseout"||r==="pointerout",vt&&l!==Dt&&(yn=l.relatedTarget||l.fromElement)&&(is(yn)||yn[gi]))break e;if((dn||vt)&&(vt=It.window===It?It:(vt=It.ownerDocument)?vt.defaultView||vt.parentWindow:window,dn?(yn=l.relatedTarget||l.toElement,dn=Ge,yn=yn?is(yn):null,yn!==null&&(Qn=vn(yn),yn!==Qn||yn.tag!==5&&yn.tag!==6)&&(yn=null)):(dn=null,yn=Ge),dn!==yn)){if(En=Is,Nt="onMouseLeave",je="onMouseEnter",ke="mouse",(r==="pointerout"||r==="pointerover")&&(En=ue,Nt="onPointerLeave",je="onPointerEnter",ke="pointer"),Qn=dn==null?vt:Ns(dn),He=yn==null?vt:Ns(yn),vt=new En(Nt,ke+"leave",dn,l,It),vt.target=Qn,vt.relatedTarget=He,Nt=null,is(It)===Ge&&(En=new En(je,ke+"enter",yn,l,It),En.target=He,En.relatedTarget=Qn,Nt=En),Qn=Nt,dn&&yn)t:{for(En=dn,je=yn,ke=0,He=En;He;He=Vs(He))ke++;for(He=0,Nt=je;Nt;Nt=Vs(Nt))He++;for(;0<ke-He;)En=Vs(En),ke--;for(;0<He-ke;)je=Vs(je),He--;for(;ke--;){if(En===je||je!==null&&En===je.alternate)break t;En=Vs(En),je=Vs(je)}En=null}else En=null;dn!==null&&Wc(Ct,vt,dn,En,!1),yn!==null&&Qn!==null&&Wc(Ct,Qn,yn,En,!0)}}e:{if(vt=Ge?Ns(Ge):window,dn=vt.nodeName&&vt.nodeName.toLowerCase(),dn==="select"||dn==="input"&&vt.type==="file")var Tn=hf;else if(Tc(vt))if(Rc)Tn=mf;else{Tn=ff;var Sn=df}else(dn=vt.nodeName)&&dn.toLowerCase()==="input"&&(vt.type==="checkbox"||vt.type==="radio")&&(Tn=pf);if(Tn&&(Tn=Tn(r,Ge))){Pc(Ct,Tn,l,It);break e}Sn&&Sn(r,vt,Ge),r==="focusout"&&(Sn=vt._wrapperState)&&Sn.controlled&&vt.type==="number"&&me(vt,"number",vt.value)}switch(Sn=Ge?Ns(Ge):window,r){case"focusin":(Tc(Sn)||Sn.contentEditable==="true")&&(ks=Sn,Tl=Ge,po=null);break;case"focusout":po=Tl=ks=null;break;case"mousedown":Pl=!0;break;case"contextmenu":case"mouseup":case"dragend":Pl=!1,Dc(Ct,l,It);break;case"selectionchange":if(yf)break;case"keydown":case"keyup":Dc(Ct,l,It)}var wn;if(Jn)e:{switch(r){case"compositionstart":var Cn="onCompositionStart";break e;case"compositionend":Cn="onCompositionEnd";break e;case"compositionupdate":Cn="onCompositionUpdate";break e}Cn=void 0}else xs?vc(r,l)&&(Cn="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(Cn="onCompositionStart");Cn&&(rs&&l.locale!=="ko"&&(xs||Cn!=="onCompositionStart"?Cn==="onCompositionEnd"&&xs&&(wn=oo()):(kr=It,As="value"in kr?kr.value:kr.textContent,xs=!0)),Sn=ha(Ge,Cn),0<Sn.length&&(Cn=new uo(Cn,r,null,l,It),Ct.push({event:Cn,listeners:Sn}),wn?Cn.data=wn:(wn=Ac(l),wn!==null&&(Cn.data=wn)))),(wn=Dr?af(r,l):lf(r,l))&&(Ge=ha(Ge,"onBeforeInput"),0<Ge.length&&(It=new uo("onBeforeInput","beforeinput",null,l,It),Ct.push({event:It,listeners:Ge}),It.data=wn))}Bc(Ct,s)})}function go(r,s,l){return{instance:r,listener:s,currentTarget:l}}function ha(r,s){for(var l=s+"Capture",h=[];r!==null;){var m=r,P=m.stateNode;m.tag===5&&P!==null&&(m=P,P=Me(r,l),P!=null&&h.unshift(go(r,P,m)),P=Me(r,s),P!=null&&h.push(go(r,P,m))),r=r.return}return h}function Vs(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Wc(r,s,l,h,m){for(var P=s._reactName,ne=[];l!==null&&l!==h;){var ye=l,Ie=ye.alternate,Ge=ye.stateNode;if(Ie!==null&&Ie===h)break;ye.tag===5&&Ge!==null&&(ye=Ge,m?(Ie=Me(l,P),Ie!=null&&ne.unshift(go(l,Ie,ye))):m||(Ie=Me(l,P),Ie!=null&&ne.push(go(l,Ie,ye)))),l=l.return}ne.length!==0&&r.push({event:s,listeners:ne})}var Tf=/\r\n?/g,Pf=/\u0000|\uFFFD/g;function $c(r){return(typeof r=="string"?r:""+r).replace(Tf,`
`).replace(Pf,"")}function da(r,s,l){if(s=$c(s),$c(r)!==s&&l)throw Error(t(425))}function fa(){}var Cl=null,xl=null;function kl(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Dl=typeof setTimeout=="function"?setTimeout:void 0,Rf=typeof clearTimeout=="function"?clearTimeout:void 0,Hc=typeof Promise=="function"?Promise:void 0,If=typeof queueMicrotask=="function"?queueMicrotask:typeof Hc<"u"?function(r){return Hc.resolve(null).then(r).catch(Sf)}:Dl;function Sf(r){setTimeout(function(){throw r})}function Vl(r,s){var l=s,h=0;do{var m=l.nextSibling;if(r.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(h===0){r.removeChild(m),Xr(s);return}h--}else l!=="$"&&l!=="$?"&&l!=="$!"||h++;l=m}while(l);Xr(s)}function Fi(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return r}function qc(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return r;s--}else l==="/$"&&s++}r=r.previousSibling}return null}var Ms=Math.random().toString(36).slice(2),li="__reactFiber$"+Ms,yo="__reactProps$"+Ms,gi="__reactContainer$"+Ms,Ml="__reactEvents$"+Ms,wf="__reactListeners$"+Ms,bf="__reactHandles$"+Ms;function is(r){var s=r[li];if(s)return s;for(var l=r.parentNode;l;){if(s=l[gi]||l[li]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(r=qc(r);r!==null;){if(l=r[li])return l;r=qc(r)}return s}r=l,l=r.parentNode}return null}function Eo(r){return r=r[li]||r[gi],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Ns(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function pa(r){return r[yo]||null}var Nl=[],Fs=-1;function Oi(r){return{current:r}}function $n(r){0>Fs||(r.current=Nl[Fs],Nl[Fs]=null,Fs--)}function zn(r,s){Fs++,Nl[Fs]=r.current,r.current=s}var Li={},dr=Oi(Li),Rr=Oi(!1),ss=Li;function Os(r,s){var l=r.type.contextTypes;if(!l)return Li;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===s)return h.__reactInternalMemoizedMaskedChildContext;var m={},P;for(P in l)m[P]=s[P];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=m),m}function Ir(r){return r=r.childContextTypes,r!=null}function ma(){$n(Rr),$n(dr)}function Gc(r,s,l){if(dr.current!==Li)throw Error(t(168));zn(dr,s),zn(Rr,l)}function Kc(r,s,l){var h=r.stateNode;if(s=s.childContextTypes,typeof h.getChildContext!="function")return l;h=h.getChildContext();for(var m in h)if(!(m in s))throw Error(t(108,ce(r)||"Unknown",m));return fe({},l,h)}function _a(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Li,ss=dr.current,zn(dr,r),zn(Rr,Rr.current),!0}function Xc(r,s,l){var h=r.stateNode;if(!h)throw Error(t(169));l?(r=Kc(r,s,ss),h.__reactInternalMemoizedMergedChildContext=r,$n(Rr),$n(dr),zn(dr,r)):$n(Rr),zn(Rr,l)}var yi=null,ga=!1,Fl=!1;function Yc(r){yi===null?yi=[r]:yi.push(r)}function Cf(r){ga=!0,Yc(r)}function Ui(){if(!Fl&&yi!==null){Fl=!0;var r=0,s=Vn;try{var l=yi;for(Vn=1;r<l.length;r++){var h=l[r];do h=h(!0);while(h!==null)}yi=null,ga=!1}catch(m){throw yi!==null&&(yi=yi.slice(r+1)),_r(Yi,Ui),m}finally{Vn=s,Fl=!1}}return null}var Ls=[],Us=0,ya=null,Ea=0,Ur=[],jr=0,os=null,Ei=1,vi="";function as(r,s){Ls[Us++]=Ea,Ls[Us++]=ya,ya=r,Ea=s}function Qc(r,s,l){Ur[jr++]=Ei,Ur[jr++]=vi,Ur[jr++]=os,os=r;var h=Ei;r=vi;var m=32-gr(h)-1;h&=~(1<<m),l+=1;var P=32-gr(s)+m;if(30<P){var ne=m-m%5;P=(h&(1<<ne)-1).toString(32),h>>=ne,m-=ne,Ei=1<<32-gr(s)+m|l<<m|h,vi=P+r}else Ei=1<<P|l<<m|h,vi=r}function Ol(r){r.return!==null&&(as(r,1),Qc(r,1,0))}function Ll(r){for(;r===ya;)ya=Ls[--Us],Ls[Us]=null,Ea=Ls[--Us],Ls[Us]=null;for(;r===os;)os=Ur[--jr],Ur[jr]=null,vi=Ur[--jr],Ur[jr]=null,Ei=Ur[--jr],Ur[jr]=null}var Vr=null,Mr=null,qn=!1,Jr=null;function Jc(r,s){var l=$r(5,null,null,0);l.elementType="DELETED",l.stateNode=s,l.return=r,s=r.deletions,s===null?(r.deletions=[l],r.flags|=16):s.push(l)}function Zc(r,s){switch(r.tag){case 5:var l=r.type;return s=s.nodeType!==1||l.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(r.stateNode=s,Vr=r,Mr=Fi(s.firstChild),!0):!1;case 6:return s=r.pendingProps===""||s.nodeType!==3?null:s,s!==null?(r.stateNode=s,Vr=r,Mr=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(l=os!==null?{id:Ei,overflow:vi}:null,r.memoizedState={dehydrated:s,treeContext:l,retryLane:1073741824},l=$r(18,null,null,0),l.stateNode=s,l.return=r,r.child=l,Vr=r,Mr=null,!0):!1;default:return!1}}function Ul(r){return(r.mode&1)!==0&&(r.flags&128)===0}function jl(r){if(qn){var s=Mr;if(s){var l=s;if(!Zc(r,s)){if(Ul(r))throw Error(t(418));s=Fi(l.nextSibling);var h=Vr;s&&Zc(r,s)?Jc(h,l):(r.flags=r.flags&-4097|2,qn=!1,Vr=r)}}else{if(Ul(r))throw Error(t(418));r.flags=r.flags&-4097|2,qn=!1,Vr=r}}}function eh(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Vr=r}function va(r){if(r!==Vr)return!1;if(!qn)return eh(r),qn=!0,!1;var s;if((s=r.tag!==3)&&!(s=r.tag!==5)&&(s=r.type,s=s!=="head"&&s!=="body"&&!kl(r.type,r.memoizedProps)),s&&(s=Mr)){if(Ul(r))throw th(),Error(t(418));for(;s;)Jc(r,s),s=Fi(s.nextSibling)}if(eh(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"){if(s===0){Mr=Fi(r.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++}r=r.nextSibling}Mr=null}}else Mr=Vr?Fi(r.stateNode.nextSibling):null;return!0}function th(){for(var r=Mr;r;)r=Fi(r.nextSibling)}function js(){Mr=Vr=null,qn=!1}function Bl(r){Jr===null?Jr=[r]:Jr.push(r)}var xf=te.ReactCurrentBatchConfig;function vo(r,s,l){if(r=l.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var h=l.stateNode}if(!h)throw Error(t(147,r));var m=h,P=""+r;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===P?s.ref:(s=function(ne){var ye=m.refs;ne===null?delete ye[P]:ye[P]=ne},s._stringRef=P,s)}if(typeof r!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,r))}return r}function Aa(r,s){throw r=Object.prototype.toString.call(s),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r))}function nh(r){var s=r._init;return s(r._payload)}function rh(r){function s(je,ke){if(r){var He=je.deletions;He===null?(je.deletions=[ke],je.flags|=16):He.push(ke)}}function l(je,ke){if(!r)return null;for(;ke!==null;)s(je,ke),ke=ke.sibling;return null}function h(je,ke){for(je=new Map;ke!==null;)ke.key!==null?je.set(ke.key,ke):je.set(ke.index,ke),ke=ke.sibling;return je}function m(je,ke){return je=Gi(je,ke),je.index=0,je.sibling=null,je}function P(je,ke,He){return je.index=He,r?(He=je.alternate,He!==null?(He=He.index,He<ke?(je.flags|=2,ke):He):(je.flags|=2,ke)):(je.flags|=1048576,ke)}function ne(je){return r&&je.alternate===null&&(je.flags|=2),je}function ye(je,ke,He,Nt){return ke===null||ke.tag!==6?(ke=Du(He,je.mode,Nt),ke.return=je,ke):(ke=m(ke,He),ke.return=je,ke)}function Ie(je,ke,He,Nt){var Tn=He.type;return Tn===y?It(je,ke,He.props.children,Nt,He.key):ke!==null&&(ke.elementType===Tn||typeof Tn=="object"&&Tn!==null&&Tn.$$typeof===Re&&nh(Tn)===ke.type)?(Nt=m(ke,He.props),Nt.ref=vo(je,ke,He),Nt.return=je,Nt):(Nt=Ha(He.type,He.key,He.props,null,je.mode,Nt),Nt.ref=vo(je,ke,He),Nt.return=je,Nt)}function Ge(je,ke,He,Nt){return ke===null||ke.tag!==4||ke.stateNode.containerInfo!==He.containerInfo||ke.stateNode.implementation!==He.implementation?(ke=Vu(He,je.mode,Nt),ke.return=je,ke):(ke=m(ke,He.children||[]),ke.return=je,ke)}function It(je,ke,He,Nt,Tn){return ke===null||ke.tag!==7?(ke=ms(He,je.mode,Nt,Tn),ke.return=je,ke):(ke=m(ke,He),ke.return=je,ke)}function Ct(je,ke,He){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return ke=Du(""+ke,je.mode,He),ke.return=je,ke;if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case H:return He=Ha(ke.type,ke.key,ke.props,null,je.mode,He),He.ref=vo(je,null,ke),He.return=je,He;case J:return ke=Vu(ke,je.mode,He),ke.return=je,ke;case Re:var Nt=ke._init;return Ct(je,Nt(ke._payload),He)}if(Te(ke)||ie(ke))return ke=ms(ke,je.mode,He,null),ke.return=je,ke;Aa(je,ke)}return null}function vt(je,ke,He,Nt){var Tn=ke!==null?ke.key:null;if(typeof He=="string"&&He!==""||typeof He=="number")return Tn!==null?null:ye(je,ke,""+He,Nt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case H:return He.key===Tn?Ie(je,ke,He,Nt):null;case J:return He.key===Tn?Ge(je,ke,He,Nt):null;case Re:return Tn=He._init,vt(je,ke,Tn(He._payload),Nt)}if(Te(He)||ie(He))return Tn!==null?null:It(je,ke,He,Nt,null);Aa(je,He)}return null}function dn(je,ke,He,Nt,Tn){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number")return je=je.get(He)||null,ye(ke,je,""+Nt,Tn);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case H:return je=je.get(Nt.key===null?He:Nt.key)||null,Ie(ke,je,Nt,Tn);case J:return je=je.get(Nt.key===null?He:Nt.key)||null,Ge(ke,je,Nt,Tn);case Re:var Sn=Nt._init;return dn(je,ke,He,Sn(Nt._payload),Tn)}if(Te(Nt)||ie(Nt))return je=je.get(He)||null,It(ke,je,Nt,Tn,null);Aa(ke,Nt)}return null}function yn(je,ke,He,Nt){for(var Tn=null,Sn=null,wn=ke,Cn=ke=0,or=null;wn!==null&&Cn<He.length;Cn++){wn.index>Cn?(or=wn,wn=null):or=wn.sibling;var Fn=vt(je,wn,He[Cn],Nt);if(Fn===null){wn===null&&(wn=or);break}r&&wn&&Fn.alternate===null&&s(je,wn),ke=P(Fn,ke,Cn),Sn===null?Tn=Fn:Sn.sibling=Fn,Sn=Fn,wn=or}if(Cn===He.length)return l(je,wn),qn&&as(je,Cn),Tn;if(wn===null){for(;Cn<He.length;Cn++)wn=Ct(je,He[Cn],Nt),wn!==null&&(ke=P(wn,ke,Cn),Sn===null?Tn=wn:Sn.sibling=wn,Sn=wn);return qn&&as(je,Cn),Tn}for(wn=h(je,wn);Cn<He.length;Cn++)or=dn(wn,je,Cn,He[Cn],Nt),or!==null&&(r&&or.alternate!==null&&wn.delete(or.key===null?Cn:or.key),ke=P(or,ke,Cn),Sn===null?Tn=or:Sn.sibling=or,Sn=or);return r&&wn.forEach(function(Ki){return s(je,Ki)}),qn&&as(je,Cn),Tn}function En(je,ke,He,Nt){var Tn=ie(He);if(typeof Tn!="function")throw Error(t(150));if(He=Tn.call(He),He==null)throw Error(t(151));for(var Sn=Tn=null,wn=ke,Cn=ke=0,or=null,Fn=He.next();wn!==null&&!Fn.done;Cn++,Fn=He.next()){wn.index>Cn?(or=wn,wn=null):or=wn.sibling;var Ki=vt(je,wn,Fn.value,Nt);if(Ki===null){wn===null&&(wn=or);break}r&&wn&&Ki.alternate===null&&s(je,wn),ke=P(Ki,ke,Cn),Sn===null?Tn=Ki:Sn.sibling=Ki,Sn=Ki,wn=or}if(Fn.done)return l(je,wn),qn&&as(je,Cn),Tn;if(wn===null){for(;!Fn.done;Cn++,Fn=He.next())Fn=Ct(je,Fn.value,Nt),Fn!==null&&(ke=P(Fn,ke,Cn),Sn===null?Tn=Fn:Sn.sibling=Fn,Sn=Fn);return qn&&as(je,Cn),Tn}for(wn=h(je,wn);!Fn.done;Cn++,Fn=He.next())Fn=dn(wn,je,Cn,Fn.value,Nt),Fn!==null&&(r&&Fn.alternate!==null&&wn.delete(Fn.key===null?Cn:Fn.key),ke=P(Fn,ke,Cn),Sn===null?Tn=Fn:Sn.sibling=Fn,Sn=Fn);return r&&wn.forEach(function(up){return s(je,up)}),qn&&as(je,Cn),Tn}function Qn(je,ke,He,Nt){if(typeof He=="object"&&He!==null&&He.type===y&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case H:e:{for(var Tn=He.key,Sn=ke;Sn!==null;){if(Sn.key===Tn){if(Tn=He.type,Tn===y){if(Sn.tag===7){l(je,Sn.sibling),ke=m(Sn,He.props.children),ke.return=je,je=ke;break e}}else if(Sn.elementType===Tn||typeof Tn=="object"&&Tn!==null&&Tn.$$typeof===Re&&nh(Tn)===Sn.type){l(je,Sn.sibling),ke=m(Sn,He.props),ke.ref=vo(je,Sn,He),ke.return=je,je=ke;break e}l(je,Sn);break}else s(je,Sn);Sn=Sn.sibling}He.type===y?(ke=ms(He.props.children,je.mode,Nt,He.key),ke.return=je,je=ke):(Nt=Ha(He.type,He.key,He.props,null,je.mode,Nt),Nt.ref=vo(je,ke,He),Nt.return=je,je=Nt)}return ne(je);case J:e:{for(Sn=He.key;ke!==null;){if(ke.key===Sn)if(ke.tag===4&&ke.stateNode.containerInfo===He.containerInfo&&ke.stateNode.implementation===He.implementation){l(je,ke.sibling),ke=m(ke,He.children||[]),ke.return=je,je=ke;break e}else{l(je,ke);break}else s(je,ke);ke=ke.sibling}ke=Vu(He,je.mode,Nt),ke.return=je,je=ke}return ne(je);case Re:return Sn=He._init,Qn(je,ke,Sn(He._payload),Nt)}if(Te(He))return yn(je,ke,He,Nt);if(ie(He))return En(je,ke,He,Nt);Aa(je,He)}return typeof He=="string"&&He!==""||typeof He=="number"?(He=""+He,ke!==null&&ke.tag===6?(l(je,ke.sibling),ke=m(ke,He),ke.return=je,je=ke):(l(je,ke),ke=Du(He,je.mode,Nt),ke.return=je,je=ke),ne(je)):l(je,ke)}return Qn}var Bs=rh(!0),ih=rh(!1),Ta=Oi(null),Pa=null,zs=null,zl=null;function Wl(){zl=zs=Pa=null}function $l(r){var s=Ta.current;$n(Ta),r._currentValue=s}function Hl(r,s,l){for(;r!==null;){var h=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),r===l)break;r=r.return}}function Ws(r,s){Pa=r,zl=zs=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&s)!==0&&(Sr=!0),r.firstContext=null)}function Br(r){var s=r._currentValue;if(zl!==r)if(r={context:r,memoizedValue:s,next:null},zs===null){if(Pa===null)throw Error(t(308));zs=r,Pa.dependencies={lanes:0,firstContext:r}}else zs=zs.next=r;return s}var ls=null;function ql(r){ls===null?ls=[r]:ls.push(r)}function sh(r,s,l,h){var m=s.interleaved;return m===null?(l.next=l,ql(s)):(l.next=m.next,m.next=l),s.interleaved=l,Ai(r,h)}function Ai(r,s){r.lanes|=s;var l=r.alternate;for(l!==null&&(l.lanes|=s),l=r,r=r.return;r!==null;)r.childLanes|=s,l=r.alternate,l!==null&&(l.childLanes|=s),l=r,r=r.return;return l.tag===3?l.stateNode:null}var ji=!1;function Gl(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oh(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Ti(r,s){return{eventTime:r,lane:s,tag:0,payload:null,callback:null,next:null}}function Bi(r,s,l){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(Nn&2)!==0){var m=h.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),h.pending=s,Ai(r,l)}return m=h.interleaved,m===null?(s.next=s,ql(h)):(s.next=m.next,m.next=s),h.interleaved=s,Ai(r,l)}function Ra(r,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194240)!==0)){var h=s.lanes;h&=r.pendingLanes,l|=h,s.lanes=l,xi(r,l)}}function ah(r,s){var l=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var m=null,P=null;if(l=l.firstBaseUpdate,l!==null){do{var ne={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};P===null?m=P=ne:P=P.next=ne,l=l.next}while(l!==null);P===null?m=P=s:P=P.next=s}else m=P=s;l={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:P,shared:h.shared,effects:h.effects},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=s:r.next=s,l.lastBaseUpdate=s}function Ia(r,s,l,h){var m=r.updateQueue;ji=!1;var P=m.firstBaseUpdate,ne=m.lastBaseUpdate,ye=m.shared.pending;if(ye!==null){m.shared.pending=null;var Ie=ye,Ge=Ie.next;Ie.next=null,ne===null?P=Ge:ne.next=Ge,ne=Ie;var It=r.alternate;It!==null&&(It=It.updateQueue,ye=It.lastBaseUpdate,ye!==ne&&(ye===null?It.firstBaseUpdate=Ge:ye.next=Ge,It.lastBaseUpdate=Ie))}if(P!==null){var Ct=m.baseState;ne=0,It=Ge=Ie=null,ye=P;do{var vt=ye.lane,dn=ye.eventTime;if((h&vt)===vt){It!==null&&(It=It.next={eventTime:dn,lane:0,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null});e:{var yn=r,En=ye;switch(vt=s,dn=l,En.tag){case 1:if(yn=En.payload,typeof yn=="function"){Ct=yn.call(dn,Ct,vt);break e}Ct=yn;break e;case 3:yn.flags=yn.flags&-65537|128;case 0:if(yn=En.payload,vt=typeof yn=="function"?yn.call(dn,Ct,vt):yn,vt==null)break e;Ct=fe({},Ct,vt);break e;case 2:ji=!0}}ye.callback!==null&&ye.lane!==0&&(r.flags|=64,vt=m.effects,vt===null?m.effects=[ye]:vt.push(ye))}else dn={eventTime:dn,lane:vt,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},It===null?(Ge=It=dn,Ie=Ct):It=It.next=dn,ne|=vt;if(ye=ye.next,ye===null){if(ye=m.shared.pending,ye===null)break;vt=ye,ye=vt.next,vt.next=null,m.lastBaseUpdate=vt,m.shared.pending=null}}while(!0);if(It===null&&(Ie=Ct),m.baseState=Ie,m.firstBaseUpdate=Ge,m.lastBaseUpdate=It,s=m.shared.interleaved,s!==null){m=s;do ne|=m.lane,m=m.next;while(m!==s)}else P===null&&(m.shared.lanes=0);hs|=ne,r.lanes=ne,r.memoizedState=Ct}}function lh(r,s,l){if(r=s.effects,s.effects=null,r!==null)for(s=0;s<r.length;s++){var h=r[s],m=h.callback;if(m!==null){if(h.callback=null,h=l,typeof m!="function")throw Error(t(191,m));m.call(h)}}}var Ao={},ui=Oi(Ao),To=Oi(Ao),Po=Oi(Ao);function us(r){if(r===Ao)throw Error(t(174));return r}function Kl(r,s){switch(zn(Po,s),zn(To,r),zn(ui,Ao),r=s.nodeType,r){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:nt(null,"");break;default:r=r===8?s.parentNode:s,s=r.namespaceURI||null,r=r.tagName,s=nt(s,r)}$n(ui),zn(ui,s)}function $s(){$n(ui),$n(To),$n(Po)}function uh(r){us(Po.current);var s=us(ui.current),l=nt(s,r.type);s!==l&&(zn(To,r),zn(ui,l))}function Xl(r){To.current===r&&($n(ui),$n(To))}var Kn=Oi(0);function Sa(r){for(var s=r;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Yl=[];function Ql(){for(var r=0;r<Yl.length;r++)Yl[r]._workInProgressVersionPrimary=null;Yl.length=0}var wa=te.ReactCurrentDispatcher,Jl=te.ReactCurrentBatchConfig,cs=0,Xn=null,tr=null,ir=null,ba=!1,Ro=!1,Io=0,kf=0;function fr(){throw Error(t(321))}function Zl(r,s){if(s===null)return!1;for(var l=0;l<s.length&&l<r.length;l++)if(!Qr(r[l],s[l]))return!1;return!0}function eu(r,s,l,h,m,P){if(cs=P,Xn=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,wa.current=r===null||r.memoizedState===null?Nf:Ff,r=l(h,m),Ro){P=0;do{if(Ro=!1,Io=0,25<=P)throw Error(t(301));P+=1,ir=tr=null,s.updateQueue=null,wa.current=Of,r=l(h,m)}while(Ro)}if(wa.current=ka,s=tr!==null&&tr.next!==null,cs=0,ir=tr=Xn=null,ba=!1,s)throw Error(t(300));return r}function tu(){var r=Io!==0;return Io=0,r}function ci(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ir===null?Xn.memoizedState=ir=r:ir=ir.next=r,ir}function zr(){if(tr===null){var r=Xn.alternate;r=r!==null?r.memoizedState:null}else r=tr.next;var s=ir===null?Xn.memoizedState:ir.next;if(s!==null)ir=s,tr=r;else{if(r===null)throw Error(t(310));tr=r,r={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},ir===null?Xn.memoizedState=ir=r:ir=ir.next=r}return ir}function So(r,s){return typeof s=="function"?s(r):s}function nu(r){var s=zr(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=r;var h=tr,m=h.baseQueue,P=l.pending;if(P!==null){if(m!==null){var ne=m.next;m.next=P.next,P.next=ne}h.baseQueue=m=P,l.pending=null}if(m!==null){P=m.next,h=h.baseState;var ye=ne=null,Ie=null,Ge=P;do{var It=Ge.lane;if((cs&It)===It)Ie!==null&&(Ie=Ie.next={lane:0,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null}),h=Ge.hasEagerState?Ge.eagerState:r(h,Ge.action);else{var Ct={lane:It,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null};Ie===null?(ye=Ie=Ct,ne=h):Ie=Ie.next=Ct,Xn.lanes|=It,hs|=It}Ge=Ge.next}while(Ge!==null&&Ge!==P);Ie===null?ne=h:Ie.next=ye,Qr(h,s.memoizedState)||(Sr=!0),s.memoizedState=h,s.baseState=ne,s.baseQueue=Ie,l.lastRenderedState=h}if(r=l.interleaved,r!==null){m=r;do P=m.lane,Xn.lanes|=P,hs|=P,m=m.next;while(m!==r)}else m===null&&(l.lanes=0);return[s.memoizedState,l.dispatch]}function ru(r){var s=zr(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=r;var h=l.dispatch,m=l.pending,P=s.memoizedState;if(m!==null){l.pending=null;var ne=m=m.next;do P=r(P,ne.action),ne=ne.next;while(ne!==m);Qr(P,s.memoizedState)||(Sr=!0),s.memoizedState=P,s.baseQueue===null&&(s.baseState=P),l.lastRenderedState=P}return[P,h]}function ch(){}function hh(r,s){var l=Xn,h=zr(),m=s(),P=!Qr(h.memoizedState,m);if(P&&(h.memoizedState=m,Sr=!0),h=h.queue,iu(ph.bind(null,l,h,r),[r]),h.getSnapshot!==s||P||ir!==null&&ir.memoizedState.tag&1){if(l.flags|=2048,wo(9,fh.bind(null,l,h,m,s),void 0,null),sr===null)throw Error(t(349));(cs&30)!==0||dh(l,s,m)}return m}function dh(r,s,l){r.flags|=16384,r={getSnapshot:s,value:l},s=Xn.updateQueue,s===null?(s={lastEffect:null,stores:null},Xn.updateQueue=s,s.stores=[r]):(l=s.stores,l===null?s.stores=[r]:l.push(r))}function fh(r,s,l,h){s.value=l,s.getSnapshot=h,mh(s)&&_h(r)}function ph(r,s,l){return l(function(){mh(s)&&_h(r)})}function mh(r){var s=r.getSnapshot;r=r.value;try{var l=s();return!Qr(r,l)}catch{return!0}}function _h(r){var s=Ai(r,1);s!==null&&ni(s,r,1,-1)}function gh(r){var s=ci();return typeof r=="function"&&(r=r()),s.memoizedState=s.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:r},s.queue=r,r=r.dispatch=Mf.bind(null,Xn,r),[s.memoizedState,r]}function wo(r,s,l,h){return r={tag:r,create:s,destroy:l,deps:h,next:null},s=Xn.updateQueue,s===null?(s={lastEffect:null,stores:null},Xn.updateQueue=s,s.lastEffect=r.next=r):(l=s.lastEffect,l===null?s.lastEffect=r.next=r:(h=l.next,l.next=r,r.next=h,s.lastEffect=r)),r}function yh(){return zr().memoizedState}function Ca(r,s,l,h){var m=ci();Xn.flags|=r,m.memoizedState=wo(1|s,l,void 0,h===void 0?null:h)}function xa(r,s,l,h){var m=zr();h=h===void 0?null:h;var P=void 0;if(tr!==null){var ne=tr.memoizedState;if(P=ne.destroy,h!==null&&Zl(h,ne.deps)){m.memoizedState=wo(s,l,P,h);return}}Xn.flags|=r,m.memoizedState=wo(1|s,l,P,h)}function Eh(r,s){return Ca(8390656,8,r,s)}function iu(r,s){return xa(2048,8,r,s)}function vh(r,s){return xa(4,2,r,s)}function Ah(r,s){return xa(4,4,r,s)}function Th(r,s){if(typeof s=="function")return r=r(),s(r),function(){s(null)};if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function Ph(r,s,l){return l=l!=null?l.concat([r]):null,xa(4,4,Th.bind(null,s,r),l)}function su(){}function Rh(r,s){var l=zr();s=s===void 0?null:s;var h=l.memoizedState;return h!==null&&s!==null&&Zl(s,h[1])?h[0]:(l.memoizedState=[r,s],r)}function Ih(r,s){var l=zr();s=s===void 0?null:s;var h=l.memoizedState;return h!==null&&s!==null&&Zl(s,h[1])?h[0]:(r=r(),l.memoizedState=[r,s],r)}function Sh(r,s,l){return(cs&21)===0?(r.baseState&&(r.baseState=!1,Sr=!0),r.memoizedState=l):(Qr(l,s)||(l=Zi(),Xn.lanes|=l,hs|=l,r.baseState=!0),s)}function Df(r,s){var l=Vn;Vn=l!==0&&4>l?l:4,r(!0);var h=Jl.transition;Jl.transition={};try{r(!1),s()}finally{Vn=l,Jl.transition=h}}function wh(){return zr().memoizedState}function Vf(r,s,l){var h=Hi(r);if(l={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null},bh(r))Ch(s,l);else if(l=sh(r,s,l,h),l!==null){var m=vr();ni(l,r,h,m),xh(l,s,h)}}function Mf(r,s,l){var h=Hi(r),m={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null};if(bh(r))Ch(s,m);else{var P=r.alternate;if(r.lanes===0&&(P===null||P.lanes===0)&&(P=s.lastRenderedReducer,P!==null))try{var ne=s.lastRenderedState,ye=P(ne,l);if(m.hasEagerState=!0,m.eagerState=ye,Qr(ye,ne)){var Ie=s.interleaved;Ie===null?(m.next=m,ql(s)):(m.next=Ie.next,Ie.next=m),s.interleaved=m;return}}catch{}finally{}l=sh(r,s,m,h),l!==null&&(m=vr(),ni(l,r,h,m),xh(l,s,h))}}function bh(r){var s=r.alternate;return r===Xn||s!==null&&s===Xn}function Ch(r,s){Ro=ba=!0;var l=r.pending;l===null?s.next=s:(s.next=l.next,l.next=s),r.pending=s}function xh(r,s,l){if((l&4194240)!==0){var h=s.lanes;h&=r.pendingLanes,l|=h,s.lanes=l,xi(r,l)}}var ka={readContext:Br,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useInsertionEffect:fr,useLayoutEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useMutableSource:fr,useSyncExternalStore:fr,useId:fr,unstable_isNewReconciler:!1},Nf={readContext:Br,useCallback:function(r,s){return ci().memoizedState=[r,s===void 0?null:s],r},useContext:Br,useEffect:Eh,useImperativeHandle:function(r,s,l){return l=l!=null?l.concat([r]):null,Ca(4194308,4,Th.bind(null,s,r),l)},useLayoutEffect:function(r,s){return Ca(4194308,4,r,s)},useInsertionEffect:function(r,s){return Ca(4,2,r,s)},useMemo:function(r,s){var l=ci();return s=s===void 0?null:s,r=r(),l.memoizedState=[r,s],r},useReducer:function(r,s,l){var h=ci();return s=l!==void 0?l(s):s,h.memoizedState=h.baseState=s,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:s},h.queue=r,r=r.dispatch=Vf.bind(null,Xn,r),[h.memoizedState,r]},useRef:function(r){var s=ci();return r={current:r},s.memoizedState=r},useState:gh,useDebugValue:su,useDeferredValue:function(r){return ci().memoizedState=r},useTransition:function(){var r=gh(!1),s=r[0];return r=Df.bind(null,r[1]),ci().memoizedState=r,[s,r]},useMutableSource:function(){},useSyncExternalStore:function(r,s,l){var h=Xn,m=ci();if(qn){if(l===void 0)throw Error(t(407));l=l()}else{if(l=s(),sr===null)throw Error(t(349));(cs&30)!==0||dh(h,s,l)}m.memoizedState=l;var P={value:l,getSnapshot:s};return m.queue=P,Eh(ph.bind(null,h,P,r),[r]),h.flags|=2048,wo(9,fh.bind(null,h,P,l,s),void 0,null),l},useId:function(){var r=ci(),s=sr.identifierPrefix;if(qn){var l=vi,h=Ei;l=(h&~(1<<32-gr(h)-1)).toString(32)+l,s=":"+s+"R"+l,l=Io++,0<l&&(s+="H"+l.toString(32)),s+=":"}else l=kf++,s=":"+s+"r"+l.toString(32)+":";return r.memoizedState=s},unstable_isNewReconciler:!1},Ff={readContext:Br,useCallback:Rh,useContext:Br,useEffect:iu,useImperativeHandle:Ph,useInsertionEffect:vh,useLayoutEffect:Ah,useMemo:Ih,useReducer:nu,useRef:yh,useState:function(){return nu(So)},useDebugValue:su,useDeferredValue:function(r){var s=zr();return Sh(s,tr.memoizedState,r)},useTransition:function(){var r=nu(So)[0],s=zr().memoizedState;return[r,s]},useMutableSource:ch,useSyncExternalStore:hh,useId:wh,unstable_isNewReconciler:!1},Of={readContext:Br,useCallback:Rh,useContext:Br,useEffect:iu,useImperativeHandle:Ph,useInsertionEffect:vh,useLayoutEffect:Ah,useMemo:Ih,useReducer:ru,useRef:yh,useState:function(){return ru(So)},useDebugValue:su,useDeferredValue:function(r){var s=zr();return tr===null?s.memoizedState=r:Sh(s,tr.memoizedState,r)},useTransition:function(){var r=ru(So)[0],s=zr().memoizedState;return[r,s]},useMutableSource:ch,useSyncExternalStore:hh,useId:wh,unstable_isNewReconciler:!1};function Zr(r,s){if(r&&r.defaultProps){s=fe({},s),r=r.defaultProps;for(var l in r)s[l]===void 0&&(s[l]=r[l]);return s}return s}function ou(r,s,l,h){s=r.memoizedState,l=l(h,s),l=l==null?s:fe({},s,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Da={isMounted:function(r){return(r=r._reactInternals)?vn(r)===r:!1},enqueueSetState:function(r,s,l){r=r._reactInternals;var h=vr(),m=Hi(r),P=Ti(h,m);P.payload=s,l!=null&&(P.callback=l),s=Bi(r,P,m),s!==null&&(ni(s,r,m,h),Ra(s,r,m))},enqueueReplaceState:function(r,s,l){r=r._reactInternals;var h=vr(),m=Hi(r),P=Ti(h,m);P.tag=1,P.payload=s,l!=null&&(P.callback=l),s=Bi(r,P,m),s!==null&&(ni(s,r,m,h),Ra(s,r,m))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var l=vr(),h=Hi(r),m=Ti(l,h);m.tag=2,s!=null&&(m.callback=s),s=Bi(r,m,h),s!==null&&(ni(s,r,h,l),Ra(s,r,h))}};function kh(r,s,l,h,m,P,ne){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,P,ne):s.prototype&&s.prototype.isPureReactComponent?!fo(l,h)||!fo(m,P):!0}function Dh(r,s,l){var h=!1,m=Li,P=s.contextType;return typeof P=="object"&&P!==null?P=Br(P):(m=Ir(s)?ss:dr.current,h=s.contextTypes,P=(h=h!=null)?Os(r,m):Li),s=new s(l,P),r.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Da,r.stateNode=s,s._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=m,r.__reactInternalMemoizedMaskedChildContext=P),s}function Vh(r,s,l,h){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,h),s.state!==r&&Da.enqueueReplaceState(s,s.state,null)}function au(r,s,l,h){var m=r.stateNode;m.props=l,m.state=r.memoizedState,m.refs={},Gl(r);var P=s.contextType;typeof P=="object"&&P!==null?m.context=Br(P):(P=Ir(s)?ss:dr.current,m.context=Os(r,P)),m.state=r.memoizedState,P=s.getDerivedStateFromProps,typeof P=="function"&&(ou(r,s,P,l),m.state=r.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(s=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),s!==m.state&&Da.enqueueReplaceState(m,m.state,null),Ia(r,l,m,h),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308)}function Hs(r,s){try{var l="",h=s;do l+=ee(h),h=h.return;while(h);var m=l}catch(P){m=`
Error generating stack: `+P.message+`
`+P.stack}return{value:r,source:s,stack:m,digest:null}}function lu(r,s,l){return{value:r,source:null,stack:l??null,digest:s??null}}function uu(r,s){try{console.error(s.value)}catch(l){setTimeout(function(){throw l})}}var Lf=typeof WeakMap=="function"?WeakMap:Map;function Mh(r,s,l){l=Ti(-1,l),l.tag=3,l.payload={element:null};var h=s.value;return l.callback=function(){Ua||(Ua=!0,Ru=h),uu(r,s)},l}function Nh(r,s,l){l=Ti(-1,l),l.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var m=s.value;l.payload=function(){return h(m)},l.callback=function(){uu(r,s)}}var P=r.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(l.callback=function(){uu(r,s),typeof h!="function"&&(Wi===null?Wi=new Set([this]):Wi.add(this));var ne=s.stack;this.componentDidCatch(s.value,{componentStack:ne!==null?ne:""})}),l}function Fh(r,s,l){var h=r.pingCache;if(h===null){h=r.pingCache=new Lf;var m=new Set;h.set(s,m)}else m=h.get(s),m===void 0&&(m=new Set,h.set(s,m));m.has(l)||(m.add(l),r=Jf.bind(null,r,s,l),s.then(r,r))}function Oh(r){do{var s;if((s=r.tag===13)&&(s=r.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return r;r=r.return}while(r!==null);return null}function Lh(r,s,l,h,m){return(r.mode&1)===0?(r===s?r.flags|=65536:(r.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(s=Ti(-1,1),s.tag=2,Bi(l,s,1))),l.lanes|=1),r):(r.flags|=65536,r.lanes=m,r)}var Uf=te.ReactCurrentOwner,Sr=!1;function Er(r,s,l,h){s.child=r===null?ih(s,null,l,h):Bs(s,r.child,l,h)}function Uh(r,s,l,h,m){l=l.render;var P=s.ref;return Ws(s,m),h=eu(r,s,l,h,P,m),l=tu(),r!==null&&!Sr?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~m,Pi(r,s,m)):(qn&&l&&Ol(s),s.flags|=1,Er(r,s,h,m),s.child)}function jh(r,s,l,h,m){if(r===null){var P=l.type;return typeof P=="function"&&!ku(P)&&P.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(s.tag=15,s.type=P,Bh(r,s,P,h,m)):(r=Ha(l.type,null,h,s,s.mode,m),r.ref=s.ref,r.return=s,s.child=r)}if(P=r.child,(r.lanes&m)===0){var ne=P.memoizedProps;if(l=l.compare,l=l!==null?l:fo,l(ne,h)&&r.ref===s.ref)return Pi(r,s,m)}return s.flags|=1,r=Gi(P,h),r.ref=s.ref,r.return=s,s.child=r}function Bh(r,s,l,h,m){if(r!==null){var P=r.memoizedProps;if(fo(P,h)&&r.ref===s.ref)if(Sr=!1,s.pendingProps=h=P,(r.lanes&m)!==0)(r.flags&131072)!==0&&(Sr=!0);else return s.lanes=r.lanes,Pi(r,s,m)}return cu(r,s,l,h,m)}function zh(r,s,l){var h=s.pendingProps,m=h.children,P=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},zn(Gs,Nr),Nr|=l;else{if((l&1073741824)===0)return r=P!==null?P.baseLanes|l:l,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:r,cachePool:null,transitions:null},s.updateQueue=null,zn(Gs,Nr),Nr|=r,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=P!==null?P.baseLanes:l,zn(Gs,Nr),Nr|=h}else P!==null?(h=P.baseLanes|l,s.memoizedState=null):h=l,zn(Gs,Nr),Nr|=h;return Er(r,s,m,l),s.child}function Wh(r,s){var l=s.ref;(r===null&&l!==null||r!==null&&r.ref!==l)&&(s.flags|=512,s.flags|=2097152)}function cu(r,s,l,h,m){var P=Ir(l)?ss:dr.current;return P=Os(s,P),Ws(s,m),l=eu(r,s,l,h,P,m),h=tu(),r!==null&&!Sr?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~m,Pi(r,s,m)):(qn&&h&&Ol(s),s.flags|=1,Er(r,s,l,m),s.child)}function $h(r,s,l,h,m){if(Ir(l)){var P=!0;_a(s)}else P=!1;if(Ws(s,m),s.stateNode===null)Ma(r,s),Dh(s,l,h),au(s,l,h,m),h=!0;else if(r===null){var ne=s.stateNode,ye=s.memoizedProps;ne.props=ye;var Ie=ne.context,Ge=l.contextType;typeof Ge=="object"&&Ge!==null?Ge=Br(Ge):(Ge=Ir(l)?ss:dr.current,Ge=Os(s,Ge));var It=l.getDerivedStateFromProps,Ct=typeof It=="function"||typeof ne.getSnapshotBeforeUpdate=="function";Ct||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(ye!==h||Ie!==Ge)&&Vh(s,ne,h,Ge),ji=!1;var vt=s.memoizedState;ne.state=vt,Ia(s,h,ne,m),Ie=s.memoizedState,ye!==h||vt!==Ie||Rr.current||ji?(typeof It=="function"&&(ou(s,l,It,h),Ie=s.memoizedState),(ye=ji||kh(s,l,ye,h,vt,Ie,Ge))?(Ct||typeof ne.UNSAFE_componentWillMount!="function"&&typeof ne.componentWillMount!="function"||(typeof ne.componentWillMount=="function"&&ne.componentWillMount(),typeof ne.UNSAFE_componentWillMount=="function"&&ne.UNSAFE_componentWillMount()),typeof ne.componentDidMount=="function"&&(s.flags|=4194308)):(typeof ne.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=Ie),ne.props=h,ne.state=Ie,ne.context=Ge,h=ye):(typeof ne.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{ne=s.stateNode,oh(r,s),ye=s.memoizedProps,Ge=s.type===s.elementType?ye:Zr(s.type,ye),ne.props=Ge,Ct=s.pendingProps,vt=ne.context,Ie=l.contextType,typeof Ie=="object"&&Ie!==null?Ie=Br(Ie):(Ie=Ir(l)?ss:dr.current,Ie=Os(s,Ie));var dn=l.getDerivedStateFromProps;(It=typeof dn=="function"||typeof ne.getSnapshotBeforeUpdate=="function")||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(ye!==Ct||vt!==Ie)&&Vh(s,ne,h,Ie),ji=!1,vt=s.memoizedState,ne.state=vt,Ia(s,h,ne,m);var yn=s.memoizedState;ye!==Ct||vt!==yn||Rr.current||ji?(typeof dn=="function"&&(ou(s,l,dn,h),yn=s.memoizedState),(Ge=ji||kh(s,l,Ge,h,vt,yn,Ie)||!1)?(It||typeof ne.UNSAFE_componentWillUpdate!="function"&&typeof ne.componentWillUpdate!="function"||(typeof ne.componentWillUpdate=="function"&&ne.componentWillUpdate(h,yn,Ie),typeof ne.UNSAFE_componentWillUpdate=="function"&&ne.UNSAFE_componentWillUpdate(h,yn,Ie)),typeof ne.componentDidUpdate=="function"&&(s.flags|=4),typeof ne.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof ne.componentDidUpdate!="function"||ye===r.memoizedProps&&vt===r.memoizedState||(s.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||ye===r.memoizedProps&&vt===r.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=yn),ne.props=h,ne.state=yn,ne.context=Ie,h=Ge):(typeof ne.componentDidUpdate!="function"||ye===r.memoizedProps&&vt===r.memoizedState||(s.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||ye===r.memoizedProps&&vt===r.memoizedState||(s.flags|=1024),h=!1)}return hu(r,s,l,h,P,m)}function hu(r,s,l,h,m,P){Wh(r,s);var ne=(s.flags&128)!==0;if(!h&&!ne)return m&&Xc(s,l,!1),Pi(r,s,P);h=s.stateNode,Uf.current=s;var ye=ne&&typeof l.getDerivedStateFromError!="function"?null:h.render();return s.flags|=1,r!==null&&ne?(s.child=Bs(s,r.child,null,P),s.child=Bs(s,null,ye,P)):Er(r,s,ye,P),s.memoizedState=h.state,m&&Xc(s,l,!0),s.child}function Hh(r){var s=r.stateNode;s.pendingContext?Gc(r,s.pendingContext,s.pendingContext!==s.context):s.context&&Gc(r,s.context,!1),Kl(r,s.containerInfo)}function qh(r,s,l,h,m){return js(),Bl(m),s.flags|=256,Er(r,s,l,h),s.child}var du={dehydrated:null,treeContext:null,retryLane:0};function fu(r){return{baseLanes:r,cachePool:null,transitions:null}}function Gh(r,s,l){var h=s.pendingProps,m=Kn.current,P=!1,ne=(s.flags&128)!==0,ye;if((ye=ne)||(ye=r!==null&&r.memoizedState===null?!1:(m&2)!==0),ye?(P=!0,s.flags&=-129):(r===null||r.memoizedState!==null)&&(m|=1),zn(Kn,m&1),r===null)return jl(s),r=s.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((s.mode&1)===0?s.lanes=1:r.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(ne=h.children,r=h.fallback,P?(h=s.mode,P=s.child,ne={mode:"hidden",children:ne},(h&1)===0&&P!==null?(P.childLanes=0,P.pendingProps=ne):P=qa(ne,h,0,null),r=ms(r,h,l,null),P.return=s,r.return=s,P.sibling=r,s.child=P,s.child.memoizedState=fu(l),s.memoizedState=du,r):pu(s,ne));if(m=r.memoizedState,m!==null&&(ye=m.dehydrated,ye!==null))return jf(r,s,ne,h,ye,m,l);if(P){P=h.fallback,ne=s.mode,m=r.child,ye=m.sibling;var Ie={mode:"hidden",children:h.children};return(ne&1)===0&&s.child!==m?(h=s.child,h.childLanes=0,h.pendingProps=Ie,s.deletions=null):(h=Gi(m,Ie),h.subtreeFlags=m.subtreeFlags&14680064),ye!==null?P=Gi(ye,P):(P=ms(P,ne,l,null),P.flags|=2),P.return=s,h.return=s,h.sibling=P,s.child=h,h=P,P=s.child,ne=r.child.memoizedState,ne=ne===null?fu(l):{baseLanes:ne.baseLanes|l,cachePool:null,transitions:ne.transitions},P.memoizedState=ne,P.childLanes=r.childLanes&~l,s.memoizedState=du,h}return P=r.child,r=P.sibling,h=Gi(P,{mode:"visible",children:h.children}),(s.mode&1)===0&&(h.lanes=l),h.return=s,h.sibling=null,r!==null&&(l=s.deletions,l===null?(s.deletions=[r],s.flags|=16):l.push(r)),s.child=h,s.memoizedState=null,h}function pu(r,s){return s=qa({mode:"visible",children:s},r.mode,0,null),s.return=r,r.child=s}function Va(r,s,l,h){return h!==null&&Bl(h),Bs(s,r.child,null,l),r=pu(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function jf(r,s,l,h,m,P,ne){if(l)return s.flags&256?(s.flags&=-257,h=lu(Error(t(422))),Va(r,s,ne,h)):s.memoizedState!==null?(s.child=r.child,s.flags|=128,null):(P=h.fallback,m=s.mode,h=qa({mode:"visible",children:h.children},m,0,null),P=ms(P,m,ne,null),P.flags|=2,h.return=s,P.return=s,h.sibling=P,s.child=h,(s.mode&1)!==0&&Bs(s,r.child,null,ne),s.child.memoizedState=fu(ne),s.memoizedState=du,P);if((s.mode&1)===0)return Va(r,s,ne,null);if(m.data==="$!"){if(h=m.nextSibling&&m.nextSibling.dataset,h)var ye=h.dgst;return h=ye,P=Error(t(419)),h=lu(P,h,void 0),Va(r,s,ne,h)}if(ye=(ne&r.childLanes)!==0,Sr||ye){if(h=sr,h!==null){switch(ne&-ne){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(h.suspendedLanes|ne))!==0?0:m,m!==0&&m!==P.retryLane&&(P.retryLane=m,Ai(r,m),ni(h,r,m,-1))}return xu(),h=lu(Error(t(421))),Va(r,s,ne,h)}return m.data==="$?"?(s.flags|=128,s.child=r.child,s=Zf.bind(null,r),m._reactRetry=s,null):(r=P.treeContext,Mr=Fi(m.nextSibling),Vr=s,qn=!0,Jr=null,r!==null&&(Ur[jr++]=Ei,Ur[jr++]=vi,Ur[jr++]=os,Ei=r.id,vi=r.overflow,os=s),s=pu(s,h.children),s.flags|=4096,s)}function Kh(r,s,l){r.lanes|=s;var h=r.alternate;h!==null&&(h.lanes|=s),Hl(r.return,s,l)}function mu(r,s,l,h,m){var P=r.memoizedState;P===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:m}:(P.isBackwards=s,P.rendering=null,P.renderingStartTime=0,P.last=h,P.tail=l,P.tailMode=m)}function Xh(r,s,l){var h=s.pendingProps,m=h.revealOrder,P=h.tail;if(Er(r,s,h.children,l),h=Kn.current,(h&2)!==0)h=h&1|2,s.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Kh(r,l,s);else if(r.tag===19)Kh(r,l,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(zn(Kn,h),(s.mode&1)===0)s.memoizedState=null;else switch(m){case"forwards":for(l=s.child,m=null;l!==null;)r=l.alternate,r!==null&&Sa(r)===null&&(m=l),l=l.sibling;l=m,l===null?(m=s.child,s.child=null):(m=l.sibling,l.sibling=null),mu(s,!1,m,l,P);break;case"backwards":for(l=null,m=s.child,s.child=null;m!==null;){if(r=m.alternate,r!==null&&Sa(r)===null){s.child=m;break}r=m.sibling,m.sibling=l,l=m,m=r}mu(s,!0,l,null,P);break;case"together":mu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ma(r,s){(s.mode&1)===0&&r!==null&&(r.alternate=null,s.alternate=null,s.flags|=2)}function Pi(r,s,l){if(r!==null&&(s.dependencies=r.dependencies),hs|=s.lanes,(l&s.childLanes)===0)return null;if(r!==null&&s.child!==r.child)throw Error(t(153));if(s.child!==null){for(r=s.child,l=Gi(r,r.pendingProps),s.child=l,l.return=s;r.sibling!==null;)r=r.sibling,l=l.sibling=Gi(r,r.pendingProps),l.return=s;l.sibling=null}return s.child}function Bf(r,s,l){switch(s.tag){case 3:Hh(s),js();break;case 5:uh(s);break;case 1:Ir(s.type)&&_a(s);break;case 4:Kl(s,s.stateNode.containerInfo);break;case 10:var h=s.type._context,m=s.memoizedProps.value;zn(Ta,h._currentValue),h._currentValue=m;break;case 13:if(h=s.memoizedState,h!==null)return h.dehydrated!==null?(zn(Kn,Kn.current&1),s.flags|=128,null):(l&s.child.childLanes)!==0?Gh(r,s,l):(zn(Kn,Kn.current&1),r=Pi(r,s,l),r!==null?r.sibling:null);zn(Kn,Kn.current&1);break;case 19:if(h=(l&s.childLanes)!==0,(r.flags&128)!==0){if(h)return Xh(r,s,l);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),zn(Kn,Kn.current),h)break;return null;case 22:case 23:return s.lanes=0,zh(r,s,l)}return Pi(r,s,l)}var Yh,_u,Qh,Jh;Yh=function(r,s){for(var l=s.child;l!==null;){if(l.tag===5||l.tag===6)r.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},_u=function(){},Qh=function(r,s,l,h){var m=r.memoizedProps;if(m!==h){r=s.stateNode,us(ui.current);var P=null;switch(l){case"input":m=Xe(r,m),h=Xe(r,h),P=[];break;case"select":m=fe({},m,{value:void 0}),h=fe({},h,{value:void 0}),P=[];break;case"textarea":m=$e(r,m),h=$e(r,h),P=[];break;default:typeof m.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=fa)}Ve(l,h);var ne;l=null;for(Ge in m)if(!h.hasOwnProperty(Ge)&&m.hasOwnProperty(Ge)&&m[Ge]!=null)if(Ge==="style"){var ye=m[Ge];for(ne in ye)ye.hasOwnProperty(ne)&&(l||(l={}),l[ne]="")}else Ge!=="dangerouslySetInnerHTML"&&Ge!=="children"&&Ge!=="suppressContentEditableWarning"&&Ge!=="suppressHydrationWarning"&&Ge!=="autoFocus"&&(o.hasOwnProperty(Ge)?P||(P=[]):(P=P||[]).push(Ge,null));for(Ge in h){var Ie=h[Ge];if(ye=m!=null?m[Ge]:void 0,h.hasOwnProperty(Ge)&&Ie!==ye&&(Ie!=null||ye!=null))if(Ge==="style")if(ye){for(ne in ye)!ye.hasOwnProperty(ne)||Ie&&Ie.hasOwnProperty(ne)||(l||(l={}),l[ne]="");for(ne in Ie)Ie.hasOwnProperty(ne)&&ye[ne]!==Ie[ne]&&(l||(l={}),l[ne]=Ie[ne])}else l||(P||(P=[]),P.push(Ge,l)),l=Ie;else Ge==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,ye=ye?ye.__html:void 0,Ie!=null&&ye!==Ie&&(P=P||[]).push(Ge,Ie)):Ge==="children"?typeof Ie!="string"&&typeof Ie!="number"||(P=P||[]).push(Ge,""+Ie):Ge!=="suppressContentEditableWarning"&&Ge!=="suppressHydrationWarning"&&(o.hasOwnProperty(Ge)?(Ie!=null&&Ge==="onScroll"&&Wn("scroll",r),P||ye===Ie||(P=[])):(P=P||[]).push(Ge,Ie))}l&&(P=P||[]).push("style",l);var Ge=P;(s.updateQueue=Ge)&&(s.flags|=4)}},Jh=function(r,s,l,h){l!==h&&(s.flags|=4)};function bo(r,s){if(!qn)switch(r.tailMode){case"hidden":s=r.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function pr(r){var s=r.alternate!==null&&r.alternate.child===r.child,l=0,h=0;if(s)for(var m=r.child;m!==null;)l|=m.lanes|m.childLanes,h|=m.subtreeFlags&14680064,h|=m.flags&14680064,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)l|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=h,r.childLanes=l,s}function zf(r,s,l){var h=s.pendingProps;switch(Ll(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pr(s),null;case 1:return Ir(s.type)&&ma(),pr(s),null;case 3:return h=s.stateNode,$s(),$n(Rr),$n(dr),Ql(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(va(s)?s.flags|=4:r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Jr!==null&&(wu(Jr),Jr=null))),_u(r,s),pr(s),null;case 5:Xl(s);var m=us(Po.current);if(l=s.type,r!==null&&s.stateNode!=null)Qh(r,s,l,h,m),r.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!h){if(s.stateNode===null)throw Error(t(166));return pr(s),null}if(r=us(ui.current),va(s)){h=s.stateNode,l=s.type;var P=s.memoizedProps;switch(h[li]=s,h[yo]=P,r=(s.mode&1)!==0,l){case"dialog":Wn("cancel",h),Wn("close",h);break;case"iframe":case"object":case"embed":Wn("load",h);break;case"video":case"audio":for(m=0;m<mo.length;m++)Wn(mo[m],h);break;case"source":Wn("error",h);break;case"img":case"image":case"link":Wn("error",h),Wn("load",h);break;case"details":Wn("toggle",h);break;case"input":Ze(h,P),Wn("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!P.multiple},Wn("invalid",h);break;case"textarea":et(h,P),Wn("invalid",h)}Ve(l,P),m=null;for(var ne in P)if(P.hasOwnProperty(ne)){var ye=P[ne];ne==="children"?typeof ye=="string"?h.textContent!==ye&&(P.suppressHydrationWarning!==!0&&da(h.textContent,ye,r),m=["children",ye]):typeof ye=="number"&&h.textContent!==""+ye&&(P.suppressHydrationWarning!==!0&&da(h.textContent,ye,r),m=["children",""+ye]):o.hasOwnProperty(ne)&&ye!=null&&ne==="onScroll"&&Wn("scroll",h)}switch(l){case"input":Be(h),se(h,P,!0);break;case"textarea":Be(h),Se(h);break;case"select":case"option":break;default:typeof P.onClick=="function"&&(h.onclick=fa)}h=m,s.updateQueue=h,h!==null&&(s.flags|=4)}else{ne=m.nodeType===9?m:m.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=rt(l)),r==="http://www.w3.org/1999/xhtml"?l==="script"?(r=ne.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=ne.createElement(l,{is:h.is}):(r=ne.createElement(l),l==="select"&&(ne=r,h.multiple?ne.multiple=!0:h.size&&(ne.size=h.size))):r=ne.createElementNS(r,l),r[li]=s,r[yo]=h,Yh(r,s,!1,!1),s.stateNode=r;e:{switch(ne=Ne(l,h),l){case"dialog":Wn("cancel",r),Wn("close",r),m=h;break;case"iframe":case"object":case"embed":Wn("load",r),m=h;break;case"video":case"audio":for(m=0;m<mo.length;m++)Wn(mo[m],r);m=h;break;case"source":Wn("error",r),m=h;break;case"img":case"image":case"link":Wn("error",r),Wn("load",r),m=h;break;case"details":Wn("toggle",r),m=h;break;case"input":Ze(r,h),m=Xe(r,h),Wn("invalid",r);break;case"option":m=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},m=fe({},h,{value:void 0}),Wn("invalid",r);break;case"textarea":et(r,h),m=$e(r,h),Wn("invalid",r);break;default:m=h}Ve(l,m),ye=m;for(P in ye)if(ye.hasOwnProperty(P)){var Ie=ye[P];P==="style"?kn(r,Ie):P==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,Ie!=null&&fn(r,Ie)):P==="children"?typeof Ie=="string"?(l!=="textarea"||Ie!=="")&&Rn(r,Ie):typeof Ie=="number"&&Rn(r,""+Ie):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(o.hasOwnProperty(P)?Ie!=null&&P==="onScroll"&&Wn("scroll",r):Ie!=null&&oe(r,P,Ie,ne))}switch(l){case"input":Be(r),se(r,h,!1);break;case"textarea":Be(r),Se(r);break;case"option":h.value!=null&&r.setAttribute("value",""+he(h.value));break;case"select":r.multiple=!!h.multiple,P=h.value,P!=null?Ce(r,!!h.multiple,P,!1):h.defaultValue!=null&&Ce(r,!!h.multiple,h.defaultValue,!0);break;default:typeof m.onClick=="function"&&(r.onclick=fa)}switch(l){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return pr(s),null;case 6:if(r&&s.stateNode!=null)Jh(r,s,r.memoizedProps,h);else{if(typeof h!="string"&&s.stateNode===null)throw Error(t(166));if(l=us(Po.current),us(ui.current),va(s)){if(h=s.stateNode,l=s.memoizedProps,h[li]=s,(P=h.nodeValue!==l)&&(r=Vr,r!==null))switch(r.tag){case 3:da(h.nodeValue,l,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&da(h.nodeValue,l,(r.mode&1)!==0)}P&&(s.flags|=4)}else h=(l.nodeType===9?l:l.ownerDocument).createTextNode(h),h[li]=s,s.stateNode=h}return pr(s),null;case 13:if($n(Kn),h=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(qn&&Mr!==null&&(s.mode&1)!==0&&(s.flags&128)===0)th(),js(),s.flags|=98560,P=!1;else if(P=va(s),h!==null&&h.dehydrated!==null){if(r===null){if(!P)throw Error(t(318));if(P=s.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(t(317));P[li]=s}else js(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;pr(s),P=!1}else Jr!==null&&(wu(Jr),Jr=null),P=!0;if(!P)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=l,s):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(s.child.flags|=8192,(s.mode&1)!==0&&(r===null||(Kn.current&1)!==0?nr===0&&(nr=3):xu())),s.updateQueue!==null&&(s.flags|=4),pr(s),null);case 4:return $s(),_u(r,s),r===null&&_o(s.stateNode.containerInfo),pr(s),null;case 10:return $l(s.type._context),pr(s),null;case 17:return Ir(s.type)&&ma(),pr(s),null;case 19:if($n(Kn),P=s.memoizedState,P===null)return pr(s),null;if(h=(s.flags&128)!==0,ne=P.rendering,ne===null)if(h)bo(P,!1);else{if(nr!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(ne=Sa(r),ne!==null){for(s.flags|=128,bo(P,!1),h=ne.updateQueue,h!==null&&(s.updateQueue=h,s.flags|=4),s.subtreeFlags=0,h=l,l=s.child;l!==null;)P=l,r=h,P.flags&=14680066,ne=P.alternate,ne===null?(P.childLanes=0,P.lanes=r,P.child=null,P.subtreeFlags=0,P.memoizedProps=null,P.memoizedState=null,P.updateQueue=null,P.dependencies=null,P.stateNode=null):(P.childLanes=ne.childLanes,P.lanes=ne.lanes,P.child=ne.child,P.subtreeFlags=0,P.deletions=null,P.memoizedProps=ne.memoizedProps,P.memoizedState=ne.memoizedState,P.updateQueue=ne.updateQueue,P.type=ne.type,r=ne.dependencies,P.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),l=l.sibling;return zn(Kn,Kn.current&1|2),s.child}r=r.sibling}P.tail!==null&&Bn()>Ks&&(s.flags|=128,h=!0,bo(P,!1),s.lanes=4194304)}else{if(!h)if(r=Sa(ne),r!==null){if(s.flags|=128,h=!0,l=r.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),bo(P,!0),P.tail===null&&P.tailMode==="hidden"&&!ne.alternate&&!qn)return pr(s),null}else 2*Bn()-P.renderingStartTime>Ks&&l!==1073741824&&(s.flags|=128,h=!0,bo(P,!1),s.lanes=4194304);P.isBackwards?(ne.sibling=s.child,s.child=ne):(l=P.last,l!==null?l.sibling=ne:s.child=ne,P.last=ne)}return P.tail!==null?(s=P.tail,P.rendering=s,P.tail=s.sibling,P.renderingStartTime=Bn(),s.sibling=null,l=Kn.current,zn(Kn,h?l&1|2:l&1),s):(pr(s),null);case 22:case 23:return Cu(),h=s.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(s.flags|=8192),h&&(s.mode&1)!==0?(Nr&1073741824)!==0&&(pr(s),s.subtreeFlags&6&&(s.flags|=8192)):pr(s),null;case 24:return null;case 25:return null}throw Error(t(156,s.tag))}function Wf(r,s){switch(Ll(s),s.tag){case 1:return Ir(s.type)&&ma(),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return $s(),$n(Rr),$n(dr),Ql(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 5:return Xl(s),null;case 13:if($n(Kn),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(t(340));js()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return $n(Kn),null;case 4:return $s(),null;case 10:return $l(s.type._context),null;case 22:case 23:return Cu(),null;case 24:return null;default:return null}}var Na=!1,mr=!1,$f=typeof WeakSet=="function"?WeakSet:Set,pn=null;function qs(r,s){var l=r.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(h){Yn(r,s,h)}else l.current=null}function gu(r,s,l){try{l()}catch(h){Yn(r,s,h)}}var Zh=!1;function Hf(r,s){if(Cl=Vi,r=kc(),Al(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var m=h.anchorOffset,P=h.focusNode;h=h.focusOffset;try{l.nodeType,P.nodeType}catch{l=null;break e}var ne=0,ye=-1,Ie=-1,Ge=0,It=0,Ct=r,vt=null;t:for(;;){for(var dn;Ct!==l||m!==0&&Ct.nodeType!==3||(ye=ne+m),Ct!==P||h!==0&&Ct.nodeType!==3||(Ie=ne+h),Ct.nodeType===3&&(ne+=Ct.nodeValue.length),(dn=Ct.firstChild)!==null;)vt=Ct,Ct=dn;for(;;){if(Ct===r)break t;if(vt===l&&++Ge===m&&(ye=ne),vt===P&&++It===h&&(Ie=ne),(dn=Ct.nextSibling)!==null)break;Ct=vt,vt=Ct.parentNode}Ct=dn}l=ye===-1||Ie===-1?null:{start:ye,end:Ie}}else l=null}l=l||{start:0,end:0}}else l=null;for(xl={focusedElem:r,selectionRange:l},Vi=!1,pn=s;pn!==null;)if(s=pn,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,pn=r;else for(;pn!==null;){s=pn;try{var yn=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(yn!==null){var En=yn.memoizedProps,Qn=yn.memoizedState,je=s.stateNode,ke=je.getSnapshotBeforeUpdate(s.elementType===s.type?En:Zr(s.type,En),Qn);je.__reactInternalSnapshotBeforeUpdate=ke}break;case 3:var He=s.stateNode.containerInfo;He.nodeType===1?He.textContent="":He.nodeType===9&&He.documentElement&&He.removeChild(He.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Nt){Yn(s,s.return,Nt)}if(r=s.sibling,r!==null){r.return=s.return,pn=r;break}pn=s.return}return yn=Zh,Zh=!1,yn}function Co(r,s,l){var h=s.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&r)===r){var P=m.destroy;m.destroy=void 0,P!==void 0&&gu(s,l,P)}m=m.next}while(m!==h)}}function Fa(r,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&r)===r){var h=l.create;l.destroy=h()}l=l.next}while(l!==s)}}function yu(r){var s=r.ref;if(s!==null){var l=r.stateNode;switch(r.tag){case 5:r=l;break;default:r=l}typeof s=="function"?s(r):s.current=r}}function ed(r){var s=r.alternate;s!==null&&(r.alternate=null,ed(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&(delete s[li],delete s[yo],delete s[Ml],delete s[wf],delete s[bf])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function td(r){return r.tag===5||r.tag===3||r.tag===4}function nd(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||td(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Eu(r,s,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,s?l.nodeType===8?l.parentNode.insertBefore(r,s):l.insertBefore(r,s):(l.nodeType===8?(s=l.parentNode,s.insertBefore(r,l)):(s=l,s.appendChild(r)),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=fa));else if(h!==4&&(r=r.child,r!==null))for(Eu(r,s,l),r=r.sibling;r!==null;)Eu(r,s,l),r=r.sibling}function vu(r,s,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,s?l.insertBefore(r,s):l.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(vu(r,s,l),r=r.sibling;r!==null;)vu(r,s,l),r=r.sibling}var ur=null,ei=!1;function zi(r,s,l){for(l=l.child;l!==null;)rd(r,s,l),l=l.sibling}function rd(r,s,l){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Qi,l)}catch{}switch(l.tag){case 5:mr||qs(l,s);case 6:var h=ur,m=ei;ur=null,zi(r,s,l),ur=h,ei=m,ur!==null&&(ei?(r=ur,l=l.stateNode,r.nodeType===8?r.parentNode.removeChild(l):r.removeChild(l)):ur.removeChild(l.stateNode));break;case 18:ur!==null&&(ei?(r=ur,l=l.stateNode,r.nodeType===8?Vl(r.parentNode,l):r.nodeType===1&&Vl(r,l),Xr(r)):Vl(ur,l.stateNode));break;case 4:h=ur,m=ei,ur=l.stateNode.containerInfo,ei=!0,zi(r,s,l),ur=h,ei=m;break;case 0:case 11:case 14:case 15:if(!mr&&(h=l.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){m=h=h.next;do{var P=m,ne=P.destroy;P=P.tag,ne!==void 0&&((P&2)!==0||(P&4)!==0)&&gu(l,s,ne),m=m.next}while(m!==h)}zi(r,s,l);break;case 1:if(!mr&&(qs(l,s),h=l.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=l.memoizedProps,h.state=l.memoizedState,h.componentWillUnmount()}catch(ye){Yn(l,s,ye)}zi(r,s,l);break;case 21:zi(r,s,l);break;case 22:l.mode&1?(mr=(h=mr)||l.memoizedState!==null,zi(r,s,l),mr=h):zi(r,s,l);break;default:zi(r,s,l)}}function id(r){var s=r.updateQueue;if(s!==null){r.updateQueue=null;var l=r.stateNode;l===null&&(l=r.stateNode=new $f),s.forEach(function(h){var m=ep.bind(null,r,h);l.has(h)||(l.add(h),h.then(m,m))})}}function ti(r,s){var l=s.deletions;if(l!==null)for(var h=0;h<l.length;h++){var m=l[h];try{var P=r,ne=s,ye=ne;e:for(;ye!==null;){switch(ye.tag){case 5:ur=ye.stateNode,ei=!1;break e;case 3:ur=ye.stateNode.containerInfo,ei=!0;break e;case 4:ur=ye.stateNode.containerInfo,ei=!0;break e}ye=ye.return}if(ur===null)throw Error(t(160));rd(P,ne,m),ur=null,ei=!1;var Ie=m.alternate;Ie!==null&&(Ie.return=null),m.return=null}catch(Ge){Yn(m,s,Ge)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)sd(s,r),s=s.sibling}function sd(r,s){var l=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(ti(s,r),hi(r),h&4){try{Co(3,r,r.return),Fa(3,r)}catch(En){Yn(r,r.return,En)}try{Co(5,r,r.return)}catch(En){Yn(r,r.return,En)}}break;case 1:ti(s,r),hi(r),h&512&&l!==null&&qs(l,l.return);break;case 5:if(ti(s,r),hi(r),h&512&&l!==null&&qs(l,l.return),r.flags&32){var m=r.stateNode;try{Rn(m,"")}catch(En){Yn(r,r.return,En)}}if(h&4&&(m=r.stateNode,m!=null)){var P=r.memoizedProps,ne=l!==null?l.memoizedProps:P,ye=r.type,Ie=r.updateQueue;if(r.updateQueue=null,Ie!==null)try{ye==="input"&&P.type==="radio"&&P.name!=null&&xe(m,P),Ne(ye,ne);var Ge=Ne(ye,P);for(ne=0;ne<Ie.length;ne+=2){var It=Ie[ne],Ct=Ie[ne+1];It==="style"?kn(m,Ct):It==="dangerouslySetInnerHTML"?fn(m,Ct):It==="children"?Rn(m,Ct):oe(m,It,Ct,Ge)}switch(ye){case"input":De(m,P);break;case"textarea":Qe(m,P);break;case"select":var vt=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!P.multiple;var dn=P.value;dn!=null?Ce(m,!!P.multiple,dn,!1):vt!==!!P.multiple&&(P.defaultValue!=null?Ce(m,!!P.multiple,P.defaultValue,!0):Ce(m,!!P.multiple,P.multiple?[]:"",!1))}m[yo]=P}catch(En){Yn(r,r.return,En)}}break;case 6:if(ti(s,r),hi(r),h&4){if(r.stateNode===null)throw Error(t(162));m=r.stateNode,P=r.memoizedProps;try{m.nodeValue=P}catch(En){Yn(r,r.return,En)}}break;case 3:if(ti(s,r),hi(r),h&4&&l!==null&&l.memoizedState.isDehydrated)try{Xr(s.containerInfo)}catch(En){Yn(r,r.return,En)}break;case 4:ti(s,r),hi(r);break;case 13:ti(s,r),hi(r),m=r.child,m.flags&8192&&(P=m.memoizedState!==null,m.stateNode.isHidden=P,!P||m.alternate!==null&&m.alternate.memoizedState!==null||(Pu=Bn())),h&4&&id(r);break;case 22:if(It=l!==null&&l.memoizedState!==null,r.mode&1?(mr=(Ge=mr)||It,ti(s,r),mr=Ge):ti(s,r),hi(r),h&8192){if(Ge=r.memoizedState!==null,(r.stateNode.isHidden=Ge)&&!It&&(r.mode&1)!==0)for(pn=r,It=r.child;It!==null;){for(Ct=pn=It;pn!==null;){switch(vt=pn,dn=vt.child,vt.tag){case 0:case 11:case 14:case 15:Co(4,vt,vt.return);break;case 1:qs(vt,vt.return);var yn=vt.stateNode;if(typeof yn.componentWillUnmount=="function"){h=vt,l=vt.return;try{s=h,yn.props=s.memoizedProps,yn.state=s.memoizedState,yn.componentWillUnmount()}catch(En){Yn(h,l,En)}}break;case 5:qs(vt,vt.return);break;case 22:if(vt.memoizedState!==null){ld(Ct);continue}}dn!==null?(dn.return=vt,pn=dn):ld(Ct)}It=It.sibling}e:for(It=null,Ct=r;;){if(Ct.tag===5){if(It===null){It=Ct;try{m=Ct.stateNode,Ge?(P=m.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none"):(ye=Ct.stateNode,Ie=Ct.memoizedProps.style,ne=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null,ye.style.display=bn("display",ne))}catch(En){Yn(r,r.return,En)}}}else if(Ct.tag===6){if(It===null)try{Ct.stateNode.nodeValue=Ge?"":Ct.memoizedProps}catch(En){Yn(r,r.return,En)}}else if((Ct.tag!==22&&Ct.tag!==23||Ct.memoizedState===null||Ct===r)&&Ct.child!==null){Ct.child.return=Ct,Ct=Ct.child;continue}if(Ct===r)break e;for(;Ct.sibling===null;){if(Ct.return===null||Ct.return===r)break e;It===Ct&&(It=null),Ct=Ct.return}It===Ct&&(It=null),Ct.sibling.return=Ct.return,Ct=Ct.sibling}}break;case 19:ti(s,r),hi(r),h&4&&id(r);break;case 21:break;default:ti(s,r),hi(r)}}function hi(r){var s=r.flags;if(s&2){try{e:{for(var l=r.return;l!==null;){if(td(l)){var h=l;break e}l=l.return}throw Error(t(160))}switch(h.tag){case 5:var m=h.stateNode;h.flags&32&&(Rn(m,""),h.flags&=-33);var P=nd(r);vu(r,P,m);break;case 3:case 4:var ne=h.stateNode.containerInfo,ye=nd(r);Eu(r,ye,ne);break;default:throw Error(t(161))}}catch(Ie){Yn(r,r.return,Ie)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function qf(r,s,l){pn=r,od(r)}function od(r,s,l){for(var h=(r.mode&1)!==0;pn!==null;){var m=pn,P=m.child;if(m.tag===22&&h){var ne=m.memoizedState!==null||Na;if(!ne){var ye=m.alternate,Ie=ye!==null&&ye.memoizedState!==null||mr;ye=Na;var Ge=mr;if(Na=ne,(mr=Ie)&&!Ge)for(pn=m;pn!==null;)ne=pn,Ie=ne.child,ne.tag===22&&ne.memoizedState!==null?ud(m):Ie!==null?(Ie.return=ne,pn=Ie):ud(m);for(;P!==null;)pn=P,od(P),P=P.sibling;pn=m,Na=ye,mr=Ge}ad(r)}else(m.subtreeFlags&8772)!==0&&P!==null?(P.return=m,pn=P):ad(r)}}function ad(r){for(;pn!==null;){var s=pn;if((s.flags&8772)!==0){var l=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:mr||Fa(5,s);break;case 1:var h=s.stateNode;if(s.flags&4&&!mr)if(l===null)h.componentDidMount();else{var m=s.elementType===s.type?l.memoizedProps:Zr(s.type,l.memoizedProps);h.componentDidUpdate(m,l.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var P=s.updateQueue;P!==null&&lh(s,P,h);break;case 3:var ne=s.updateQueue;if(ne!==null){if(l=null,s.child!==null)switch(s.child.tag){case 5:l=s.child.stateNode;break;case 1:l=s.child.stateNode}lh(s,ne,l)}break;case 5:var ye=s.stateNode;if(l===null&&s.flags&4){l=ye;var Ie=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":Ie.autoFocus&&l.focus();break;case"img":Ie.src&&(l.src=Ie.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var Ge=s.alternate;if(Ge!==null){var It=Ge.memoizedState;if(It!==null){var Ct=It.dehydrated;Ct!==null&&Xr(Ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}mr||s.flags&512&&yu(s)}catch(vt){Yn(s,s.return,vt)}}if(s===r){pn=null;break}if(l=s.sibling,l!==null){l.return=s.return,pn=l;break}pn=s.return}}function ld(r){for(;pn!==null;){var s=pn;if(s===r){pn=null;break}var l=s.sibling;if(l!==null){l.return=s.return,pn=l;break}pn=s.return}}function ud(r){for(;pn!==null;){var s=pn;try{switch(s.tag){case 0:case 11:case 15:var l=s.return;try{Fa(4,s)}catch(Ie){Yn(s,l,Ie)}break;case 1:var h=s.stateNode;if(typeof h.componentDidMount=="function"){var m=s.return;try{h.componentDidMount()}catch(Ie){Yn(s,m,Ie)}}var P=s.return;try{yu(s)}catch(Ie){Yn(s,P,Ie)}break;case 5:var ne=s.return;try{yu(s)}catch(Ie){Yn(s,ne,Ie)}}}catch(Ie){Yn(s,s.return,Ie)}if(s===r){pn=null;break}var ye=s.sibling;if(ye!==null){ye.return=s.return,pn=ye;break}pn=s.return}}var Gf=Math.ceil,Oa=te.ReactCurrentDispatcher,Au=te.ReactCurrentOwner,Wr=te.ReactCurrentBatchConfig,Nn=0,sr=null,Zn=null,cr=0,Nr=0,Gs=Oi(0),nr=0,xo=null,hs=0,La=0,Tu=0,ko=null,wr=null,Pu=0,Ks=1/0,Ri=null,Ua=!1,Ru=null,Wi=null,ja=!1,$i=null,Ba=0,Do=0,Iu=null,za=-1,Wa=0;function vr(){return(Nn&6)!==0?Bn():za!==-1?za:za=Bn()}function Hi(r){return(r.mode&1)===0?1:(Nn&2)!==0&&cr!==0?cr&-cr:xf.transition!==null?(Wa===0&&(Wa=Zi()),Wa):(r=Vn,r!==0||(r=window.event,r=r===void 0?16:so(r.type)),r)}function ni(r,s,l,h){if(50<Do)throw Do=0,Iu=null,Error(t(185));Ci(r,l,h),((Nn&2)===0||r!==sr)&&(r===sr&&((Nn&2)===0&&(La|=l),nr===4&&qi(r,cr)),br(r,h),l===1&&Nn===0&&(s.mode&1)===0&&(Ks=Bn()+500,ga&&Ui()))}function br(r,s){var l=r.callbackNode;di(r,s);var h=Ji(r,r===sr?cr:0);if(h===0)l!==null&&Ar(l),r.callbackNode=null,r.callbackPriority=0;else if(s=h&-h,r.callbackPriority!==s){if(l!=null&&Ar(l),s===1)r.tag===0?Cf(hd.bind(null,r)):Yc(hd.bind(null,r)),If(function(){(Nn&6)===0&&Ui()}),l=null;else{switch(ki(h)){case 1:l=Yi;break;case 4:l=Si;break;case 16:l=Fr;break;case 536870912:l=Wo;break;default:l=Fr}l=Ed(l,cd.bind(null,r))}r.callbackPriority=s,r.callbackNode=l}}function cd(r,s){if(za=-1,Wa=0,(Nn&6)!==0)throw Error(t(327));var l=r.callbackNode;if(Xs()&&r.callbackNode!==l)return null;var h=Ji(r,r===sr?cr:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||s)s=$a(r,h);else{s=h;var m=Nn;Nn|=2;var P=fd();(sr!==r||cr!==s)&&(Ri=null,Ks=Bn()+500,fs(r,s));do try{Yf();break}catch(ye){dd(r,ye)}while(!0);Wl(),Oa.current=P,Nn=m,Zn!==null?s=0:(sr=null,cr=0,s=nr)}if(s!==0){if(s===2&&(m=xr(r),m!==0&&(h=m,s=Su(r,m))),s===1)throw l=xo,fs(r,0),qi(r,h),br(r,Bn()),l;if(s===6)qi(r,h);else{if(m=r.current.alternate,(h&30)===0&&!Kf(m)&&(s=$a(r,h),s===2&&(P=xr(r),P!==0&&(h=P,s=Su(r,P))),s===1))throw l=xo,fs(r,0),qi(r,h),br(r,Bn()),l;switch(r.finishedWork=m,r.finishedLanes=h,s){case 0:case 1:throw Error(t(345));case 2:ps(r,wr,Ri);break;case 3:if(qi(r,h),(h&130023424)===h&&(s=Pu+500-Bn(),10<s)){if(Ji(r,0)!==0)break;if(m=r.suspendedLanes,(m&h)!==h){vr(),r.pingedLanes|=r.suspendedLanes&m;break}r.timeoutHandle=Dl(ps.bind(null,r,wr,Ri),s);break}ps(r,wr,Ri);break;case 4:if(qi(r,h),(h&4194240)===h)break;for(s=r.eventTimes,m=-1;0<h;){var ne=31-gr(h);P=1<<ne,ne=s[ne],ne>m&&(m=ne),h&=~P}if(h=m,h=Bn()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*Gf(h/1960))-h,10<h){r.timeoutHandle=Dl(ps.bind(null,r,wr,Ri),h);break}ps(r,wr,Ri);break;case 5:ps(r,wr,Ri);break;default:throw Error(t(329))}}}return br(r,Bn()),r.callbackNode===l?cd.bind(null,r):null}function Su(r,s){var l=ko;return r.current.memoizedState.isDehydrated&&(fs(r,s).flags|=256),r=$a(r,s),r!==2&&(s=wr,wr=l,s!==null&&wu(s)),r}function wu(r){wr===null?wr=r:wr.push.apply(wr,r)}function Kf(r){for(var s=r;;){if(s.flags&16384){var l=s.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var h=0;h<l.length;h++){var m=l[h],P=m.getSnapshot;m=m.value;try{if(!Qr(P(),m))return!1}catch{return!1}}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function qi(r,s){for(s&=~Tu,s&=~La,r.suspendedLanes|=s,r.pingedLanes&=~s,r=r.expirationTimes;0<s;){var l=31-gr(s),h=1<<l;r[l]=-1,s&=~h}}function hd(r){if((Nn&6)!==0)throw Error(t(327));Xs();var s=Ji(r,0);if((s&1)===0)return br(r,Bn()),null;var l=$a(r,s);if(r.tag!==0&&l===2){var h=xr(r);h!==0&&(s=h,l=Su(r,h))}if(l===1)throw l=xo,fs(r,0),qi(r,s),br(r,Bn()),l;if(l===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=s,ps(r,wr,Ri),br(r,Bn()),null}function bu(r,s){var l=Nn;Nn|=1;try{return r(s)}finally{Nn=l,Nn===0&&(Ks=Bn()+500,ga&&Ui())}}function ds(r){$i!==null&&$i.tag===0&&(Nn&6)===0&&Xs();var s=Nn;Nn|=1;var l=Wr.transition,h=Vn;try{if(Wr.transition=null,Vn=1,r)return r()}finally{Vn=h,Wr.transition=l,Nn=s,(Nn&6)===0&&Ui()}}function Cu(){Nr=Gs.current,$n(Gs)}function fs(r,s){r.finishedWork=null,r.finishedLanes=0;var l=r.timeoutHandle;if(l!==-1&&(r.timeoutHandle=-1,Rf(l)),Zn!==null)for(l=Zn.return;l!==null;){var h=l;switch(Ll(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&ma();break;case 3:$s(),$n(Rr),$n(dr),Ql();break;case 5:Xl(h);break;case 4:$s();break;case 13:$n(Kn);break;case 19:$n(Kn);break;case 10:$l(h.type._context);break;case 22:case 23:Cu()}l=l.return}if(sr=r,Zn=r=Gi(r.current,null),cr=Nr=s,nr=0,xo=null,Tu=La=hs=0,wr=ko=null,ls!==null){for(s=0;s<ls.length;s++)if(l=ls[s],h=l.interleaved,h!==null){l.interleaved=null;var m=h.next,P=l.pending;if(P!==null){var ne=P.next;P.next=m,h.next=ne}l.pending=h}ls=null}return r}function dd(r,s){do{var l=Zn;try{if(Wl(),wa.current=ka,ba){for(var h=Xn.memoizedState;h!==null;){var m=h.queue;m!==null&&(m.pending=null),h=h.next}ba=!1}if(cs=0,ir=tr=Xn=null,Ro=!1,Io=0,Au.current=null,l===null||l.return===null){nr=1,xo=s,Zn=null;break}e:{var P=r,ne=l.return,ye=l,Ie=s;if(s=cr,ye.flags|=32768,Ie!==null&&typeof Ie=="object"&&typeof Ie.then=="function"){var Ge=Ie,It=ye,Ct=It.tag;if((It.mode&1)===0&&(Ct===0||Ct===11||Ct===15)){var vt=It.alternate;vt?(It.updateQueue=vt.updateQueue,It.memoizedState=vt.memoizedState,It.lanes=vt.lanes):(It.updateQueue=null,It.memoizedState=null)}var dn=Oh(ne);if(dn!==null){dn.flags&=-257,Lh(dn,ne,ye,P,s),dn.mode&1&&Fh(P,Ge,s),s=dn,Ie=Ge;var yn=s.updateQueue;if(yn===null){var En=new Set;En.add(Ie),s.updateQueue=En}else yn.add(Ie);break e}else{if((s&1)===0){Fh(P,Ge,s),xu();break e}Ie=Error(t(426))}}else if(qn&&ye.mode&1){var Qn=Oh(ne);if(Qn!==null){(Qn.flags&65536)===0&&(Qn.flags|=256),Lh(Qn,ne,ye,P,s),Bl(Hs(Ie,ye));break e}}P=Ie=Hs(Ie,ye),nr!==4&&(nr=2),ko===null?ko=[P]:ko.push(P),P=ne;do{switch(P.tag){case 3:P.flags|=65536,s&=-s,P.lanes|=s;var je=Mh(P,Ie,s);ah(P,je);break e;case 1:ye=Ie;var ke=P.type,He=P.stateNode;if((P.flags&128)===0&&(typeof ke.getDerivedStateFromError=="function"||He!==null&&typeof He.componentDidCatch=="function"&&(Wi===null||!Wi.has(He)))){P.flags|=65536,s&=-s,P.lanes|=s;var Nt=Nh(P,ye,s);ah(P,Nt);break e}}P=P.return}while(P!==null)}md(l)}catch(Tn){s=Tn,Zn===l&&l!==null&&(Zn=l=l.return);continue}break}while(!0)}function fd(){var r=Oa.current;return Oa.current=ka,r===null?ka:r}function xu(){(nr===0||nr===3||nr===2)&&(nr=4),sr===null||(hs&268435455)===0&&(La&268435455)===0||qi(sr,cr)}function $a(r,s){var l=Nn;Nn|=2;var h=fd();(sr!==r||cr!==s)&&(Ri=null,fs(r,s));do try{Xf();break}catch(m){dd(r,m)}while(!0);if(Wl(),Nn=l,Oa.current=h,Zn!==null)throw Error(t(261));return sr=null,cr=0,nr}function Xf(){for(;Zn!==null;)pd(Zn)}function Yf(){for(;Zn!==null&&!Xi();)pd(Zn)}function pd(r){var s=yd(r.alternate,r,Nr);r.memoizedProps=r.pendingProps,s===null?md(r):Zn=s,Au.current=null}function md(r){var s=r;do{var l=s.alternate;if(r=s.return,(s.flags&32768)===0){if(l=zf(l,s,Nr),l!==null){Zn=l;return}}else{if(l=Wf(l,s),l!==null){l.flags&=32767,Zn=l;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{nr=6,Zn=null;return}}if(s=s.sibling,s!==null){Zn=s;return}Zn=s=r}while(s!==null);nr===0&&(nr=5)}function ps(r,s,l){var h=Vn,m=Wr.transition;try{Wr.transition=null,Vn=1,Qf(r,s,l,h)}finally{Wr.transition=m,Vn=h}return null}function Qf(r,s,l,h){do Xs();while($i!==null);if((Nn&6)!==0)throw Error(t(327));l=r.finishedWork;var m=r.finishedLanes;if(l===null)return null;if(r.finishedWork=null,r.finishedLanes=0,l===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var P=l.lanes|l.childLanes;if(jn(r,P),r===sr&&(Zn=sr=null,cr=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||ja||(ja=!0,Ed(Fr,function(){return Xs(),null})),P=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||P){P=Wr.transition,Wr.transition=null;var ne=Vn;Vn=1;var ye=Nn;Nn|=4,Au.current=null,Hf(r,l),sd(l,r),gf(xl),Vi=!!Cl,xl=Cl=null,r.current=l,qf(l),fl(),Nn=ye,Vn=ne,Wr.transition=P}else r.current=l;if(ja&&(ja=!1,$i=r,Ba=m),P=r.pendingLanes,P===0&&(Wi=null),$o(l.stateNode),br(r,Bn()),s!==null)for(h=r.onRecoverableError,l=0;l<s.length;l++)m=s[l],h(m.value,{componentStack:m.stack,digest:m.digest});if(Ua)throw Ua=!1,r=Ru,Ru=null,r;return(Ba&1)!==0&&r.tag!==0&&Xs(),P=r.pendingLanes,(P&1)!==0?r===Iu?Do++:(Do=0,Iu=r):Do=0,Ui(),null}function Xs(){if($i!==null){var r=ki(Ba),s=Wr.transition,l=Vn;try{if(Wr.transition=null,Vn=16>r?16:r,$i===null)var h=!1;else{if(r=$i,$i=null,Ba=0,(Nn&6)!==0)throw Error(t(331));var m=Nn;for(Nn|=4,pn=r.current;pn!==null;){var P=pn,ne=P.child;if((pn.flags&16)!==0){var ye=P.deletions;if(ye!==null){for(var Ie=0;Ie<ye.length;Ie++){var Ge=ye[Ie];for(pn=Ge;pn!==null;){var It=pn;switch(It.tag){case 0:case 11:case 15:Co(8,It,P)}var Ct=It.child;if(Ct!==null)Ct.return=It,pn=Ct;else for(;pn!==null;){It=pn;var vt=It.sibling,dn=It.return;if(ed(It),It===Ge){pn=null;break}if(vt!==null){vt.return=dn,pn=vt;break}pn=dn}}}var yn=P.alternate;if(yn!==null){var En=yn.child;if(En!==null){yn.child=null;do{var Qn=En.sibling;En.sibling=null,En=Qn}while(En!==null)}}pn=P}}if((P.subtreeFlags&2064)!==0&&ne!==null)ne.return=P,pn=ne;else e:for(;pn!==null;){if(P=pn,(P.flags&2048)!==0)switch(P.tag){case 0:case 11:case 15:Co(9,P,P.return)}var je=P.sibling;if(je!==null){je.return=P.return,pn=je;break e}pn=P.return}}var ke=r.current;for(pn=ke;pn!==null;){ne=pn;var He=ne.child;if((ne.subtreeFlags&2064)!==0&&He!==null)He.return=ne,pn=He;else e:for(ne=ke;pn!==null;){if(ye=pn,(ye.flags&2048)!==0)try{switch(ye.tag){case 0:case 11:case 15:Fa(9,ye)}}catch(Tn){Yn(ye,ye.return,Tn)}if(ye===ne){pn=null;break e}var Nt=ye.sibling;if(Nt!==null){Nt.return=ye.return,pn=Nt;break e}pn=ye.return}}if(Nn=m,Ui(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Qi,r)}catch{}h=!0}return h}finally{Vn=l,Wr.transition=s}}return!1}function _d(r,s,l){s=Hs(l,s),s=Mh(r,s,1),r=Bi(r,s,1),s=vr(),r!==null&&(Ci(r,1,s),br(r,s))}function Yn(r,s,l){if(r.tag===3)_d(r,r,l);else for(;s!==null;){if(s.tag===3){_d(s,r,l);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Wi===null||!Wi.has(h))){r=Hs(l,r),r=Nh(s,r,1),s=Bi(s,r,1),r=vr(),s!==null&&(Ci(s,1,r),br(s,r));break}}s=s.return}}function Jf(r,s,l){var h=r.pingCache;h!==null&&h.delete(s),s=vr(),r.pingedLanes|=r.suspendedLanes&l,sr===r&&(cr&l)===l&&(nr===4||nr===3&&(cr&130023424)===cr&&500>Bn()-Pu?fs(r,0):Tu|=l),br(r,s)}function gd(r,s){s===0&&((r.mode&1)===0?s=1:(s=ys,ys<<=1,(ys&130023424)===0&&(ys=4194304)));var l=vr();r=Ai(r,s),r!==null&&(Ci(r,s,l),br(r,l))}function Zf(r){var s=r.memoizedState,l=0;s!==null&&(l=s.retryLane),gd(r,l)}function ep(r,s){var l=0;switch(r.tag){case 13:var h=r.stateNode,m=r.memoizedState;m!==null&&(l=m.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(s),gd(r,l)}var yd;yd=function(r,s,l){if(r!==null)if(r.memoizedProps!==s.pendingProps||Rr.current)Sr=!0;else{if((r.lanes&l)===0&&(s.flags&128)===0)return Sr=!1,Bf(r,s,l);Sr=(r.flags&131072)!==0}else Sr=!1,qn&&(s.flags&1048576)!==0&&Qc(s,Ea,s.index);switch(s.lanes=0,s.tag){case 2:var h=s.type;Ma(r,s),r=s.pendingProps;var m=Os(s,dr.current);Ws(s,l),m=eu(null,s,h,r,m,l);var P=tu();return s.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Ir(h)?(P=!0,_a(s)):P=!1,s.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Gl(s),m.updater=Da,s.stateNode=m,m._reactInternals=s,au(s,h,r,l),s=hu(null,s,h,!0,P,l)):(s.tag=0,qn&&P&&Ol(s),Er(null,s,m,l),s=s.child),s;case 16:h=s.elementType;e:{switch(Ma(r,s),r=s.pendingProps,m=h._init,h=m(h._payload),s.type=h,m=s.tag=np(h),r=Zr(h,r),m){case 0:s=cu(null,s,h,r,l);break e;case 1:s=$h(null,s,h,r,l);break e;case 11:s=Uh(null,s,h,r,l);break e;case 14:s=jh(null,s,h,Zr(h.type,r),l);break e}throw Error(t(306,h,""))}return s;case 0:return h=s.type,m=s.pendingProps,m=s.elementType===h?m:Zr(h,m),cu(r,s,h,m,l);case 1:return h=s.type,m=s.pendingProps,m=s.elementType===h?m:Zr(h,m),$h(r,s,h,m,l);case 3:e:{if(Hh(s),r===null)throw Error(t(387));h=s.pendingProps,P=s.memoizedState,m=P.element,oh(r,s),Ia(s,h,null,l);var ne=s.memoizedState;if(h=ne.element,P.isDehydrated)if(P={element:h,isDehydrated:!1,cache:ne.cache,pendingSuspenseBoundaries:ne.pendingSuspenseBoundaries,transitions:ne.transitions},s.updateQueue.baseState=P,s.memoizedState=P,s.flags&256){m=Hs(Error(t(423)),s),s=qh(r,s,h,l,m);break e}else if(h!==m){m=Hs(Error(t(424)),s),s=qh(r,s,h,l,m);break e}else for(Mr=Fi(s.stateNode.containerInfo.firstChild),Vr=s,qn=!0,Jr=null,l=ih(s,null,h,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(js(),h===m){s=Pi(r,s,l);break e}Er(r,s,h,l)}s=s.child}return s;case 5:return uh(s),r===null&&jl(s),h=s.type,m=s.pendingProps,P=r!==null?r.memoizedProps:null,ne=m.children,kl(h,m)?ne=null:P!==null&&kl(h,P)&&(s.flags|=32),Wh(r,s),Er(r,s,ne,l),s.child;case 6:return r===null&&jl(s),null;case 13:return Gh(r,s,l);case 4:return Kl(s,s.stateNode.containerInfo),h=s.pendingProps,r===null?s.child=Bs(s,null,h,l):Er(r,s,h,l),s.child;case 11:return h=s.type,m=s.pendingProps,m=s.elementType===h?m:Zr(h,m),Uh(r,s,h,m,l);case 7:return Er(r,s,s.pendingProps,l),s.child;case 8:return Er(r,s,s.pendingProps.children,l),s.child;case 12:return Er(r,s,s.pendingProps.children,l),s.child;case 10:e:{if(h=s.type._context,m=s.pendingProps,P=s.memoizedProps,ne=m.value,zn(Ta,h._currentValue),h._currentValue=ne,P!==null)if(Qr(P.value,ne)){if(P.children===m.children&&!Rr.current){s=Pi(r,s,l);break e}}else for(P=s.child,P!==null&&(P.return=s);P!==null;){var ye=P.dependencies;if(ye!==null){ne=P.child;for(var Ie=ye.firstContext;Ie!==null;){if(Ie.context===h){if(P.tag===1){Ie=Ti(-1,l&-l),Ie.tag=2;var Ge=P.updateQueue;if(Ge!==null){Ge=Ge.shared;var It=Ge.pending;It===null?Ie.next=Ie:(Ie.next=It.next,It.next=Ie),Ge.pending=Ie}}P.lanes|=l,Ie=P.alternate,Ie!==null&&(Ie.lanes|=l),Hl(P.return,l,s),ye.lanes|=l;break}Ie=Ie.next}}else if(P.tag===10)ne=P.type===s.type?null:P.child;else if(P.tag===18){if(ne=P.return,ne===null)throw Error(t(341));ne.lanes|=l,ye=ne.alternate,ye!==null&&(ye.lanes|=l),Hl(ne,l,s),ne=P.sibling}else ne=P.child;if(ne!==null)ne.return=P;else for(ne=P;ne!==null;){if(ne===s){ne=null;break}if(P=ne.sibling,P!==null){P.return=ne.return,ne=P;break}ne=ne.return}P=ne}Er(r,s,m.children,l),s=s.child}return s;case 9:return m=s.type,h=s.pendingProps.children,Ws(s,l),m=Br(m),h=h(m),s.flags|=1,Er(r,s,h,l),s.child;case 14:return h=s.type,m=Zr(h,s.pendingProps),m=Zr(h.type,m),jh(r,s,h,m,l);case 15:return Bh(r,s,s.type,s.pendingProps,l);case 17:return h=s.type,m=s.pendingProps,m=s.elementType===h?m:Zr(h,m),Ma(r,s),s.tag=1,Ir(h)?(r=!0,_a(s)):r=!1,Ws(s,l),Dh(s,h,m),au(s,h,m,l),hu(null,s,h,!0,r,l);case 19:return Xh(r,s,l);case 22:return zh(r,s,l)}throw Error(t(156,s.tag))};function Ed(r,s){return _r(r,s)}function tp(r,s,l,h){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $r(r,s,l,h){return new tp(r,s,l,h)}function ku(r){return r=r.prototype,!(!r||!r.isReactComponent)}function np(r){if(typeof r=="function")return ku(r)?1:0;if(r!=null){if(r=r.$$typeof,r===D)return 11;if(r===ve)return 14}return 2}function Gi(r,s){var l=r.alternate;return l===null?(l=$r(r.tag,s,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=s,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&14680064,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,s=r.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l}function Ha(r,s,l,h,m,P){var ne=2;if(h=r,typeof r=="function")ku(r)&&(ne=1);else if(typeof r=="string")ne=5;else e:switch(r){case y:return ms(l.children,m,P,s);case g:ne=8,m|=8;break;case E:return r=$r(12,l,s,m|2),r.elementType=E,r.lanes=P,r;case C:return r=$r(13,l,s,m),r.elementType=C,r.lanes=P,r;case we:return r=$r(19,l,s,m),r.elementType=we,r.lanes=P,r;case _e:return qa(l,m,P,s);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case W:ne=10;break e;case v:ne=9;break e;case D:ne=11;break e;case ve:ne=14;break e;case Re:ne=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return s=$r(ne,l,s,m),s.elementType=r,s.type=h,s.lanes=P,s}function ms(r,s,l,h){return r=$r(7,r,h,s),r.lanes=l,r}function qa(r,s,l,h){return r=$r(22,r,h,s),r.elementType=_e,r.lanes=l,r.stateNode={isHidden:!1},r}function Du(r,s,l){return r=$r(6,r,null,s),r.lanes=l,r}function Vu(r,s,l){return s=$r(4,r.children!==null?r.children:[],r.key,s),s.lanes=l,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}function rp(r,s,l,h,m){this.tag=s,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bi(0),this.expirationTimes=bi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bi(0),this.identifierPrefix=h,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function Mu(r,s,l,h,m,P,ne,ye,Ie){return r=new rp(r,s,l,ye,Ie),s===1?(s=1,P===!0&&(s|=8)):s=0,P=$r(3,null,null,s),r.current=P,P.stateNode=r,P.memoizedState={element:h,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gl(P),r}function ip(r,s,l){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:J,key:h==null?null:""+h,children:r,containerInfo:s,implementation:l}}function vd(r){if(!r)return Li;r=r._reactInternals;e:{if(vn(r)!==r||r.tag!==1)throw Error(t(170));var s=r;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Ir(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(t(171))}if(r.tag===1){var l=r.type;if(Ir(l))return Kc(r,l,s)}return s}function Ad(r,s,l,h,m,P,ne,ye,Ie){return r=Mu(l,h,!0,r,m,P,ne,ye,Ie),r.context=vd(null),l=r.current,h=vr(),m=Hi(l),P=Ti(h,m),P.callback=s??null,Bi(l,P,m),r.current.lanes=m,Ci(r,m,h),br(r,h),r}function Ga(r,s,l,h){var m=s.current,P=vr(),ne=Hi(m);return l=vd(l),s.context===null?s.context=l:s.pendingContext=l,s=Ti(P,ne),s.payload={element:r},h=h===void 0?null:h,h!==null&&(s.callback=h),r=Bi(m,s,ne),r!==null&&(ni(r,m,ne,P),Ra(r,m,ne)),ne}function Ka(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Td(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<s?l:s}}function Nu(r,s){Td(r,s),(r=r.alternate)&&Td(r,s)}function sp(){return null}var Pd=typeof reportError=="function"?reportError:function(r){console.error(r)};function Fu(r){this._internalRoot=r}Xa.prototype.render=Fu.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(t(409));Ga(r,s,null,null)},Xa.prototype.unmount=Fu.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;ds(function(){Ga(null,r,null,null)}),s[gi]=null}};function Xa(r){this._internalRoot=r}Xa.prototype.unstable_scheduleHydration=function(r){if(r){var s=Xo();r={blockedOn:null,target:r,priority:s};for(var l=0;l<ii.length&&s!==0&&s<ii[l].priority;l++);ii.splice(l,0,r),l===0&&Jo(r)}};function Ou(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Ya(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Rd(){}function op(r,s,l,h,m){if(m){if(typeof h=="function"){var P=h;h=function(){var Ge=Ka(ne);P.call(Ge)}}var ne=Ad(s,h,r,0,null,!1,!1,"",Rd);return r._reactRootContainer=ne,r[gi]=ne.current,_o(r.nodeType===8?r.parentNode:r),ds(),ne}for(;m=r.lastChild;)r.removeChild(m);if(typeof h=="function"){var ye=h;h=function(){var Ge=Ka(Ie);ye.call(Ge)}}var Ie=Mu(r,0,!1,null,null,!1,!1,"",Rd);return r._reactRootContainer=Ie,r[gi]=Ie.current,_o(r.nodeType===8?r.parentNode:r),ds(function(){Ga(s,Ie,l,h)}),Ie}function Qa(r,s,l,h,m){var P=l._reactRootContainer;if(P){var ne=P;if(typeof m=="function"){var ye=m;m=function(){var Ie=Ka(ne);ye.call(Ie)}}Ga(s,ne,r,m)}else ne=op(l,s,r,m,h);return Ka(ne)}Go=function(r){switch(r.tag){case 3:var s=r.stateNode;if(s.current.memoizedState.isDehydrated){var l=wi(s.pendingLanes);l!==0&&(xi(s,l|1),br(s,Bn()),(Nn&6)===0&&(Ks=Bn()+500,Ui()))}break;case 13:ds(function(){var h=Ai(r,1);if(h!==null){var m=vr();ni(h,r,1,m)}}),Nu(r,1)}},Es=function(r){if(r.tag===13){var s=Ai(r,134217728);if(s!==null){var l=vr();ni(s,r,134217728,l)}Nu(r,134217728)}},Ko=function(r){if(r.tag===13){var s=Hi(r),l=Ai(r,s);if(l!==null){var h=vr();ni(l,r,s,h)}Nu(r,s)}},Xo=function(){return Vn},Yo=function(r,s){var l=Vn;try{return Vn=r,s()}finally{Vn=l}},Pn=function(r,s,l){switch(s){case"input":if(De(r,l),s=l.name,l.type==="radio"&&s!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<l.length;s++){var h=l[s];if(h!==r&&h.form===r.form){var m=pa(h);if(!m)throw Error(t(90));ze(h),De(h,m)}}}break;case"textarea":Qe(r,l);break;case"select":s=l.value,s!=null&&Ce(r,!!l.multiple,s,!1)}},kt=bu,de=ds;var ap={usingClientEntryPoint:!1,Events:[Eo,Ns,pa,Lt,un,bu]},Vo={findFiberByHostInstance:is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lp={bundleType:Vo.bundleType,version:Vo.version,rendererPackageName:Vo.rendererPackageName,rendererConfig:Vo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:te.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=On(r),r===null?null:r.stateNode},findFiberByHostInstance:Vo.findFiberByHostInstance||sp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ja=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ja.isDisabled&&Ja.supportsFiber)try{Qi=Ja.inject(lp),Cr=Ja}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ap,reactDom_production_min.createPortal=function(r,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ou(s))throw Error(t(200));return ip(r,s,null,l)},reactDom_production_min.createRoot=function(r,s){if(!Ou(r))throw Error(t(299));var l=!1,h="",m=Pd;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onRecoverableError!==void 0&&(m=s.onRecoverableError)),s=Mu(r,1,!1,null,null,l,!1,h,m),r[gi]=s.current,_o(r.nodeType===8?r.parentNode:r),new Fu(s)},reactDom_production_min.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=On(s),r=r===null?null:r.stateNode,r},reactDom_production_min.flushSync=function(r){return ds(r)},reactDom_production_min.hydrate=function(r,s,l){if(!Ya(s))throw Error(t(200));return Qa(null,r,s,!0,l)},reactDom_production_min.hydrateRoot=function(r,s,l){if(!Ou(r))throw Error(t(405));var h=l!=null&&l.hydratedSources||null,m=!1,P="",ne=Pd;if(l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(P=l.identifierPrefix),l.onRecoverableError!==void 0&&(ne=l.onRecoverableError)),s=Ad(s,null,r,1,l??null,m,!1,P,ne),r[gi]=s.current,_o(r),h)for(r=0;r<h.length;r++)l=h[r],m=l._getVersion,m=m(l._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[l,m]:s.mutableSourceEagerHydrationData.push(l,m);return new Xa(s)},reactDom_production_min.render=function(r,s,l){if(!Ya(s))throw Error(t(200));return Qa(null,r,s,!1,l)},reactDom_production_min.unmountComponentAtNode=function(r){if(!Ya(r))throw Error(t(40));return r._reactRootContainer?(ds(function(){Qa(null,null,r,!1,function(){r._reactRootContainer=null,r[gi]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=bu,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(r,s,l,h){if(!Ya(l))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return Qa(r,s,l,!1,h)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var n=requireReactDom();return client.createRoot=n.createRoot,client.hydrateRoot=n.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);requireReactDom();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},_extends$3.apply(this,arguments)}var Action;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(n){n===void 0&&(n={});function e(i,o){let{pathname:a,search:u,hash:f}=i.location;return createLocation("",{pathname:a,search:u,hash:f},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(i,o){return typeof o=="string"?o:createPath(o)}return getUrlBasedHistory(e,t,null,n)}function invariant(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function warning(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(n,e){return{usr:n.state,key:n.key,idx:e}}function createLocation(n,e,t,i){return t===void 0&&(t=null),_extends$3({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e,{state:t,key:e&&e.key||i||createKey()})}function createPath(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function parsePath(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function getUrlBasedHistory(n,e,t,i){i===void 0&&(i={});let{window:o=document.defaultView,v5Compat:a=!1}=i,u=o.history,f=Action.Pop,d=null,p=_();p==null&&(p=0,u.replaceState(_extends$3({},u.state,{idx:p}),""));function _(){return(u.state||{idx:null}).idx}function R(){f=Action.Pop;let b=_(),K=b==null?null:b-p;p=b,d&&d({action:f,location:X.location,delta:K})}function w(b,K){f=Action.Push;let Z=createLocation(X.location,b,K);p=_()+1;let oe=getHistoryState(Z,p),te=X.createHref(Z);try{u.pushState(oe,"",te)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;o.location.assign(te)}a&&d&&d({action:f,location:X.location,delta:1})}function V(b,K){f=Action.Replace;let Z=createLocation(X.location,b,K);p=_();let oe=getHistoryState(Z,p),te=X.createHref(Z);u.replaceState(oe,"",te),a&&d&&d({action:f,location:X.location,delta:0})}function U(b){let K=o.location.origin!=="null"?o.location.origin:o.location.href,Z=typeof b=="string"?b:createPath(b);return Z=Z.replace(/ $/,"%20"),invariant(K,"No window.location.(origin|href) available to create URL for href: "+Z),new URL(Z,K)}let X={get action(){return f},get location(){return n(o,u)},listen(b){if(d)throw new Error("A history only accepts one active listener");return o.addEventListener(PopStateEventType,R),d=b,()=>{o.removeEventListener(PopStateEventType,R),d=null}},createHref(b){return e(o,b)},createURL:U,encodeLocation(b){let K=U(b);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:w,replace:V,go(b){return u.go(b)}};return X}var ResultType;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(ResultType||(ResultType={}));function matchRoutes(n,e,t){return t===void 0&&(t="/"),matchRoutesImpl(n,e,t)}function matchRoutesImpl(n,e,t,i){let o=typeof e=="string"?parsePath(e):e,a=stripBasename(o.pathname||"/",t);if(a==null)return null;let u=flattenRoutes(n);rankRouteBranches(u);let f=null;for(let d=0;f==null&&d<u.length;++d){let p=decodePath(a);f=matchRouteBranch(u[d],p)}return f}function flattenRoutes(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let o=(a,u,f)=>{let d={relativePath:f===void 0?a.path||"":f,caseSensitive:a.caseSensitive===!0,childrenIndex:u,route:a};d.relativePath.startsWith("/")&&(invariant(d.relativePath.startsWith(i),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(i.length));let p=joinPaths([i,d.relativePath]),_=t.concat(d);a.children&&a.children.length>0&&(invariant(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),flattenRoutes(a.children,e,_,p)),!(a.path==null&&!a.index)&&e.push({path:p,score:computeScore(p,a.index),routesMeta:_})};return n.forEach((a,u)=>{var f;if(a.path===""||!((f=a.path)!=null&&f.includes("?")))o(a,u);else for(let d of explodeOptionalSegments(a.path))o(a,u,d)}),e}function explodeOptionalSegments(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,o=t.endsWith("?"),a=t.replace(/\?$/,"");if(i.length===0)return o?[a,""]:[a];let u=explodeOptionalSegments(i.join("/")),f=[];return f.push(...u.map(d=>d===""?a:[a,d].join("/"))),o&&f.push(...u),f.map(d=>n.startsWith("/")&&d===""?"/":d)}function rankRouteBranches(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:compareIndexes(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=n=>n==="*";function computeScore(n,e){let t=n.split("/"),i=t.length;return t.some(isSplat)&&(i+=splatPenalty),e&&(i+=indexRouteValue),t.filter(o=>!isSplat(o)).reduce((o,a)=>o+(paramRe.test(a)?dynamicSegmentValue:a===""?emptySegmentValue:staticSegmentValue),i)}function compareIndexes(n,e){return n.length===e.length&&n.slice(0,-1).every((i,o)=>i===e[o])?n[n.length-1]-e[e.length-1]:0}function matchRouteBranch(n,e,t){let{routesMeta:i}=n,o={},a="/",u=[];for(let f=0;f<i.length;++f){let d=i[f],p=f===i.length-1,_=a==="/"?e:e.slice(a.length)||"/",R=matchPath({path:d.relativePath,caseSensitive:d.caseSensitive,end:p},_),w=d.route;if(!R)return null;Object.assign(o,R.params),u.push({params:o,pathname:joinPaths([a,R.pathname]),pathnameBase:normalizePathname(joinPaths([a,R.pathnameBase])),route:w}),R.pathnameBase!=="/"&&(a=joinPaths([a,R.pathnameBase]))}return u}function matchPath(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=compilePath(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let a=o[0],u=a.replace(/(.)\/+$/,"$1"),f=o.slice(1);return{params:i.reduce((p,_,R)=>{let{paramName:w,isOptional:V}=_;if(w==="*"){let X=f[R]||"";u=a.slice(0,a.length-X.length).replace(/(.)\/+$/,"$1")}const U=f[R];return V&&!U?p[w]=void 0:p[w]=(U||"").replace(/%2F/g,"/"),p},{}),pathname:a,pathnameBase:u,pattern:n}}function compilePath(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),warning(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,d)=>(i.push({paramName:f,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function decodePath(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function stripBasename(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function resolvePath(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:o=""}=typeof n=="string"?parsePath(n):n;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,e):e,search:normalizeSearch(i),hash:normalizeHash(o)}}function resolvePathname(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(n,e){let t=getPathContributingMatches(n);return e?t.map((i,o)=>o===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function resolveTo(n,e,t,i){i===void 0&&(i=!1);let o;typeof n=="string"?o=parsePath(n):(o=_extends$3({},n),invariant(!o.pathname||!o.pathname.includes("?"),getInvalidPathError("?","pathname","search",o)),invariant(!o.pathname||!o.pathname.includes("#"),getInvalidPathError("#","pathname","hash",o)),invariant(!o.search||!o.search.includes("#"),getInvalidPathError("#","search","hash",o)));let a=n===""||o.pathname==="",u=a?"/":o.pathname,f;if(u==null)f=t;else{let R=e.length-1;if(!i&&u.startsWith("..")){let w=u.split("/");for(;w[0]==="..";)w.shift(),R-=1;o.pathname=w.join("/")}f=R>=0?e[R]:"/"}let d=resolvePath(o,f),p=u&&u!=="/"&&u.endsWith("/"),_=(a||u===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(p||_)&&(d.pathname+="/"),d}const joinPaths=n=>n.join("/").replace(/\/\/+/g,"/"),normalizePathname=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,normalizeHash=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function isRouteErrorResponse(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},_extends$2.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(n,e){let{relative:t}=e===void 0?{}:e;useInRouterContext()||invariant(!1);let{basename:i,navigator:o}=reactExports.useContext(NavigationContext),{hash:a,pathname:u,search:f}=useResolvedPath(n,{relative:t}),d=u;return i!=="/"&&(d=u==="/"?i:joinPaths([i,u])),o.createHref({pathname:d,search:f,hash:a})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(n){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(n)}function useNavigate(){let{isDataRoute:n}=reactExports.useContext(RouteContext);return n?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let n=reactExports.useContext(DataRouterContext),{basename:e,future:t,navigator:i}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),u=JSON.stringify(getResolveToMatches(o,t.v7_relativeSplatPath)),f=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{f.current=!0}),reactExports.useCallback(function(p,_){if(_===void 0&&(_={}),!f.current)return;if(typeof p=="number"){i.go(p);return}let R=resolveTo(p,JSON.parse(u),a,_.relative==="path");n==null&&e!=="/"&&(R.pathname=R.pathname==="/"?e:joinPaths([e,R.pathname])),(_.replace?i.replace:i.push)(R,_.state,_)},[e,i,u,a,n])}function useResolvedPath(n,e){let{relative:t}=e===void 0?{}:e,{future:i}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),u=JSON.stringify(getResolveToMatches(o,i.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(n,JSON.parse(u),a,t==="path"),[n,u,a,t])}function useRoutes(n,e){return useRoutesImpl(n,e)}function useRoutesImpl(n,e,t,i){useInRouterContext()||invariant(!1);let{navigator:o}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),u=a[a.length-1],f=u?u.params:{};u&&u.pathname;let d=u?u.pathnameBase:"/";u&&u.route;let p=useLocation(),_;if(e){var R;let b=typeof e=="string"?parsePath(e):e;d==="/"||(R=b.pathname)!=null&&R.startsWith(d)||invariant(!1),_=b}else _=p;let w=_.pathname||"/",V=w;if(d!=="/"){let b=d.replace(/^\//,"").split("/");V="/"+w.replace(/^\//,"").split("/").slice(b.length).join("/")}let U=matchRoutes(n,{pathname:V}),X=_renderMatches(U&&U.map(b=>Object.assign({},b,{params:Object.assign({},f,b.params),pathname:joinPaths([d,o.encodeLocation?o.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?d:joinPaths([d,o.encodeLocation?o.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,t,i);return e&&X?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$2({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:Action.Pop}},X):X}function DefaultErrorComponent(){let n=useRouteError(),e=isRouteErrorResponse(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),t?reactExports.createElement("pre",{style:o},t):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(n){let{routeContext:e,match:t,children:i}=n,o=reactExports.useContext(DataRouterContext);return o&&o.static&&o.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=t.route.id),reactExports.createElement(RouteContext.Provider,{value:e},i)}function _renderMatches(n,e,t,i){var o;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=i)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,f=(o=t)==null?void 0:o.errors;if(f!=null){let _=u.findIndex(R=>R.route.id&&(f==null?void 0:f[R.route.id])!==void 0);_>=0||invariant(!1),u=u.slice(0,Math.min(u.length,_+1))}let d=!1,p=-1;if(t&&i&&i.v7_partialHydration)for(let _=0;_<u.length;_++){let R=u[_];if((R.route.HydrateFallback||R.route.hydrateFallbackElement)&&(p=_),R.route.id){let{loaderData:w,errors:V}=t,U=R.route.loader&&w[R.route.id]===void 0&&(!V||V[R.route.id]===void 0);if(R.route.lazy||U){d=!0,p>=0?u=u.slice(0,p+1):u=[u[0]];break}}}return u.reduceRight((_,R,w)=>{let V,U=!1,X=null,b=null;t&&(V=f&&R.route.id?f[R.route.id]:void 0,X=R.route.errorElement||defaultErrorElement,d&&(p<0&&w===0?(warningOnce("route-fallback"),U=!0,b=null):p===w&&(U=!0,b=R.route.hydrateFallbackElement||null)));let K=e.concat(u.slice(0,w+1)),Z=()=>{let oe;return V?oe=X:U?oe=b:R.route.Component?oe=reactExports.createElement(R.route.Component,null):R.route.element?oe=R.route.element:oe=_,reactExports.createElement(RenderedRoute,{match:R,routeContext:{outlet:_,matches:K,isDataRoute:t!=null},children:oe})};return t&&(R.route.ErrorBoundary||R.route.errorElement||w===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:X,error:V,children:Z(),routeContext:{outlet:null,matches:K,isDataRoute:!0}}):Z()},null)}var DataRouterHook$1=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(DataRouterHook$1||{}),DataRouterStateHook$1=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(DataRouterStateHook$1||{});function useDataRouterContext(n){let e=reactExports.useContext(DataRouterContext);return e||invariant(!1),e}function useDataRouterState(n){let e=reactExports.useContext(DataRouterStateContext);return e||invariant(!1),e}function useRouteContext(n){let e=reactExports.useContext(RouteContext);return e||invariant(!1),e}function useCurrentRouteId(n){let e=useRouteContext(),t=e.matches[e.matches.length-1];return t.route.id||invariant(!1),t.route.id}function useRouteError(){var n;let e=reactExports.useContext(RouteErrorContext),t=useDataRouterState(),i=useCurrentRouteId();return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function useNavigateStable(){let{router:n}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),e=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{t.current=!0}),reactExports.useCallback(function(o,a){a===void 0&&(a={}),t.current&&(typeof o=="number"?n.navigate(o):n.navigate(o,_extends$2({fromRouteId:e},a)))},[n,e])}const alreadyWarned$1={};function warningOnce(n,e,t){alreadyWarned$1[n]||(alreadyWarned$1[n]=!0)}function logV6DeprecationWarnings(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Navigate(n){let{to:e,replace:t,state:i,relative:o}=n;useInRouterContext()||invariant(!1);let{future:a,static:u}=reactExports.useContext(NavigationContext),{matches:f}=reactExports.useContext(RouteContext),{pathname:d}=useLocation(),p=useNavigate(),_=resolveTo(e,getResolveToMatches(f,a.v7_relativeSplatPath),d,o==="path"),R=JSON.stringify(_);return reactExports.useEffect(()=>p(JSON.parse(R),{replace:t,state:i,relative:o}),[p,R,o,t,i]),null}function Route(n){invariant(!1)}function Router(n){let{basename:e="/",children:t=null,location:i,navigationType:o=Action.Pop,navigator:a,static:u=!1,future:f}=n;useInRouterContext()&&invariant(!1);let d=e.replace(/^\/*/,"/"),p=reactExports.useMemo(()=>({basename:d,navigator:a,static:u,future:_extends$2({v7_relativeSplatPath:!1},f)}),[d,f,a,u]);typeof i=="string"&&(i=parsePath(i));let{pathname:_="/",search:R="",hash:w="",state:V=null,key:U="default"}=i,X=reactExports.useMemo(()=>{let b=stripBasename(_,d);return b==null?null:{location:{pathname:b,search:R,hash:w,state:V,key:U},navigationType:o}},[d,_,R,w,V,U,o]);return X==null?null:reactExports.createElement(NavigationContext.Provider,{value:p},reactExports.createElement(LocationContext.Provider,{children:t,value:X}))}function Routes(n){let{children:e,location:t}=n;return useRoutes(createRoutesFromChildren(e),t)}new Promise(()=>{});function createRoutesFromChildren(n,e){e===void 0&&(e=[]);let t=[];return reactExports.Children.forEach(n,(i,o)=>{if(!reactExports.isValidElement(i))return;let a=[...e,o];if(i.type===reactExports.Fragment){t.push.apply(t,createRoutesFromChildren(i.props.children,a));return}i.type!==Route&&invariant(!1),!i.props.index||!i.props.children||invariant(!1);let u={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(u.children=createRoutesFromChildren(i.props.children,a)),t.push(u)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},_extends$1.apply(this,arguments)}function _objectWithoutPropertiesLoose$1(n,e){if(n==null)return{};var t={},i=Object.keys(n),o,a;for(a=0;a<i.length;a++)o=i[a],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function isModifiedEvent(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function shouldProcessLinkClick(n,e){return n.button===0&&(!e||e==="_self")&&!isModifiedEvent(n)}const _excluded$1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(n){let{basename:e,children:t,future:i,window:o}=n,a=reactExports.useRef();a.current==null&&(a.current=createBrowserHistory({window:o,v5Compat:!0}));let u=a.current,[f,d]=reactExports.useState({action:u.action,location:u.location}),{v7_startTransition:p}=i||{},_=reactExports.useCallback(R=>{p&&startTransitionImpl?startTransitionImpl(()=>d(R)):d(R)},[d,p]);return reactExports.useLayoutEffect(()=>u.listen(_),[u,_]),reactExports.useEffect(()=>logV6DeprecationWarnings(i),[i]),reactExports.createElement(Router,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:u,future:i})}const isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(e,t){let{onClick:i,relative:o,reloadDocument:a,replace:u,state:f,target:d,to:p,preventScrollReset:_,viewTransition:R}=e,w=_objectWithoutPropertiesLoose$1(e,_excluded$1),{basename:V}=reactExports.useContext(NavigationContext),U,X=!1;if(typeof p=="string"&&ABSOLUTE_URL_REGEX.test(p)&&(U=p,isBrowser))try{let oe=new URL(window.location.href),te=p.startsWith("//")?new URL(oe.protocol+p):new URL(p),H=stripBasename(te.pathname,V);te.origin===oe.origin&&H!=null?p=H+te.search+te.hash:X=!0}catch{}let b=useHref(p,{relative:o}),K=useLinkClickHandler(p,{replace:u,state:f,target:d,preventScrollReset:_,relative:o,viewTransition:R});function Z(oe){i&&i(oe),oe.defaultPrevented||K(oe)}return reactExports.createElement("a",_extends$1({},w,{href:U||b,onClick:X||a?i:Z,ref:t,target:d}))});var DataRouterHook;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(n,e){let{target:t,replace:i,state:o,preventScrollReset:a,relative:u,viewTransition:f}=e===void 0?{}:e,d=useNavigate(),p=useLocation(),_=useResolvedPath(n,{relative:u});return reactExports.useCallback(R=>{if(shouldProcessLinkClick(R,t)){R.preventDefault();let w=i!==void 0?i:createPath(p)===createPath(_);d(n,{replace:w,state:o,preventScrollReset:a,relative:u,viewTransition:f})}},[p,d,_,i,o,t,n,a,u,f])}const getDefaultsFromPostinstall=()=>{};var define_process_env_default={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},byteArrayToString=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const a=n[t++];e[i++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=n[t++],u=n[t++],f=n[t++],d=((o&7)<<18|(a&63)<<12|(u&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(d>>10)),e[i++]=String.fromCharCode(56320+(d&1023))}else{const a=n[t++],u=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(a&63)<<6|u&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const a=n[o],u=o+1<n.length,f=u?n[o+1]:0,d=o+2<n.length,p=d?n[o+2]:0,_=a>>2,R=(a&3)<<4|f>>4;let w=(f&15)<<2|p>>6,V=p&63;d||(V=64,u||(w=64)),i.push(t[_],t[R],t[w],t[V])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(stringToByteArray$1(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):byteArrayToString(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const a=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const p=o<n.length?t[n.charAt(o)]:64;++o;const R=o<n.length?t[n.charAt(o)]:64;if(++o,a==null||f==null||p==null||R==null)throw new DecodeBase64StringError;const w=a<<2|f>>4;if(i.push(w),p!==64){const V=f<<4&240|p>>2;if(i.push(V),R!==64){const U=p<<6&192|R;i.push(U)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(n){const e=stringToByteArray$1(n);return base64.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(n){return base64Encode(n).replace(/\./g,"")},base64Decode=function(n){try{return base64.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof define_process_env_default>"u")return;const n=define_process_env_default.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&base64Decode(n[1]);return e&&JSON.parse(e)},getDefaults=()=>{try{return getDefaultsFromPostinstall()||getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},getDefaultEmulatorHost=n=>{var e,t;return(t=(e=getDefaults())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},getDefaultEmulatorHostnameAndPort=n=>{const e=getDefaultEmulatorHost(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},getDefaultAppConfig=()=>{var n;return(n=getDefaults())===null||n===void 0?void 0:n.config},getExperimentalSetting=n=>{var e;return(e=getDefaults())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isCloudWorkstation(n){return n.endsWith(".cloudworkstations.dev")}async function pingServer(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[base64urlEncodeWithoutPadding(JSON.stringify(t)),base64urlEncodeWithoutPadding(JSON.stringify(u)),""].join(".")}const emulatorStatus={};function getEmulatorSummary(){const n={prod:[],emulator:[]};for(const e of Object.keys(emulatorStatus))emulatorStatus[e]?n.emulator.push(e):n.prod.push(e);return n}function getOrCreateEl(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let previouslyDismissed=!1;function updateEmulatorBanner(n,e){if(typeof window>"u"||typeof document>"u"||!isCloudWorkstation(window.location.host)||emulatorStatus[n]===e||emulatorStatus[n]||previouslyDismissed)return;emulatorStatus[n]=e;function t(w){return`__firebase__banner__${w}`}const i="__firebase__banner",a=getEmulatorSummary().prod.length>0;function u(){const w=document.getElementById(i);w&&w.remove()}function f(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function d(w,V){w.setAttribute("width","24"),w.setAttribute("id",V),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function p(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{previouslyDismissed=!0,u()},w}function _(w,V){w.setAttribute("id",V),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function R(){const w=getOrCreateEl(i),V=t("text"),U=document.getElementById(V)||document.createElement("span"),X=t("learnmore"),b=document.getElementById(X)||document.createElement("a"),K=t("preprendIcon"),Z=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const oe=w.element;f(oe),_(b,X);const te=p();d(Z,K),oe.append(Z,U,b,te),document.body.appendChild(oe)}a?(U.innerText="Preview backend disconnected.",Z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,U.innerText="Preview backend running in this workspace."),U.setAttribute("id",V)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",R):R()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){var n;const e=(n=getDefaults())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function isCloudflareWorker(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function isBrowserExtension(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){const n=getUA();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function isSafari(){return!isNode()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var a;e(((a=o.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,a=this.errors[e],u=a?replaceTemplate(a,i):"Error",f=`${this.serviceName}: ${u} (${o}).`;return new FirebaseError(o,f,i)}}function replaceTemplate(n,e){return n.replace(PATTERN,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const PATTERN=/\{\$([^}]+)}/g;function isEmpty$1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function deepEqual(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const a=n[o],u=e[o];if(isObject(a)&&isObject(u)){if(!deepEqual(a,u))return!1}else if(a!==u)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function isObject(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function querystringDecode(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,a]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(a)}}),e}function extractQuerystring(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function createSubscribe(n,e){const t=new ObserverProxy(n,e);return t.subscribe.bind(t)}class ObserverProxy{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");implementsAnyMethods(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=noop),o.error===void 0&&(o.error=noop),o.complete===void 0&&(o.complete=noop);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function noop(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(n){return n&&n._delegate?n._delegate:n}class Component{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Deferred;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:o});i.resolve(a)}catch{}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(a);i===f&&u.resolve(o)}return o}onInit(e,t){var i;const o=this.normalizeInstanceIdentifier(t),a=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;a.add(e),this.onInitCallbacks.set(o,a);const u=this.instances.get(o);return u&&e(u,o),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(n){return n===DEFAULT_ENTRY_NAME$1?void 0:n}function isComponentEager(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Provider(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=ConsoleMethod[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}const instanceOfAny=(n,e)=>e.some(t=>n instanceof t);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",a),n.removeEventListener("error",u)},a=()=>{t(wrap(n.result)),o()},u=()=>{i(n.error),o()};n.addEventListener("success",a),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&cursorRequestMap.set(t,n)}).catch(()=>{}),reverseTransformCache.set(e,n),e}function cacheDonePromiseForTransaction(n){if(transactionDoneMap.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",u),n.removeEventListener("abort",u)},a=()=>{t(),o()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",a),n.addEventListener("error",u),n.addEventListener("abort",u)});transactionDoneMap.set(n,e)}let idbProxyTraps={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return transactionDoneMap.get(n);if(e==="objectStoreNames")return n.objectStoreNames||transactionStoreNamesMap.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return wrap(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function replaceTraps(n){idbProxyTraps=n(idbProxyTraps)}function wrapFunction(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(unwrap(this),e,...t);return transactionStoreNamesMap.set(i,e.sort?e.sort():[e]),wrap(i)}:getCursorAdvanceMethods().includes(n)?function(...e){return n.apply(unwrap(this),e),wrap(cursorRequestMap.get(this))}:function(...e){return wrap(n.apply(unwrap(this),e))}}function transformCachableValue(n){return typeof n=="function"?wrapFunction(n):(n instanceof IDBTransaction&&cacheDonePromiseForTransaction(n),instanceOfAny(n,getIdbProxyableTypes())?new Proxy(n,idbProxyTraps):n)}function wrap(n){if(n instanceof IDBRequest)return promisifyRequest(n);if(transformCache.has(n))return transformCache.get(n);const e=transformCachableValue(n);return e!==n&&(transformCache.set(n,e),reverseTransformCache.set(e,n)),e}const unwrap=n=>reverseTransformCache.get(n);function openDB(n,e,{blocked:t,upgrade:i,blocking:o,terminated:a}={}){const u=indexedDB.open(n,e),f=wrap(u);return i&&u.addEventListener("upgradeneeded",d=>{i(wrap(u.result),d.oldVersion,d.newVersion,wrap(u.transaction),d)}),t&&u.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),f.then(d=>{a&&d.addEventListener("close",()=>a()),o&&d.addEventListener("versionchange",p=>o(p.oldVersion,p.newVersion,p))}).catch(()=>{}),f}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(cachedMethods.get(e))return cachedMethods.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=writeMethods.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||readMethods.includes(t)))return;const a=async function(u,...f){const d=this.transaction(u,o?"readwrite":"readonly");let p=d.store;return i&&(p=p.index(f.shift())),(await Promise.all([p[t](...f),o&&d.done]))[0]};return cachedMethods.set(e,a),a}replaceTraps(n=>({...n,get:(e,t,i)=>getMethod(e,t)||n.get(e,t,i),has:(e,t)=>!!getMethod(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(isVersionServiceProvider(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function isVersionServiceProvider(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$q="@firebase/app",version$1$1="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger("@firebase/app"),name$p="@firebase/app-compat",name$o="@firebase/analytics-compat",name$n="@firebase/analytics",name$m="@firebase/app-check-compat",name$l="@firebase/app-check",name$k="@firebase/auth",name$j="@firebase/auth-compat",name$i="@firebase/database",name$h="@firebase/data-connect",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5="@firebase/storage",name$4="@firebase/storage-compat",name$3="@firebase/firestore",name$2="@firebase/ai",name$1$1="@firebase/firestore-compat",name$r="firebase",version$2="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$q]:"fire-core",[name$p]:"fire-core-compat",[name$n]:"fire-analytics",[name$o]:"fire-analytics-compat",[name$l]:"fire-app-check",[name$m]:"fire-app-check-compat",[name$k]:"fire-auth",[name$j]:"fire-auth-compat",[name$i]:"fire-rtdb",[name$h]:"fire-data-connect",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5]:"fire-gcs",[name$4]:"fire-gcs-compat",[name$3]:"fire-fst",[name$1$1]:"fire-fst-compat",[name$2]:"fire-vertex","fire-js":"fire-js",[name$r]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(n,e){try{n.container.addComponent(e)}catch(t){logger.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function _registerComponent(n){const e=n.name;if(_components.has(e))return logger.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,n);for(const t of _apps.values())_addComponent(t,n);for(const t of _serverApps.values())_addComponent(t,n);return!0}function _getProvider(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function _isFirebaseServerApp(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY=new ErrorFactory("app","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$2;function initializeApp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!0},e),o=i.name;if(typeof o!="string"||!o)throw ERROR_FACTORY.create("bad-app-name",{appName:String(o)});if(t||(t=getDefaultAppConfig()),!t)throw ERROR_FACTORY.create("no-options");const a=_apps.get(o);if(a){if(deepEqual(t,a.options)&&deepEqual(i,a.config))return a;throw ERROR_FACTORY.create("duplicate-app",{appName:o})}const u=new ComponentContainer(o);for(const d of _components.values())u.addComponent(d);const f=new FirebaseAppImpl(t,i,u);return _apps.set(o,f),f}function getApp(n=DEFAULT_ENTRY_NAME){const e=_apps.get(n);if(!e&&n===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!e)throw ERROR_FACTORY.create("no-app",{appName:n});return e}function registerVersion(n,e,t){var i;let o=(i=PLATFORM_LOG_STRING[n])!==null&&i!==void 0?i:n;t&&(o+=`-${t}`);const a=o.match(/\s|\//),u=e.match(/\s|\//);if(a||u){const f=[`Unable to register library "${o}" with version "${e}":`];a&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&u&&f.push("and"),u&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger.warn(f.join(" "));return}_registerComponent(new Component(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(STORE_NAME)}catch(t){console.warn(t)}}}}).catch(n=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:n.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(n){try{const t=(await getDbPromise()).transaction(STORE_NAME),i=await t.objectStore(STORE_NAME).get(computeKey(n));return await t.done,i}catch(e){if(e instanceof FirebaseError)logger.warn(e.message);else{const t=ERROR_FACTORY.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});logger.warn(t.message)}}}async function writeHeartbeatsToIndexedDB(n,e){try{const i=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await i.objectStore(STORE_NAME).put(e,computeKey(n)),await i.done}catch(t){if(t instanceof FirebaseError)logger.warn(t.message);else{const i=ERROR_FACTORY.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});logger.warn(i.message)}}}function computeKey(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,MAX_NUM_STORED_HEARTBEATS=30;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=getUTCDateString();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(u=>u.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:o}),this._heartbeatsCache.heartbeats.length>MAX_NUM_STORED_HEARTBEATS){const u=getEarliestHeartbeatIdx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){logger.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=getUTCDateString(),{heartbeatsToSend:i,unsentEntries:o}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),a=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return logger.warn(t),""}}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(n,e=MAX_HEADER_BYTES){const t=[];let i=n.slice();for(const o of n){const a=t.find(u=>u.agent===o.agent);if(a){if(a.dates.push(o.date),countBytes(t)>e){a.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),countBytes(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await readHeartbeatsFromIndexedDB(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function countBytes(n){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:n})).length}function getEarliestHeartbeatIdx(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(n){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$q,version$1$1,n),registerVersion(name$q,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");var name$1="firebase",version$1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name$1,version$1,"app");var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Integer,Md5;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,g){function E(){}E.prototype=g.prototype,y.D=g.prototype,y.prototype=new E,y.prototype.constructor=y,y.C=function(W,v,D){for(var C=Array(arguments.length-2),we=2;we<arguments.length;we++)C[we-2]=arguments[we];return g.prototype[v].apply(W,C)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(y,g,E){E||(E=0);var W=Array(16);if(typeof g=="string")for(var v=0;16>v;++v)W[v]=g.charCodeAt(E++)|g.charCodeAt(E++)<<8|g.charCodeAt(E++)<<16|g.charCodeAt(E++)<<24;else for(v=0;16>v;++v)W[v]=g[E++]|g[E++]<<8|g[E++]<<16|g[E++]<<24;g=y.g[0],E=y.g[1],v=y.g[2];var D=y.g[3],C=g+(D^E&(v^D))+W[0]+3614090360&4294967295;g=E+(C<<7&4294967295|C>>>25),C=D+(v^g&(E^v))+W[1]+3905402710&4294967295,D=g+(C<<12&4294967295|C>>>20),C=v+(E^D&(g^E))+W[2]+606105819&4294967295,v=D+(C<<17&4294967295|C>>>15),C=E+(g^v&(D^g))+W[3]+3250441966&4294967295,E=v+(C<<22&4294967295|C>>>10),C=g+(D^E&(v^D))+W[4]+4118548399&4294967295,g=E+(C<<7&4294967295|C>>>25),C=D+(v^g&(E^v))+W[5]+1200080426&4294967295,D=g+(C<<12&4294967295|C>>>20),C=v+(E^D&(g^E))+W[6]+2821735955&4294967295,v=D+(C<<17&4294967295|C>>>15),C=E+(g^v&(D^g))+W[7]+4249261313&4294967295,E=v+(C<<22&4294967295|C>>>10),C=g+(D^E&(v^D))+W[8]+1770035416&4294967295,g=E+(C<<7&4294967295|C>>>25),C=D+(v^g&(E^v))+W[9]+2336552879&4294967295,D=g+(C<<12&4294967295|C>>>20),C=v+(E^D&(g^E))+W[10]+4294925233&4294967295,v=D+(C<<17&4294967295|C>>>15),C=E+(g^v&(D^g))+W[11]+2304563134&4294967295,E=v+(C<<22&4294967295|C>>>10),C=g+(D^E&(v^D))+W[12]+1804603682&4294967295,g=E+(C<<7&4294967295|C>>>25),C=D+(v^g&(E^v))+W[13]+4254626195&4294967295,D=g+(C<<12&4294967295|C>>>20),C=v+(E^D&(g^E))+W[14]+2792965006&4294967295,v=D+(C<<17&4294967295|C>>>15),C=E+(g^v&(D^g))+W[15]+1236535329&4294967295,E=v+(C<<22&4294967295|C>>>10),C=g+(v^D&(E^v))+W[1]+4129170786&4294967295,g=E+(C<<5&4294967295|C>>>27),C=D+(E^v&(g^E))+W[6]+3225465664&4294967295,D=g+(C<<9&4294967295|C>>>23),C=v+(g^E&(D^g))+W[11]+643717713&4294967295,v=D+(C<<14&4294967295|C>>>18),C=E+(D^g&(v^D))+W[0]+3921069994&4294967295,E=v+(C<<20&4294967295|C>>>12),C=g+(v^D&(E^v))+W[5]+3593408605&4294967295,g=E+(C<<5&4294967295|C>>>27),C=D+(E^v&(g^E))+W[10]+38016083&4294967295,D=g+(C<<9&4294967295|C>>>23),C=v+(g^E&(D^g))+W[15]+3634488961&4294967295,v=D+(C<<14&4294967295|C>>>18),C=E+(D^g&(v^D))+W[4]+3889429448&4294967295,E=v+(C<<20&4294967295|C>>>12),C=g+(v^D&(E^v))+W[9]+568446438&4294967295,g=E+(C<<5&4294967295|C>>>27),C=D+(E^v&(g^E))+W[14]+3275163606&4294967295,D=g+(C<<9&4294967295|C>>>23),C=v+(g^E&(D^g))+W[3]+4107603335&4294967295,v=D+(C<<14&4294967295|C>>>18),C=E+(D^g&(v^D))+W[8]+1163531501&4294967295,E=v+(C<<20&4294967295|C>>>12),C=g+(v^D&(E^v))+W[13]+2850285829&4294967295,g=E+(C<<5&4294967295|C>>>27),C=D+(E^v&(g^E))+W[2]+4243563512&4294967295,D=g+(C<<9&4294967295|C>>>23),C=v+(g^E&(D^g))+W[7]+1735328473&4294967295,v=D+(C<<14&4294967295|C>>>18),C=E+(D^g&(v^D))+W[12]+2368359562&4294967295,E=v+(C<<20&4294967295|C>>>12),C=g+(E^v^D)+W[5]+4294588738&4294967295,g=E+(C<<4&4294967295|C>>>28),C=D+(g^E^v)+W[8]+2272392833&4294967295,D=g+(C<<11&4294967295|C>>>21),C=v+(D^g^E)+W[11]+1839030562&4294967295,v=D+(C<<16&4294967295|C>>>16),C=E+(v^D^g)+W[14]+4259657740&4294967295,E=v+(C<<23&4294967295|C>>>9),C=g+(E^v^D)+W[1]+2763975236&4294967295,g=E+(C<<4&4294967295|C>>>28),C=D+(g^E^v)+W[4]+1272893353&4294967295,D=g+(C<<11&4294967295|C>>>21),C=v+(D^g^E)+W[7]+4139469664&4294967295,v=D+(C<<16&4294967295|C>>>16),C=E+(v^D^g)+W[10]+3200236656&4294967295,E=v+(C<<23&4294967295|C>>>9),C=g+(E^v^D)+W[13]+681279174&4294967295,g=E+(C<<4&4294967295|C>>>28),C=D+(g^E^v)+W[0]+3936430074&4294967295,D=g+(C<<11&4294967295|C>>>21),C=v+(D^g^E)+W[3]+3572445317&4294967295,v=D+(C<<16&4294967295|C>>>16),C=E+(v^D^g)+W[6]+76029189&4294967295,E=v+(C<<23&4294967295|C>>>9),C=g+(E^v^D)+W[9]+3654602809&4294967295,g=E+(C<<4&4294967295|C>>>28),C=D+(g^E^v)+W[12]+3873151461&4294967295,D=g+(C<<11&4294967295|C>>>21),C=v+(D^g^E)+W[15]+530742520&4294967295,v=D+(C<<16&4294967295|C>>>16),C=E+(v^D^g)+W[2]+3299628645&4294967295,E=v+(C<<23&4294967295|C>>>9),C=g+(v^(E|~D))+W[0]+4096336452&4294967295,g=E+(C<<6&4294967295|C>>>26),C=D+(E^(g|~v))+W[7]+1126891415&4294967295,D=g+(C<<10&4294967295|C>>>22),C=v+(g^(D|~E))+W[14]+2878612391&4294967295,v=D+(C<<15&4294967295|C>>>17),C=E+(D^(v|~g))+W[5]+4237533241&4294967295,E=v+(C<<21&4294967295|C>>>11),C=g+(v^(E|~D))+W[12]+1700485571&4294967295,g=E+(C<<6&4294967295|C>>>26),C=D+(E^(g|~v))+W[3]+2399980690&4294967295,D=g+(C<<10&4294967295|C>>>22),C=v+(g^(D|~E))+W[10]+4293915773&4294967295,v=D+(C<<15&4294967295|C>>>17),C=E+(D^(v|~g))+W[1]+2240044497&4294967295,E=v+(C<<21&4294967295|C>>>11),C=g+(v^(E|~D))+W[8]+1873313359&4294967295,g=E+(C<<6&4294967295|C>>>26),C=D+(E^(g|~v))+W[15]+4264355552&4294967295,D=g+(C<<10&4294967295|C>>>22),C=v+(g^(D|~E))+W[6]+2734768916&4294967295,v=D+(C<<15&4294967295|C>>>17),C=E+(D^(v|~g))+W[13]+1309151649&4294967295,E=v+(C<<21&4294967295|C>>>11),C=g+(v^(E|~D))+W[4]+4149444226&4294967295,g=E+(C<<6&4294967295|C>>>26),C=D+(E^(g|~v))+W[11]+3174756917&4294967295,D=g+(C<<10&4294967295|C>>>22),C=v+(g^(D|~E))+W[2]+718787259&4294967295,v=D+(C<<15&4294967295|C>>>17),C=E+(D^(v|~g))+W[9]+3951481745&4294967295,y.g[0]=y.g[0]+g&4294967295,y.g[1]=y.g[1]+(v+(C<<21&4294967295|C>>>11))&4294967295,y.g[2]=y.g[2]+v&4294967295,y.g[3]=y.g[3]+D&4294967295}i.prototype.u=function(y,g){g===void 0&&(g=y.length);for(var E=g-this.blockSize,W=this.B,v=this.h,D=0;D<g;){if(v==0)for(;D<=E;)o(this,y,D),D+=this.blockSize;if(typeof y=="string"){for(;D<g;)if(W[v++]=y.charCodeAt(D++),v==this.blockSize){o(this,W),v=0;break}}else for(;D<g;)if(W[v++]=y[D++],v==this.blockSize){o(this,W),v=0;break}}this.h=v,this.o+=g},i.prototype.v=function(){var y=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);y[0]=128;for(var g=1;g<y.length-8;++g)y[g]=0;var E=8*this.o;for(g=y.length-8;g<y.length;++g)y[g]=E&255,E/=256;for(this.u(y),y=Array(16),g=E=0;4>g;++g)for(var W=0;32>W;W+=8)y[E++]=this.g[g]>>>W&255;return y};function a(y,g){var E=f;return Object.prototype.hasOwnProperty.call(E,y)?E[y]:E[y]=g(y)}function u(y,g){this.h=g;for(var E=[],W=!0,v=y.length-1;0<=v;v--){var D=y[v]|0;W&&D==g||(E[v]=D,W=!1)}this.g=E}var f={};function d(y){return-128<=y&&128>y?a(y,function(g){return new u([g|0],0>g?-1:0)}):new u([y|0],0>y?-1:0)}function p(y){if(isNaN(y)||!isFinite(y))return R;if(0>y)return b(p(-y));for(var g=[],E=1,W=0;y>=E;W++)g[W]=y/E|0,E*=4294967296;return new u(g,0)}function _(y,g){if(y.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(y.charAt(0)=="-")return b(_(y.substring(1),g));if(0<=y.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=p(Math.pow(g,8)),W=R,v=0;v<y.length;v+=8){var D=Math.min(8,y.length-v),C=parseInt(y.substring(v,v+D),g);8>D?(D=p(Math.pow(g,D)),W=W.j(D).add(p(C))):(W=W.j(E),W=W.add(p(C)))}return W}var R=d(0),w=d(1),V=d(16777216);n=u.prototype,n.m=function(){if(X(this))return-b(this).m();for(var y=0,g=1,E=0;E<this.g.length;E++){var W=this.i(E);y+=(0<=W?W:4294967296+W)*g,g*=4294967296}return y},n.toString=function(y){if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(U(this))return"0";if(X(this))return"-"+b(this).toString(y);for(var g=p(Math.pow(y,6)),E=this,W="";;){var v=te(E,g).g;E=K(E,v.j(g));var D=((0<E.g.length?E.g[0]:E.h)>>>0).toString(y);if(E=v,U(E))return D+W;for(;6>D.length;)D="0"+D;W=D+W}},n.i=function(y){return 0>y?0:y<this.g.length?this.g[y]:this.h};function U(y){if(y.h!=0)return!1;for(var g=0;g<y.g.length;g++)if(y.g[g]!=0)return!1;return!0}function X(y){return y.h==-1}n.l=function(y){return y=K(this,y),X(y)?-1:U(y)?0:1};function b(y){for(var g=y.g.length,E=[],W=0;W<g;W++)E[W]=~y.g[W];return new u(E,~y.h).add(w)}n.abs=function(){return X(this)?b(this):this},n.add=function(y){for(var g=Math.max(this.g.length,y.g.length),E=[],W=0,v=0;v<=g;v++){var D=W+(this.i(v)&65535)+(y.i(v)&65535),C=(D>>>16)+(this.i(v)>>>16)+(y.i(v)>>>16);W=C>>>16,D&=65535,C&=65535,E[v]=C<<16|D}return new u(E,E[E.length-1]&-2147483648?-1:0)};function K(y,g){return y.add(b(g))}n.j=function(y){if(U(this)||U(y))return R;if(X(this))return X(y)?b(this).j(b(y)):b(b(this).j(y));if(X(y))return b(this.j(b(y)));if(0>this.l(V)&&0>y.l(V))return p(this.m()*y.m());for(var g=this.g.length+y.g.length,E=[],W=0;W<2*g;W++)E[W]=0;for(W=0;W<this.g.length;W++)for(var v=0;v<y.g.length;v++){var D=this.i(W)>>>16,C=this.i(W)&65535,we=y.i(v)>>>16,ve=y.i(v)&65535;E[2*W+2*v]+=C*ve,Z(E,2*W+2*v),E[2*W+2*v+1]+=D*ve,Z(E,2*W+2*v+1),E[2*W+2*v+1]+=C*we,Z(E,2*W+2*v+1),E[2*W+2*v+2]+=D*we,Z(E,2*W+2*v+2)}for(W=0;W<g;W++)E[W]=E[2*W+1]<<16|E[2*W];for(W=g;W<2*g;W++)E[W]=0;return new u(E,0)};function Z(y,g){for(;(y[g]&65535)!=y[g];)y[g+1]+=y[g]>>>16,y[g]&=65535,g++}function oe(y,g){this.g=y,this.h=g}function te(y,g){if(U(g))throw Error("division by zero");if(U(y))return new oe(R,R);if(X(y))return g=te(b(y),g),new oe(b(g.g),b(g.h));if(X(g))return g=te(y,b(g)),new oe(b(g.g),g.h);if(30<y.g.length){if(X(y)||X(g))throw Error("slowDivide_ only works with positive integers.");for(var E=w,W=g;0>=W.l(y);)E=H(E),W=H(W);var v=J(E,1),D=J(W,1);for(W=J(W,2),E=J(E,2);!U(W);){var C=D.add(W);0>=C.l(y)&&(v=v.add(E),D=C),W=J(W,1),E=J(E,1)}return g=K(y,v.j(g)),new oe(v,g)}for(v=R;0<=y.l(g);){for(E=Math.max(1,Math.floor(y.m()/g.m())),W=Math.ceil(Math.log(E)/Math.LN2),W=48>=W?1:Math.pow(2,W-48),D=p(E),C=D.j(g);X(C)||0<C.l(y);)E-=W,D=p(E),C=D.j(g);U(D)&&(D=w),v=v.add(D),y=K(y,C)}return new oe(v,y)}n.A=function(y){return te(this,y).h},n.and=function(y){for(var g=Math.max(this.g.length,y.g.length),E=[],W=0;W<g;W++)E[W]=this.i(W)&y.i(W);return new u(E,this.h&y.h)},n.or=function(y){for(var g=Math.max(this.g.length,y.g.length),E=[],W=0;W<g;W++)E[W]=this.i(W)|y.i(W);return new u(E,this.h|y.h)},n.xor=function(y){for(var g=Math.max(this.g.length,y.g.length),E=[],W=0;W<g;W++)E[W]=this.i(W)^y.i(W);return new u(E,this.h^y.h)};function H(y){for(var g=y.g.length+1,E=[],W=0;W<g;W++)E[W]=y.i(W)<<1|y.i(W-1)>>>31;return new u(E,y.h)}function J(y,g){var E=g>>5;g%=32;for(var W=y.g.length-E,v=[],D=0;D<W;D++)v[D]=0<g?y.i(D+E)>>>g|y.i(D+E+1)<<32-g:y.i(D+E);return new u(v,y.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Md5=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=_,Integer=u}).apply(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{});var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XhrIo,WebChannel,EventType,ErrorCode,Stat,Event$1,getStatEventTarget,createWebChannelTransport;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,A,j){return c==Array.prototype||c==Object.prototype||(c[A]=j.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal=="object"&&commonjsGlobal];for(var A=0;A<c.length;++A){var j=c[A];if(j&&j.Math==Math)return j}throw Error("Cannot find global object")}var i=t(this);function o(c,A){if(A)e:{var j=i;c=c.split(".");for(var ue=0;ue<c.length-1;ue++){var Le=c[ue];if(!(Le in j))break e;j=j[Le]}c=c[c.length-1],ue=j[c],A=A(ue),A!=ue&&A!=null&&e(j,c,{configurable:!0,writable:!0,value:A})}}function a(c,A){c instanceof String&&(c+="");var j=0,ue=!1,Le={next:function(){if(!ue&&j<c.length){var Je=j++;return{value:A(Je,c[Je]),done:!1}}return ue=!0,{done:!0,value:void 0}}};return Le[Symbol.iterator]=function(){return Le},Le}o("Array.prototype.values",function(c){return c||function(){return a(this,function(A,j){return j})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},f=this||self;function d(c){var A=typeof c;return A=A!="object"?A:c?Array.isArray(c)?"array":A:"null",A=="array"||A=="object"&&typeof c.length=="number"}function p(c){var A=typeof c;return A=="object"&&c!=null||A=="function"}function _(c,A,j){return c.call.apply(c.bind,arguments)}function R(c,A,j){if(!c)throw Error();if(2<arguments.length){var ue=Array.prototype.slice.call(arguments,2);return function(){var Le=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Le,ue),c.apply(A,Le)}}return function(){return c.apply(A,arguments)}}function w(c,A,j){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:R,w.apply(null,arguments)}function V(c,A){var j=Array.prototype.slice.call(arguments,1);return function(){var ue=j.slice();return ue.push.apply(ue,arguments),c.apply(this,ue)}}function U(c,A){function j(){}j.prototype=A.prototype,c.aa=A.prototype,c.prototype=new j,c.prototype.constructor=c,c.Qb=function(ue,Le,Je){for(var qt=Array(arguments.length-2),Ln=2;Ln<arguments.length;Ln++)qt[Ln-2]=arguments[Ln];return A.prototype[Le].apply(ue,qt)}}function X(c){const A=c.length;if(0<A){const j=Array(A);for(let ue=0;ue<A;ue++)j[ue]=c[ue];return j}return[]}function b(c,A){for(let j=1;j<arguments.length;j++){const ue=arguments[j];if(d(ue)){const Le=c.length||0,Je=ue.length||0;c.length=Le+Je;for(let qt=0;qt<Je;qt++)c[Le+qt]=ue[qt]}else c.push(ue)}}class K{constructor(A,j){this.i=A,this.j=j,this.h=0,this.g=null}get(){let A;return 0<this.h?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function Z(c){return/^[\s\xa0]*$/.test(c)}function oe(){var c=f.navigator;return c&&(c=c.userAgent)?c:""}function te(c){return te[" "](c),c}te[" "]=function(){};var H=oe().indexOf("Gecko")!=-1&&!(oe().toLowerCase().indexOf("webkit")!=-1&&oe().indexOf("Edge")==-1)&&!(oe().indexOf("Trident")!=-1||oe().indexOf("MSIE")!=-1)&&oe().indexOf("Edge")==-1;function J(c,A,j){for(const ue in c)A.call(j,c[ue],ue,c)}function y(c,A){for(const j in c)A.call(void 0,c[j],j,c)}function g(c){const A={};for(const j in c)A[j]=c[j];return A}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(c,A){let j,ue;for(let Le=1;Le<arguments.length;Le++){ue=arguments[Le];for(j in ue)c[j]=ue[j];for(let Je=0;Je<E.length;Je++)j=E[Je],Object.prototype.hasOwnProperty.call(ue,j)&&(c[j]=ue[j])}}function v(c){var A=1;c=c.split(":");const j=[];for(;0<A&&c.length;)j.push(c.shift()),A--;return c.length&&j.push(c.join(":")),j}function D(c){f.setTimeout(()=>{throw c},0)}function C(){var c=ie;let A=null;return c.g&&(A=c.g,c.g=c.g.next,c.g||(c.h=null),A.next=null),A}class we{constructor(){this.h=this.g=null}add(A,j){const ue=ve.get();ue.set(A,j),this.h?this.h.next=ue:this.g=ue,this.h=ue}}var ve=new K(()=>new Re,c=>c.reset());class Re{constructor(){this.next=this.g=this.h=null}set(A,j){this.h=A,this.g=j,this.next=null}reset(){this.next=this.g=this.h=null}}let _e,ge=!1,ie=new we,fe=()=>{const c=f.Promise.resolve(void 0);_e=()=>{c.then(re)}};var re=()=>{for(var c;c=C();){try{c.h.call(c.g)}catch(j){D(j)}var A=ve;A.j(c),100>A.h&&(A.h++,c.next=A.g,A.g=c)}ge=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(c,A){this.type=c,this.g=this.target=A,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var c=!1,A=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const j=()=>{};f.addEventListener("test",j,A),f.removeEventListener("test",j,A)}catch{}return c}();function ee(c,A){if(I.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var j=this.type=c.type,ue=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=A,A=c.relatedTarget){if(H){e:{try{te(A.nodeName);var Le=!0;break e}catch{}Le=!1}Le||(A=null)}}else j=="mouseover"?A=c.fromElement:j=="mouseout"&&(A=c.toElement);this.relatedTarget=A,ue?(this.clientX=ue.clientX!==void 0?ue.clientX:ue.pageX,this.clientY=ue.clientY!==void 0?ue.clientY:ue.pageY,this.screenX=ue.screenX||0,this.screenY=ue.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:le[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&ee.aa.h.call(this)}}U(ee,I);var le={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),he=0;function Ee(c,A,j,ue,Le){this.listener=c,this.proxy=null,this.src=A,this.type=j,this.capture=!!ue,this.ha=Le,this.key=++he,this.da=this.fa=!1}function be(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Be(c){this.src=c,this.g={},this.h=0}Be.prototype.add=function(c,A,j,ue,Le){var Je=c.toString();c=this.g[Je],c||(c=this.g[Je]=[],this.h++);var qt=Ke(c,A,ue,Le);return-1<qt?(A=c[qt],j||(A.fa=!1)):(A=new Ee(A,this.src,Je,!!ue,Le),A.fa=j,c.push(A)),A};function ze(c,A){var j=A.type;if(j in c.g){var ue=c.g[j],Le=Array.prototype.indexOf.call(ue,A,void 0),Je;(Je=0<=Le)&&Array.prototype.splice.call(ue,Le,1),Je&&(be(A),c.g[j].length==0&&(delete c.g[j],c.h--))}}function Ke(c,A,j,ue){for(var Le=0;Le<c.length;++Le){var Je=c[Le];if(!Je.da&&Je.listener==A&&Je.capture==!!j&&Je.ha==ue)return Le}return-1}var Xe="closure_lm_"+(1e6*Math.random()|0),Ze={};function xe(c,A,j,ue,Le){if(Array.isArray(A)){for(var Je=0;Je<A.length;Je++)xe(c,A[Je],j,ue,Le);return null}return j=Se(j),c&&c[ce]?c.K(A,j,p(ue)?!!ue.capture:!1,Le):De(c,A,j,!1,ue,Le)}function De(c,A,j,ue,Le,Je){if(!A)throw Error("Invalid event type");var qt=p(Le)?!!Le.capture:!!Le,Ln=et(c);if(Ln||(c[Xe]=Ln=new Be(c)),j=Ln.add(A,j,ue,qt,Je),j.proxy)return j;if(ue=se(),j.proxy=ue,ue.src=c,ue.listener=j,c.addEventListener)S||(Le=qt),Le===void 0&&(Le=!1),c.addEventListener(A.toString(),ue,Le);else if(c.attachEvent)c.attachEvent(Ce(A.toString()),ue);else if(c.addListener&&c.removeListener)c.addListener(ue);else throw Error("addEventListener and attachEvent are unavailable.");return j}function se(){function c(j){return A.call(c.src,c.listener,j)}const A=$e;return c}function me(c,A,j,ue,Le){if(Array.isArray(A))for(var Je=0;Je<A.length;Je++)me(c,A[Je],j,ue,Le);else ue=p(ue)?!!ue.capture:!!ue,j=Se(j),c&&c[ce]?(c=c.i,A=String(A).toString(),A in c.g&&(Je=c.g[A],j=Ke(Je,j,ue,Le),-1<j&&(be(Je[j]),Array.prototype.splice.call(Je,j,1),Je.length==0&&(delete c.g[A],c.h--)))):c&&(c=et(c))&&(A=c.g[A.toString()],c=-1,A&&(c=Ke(A,j,ue,Le)),(j=-1<c?A[c]:null)&&Te(j))}function Te(c){if(typeof c!="number"&&c&&!c.da){var A=c.src;if(A&&A[ce])ze(A.i,c);else{var j=c.type,ue=c.proxy;A.removeEventListener?A.removeEventListener(j,ue,c.capture):A.detachEvent?A.detachEvent(Ce(j),ue):A.addListener&&A.removeListener&&A.removeListener(ue),(j=et(A))?(ze(j,c),j.h==0&&(j.src=null,A[Xe]=null)):be(c)}}}function Ce(c){return c in Ze?Ze[c]:Ze[c]="on"+c}function $e(c,A){if(c.da)c=!0;else{A=new ee(A,this);var j=c.listener,ue=c.ha||c.src;c.fa&&Te(c),c=j.call(ue,A)}return c}function et(c){return c=c[Xe],c instanceof Be?c:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(c){return typeof c=="function"?c:(c[Qe]||(c[Qe]=function(A){return c.handleEvent(A)}),c[Qe])}function rt(){Y.call(this),this.i=new Be(this),this.M=this,this.F=null}U(rt,Y),rt.prototype[ce]=!0,rt.prototype.removeEventListener=function(c,A,j,ue){me(this,c,A,j,ue)};function nt(c,A){var j,ue=c.F;if(ue)for(j=[];ue;ue=ue.F)j.push(ue);if(c=c.M,ue=A.type||A,typeof A=="string")A=new I(A,c);else if(A instanceof I)A.target=A.target||c;else{var Le=A;A=new I(ue,c),W(A,Le)}if(Le=!0,j)for(var Je=j.length-1;0<=Je;Je--){var qt=A.g=j[Je];Le=mn(qt,ue,!0,A)&&Le}if(qt=A.g=c,Le=mn(qt,ue,!0,A)&&Le,Le=mn(qt,ue,!1,A)&&Le,j)for(Je=0;Je<j.length;Je++)qt=A.g=j[Je],Le=mn(qt,ue,!1,A)&&Le}rt.prototype.N=function(){if(rt.aa.N.call(this),this.i){var c=this.i,A;for(A in c.g){for(var j=c.g[A],ue=0;ue<j.length;ue++)be(j[ue]);delete c.g[A],c.h--}}this.F=null},rt.prototype.K=function(c,A,j,ue){return this.i.add(String(c),A,!1,j,ue)},rt.prototype.L=function(c,A,j,ue){return this.i.add(String(c),A,!0,j,ue)};function mn(c,A,j,ue){if(A=c.i.g[String(A)],!A)return!0;A=A.concat();for(var Le=!0,Je=0;Je<A.length;++Je){var qt=A[Je];if(qt&&!qt.da&&qt.capture==j){var Ln=qt.listener,er=qt.ha||qt.src;qt.fa&&ze(c.i,qt),Le=Ln.call(er,ue)!==!1&&Le}}return Le&&!ue.defaultPrevented}function fn(c,A,j){if(typeof c=="function")j&&(c=w(c,j));else if(c&&typeof c.handleEvent=="function")c=w(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(A)?-1:f.setTimeout(c,A||0)}function Rn(c){c.g=fn(()=>{c.g=null,c.i&&(c.i=!1,Rn(c))},c.l);const A=c.h;c.h=null,c.m.apply(null,A)}class Ut extends Y{constructor(A,j){super(),this.m=A,this.l=j,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:Rn(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hn(c){Y.call(this),this.h=c,this.g={}}U(hn,Y);var bn=[];function kn(c){J(c.g,function(A,j){this.g.hasOwnProperty(j)&&Te(A)},c),c.g={}}hn.prototype.N=function(){hn.aa.N.call(this),kn(this)},hn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ye=f.JSON.stringify,Ve=f.JSON.parse,Ne=class{stringify(c){return f.JSON.stringify(c,void 0)}parse(c){return f.JSON.parse(c,void 0)}};function Dt(){}Dt.prototype.h=null;function In(c){return c.h||(c.h=c.i())}function Pn(){}var pe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function We(){I.call(this,"d")}U(We,I);function pt(){I.call(this,"c")}U(pt,I);var Lt={},un=null;function kt(){return un=un||new rt}Lt.La="serverreachability";function de(c){I.call(this,Lt.La,c)}U(de,I);function ae(c){const A=kt();nt(A,new de(A))}Lt.STAT_EVENT="statevent";function Ae(c,A){I.call(this,Lt.STAT_EVENT,c),this.stat=A}U(Ae,I);function Me(c){const A=kt();nt(A,new Ae(A,c))}Lt.Ma="timingevent";function Ue(c,A){I.call(this,Lt.Ma,c),this.size=A}U(Ue,I);function qe(c,A){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){c()},A)}function tt(){this.g=!0}tt.prototype.xa=function(){this.g=!1};function Wt(c,A,j,ue,Le,Je){c.info(function(){if(c.g)if(Je)for(var qt="",Ln=Je.split("&"),er=0;er<Ln.length;er++){var Mn=Ln[er].split("=");if(1<Mn.length){var rr=Mn[0];Mn=Mn[1];var Jn=rr.split("_");qt=2<=Jn.length&&Jn[1]=="type"?qt+(rr+"="+Mn+"&"):qt+(rr+"=redacted&")}}else qt=null;else qt=Je;return"XMLHTTP REQ ("+ue+") [attempt "+Le+"]: "+A+`
`+j+`
`+qt})}function Bt(c,A,j,ue,Le,Je,qt){c.info(function(){return"XMLHTTP RESP ("+ue+") [ attempt "+Le+"]: "+A+`
`+j+`
`+Je+" "+qt})}function Et(c,A,j,ue){c.info(function(){return"XMLHTTP TEXT ("+A+"): "+Gt(c,j)+(ue?" "+ue:"")})}function An(c,A){c.info(function(){return"TIMEOUT: "+A})}tt.prototype.info=function(){};function Gt(c,A){if(!c.g)return A;if(!A)return null;try{var j=JSON.parse(A);if(j){for(c=0;c<j.length;c++)if(Array.isArray(j[c])){var ue=j[c];if(!(2>ue.length)){var Le=ue[1];if(Array.isArray(Le)&&!(1>Le.length)){var Je=Le[0];if(Je!="noop"&&Je!="stop"&&Je!="close")for(var qt=1;qt<Le.length;qt++)Le[qt]=""}}}}return Ye(j)}catch{return A}}var Kt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},vn;function xn(){}U(xn,Dt),xn.prototype.g=function(){return new XMLHttpRequest},xn.prototype.i=function(){return{}},vn=new xn;function Dn(c,A,j,ue){this.j=c,this.i=A,this.l=j,this.R=ue||1,this.U=new hn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gn}function Gn(){this.i=null,this.g="",this.h=!1}var On={},hr={};function _r(c,A,j){c.L=1,c.v=xi(xr(A)),c.m=j,c.P=!0,Ar(c,null)}function Ar(c,A){c.F=Date.now(),Bn(c),c.A=xr(c.v);var j=c.A,ue=c.R;Array.isArray(ue)||(ue=[String(ue)]),Di(j.i,"t",ue),c.C=0,j=c.j.J,c.h=new Gn,c.g=ia(c.j,j?A:null,!c.m),0<c.O&&(c.M=new Ut(w(c.Y,c,c.g),c.O)),A=c.U,j=c.g,ue=c.ca;var Le="readystatechange";Array.isArray(Le)||(Le&&(bn[0]=Le.toString()),Le=bn);for(var Je=0;Je<Le.length;Je++){var qt=xe(j,Le[Je],ue||A.handleEvent,!1,A.h||A);if(!qt)break;A.g[qt.key]=qt}A=c.H?g(c.H):{},c.m?(c.u||(c.u="POST"),A["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,A)):(c.u="GET",c.g.ea(c.A,c.u,null,A)),ae(),Wt(c.i,c.u,c.A,c.l,c.R,c.m)}Dn.prototype.ca=function(c){c=c.target;const A=this.M;A&&Pr(c)==3?A.j():this.Y(c)},Dn.prototype.Y=function(c){try{if(c==this.g)e:{const Jn=Pr(this.g);var A=this.g.Ba();const Lr=this.g.Z();if(!(3>Jn)&&(Jn!=3||this.g&&(this.h.h||this.g.oa()||oo(this.g)))){this.J||Jn!=4||A==7||(A==8||0>=Lr?ae(3):ae(2)),Yi(this);var j=this.g.Z();this.X=j;t:if(Xi(this)){var ue=oo(this.g);c="";var Le=ue.length,Je=Pr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),Si(this);var qt="";break t}this.h.i=new f.TextDecoder}for(A=0;A<Le;A++)this.h.h=!0,c+=this.h.i.decode(ue[A],{stream:!(Je&&A==Le-1)});ue.length=0,this.h.g+=c,this.C=0,qt=this.h.g}else qt=this.g.oa();if(this.o=j==200,Bt(this.i,this.u,this.A,this.l,this.R,Jn,j),this.o){if(this.T&&!this.K){t:{if(this.g){var Ln,er=this.g;if((Ln=er.g?er.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Z(Ln)){var Mn=Ln;break t}}Mn=null}if(j=Mn)Et(this.i,this.l,j,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,to(this,j);else{this.o=!1,this.s=3,Me(12),Fr(this),Si(this);break e}}if(this.P){j=!0;let Dr;for(;!this.J&&this.C<qt.length;)if(Dr=fl(this,qt),Dr==hr){Jn==4&&(this.s=4,Me(14),j=!1),Et(this.i,this.l,null,"[Incomplete Response]");break}else if(Dr==On){this.s=4,Me(15),Et(this.i,this.l,qt,"[Invalid Chunk]"),j=!1;break}else Et(this.i,this.l,Dr,null),to(this,Dr);if(Xi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jn!=4||qt.length!=0||this.h.h||(this.s=1,Me(16),j=!1),this.o=this.o&&j,!j)Et(this.i,this.l,qt,"[Invalid Chunked Response]"),Fr(this),Si(this);else if(0<qt.length&&!this.W){this.W=!0;var rr=this.j;rr.g==this&&rr.ba&&!rr.M&&(rr.j.info("Great, no buffering proxy detected. Bytes received: "+qt.length),lo(rr),rr.M=!0,Me(11))}}else Et(this.i,this.l,qt,null),to(this,qt);Jn==4&&Fr(this),this.o&&!this.J&&(Jn==4?ws(this.j,this):(this.o=!1,Bn(this)))}else Ts(this.g),j==400&&0<qt.indexOf("Unknown SID")?(this.s=3,Me(12)):(this.s=0,Me(13)),Fr(this),Si(this)}}}catch{}finally{}};function Xi(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function fl(c,A){var j=c.C,ue=A.indexOf(`
`,j);return ue==-1?hr:(j=Number(A.substring(j,ue)),isNaN(j)?On:(ue+=1,ue+j>A.length?hr:(A=A.slice(ue,ue+j),c.C=ue+j,A)))}Dn.prototype.cancel=function(){this.J=!0,Fr(this)};function Bn(c){c.S=Date.now()+c.I,zo(c,c.I)}function zo(c,A){if(c.B!=null)throw Error("WatchDog timer not null");c.B=qe(w(c.ba,c),A)}function Yi(c){c.B&&(f.clearTimeout(c.B),c.B=null)}Dn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(An(this.i,this.A),this.L!=2&&(ae(),Me(17)),Fr(this),this.s=2,Si(this)):zo(this,this.S-c)};function Si(c){c.j.G==0||c.J||ws(c.j,c)}function Fr(c){Yi(c);var A=c.M;A&&typeof A.ma=="function"&&A.ma(),c.M=null,kn(c.U),c.g&&(A=c.g,c.g=null,A.abort(),A.ma())}function to(c,A){try{var j=c.j;if(j.G!=0&&(j.g==c||gr(j.h,c))){if(!c.K&&gr(j.h,c)&&j.G==3){try{var ue=j.Da.g.parse(A)}catch{ue=null}if(Array.isArray(ue)&&ue.length==3){var Le=ue;if(Le[0]==0){e:if(!j.u){if(j.g)if(j.g.F+3e3<c.F)Ss(j),Yr(j);else break e;Is(j),Me(18)}}else j.za=Le[1],0<j.za-j.T&&37500>Le[2]&&j.F&&j.v==0&&!j.C&&(j.C=qe(w(j.Za,j),6e3));if(1>=$o(j.h)&&j.ca){try{j.ca()}catch{}j.ca=void 0}}else _i(j,11)}else if((c.K||j.g==c)&&Ss(j),!Z(A))for(Le=j.Da.g.parse(A),A=0;A<Le.length;A++){let Mn=Le[A];if(j.T=Mn[0],Mn=Mn[1],j.G==2)if(Mn[0]=="c"){j.K=Mn[1],j.ia=Mn[2];const rr=Mn[3];rr!=null&&(j.la=rr,j.j.info("VER="+j.la));const Jn=Mn[4];Jn!=null&&(j.Aa=Jn,j.j.info("SVER="+j.Aa));const Lr=Mn[5];Lr!=null&&typeof Lr=="number"&&0<Lr&&(ue=1.5*Lr,j.L=ue,j.j.info("backChannelRequestTimeoutMs_="+ue)),ue=j;const Dr=c.g;if(Dr){const rs=Dr.g?Dr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rs){var Je=ue.h;Je.g||rs.indexOf("spdy")==-1&&rs.indexOf("quic")==-1&&rs.indexOf("h2")==-1||(Je.j=Je.l,Je.g=new Set,Je.h&&(no(Je,Je.h),Je.h=null))}if(ue.D){const Cs=Dr.g?Dr.g.getResponseHeader("X-HTTP-Session-Id"):null;Cs&&(ue.ya=Cs,jn(ue.I,ue.D,Cs))}}j.G=3,j.l&&j.l.ua(),j.ba&&(j.R=Date.now()-c.F,j.j.info("Handshake RTT: "+j.R+"ms")),ue=j;var qt=c;if(ue.qa=ra(ue,ue.J?ue.ia:null,ue.W),qt.K){Ho(ue.h,qt);var Ln=qt,er=ue.L;er&&(Ln.I=er),Ln.B&&(Yi(Ln),Bn(Ln)),ue.g=qt}else ns(ue);0<j.i.length&&oi(j)}else Mn[0]!="stop"&&Mn[0]!="close"||_i(j,7);else j.G==3&&(Mn[0]=="stop"||Mn[0]=="close"?Mn[0]=="stop"?_i(j,7):lr(j):Mn[0]!="noop"&&j.l&&j.l.ta(Mn),j.v=0)}}ae(4)}catch{}}var Wo=class{constructor(c,A){this.g=c,this.map=A}};function Qi(c){this.l=c||10,f.PerformanceNavigationTiming?(c=f.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Cr(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function $o(c){return c.h?1:c.g?c.g.size:0}function gr(c,A){return c.h?c.h==A:c.g?c.g.has(A):!1}function no(c,A){c.g?c.g.add(A):c.h=A}function Ho(c,A){c.h&&c.h==A?c.h=null:c.g&&c.g.has(A)&&c.g.delete(A)}Qi.prototype.cancel=function(){if(this.i=qo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function qo(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let A=c.i;for(const j of c.g.values())A=A.concat(j.D);return A}return X(c.i)}function gs(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(d(c)){for(var A=[],j=c.length,ue=0;ue<j;ue++)A.push(c[ue]);return A}A=[],j=0;for(ue in c)A[j++]=c[ue];return A}function ys(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(d(c)||typeof c=="string"){var A=[];c=c.length;for(var j=0;j<c;j++)A.push(j);return A}A=[],j=0;for(const ue in c)A[j++]=ue;return A}}}function wi(c,A){if(c.forEach&&typeof c.forEach=="function")c.forEach(A,void 0);else if(d(c)||typeof c=="string")Array.prototype.forEach.call(c,A,void 0);else for(var j=ys(c),ue=gs(c),Le=ue.length,Je=0;Je<Le;Je++)A.call(void 0,ue[Je],j&&j[Je],c)}var Ji=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pl(c,A){if(c){c=c.split("&");for(var j=0;j<c.length;j++){var ue=c[j].indexOf("="),Le=null;if(0<=ue){var Je=c[j].substring(0,ue);Le=c[j].substring(ue+1)}else Je=c[j];A(Je,Le?decodeURIComponent(Le.replace(/\+/g," ")):"")}}}function di(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof di){this.h=c.h,Zi(this,c.j),this.o=c.o,this.g=c.g,bi(this,c.s),this.l=c.l;var A=c.i,j=new ri;j.i=A.i,A.g&&(j.g=new Map(A.g),j.h=A.h),Ci(this,j),this.m=c.m}else c&&(A=String(c).match(Ji))?(this.h=!1,Zi(this,A[1]||"",!0),this.o=Vn(A[2]||""),this.g=Vn(A[3]||"",!0),bi(this,A[4]),this.l=Vn(A[5]||"",!0),Ci(this,A[6]||"",!0),this.m=Vn(A[7]||"")):(this.h=!1,this.i=new ri(null,this.h))}di.prototype.toString=function(){var c=[],A=this.j;A&&c.push(ki(A,Es,!0),":");var j=this.g;return(j||A=="file")&&(c.push("//"),(A=this.o)&&c.push(ki(A,Es,!0),"@"),c.push(encodeURIComponent(String(j)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),j=this.s,j!=null&&c.push(":",String(j))),(j=this.l)&&(this.g&&j.charAt(0)!="/"&&c.push("/"),c.push(ki(j,j.charAt(0)=="/"?Xo:Ko,!0))),(j=this.i.toString())&&c.push("?",j),(j=this.m)&&c.push("#",ki(j,ro)),c.join("")};function xr(c){return new di(c)}function Zi(c,A,j){c.j=j?Vn(A,!0):A,c.j&&(c.j=c.j.replace(/:$/,""))}function bi(c,A){if(A){if(A=Number(A),isNaN(A)||0>A)throw Error("Bad port number "+A);c.s=A}else c.s=null}function Ci(c,A,j){A instanceof ri?(c.i=A,ii(c.i,c.h)):(j||(A=ki(A,Yo)),c.i=new ri(A,c.h))}function jn(c,A,j){c.i.set(A,j)}function xi(c){return jn(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Vn(c,A){return c?A?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function ki(c,A,j){return typeof c=="string"?(c=encodeURI(c).replace(A,Go),j&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Go(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Es=/[#\/\?@]/g,Ko=/[#\?:]/g,Xo=/[#\?]/g,Yo=/[#\?@]/g,ro=/#/g;function ri(c,A){this.h=this.g=null,this.i=c||null,this.j=!!A}function ar(c){c.g||(c.g=new Map,c.h=0,c.i&&pl(c.i,function(A,j){c.add(decodeURIComponent(A.replace(/\+/g," ")),j)}))}n=ri.prototype,n.add=function(c,A){ar(this),this.i=null,c=Or(this,c);var j=this.g.get(c);return j||this.g.set(c,j=[]),j.push(A),this.h+=1,this};function qr(c,A){ar(c),A=Or(c,A),c.g.has(A)&&(c.i=null,c.h-=c.g.get(A).length,c.g.delete(A))}function Gr(c,A){return ar(c),A=Or(c,A),c.g.has(A)}n.forEach=function(c,A){ar(this),this.g.forEach(function(j,ue){j.forEach(function(Le){c.call(A,Le,ue,this)},this)},this)},n.na=function(){ar(this);const c=Array.from(this.g.values()),A=Array.from(this.g.keys()),j=[];for(let ue=0;ue<A.length;ue++){const Le=c[ue];for(let Je=0;Je<Le.length;Je++)j.push(A[ue])}return j},n.V=function(c){ar(this);let A=[];if(typeof c=="string")Gr(this,c)&&(A=A.concat(this.g.get(Or(this,c))));else{c=Array.from(this.g.values());for(let j=0;j<c.length;j++)A=A.concat(c[j])}return A},n.set=function(c,A){return ar(this),this.i=null,c=Or(this,c),Gr(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[A]),this.h+=1,this},n.get=function(c,A){return c?(c=this.V(c),0<c.length?String(c[0]):A):A};function Di(c,A,j){qr(c,A),0<j.length&&(c.i=null,c.g.set(Or(c,A),X(j)),c.h+=j.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],A=Array.from(this.g.keys());for(var j=0;j<A.length;j++){var ue=A[j];const Je=encodeURIComponent(String(ue)),qt=this.V(ue);for(ue=0;ue<qt.length;ue++){var Le=Je;qt[ue]!==""&&(Le+="="+encodeURIComponent(String(qt[ue]))),c.push(Le)}}return this.i=c.join("&")};function Or(c,A){return A=String(A),c.j&&(A=A.toLowerCase()),A}function ii(c,A){A&&!c.j&&(ar(c),c.i=null,c.g.forEach(function(j,ue){var Le=ue.toLowerCase();ue!=Le&&(qr(this,ue),Di(this,Le,j))},c)),c.j=A}function ml(c,A){const j=new tt;if(f.Image){const ue=new Image;ue.onload=V(Tr,j,"TestLoadImage: loaded",!0,A,ue),ue.onerror=V(Tr,j,"TestLoadImage: error",!1,A,ue),ue.onabort=V(Tr,j,"TestLoadImage: abort",!1,A,ue),ue.ontimeout=V(Tr,j,"TestLoadImage: timeout",!1,A,ue),f.setTimeout(function(){ue.ontimeout&&ue.ontimeout()},1e4),ue.src=c}else A(!1)}function Qo(c,A){const j=new tt,ue=new AbortController,Le=setTimeout(()=>{ue.abort(),Tr(j,"TestPingServer: timeout",!1,A)},1e4);fetch(c,{signal:ue.signal}).then(Je=>{clearTimeout(Le),Je.ok?Tr(j,"TestPingServer: ok",!0,A):Tr(j,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(Le),Tr(j,"TestPingServer: error",!1,A)})}function Tr(c,A,j,ue,Le){try{Le&&(Le.onload=null,Le.onerror=null,Le.onabort=null,Le.ontimeout=null),ue(j)}catch{}}function _l(){this.g=new Ne}function Jo(c,A,j){const ue=j||"";try{wi(c,function(Le,Je){let qt=Le;p(Le)&&(qt=Ye(Le)),A.push(ue+Je+"="+encodeURIComponent(qt))})}catch(Le){throw A.push(ue+"type="+encodeURIComponent("_badmap")),Le}}function fi(c){this.l=c.Ub||null,this.j=c.eb||!1}U(fi,Dt),fi.prototype.g=function(){return new es(this.l,this.j)},fi.prototype.i=function(c){return function(){return c}}({});function es(c,A){rt.call(this),this.D=c,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}U(es,rt),n=es.prototype,n.open=function(c,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=A,this.readyState=1,Xr(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const A={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(A.body=c),(this.D||f).fetch(new Request(this.A,A)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Xr(this)),this.g&&(this.readyState=3,Xr(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Zo(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Zo(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var A=c.value?c.value:new Uint8Array(0);(A=this.v.decode(A,{stream:!c.done}))&&(this.response=this.responseText+=A)}c.done?Kr(this):Xr(this),this.readyState==3&&Zo(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Kr(this))},n.Qa=function(c){this.g&&(this.response=c,Kr(this))},n.ga=function(){this.g&&Kr(this)};function Kr(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Xr(c)}n.setRequestHeader=function(c,A){this.u.append(c,A)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],A=this.h.entries();for(var j=A.next();!j.done;)j=j.value,c.push(j[0]+": "+j[1]),j=A.next();return c.join(`\r
`)};function Xr(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(es.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function pi(c){let A="";return J(c,function(j,ue){A+=ue,A+=":",A+=j,A+=`\r
`}),A}function Vi(c,A,j){e:{for(ue in j){var ue=!1;break e}ue=!0}ue||(j=pi(j),typeof c=="string"?j!=null&&encodeURIComponent(String(j)):jn(c,A,j))}function Hn(c){rt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}U(Hn,rt);var gl=/^https?$/i,io=["POST","PUT"];n=Hn.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,A,j,ue){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);A=A?A.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():vn.g(),this.v=this.o?In(this.o):In(vn),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(A,String(c),!0),this.B=!1}catch(Je){ts(this,Je);return}if(c=j||"",j=new Map(this.headers),ue)if(Object.getPrototypeOf(ue)===Object.prototype)for(var Le in ue)j.set(Le,ue[Le]);else if(typeof ue.keys=="function"&&typeof ue.get=="function")for(const Je of ue.keys())j.set(Je,ue.get(Je));else throw Error("Unknown input type for opt_headers: "+String(ue));ue=Array.from(j.keys()).find(Je=>Je.toLowerCase()=="content-type"),Le=f.FormData&&c instanceof f.FormData,!(0<=Array.prototype.indexOf.call(io,A,void 0))||ue||Le||j.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Je,qt]of j)this.g.setRequestHeader(Je,qt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{As(this),this.u=!0,this.g.send(c),this.u=!1}catch(Je){ts(this,Je)}};function ts(c,A){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=A,c.m=5,vs(c),kr(c)}function vs(c){c.A||(c.A=!0,nt(c,"complete"),nt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,nt(this,"complete"),nt(this,"abort"),kr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),kr(this,!0)),Hn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?so(this):this.bb())},n.bb=function(){so(this)};function so(c){if(c.h&&typeof u<"u"&&(!c.v[1]||Pr(c)!=4||c.Z()!=2)){if(c.u&&Pr(c)==4)fn(c.Ea,0,c);else if(nt(c,"readystatechange"),Pr(c)==4){c.h=!1;try{const qt=c.Z();e:switch(qt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var j;if(!(j=A)){var ue;if(ue=qt===0){var Le=String(c.D).match(Ji)[1]||null;!Le&&f.self&&f.self.location&&(Le=f.self.location.protocol.slice(0,-1)),ue=!gl.test(Le?Le.toLowerCase():"")}j=ue}if(j)nt(c,"complete"),nt(c,"success");else{c.m=6;try{var Je=2<Pr(c)?c.g.statusText:""}catch{Je=""}c.l=Je+" ["+c.Z()+"]",vs(c)}}finally{kr(c)}}}}function kr(c,A){if(c.g){As(c);const j=c.g,ue=c.v[0]?()=>{}:null;c.g=null,c.v=null,A||nt(c,"ready");try{j.onreadystatechange=ue}catch{}}}function As(c){c.I&&(f.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Pr(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Pr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var A=this.g.responseText;return c&&A.indexOf(c)==0&&(A=A.substring(c.length)),Ve(A)}};function oo(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Ts(c){const A={};c=(c.g&&2<=Pr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let ue=0;ue<c.length;ue++){if(Z(c[ue]))continue;var j=v(c[ue]);const Le=j[0];if(j=j[1],typeof j!="string")continue;j=j.trim();const Je=A[Le]||[];A[Le]=Je,Je.push(j)}y(A,function(ue){return ue.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function si(c,A,j){return j&&j.internalChannelParams&&j.internalChannelParams[c]||A}function ao(c){this.Aa=0,this.i=[],this.j=new tt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=si("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=si("baseRetryDelayMs",5e3,c),this.cb=si("retryDelaySeedMs",1e4,c),this.Wa=si("forwardChannelMaxRetries",2,c),this.wa=si("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Qi(c&&c.concurrentRequestLimit),this.Da=new _l,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ao.prototype,n.la=8,n.G=1,n.connect=function(c,A,j,ue){Me(0),this.W=c,this.H=A||{},j&&ue!==void 0&&(this.H.OSID=j,this.H.OAID=ue),this.F=this.X,this.I=ra(this,null,this.W),oi(this)};function lr(c){if(Ps(c),c.G==3){var A=c.U++,j=xr(c.I);if(jn(j,"SID",c.K),jn(j,"RID",A),jn(j,"TYPE","terminate"),mi(c,j),A=new Dn(c,c.j,A),A.L=2,A.v=xi(xr(j)),j=!1,f.navigator&&f.navigator.sendBeacon)try{j=f.navigator.sendBeacon(A.v.toString(),"")}catch{}!j&&f.Image&&(new Image().src=A.v,j=!0),j||(A.g=ia(A.j,null),A.g.ea(A.v)),A.F=Date.now(),Bn(A)}na(c)}function Yr(c){c.g&&(lo(c),c.g.cancel(),c.g=null)}function Ps(c){Yr(c),c.u&&(f.clearTimeout(c.u),c.u=null),Ss(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&f.clearTimeout(c.s),c.s=null)}function oi(c){if(!Cr(c.h)&&!c.s){c.s=!0;var A=c.Ga;_e||fe(),ge||(_e(),ge=!0),ie.add(A,c),c.B=0}}function yl(c,A){return $o(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=A.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=qe(w(c.Ga,c,A),ta(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const Le=new Dn(this,this.j,c);let Je=this.o;if(this.S&&(Je?(Je=g(Je),W(Je,this.S)):Je=this.S),this.m!==null||this.O||(Le.H=Je,Je=null),this.P)e:{for(var A=0,j=0;j<this.i.length;j++){t:{var ue=this.i[j];if("__data__"in ue.map&&(ue=ue.map.__data__,typeof ue=="string")){ue=ue.length;break t}ue=void 0}if(ue===void 0)break;if(A+=ue,4096<A){A=j;break e}if(A===4096||j===this.i.length-1){A=j+1;break e}}A=1e3}else A=1e3;A=Mi(this,Le,A),j=xr(this.I),jn(j,"RID",c),jn(j,"CVER",22),this.D&&jn(j,"X-HTTP-Session-Id",this.D),mi(this,j),Je&&(this.O?A="headers="+encodeURIComponent(String(pi(Je)))+"&"+A:this.m&&Vi(j,this.m,Je)),no(this.h,Le),this.Ua&&jn(j,"TYPE","init"),this.P?(jn(j,"$req",A),jn(j,"SID","null"),Le.T=!0,_r(Le,j,null)):_r(Le,j,A),this.G=2}}else this.G==3&&(c?Rs(this,c):this.i.length==0||Cr(this.h)||Rs(this))};function Rs(c,A){var j;A?j=A.l:j=c.U++;const ue=xr(c.I);jn(ue,"SID",c.K),jn(ue,"RID",j),jn(ue,"AID",c.T),mi(c,ue),c.m&&c.o&&Vi(ue,c.m,c.o),j=new Dn(c,c.j,j,c.B+1),c.m===null&&(j.H=c.o),A&&(c.i=A.D.concat(c.i)),A=Mi(c,j,1e3),j.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),no(c.h,j),_r(j,ue,A)}function mi(c,A){c.H&&J(c.H,function(j,ue){jn(A,ue,j)}),c.l&&wi({},function(j,ue){jn(A,ue,j)})}function Mi(c,A,j){j=Math.min(c.i.length,j);var ue=c.l?w(c.l.Na,c.l,c):null;e:{var Le=c.i;let Je=-1;for(;;){const qt=["count="+j];Je==-1?0<j?(Je=Le[0].g,qt.push("ofs="+Je)):Je=0:qt.push("ofs="+Je);let Ln=!0;for(let er=0;er<j;er++){let Mn=Le[er].g;const rr=Le[er].map;if(Mn-=Je,0>Mn)Je=Math.max(0,Le[er].g-100),Ln=!1;else try{Jo(rr,qt,"req"+Mn+"_")}catch{ue&&ue(rr)}}if(Ln){ue=qt.join("&");break e}}}return c=c.i.splice(0,j),A.D=c,ue}function ns(c){if(!c.g&&!c.u){c.Y=1;var A=c.Fa;_e||fe(),ge||(_e(),ge=!0),ie.add(A,c),c.v=0}}function Is(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=qe(w(c.Fa,c),ta(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,ea(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=qe(w(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Me(10),Yr(this),ea(this))};function lo(c){c.A!=null&&(f.clearTimeout(c.A),c.A=null)}function ea(c){c.g=new Dn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var A=xr(c.qa);jn(A,"RID","rpc"),jn(A,"SID",c.K),jn(A,"AID",c.T),jn(A,"CI",c.F?"0":"1"),!c.F&&c.ja&&jn(A,"TO",c.ja),jn(A,"TYPE","xmlhttp"),mi(c,A),c.m&&c.o&&Vi(A,c.m,c.o),c.L&&(c.g.I=c.L);var j=c.g;c=c.ia,j.L=1,j.v=xi(xr(A)),j.m=null,j.P=!0,Ar(j,c)}n.Za=function(){this.C!=null&&(this.C=null,Yr(this),Is(this),Me(19))};function Ss(c){c.C!=null&&(f.clearTimeout(c.C),c.C=null)}function ws(c,A){var j=null;if(c.g==A){Ss(c),lo(c),c.g=null;var ue=2}else if(gr(c.h,A))j=A.D,Ho(c.h,A),ue=1;else return;if(c.G!=0){if(A.o)if(ue==1){j=A.m?A.m.length:0,A=Date.now()-A.F;var Le=c.B;ue=kt(),nt(ue,new Ue(ue,j)),oi(c)}else ns(c);else if(Le=A.s,Le==3||Le==0&&0<A.X||!(ue==1&&yl(c,A)||ue==2&&Is(c)))switch(j&&0<j.length&&(A=c.h,A.i=A.i.concat(j)),Le){case 1:_i(c,5);break;case 4:_i(c,10);break;case 3:_i(c,6);break;default:_i(c,2)}}}function ta(c,A){let j=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(j*=2),j*A}function _i(c,A){if(c.j.info("Error code "+A),A==2){var j=w(c.fb,c),ue=c.Xa;const Le=!ue;ue=new di(ue||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Zi(ue,"https"),xi(ue),Le?ml(ue.toString(),j):Qo(ue.toString(),j)}else Me(2);c.G=0,c.l&&c.l.sa(A),na(c),Ps(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Me(2)):(this.j.info("Failed to ping google.com"),Me(1))};function na(c){if(c.G=0,c.ka=[],c.l){const A=qo(c.h);(A.length!=0||c.i.length!=0)&&(b(c.ka,A),b(c.ka,c.i),c.h.i.length=0,X(c.i),c.i.length=0),c.l.ra()}}function ra(c,A,j){var ue=j instanceof di?xr(j):new di(j);if(ue.g!="")A&&(ue.g=A+"."+ue.g),bi(ue,ue.s);else{var Le=f.location;ue=Le.protocol,A=A?A+"."+Le.hostname:Le.hostname,Le=+Le.port;var Je=new di(null);ue&&Zi(Je,ue),A&&(Je.g=A),Le&&bi(Je,Le),j&&(Je.l=j),ue=Je}return j=c.D,A=c.ya,j&&A&&jn(ue,j,A),jn(ue,"VER",c.la),mi(c,ue),ue}function ia(c,A,j){if(A&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return A=c.Ca&&!c.pa?new Hn(new fi({eb:j})):new Hn(c.pa),A.Ha(c.J),A}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function uo(){}n=uo.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function bs(){}bs.prototype.g=function(c,A){return new yr(c,A)};function yr(c,A){rt.call(this),this.g=new ao(A),this.l=c,this.h=A&&A.messageUrlParams||null,c=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(c?c["X-WebChannel-Content-Type"]=A.messageContentType:c={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.va&&(c?c["X-WebChannel-Client-Profile"]=A.va:c={"X-WebChannel-Client-Profile":A.va}),this.g.S=c,(c=A&&A.Sb)&&!Z(c)&&(this.g.m=c),this.v=A&&A.supportsCrossDomainXhr||!1,this.u=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!Z(A)&&(this.g.D=A,c=this.h,c!==null&&A in c&&(c=this.h,A in c&&delete c[A])),this.j=new ai(this)}U(yr,rt),yr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yr.prototype.close=function(){lr(this.g)},yr.prototype.o=function(c){var A=this.g;if(typeof c=="string"){var j={};j.__data__=c,c=j}else this.u&&(j={},j.__data__=Ye(c),c=j);A.i.push(new Wo(A.Ya++,c)),A.G==3&&oi(A)},yr.prototype.N=function(){this.g.l=null,delete this.j,lr(this.g),delete this.g,yr.aa.N.call(this)};function sa(c){We.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var A=c.__sm__;if(A){e:{for(const j in A){c=j;break e}c=void 0}(this.i=c)&&(c=this.i,A=A!==null&&c in A?A[c]:void 0),this.data=A}else this.data=c}U(sa,We);function oa(){pt.call(this),this.status=1}U(oa,pt);function ai(c){this.g=c}U(ai,uo),ai.prototype.ua=function(){nt(this.g,"a")},ai.prototype.ta=function(c){nt(this.g,new sa(c))},ai.prototype.sa=function(c){nt(this.g,new oa)},ai.prototype.ra=function(){nt(this.g,"b")},bs.prototype.createWebChannel=bs.prototype.g,yr.prototype.send=yr.prototype.o,yr.prototype.open=yr.prototype.m,yr.prototype.close=yr.prototype.close,createWebChannelTransport=function(){return new bs},getStatEventTarget=function(){return kt()},Event$1=Lt,Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kt.NO_ERROR=0,Kt.TIMEOUT=8,Kt.HTTP_ERROR=6,ErrorCode=Kt,gn.COMPLETE="complete",EventType=gn,Pn.EventType=pe,pe.OPEN="a",pe.CLOSE="b",pe.ERROR="c",pe.MESSAGE="d",rt.prototype.listen=rt.prototype.K,WebChannel=Pn,Hn.prototype.listenOnce=Hn.prototype.L,Hn.prototype.getLastError=Hn.prototype.Ka,Hn.prototype.getLastErrorCode=Hn.prototype.Ba,Hn.prototype.getStatus=Hn.prototype.Z,Hn.prototype.getResponseJson=Hn.prototype.Oa,Hn.prototype.getResponseText=Hn.prototype.oa,Hn.prototype.send=Hn.prototype.ea,Hn.prototype.setWithCredentials=Hn.prototype.Ha,XhrIo=Hn}).apply(typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{});const F="@firebase/firestore",M="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let x="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=new Logger("@firebase/firestore");function __PRIVATE_getLogLevel(){return O.logLevel}function __PRIVATE_logDebug(n,...e){if(O.logLevel<=LogLevel.DEBUG){const t=e.map(__PRIVATE_argToString);O.debug(`Firestore (${x}): ${n}`,...t)}}function __PRIVATE_logError(n,...e){if(O.logLevel<=LogLevel.ERROR){const t=e.map(__PRIVATE_argToString);O.error(`Firestore (${x}): ${n}`,...t)}}function __PRIVATE_logWarn(n,...e){if(O.logLevel<=LogLevel.WARN){const t=e.map(__PRIVATE_argToString);O.warn(`Firestore (${x}): ${n}`,...t)}}function __PRIVATE_argToString(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fail(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,__PRIVATE__fail(n,i,t)}function __PRIVATE__fail(n,e,t){let i=`FIRESTORE (${x}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw __PRIVATE_logError(i),new Error(i)}function __PRIVATE_hardAssert(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||__PRIVATE__fail(e,o,i)}function __PRIVATE_debugCast(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class FirestoreError extends FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Deferred{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_OAuthToken{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(User.UNAUTHENTICATED))}shutdown(){}}class __PRIVATE_EmulatorAuthCredentialsProvider{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class __PRIVATE_FirebaseAuthCredentialsProvider{constructor(e){this.t=e,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){__PRIVATE_hardAssert(this.o===void 0,42304);let i=this.i;const o=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve();let a=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new __PRIVATE_Deferred,e.enqueueRetryable(()=>o(this.currentUser))};const u=()=>{const d=a;e.enqueueRetryable(async()=>{await d.promise,await o(this.currentUser)})},f=d=>{__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(d=>f(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?f(d):(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new __PRIVATE_Deferred)}},0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(__PRIVATE_hardAssert(typeof i.accessToken=="string",31837,{l:i}),new __PRIVATE_OAuthToken(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert(e===null||typeof e=="string",2055,{h:e}),new User(e)}}class __PRIVATE_FirstPartyToken{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=User.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AppCheckToken{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __PRIVATE_FirebaseAppCheckTokenProvider{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){__PRIVATE_hardAssert(this.o===void 0,3512);const i=a=>{a.error!=null&&__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const u=a.token!==this.m;return this.m=a.token,__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>i(a))};const o=a=>{__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>o(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?o(a):__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AppCheckToken(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(__PRIVATE_hardAssert(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new AppCheckToken(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_randomBytes(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newTextEncoder(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AutoId{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=__PRIVATE_randomBytes(40);for(let a=0;a<o.length;++a)i.length<20&&o[a]<t&&(i+=e.charAt(o[a]%62))}return i}}function __PRIVATE_primitiveComparator(n,e){return n<e?-1:n>e?1:0}function __PRIVATE_compareUtf8Strings(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=n.codePointAt(t),o=e.codePointAt(t);if(i!==o){if(i<128&&o<128)return __PRIVATE_primitiveComparator(i,o);{const a=__PRIVATE_newTextEncoder(),u=__PRIVATE_compareByteArrays$1(a.encode(__PRIVATE_getUtf8SafeSubstring(n,t)),a.encode(__PRIVATE_getUtf8SafeSubstring(e,t)));return u!==0?u:__PRIVATE_primitiveComparator(i,o)}}t+=i>65535?2:1}return __PRIVATE_primitiveComparator(n.length,e.length)}function __PRIVATE_getUtf8SafeSubstring(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function __PRIVATE_compareByteArrays$1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return __PRIVATE_primitiveComparator(n[t],e[t]);return __PRIVATE_primitiveComparator(n.length,e.length)}function __PRIVATE_arrayEquals(n,e,t){return n.length===e.length&&n.every((i,o)=>t(i,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B=-62135596800,L=1e6;class Timestamp{static now(){return Timestamp.fromMillis(Date.now())}static fromDate(e){return Timestamp.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*L);return new Timestamp(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<B)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/L}_compareTo(e){return this.seconds===e.seconds?__PRIVATE_primitiveComparator(this.nanoseconds,e.nanoseconds):__PRIVATE_primitiveComparator(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-B;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotVersion{static fromTimestamp(e){return new SnapshotVersion(e)}static min(){return new SnapshotVersion(new Timestamp(0,0))}static max(){return new SnapshotVersion(new Timestamp(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k="__name__";class BasePath{constructor(e,t,i){t===void 0?t=0:t>e.length&&fail(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&fail(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return BasePath.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof BasePath?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const a=BasePath.compareSegments(e.get(o),t.get(o));if(a!==0)return a}return __PRIVATE_primitiveComparator(e.length,t.length)}static compareSegments(e,t){const i=BasePath.isNumericId(e),o=BasePath.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?BasePath.extractNumericId(e).compare(BasePath.extractNumericId(t)):__PRIVATE_compareUtf8Strings(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Integer.fromString(e.substring(4,e.length-2))}}class ResourcePath extends BasePath{construct(e,t,i){return new ResourcePath(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(o=>o.length>0))}return new ResourcePath(t)}static emptyPath(){return new ResourcePath([])}}const q=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class FieldPath$1 extends BasePath{construct(e,t,i){return new FieldPath$1(e,t,i)}static isValidIdentifier(e){return q.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),FieldPath$1.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===k}static keyField(){return new FieldPath$1([k])}static fromServerFormat(e){const t=[];let i="",o=0;const a=()=>{if(i.length===0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new FirestoreError(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new FirestoreError(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,o+=2}else f==="`"?(u=!u,o++):f!=="."||u?(i+=f,o++):(a(),o++)}if(a(),u)throw new FirestoreError(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new FieldPath$1(t)}static emptyPath(){return new FieldPath$1([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentKey{constructor(e){this.path=e}static fromPath(e){return new DocumentKey(ResourcePath.fromString(e))}static fromName(e){return new DocumentKey(ResourcePath.fromString(e).popFirst(5))}static empty(){return new DocumentKey(ResourcePath.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ResourcePath.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ResourcePath.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new DocumentKey(new ResourcePath(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q=-1;function __PRIVATE_newIndexOffsetSuccessorFromReadTime(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=SnapshotVersion.fromTimestamp(i===1e9?new Timestamp(t+1,0):new Timestamp(t,i));return new IndexOffset(o,DocumentKey.empty(),e)}function __PRIVATE_newIndexOffsetFromDocument(n){return new IndexOffset(n.readTime,n.key,Q)}class IndexOffset{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new IndexOffset(SnapshotVersion.min(),DocumentKey.empty(),Q)}static max(){return new IndexOffset(SnapshotVersion.max(),DocumentKey.empty(),Q)}}function __PRIVATE_indexOffsetComparator(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=DocumentKey.comparator(n.documentKey,e.documentKey),t!==0?t:__PRIVATE_primitiveComparator(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PersistenceTransaction{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __PRIVATE_ignoreIfPrimaryLeaseLoss(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==$)throw n;__PRIVATE_logDebug("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PersistencePromise{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&fail(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new PersistencePromise((i,o)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,o)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof PersistencePromise?t:PersistencePromise.resolve(t)}catch(t){return PersistencePromise.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):PersistencePromise.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):PersistencePromise.reject(t)}static resolve(e){return new PersistencePromise((t,i)=>{t(e)})}static reject(e){return new PersistencePromise((t,i)=>{i(e)})}static waitFor(e){return new PersistencePromise((t,i)=>{let o=0,a=0,u=!1;e.forEach(f=>{++o,f.next(()=>{++a,u&&a===o&&t()},d=>i(d))}),u=!0,a===o&&t()})}static or(e){let t=PersistencePromise.resolve(!1);for(const i of e)t=t.next(o=>o?PersistencePromise.resolve(o):i());return t}static forEach(e,t){const i=[];return e.forEach((o,a)=>{i.push(t.call(this,o,a))}),this.waitFor(i)}static mapArray(e,t){return new PersistencePromise((i,o)=>{const a=e.length,u=new Array(a);let f=0;for(let d=0;d<a;d++){const p=d;t(e[p]).next(_=>{u[p]=_,++f,f===a&&i(u)},_=>o(_))}})}static doWhile(e,t){return new PersistencePromise((i,o)=>{const a=()=>{e()===!0?t().next(()=>{a()},o):i()};a()})}}function __PRIVATE_getAndroidVersion(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function __PRIVATE_isIndexedDbTransactionError(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ListenSequence{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>t.writeSequenceNumber(i))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}__PRIVATE_ListenSequence.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G=-1;function __PRIVATE_isNullOrUndefined(n){return n==null}function __PRIVATE_isNegativeZero(n){return n===0&&1/n==-1/0}function isSafeInteger(n){return typeof n=="number"&&Number.isInteger(n)&&!__PRIVATE_isNegativeZero(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z="";function __PRIVATE_encodeResourcePath(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=__PRIVATE_encodeSeparator(e)),e=__PRIVATE_encodeSegment(n.get(t),e);return __PRIVATE_encodeSeparator(e)}function __PRIVATE_encodeSegment(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const a=n.charAt(o);switch(a){case"\0":t+="";break;case z:t+="";break;default:t+=a}}return t}function __PRIVATE_encodeSeparator(n){return n+z+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_objectSize(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function forEach(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function isEmpty(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMap{constructor(e,t){this.comparator=e,this.root=t||LLRBNode.EMPTY}insert(e,t){return new SortedMap(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator,this.root.remove(e,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new SortedMapIterator(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!1)}getReverseIterator(){return new SortedMapIterator(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!0)}}class SortedMapIterator{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&o&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class LLRBNode{constructor(e,t,i,o,a){this.key=e,this.value=t,this.color=i??LLRBNode.RED,this.left=o??LLRBNode.EMPTY,this.right=a??LLRBNode.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,a){return new LLRBNode(e??this.key,t??this.value,i??this.color,o??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const a=i(e,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(e,t,i),null):a===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return LLRBNode.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return LLRBNode.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fail(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fail(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fail(27949);return e+(this.isRed()?0:1)}}LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1;LLRBNode.EMPTY=new class{constructor(){this.size=0}get key(){throw fail(57766)}get value(){throw fail(16141)}get color(){throw fail(16727)}get left(){throw fail(29726)}get right(){throw fail(36894)}copy(e,t,i,o,a){return this}insert(e,t,i){return new LLRBNode(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedSet{constructor(e){this.comparator=e,this.data=new SortedMap(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new SortedSetIterator(this.data.getIterator())}getIteratorFrom(e){return new SortedSetIterator(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof SortedSet)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=i.getNext().key;if(this.comparator(o,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new SortedSet(this.comparator);return t.data=e,t}}class SortedSetIterator{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldMask{constructor(e){this.fields=e,e.sort(FieldPath$1.comparator)}static empty(){return new FieldMask([])}unionWith(e){let t=new SortedSet(FieldPath$1.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new FieldMask(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return __PRIVATE_arrayEquals(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Base64DecodeError extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ByteString{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new __PRIVATE_Base64DecodeError("Invalid base64 string: "+a):a}}(e);return new ByteString(t)}static fromUint8Array(e){const t=function(o){let a="";for(let u=0;u<o.length;++u)a+=String.fromCharCode(o[u]);return a}(e);return new ByteString(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return __PRIVATE_primitiveComparator(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ByteString.EMPTY_BYTE_STRING=new ByteString("");const it=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function __PRIVATE_normalizeTimestamp(n){if(__PRIVATE_hardAssert(!!n,39018),typeof n=="string"){let e=0;const t=it.exec(n);if(__PRIVATE_hardAssert(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:__PRIVATE_normalizeNumber(n.seconds),nanos:__PRIVATE_normalizeNumber(n.nanos)}}function __PRIVATE_normalizeNumber(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function __PRIVATE_normalizeByteString(n){return typeof n=="string"?ByteString.fromBase64String(n):ByteString.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const st="server_timestamp",ot="__type__",_t="__previous_value__",at="__local_write_time__";function __PRIVATE_isServerTimestamp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[ot])===null||t===void 0?void 0:t.stringValue)===st}function __PRIVATE_getPreviousValue(n){const e=n.mapValue.fields[_t];return __PRIVATE_isServerTimestamp(e)?__PRIVATE_getPreviousValue(e):e}function __PRIVATE_getLocalWriteTime(n){const e=__PRIVATE_normalizeTimestamp(n.mapValue.fields[at].timestampValue);return new Timestamp(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DatabaseInfo{constructor(e,t,i,o,a,u,f,d,p,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=d,this.useFetchStreams=p,this.isUsingEmulator=_}}const ut="(default)";class DatabaseId{constructor(e,t){this.projectId=e,this.database=t||ut}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database===ut}isEqual(e){return e instanceof DatabaseId&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct="__type__",lt="__max__",ht={mapValue:{}},Pt="__vector__",Tt="value";function __PRIVATE_typeOrder(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?__PRIVATE_isServerTimestamp(n)?4:__PRIVATE_isMaxValue(n)?9007199254740991:__PRIVATE_isVectorValue(n)?10:11:fail(28295,{value:n})}function __PRIVATE_valueEquals(n,e){if(n===e)return!0;const t=__PRIVATE_typeOrder(n);if(t!==__PRIVATE_typeOrder(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return __PRIVATE_getLocalWriteTime(n).isEqual(__PRIVATE_getLocalWriteTime(e));case 3:return function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const u=__PRIVATE_normalizeTimestamp(o.timestampValue),f=__PRIVATE_normalizeTimestamp(a.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,a){return __PRIVATE_normalizeByteString(o.bytesValue).isEqual(__PRIVATE_normalizeByteString(a.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,a){return __PRIVATE_normalizeNumber(o.geoPointValue.latitude)===__PRIVATE_normalizeNumber(a.geoPointValue.latitude)&&__PRIVATE_normalizeNumber(o.geoPointValue.longitude)===__PRIVATE_normalizeNumber(a.geoPointValue.longitude)}(n,e);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return __PRIVATE_normalizeNumber(o.integerValue)===__PRIVATE_normalizeNumber(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const u=__PRIVATE_normalizeNumber(o.doubleValue),f=__PRIVATE_normalizeNumber(a.doubleValue);return u===f?__PRIVATE_isNegativeZero(u)===__PRIVATE_isNegativeZero(f):isNaN(u)&&isNaN(f)}return!1}(n,e);case 9:return __PRIVATE_arrayEquals(n.arrayValue.values||[],e.arrayValue.values||[],__PRIVATE_valueEquals);case 10:case 11:return function(o,a){const u=o.mapValue.fields||{},f=a.mapValue.fields||{};if(__PRIVATE_objectSize(u)!==__PRIVATE_objectSize(f))return!1;for(const d in u)if(u.hasOwnProperty(d)&&(f[d]===void 0||!__PRIVATE_valueEquals(u[d],f[d])))return!1;return!0}(n,e);default:return fail(52216,{left:n})}}function __PRIVATE_arrayValueContains(n,e){return(n.values||[]).find(t=>__PRIVATE_valueEquals(t,e))!==void 0}function __PRIVATE_valueCompare(n,e){if(n===e)return 0;const t=__PRIVATE_typeOrder(n),i=__PRIVATE_typeOrder(e);if(t!==i)return __PRIVATE_primitiveComparator(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return __PRIVATE_primitiveComparator(n.booleanValue,e.booleanValue);case 2:return function(a,u){const f=__PRIVATE_normalizeNumber(a.integerValue||a.doubleValue),d=__PRIVATE_normalizeNumber(u.integerValue||u.doubleValue);return f<d?-1:f>d?1:f===d?0:isNaN(f)?isNaN(d)?0:-1:1}(n,e);case 3:return __PRIVATE_compareTimestamps(n.timestampValue,e.timestampValue);case 4:return __PRIVATE_compareTimestamps(__PRIVATE_getLocalWriteTime(n),__PRIVATE_getLocalWriteTime(e));case 5:return __PRIVATE_compareUtf8Strings(n.stringValue,e.stringValue);case 6:return function(a,u){const f=__PRIVATE_normalizeByteString(a),d=__PRIVATE_normalizeByteString(u);return f.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(a,u){const f=a.split("/"),d=u.split("/");for(let p=0;p<f.length&&p<d.length;p++){const _=__PRIVATE_primitiveComparator(f[p],d[p]);if(_!==0)return _}return __PRIVATE_primitiveComparator(f.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(a,u){const f=__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(a.latitude),__PRIVATE_normalizeNumber(u.latitude));return f!==0?f:__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(a.longitude),__PRIVATE_normalizeNumber(u.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return __PRIVATE_compareArrays(n.arrayValue,e.arrayValue);case 10:return function(a,u){var f,d,p,_;const R=a.fields||{},w=u.fields||{},V=(f=R[Tt])===null||f===void 0?void 0:f.arrayValue,U=(d=w[Tt])===null||d===void 0?void 0:d.arrayValue,X=__PRIVATE_primitiveComparator(((p=V==null?void 0:V.values)===null||p===void 0?void 0:p.length)||0,((_=U==null?void 0:U.values)===null||_===void 0?void 0:_.length)||0);return X!==0?X:__PRIVATE_compareArrays(V,U)}(n.mapValue,e.mapValue);case 11:return function(a,u){if(a===ht.mapValue&&u===ht.mapValue)return 0;if(a===ht.mapValue)return 1;if(u===ht.mapValue)return-1;const f=a.fields||{},d=Object.keys(f),p=u.fields||{},_=Object.keys(p);d.sort(),_.sort();for(let R=0;R<d.length&&R<_.length;++R){const w=__PRIVATE_compareUtf8Strings(d[R],_[R]);if(w!==0)return w;const V=__PRIVATE_valueCompare(f[d[R]],p[_[R]]);if(V!==0)return V}return __PRIVATE_primitiveComparator(d.length,_.length)}(n.mapValue,e.mapValue);default:throw fail(23264,{Pe:t})}}function __PRIVATE_compareTimestamps(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return __PRIVATE_primitiveComparator(n,e);const t=__PRIVATE_normalizeTimestamp(n),i=__PRIVATE_normalizeTimestamp(e),o=__PRIVATE_primitiveComparator(t.seconds,i.seconds);return o!==0?o:__PRIVATE_primitiveComparator(t.nanos,i.nanos)}function __PRIVATE_compareArrays(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const a=__PRIVATE_valueCompare(t[o],i[o]);if(a)return a}return __PRIVATE_primitiveComparator(t.length,i.length)}function canonicalId(n){return __PRIVATE_canonifyValue(n)}function __PRIVATE_canonifyValue(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=__PRIVATE_normalizeTimestamp(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return __PRIVATE_normalizeByteString(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return DocumentKey.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",o=!0;for(const a of t.values||[])o?o=!1:i+=",",i+=__PRIVATE_canonifyValue(a);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let o="{",a=!0;for(const u of i)a?a=!1:o+=",",o+=`${u}:${__PRIVATE_canonifyValue(t.fields[u])}`;return o+"}"}(n.mapValue):fail(61005,{value:n})}function __PRIVATE_estimateByteSize(n){switch(__PRIVATE_typeOrder(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=__PRIVATE_getPreviousValue(n);return e?16+__PRIVATE_estimateByteSize(e):16;case 5:return 2*n.stringValue.length;case 6:return __PRIVATE_normalizeByteString(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((o,a)=>o+__PRIVATE_estimateByteSize(a),0)}(n.arrayValue);case 10:case 11:return function(i){let o=0;return forEach(i.fields,(a,u)=>{o+=a.length+__PRIVATE_estimateByteSize(u)}),o}(n.mapValue);default:throw fail(13486,{value:n})}}function __PRIVATE_refValue(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function isInteger(n){return!!n&&"integerValue"in n}function isArray(n){return!!n&&"arrayValue"in n}function __PRIVATE_isNullValue(n){return!!n&&"nullValue"in n}function __PRIVATE_isNanValue(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function __PRIVATE_isMapValue(n){return!!n&&"mapValue"in n}function __PRIVATE_isVectorValue(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[ct])===null||t===void 0?void 0:t.stringValue)===Pt}function __PRIVATE_deepClone(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return forEach(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=__PRIVATE_deepClone(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=__PRIVATE_deepClone(n.arrayValue.values[t]);return e}return Object.assign({},n)}function __PRIVATE_isMaxValue(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===lt}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectValue{constructor(e){this.value=e}static empty(){return new ObjectValue({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!__PRIVATE_isMapValue(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=__PRIVATE_deepClone(t)}setAll(e){let t=FieldPath$1.emptyPath(),i={},o=[];e.forEach((u,f)=>{if(!t.isImmediateParentOf(f)){const d=this.getFieldsMap(t);this.applyChanges(d,i,o),i={},o=[],t=f.popLast()}u?i[f.lastSegment()]=__PRIVATE_deepClone(u):o.push(f.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,i,o)}delete(e){const t=this.field(e.popLast());__PRIVATE_isMapValue(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return __PRIVATE_valueEquals(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];__PRIVATE_isMapValue(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){forEach(t,(o,a)=>e[o]=a);for(const o of i)delete e[o]}clone(){return new ObjectValue(__PRIVATE_deepClone(this.value))}}function __PRIVATE_extractFieldMask(n){const e=[];return forEach(n.fields,(t,i)=>{const o=new FieldPath$1([t]);if(__PRIVATE_isMapValue(i)){const a=__PRIVATE_extractFieldMask(i.mapValue).fields;if(a.length===0)e.push(o);else for(const u of a)e.push(o.child(u))}else e.push(o)}),new FieldMask(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutableDocument{constructor(e,t,i,o,a,u,f){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=a,this.data=u,this.documentState=f}static newInvalidDocument(e){return new MutableDocument(e,0,SnapshotVersion.min(),SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newFoundDocument(e,t,i,o){return new MutableDocument(e,1,t,SnapshotVersion.min(),i,o,0)}static newNoDocument(e,t){return new MutableDocument(e,2,t,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newUnknownDocument(e,t){return new MutableDocument(e,3,t,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(SnapshotVersion.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ObjectValue.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ObjectValue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=SnapshotVersion.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof MutableDocument&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new MutableDocument(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bound{constructor(e,t){this.position=e,this.inclusive=t}}function __PRIVATE_boundCompareToDocument(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const a=e[o],u=n.position[o];if(a.field.isKeyField()?i=DocumentKey.comparator(DocumentKey.fromName(u.referenceValue),t.key):i=__PRIVATE_valueCompare(u,t.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function __PRIVATE_boundEquals(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!__PRIVATE_valueEquals(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OrderBy{constructor(e,t="asc"){this.field=e,this.dir=t}}function __PRIVATE_orderByEquals(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Filter{}class FieldFilter extends Filter{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new __PRIVATE_KeyFieldFilter(e,t,i):t==="array-contains"?new __PRIVATE_ArrayContainsFilter(e,i):t==="in"?new __PRIVATE_InFilter(e,i):t==="not-in"?new __PRIVATE_NotInFilter(e,i):t==="array-contains-any"?new __PRIVATE_ArrayContainsAnyFilter(e,i):new FieldFilter(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new __PRIVATE_KeyFieldInFilter(e,i):new __PRIVATE_KeyFieldNotInFilter(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(__PRIVATE_valueCompare(t,this.value)):t!==null&&__PRIVATE_typeOrder(this.value)===__PRIVATE_typeOrder(t)&&this.matchesComparison(__PRIVATE_valueCompare(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fail(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class CompositeFilter extends Filter{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new CompositeFilter(e,t)}matches(e){return __PRIVATE_compositeFilterIsConjunction(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function __PRIVATE_compositeFilterIsConjunction(n){return n.op==="and"}function __PRIVATE_compositeFilterIsFlatConjunction(n){return __PRIVATE_compositeFilterIsFlat(n)&&__PRIVATE_compositeFilterIsConjunction(n)}function __PRIVATE_compositeFilterIsFlat(n){for(const e of n.filters)if(e instanceof CompositeFilter)return!1;return!0}function __PRIVATE_canonifyFilter(n){if(n instanceof FieldFilter)return n.field.canonicalString()+n.op.toString()+canonicalId(n.value);if(__PRIVATE_compositeFilterIsFlatConjunction(n))return n.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");{const e=n.filters.map(t=>__PRIVATE_canonifyFilter(t)).join(",");return`${n.op}(${e})`}}function __PRIVATE_filterEquals(n,e){return n instanceof FieldFilter?function(i,o){return o instanceof FieldFilter&&i.op===o.op&&i.field.isEqual(o.field)&&__PRIVATE_valueEquals(i.value,o.value)}(n,e):n instanceof CompositeFilter?function(i,o){return o instanceof CompositeFilter&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((a,u,f)=>a&&__PRIVATE_filterEquals(u,o.filters[f]),!0):!1}(n,e):void fail(19439)}function __PRIVATE_stringifyFilter(n){return n instanceof FieldFilter?function(t){return`${t.field.canonicalString()} ${t.op} ${canonicalId(t.value)}`}(n):n instanceof CompositeFilter?function(t){return t.op.toString()+" {"+t.getFilters().map(__PRIVATE_stringifyFilter).join(" ,")+"}"}(n):"Filter"}class __PRIVATE_KeyFieldFilter extends FieldFilter{constructor(e,t,i){super(e,t,i),this.key=DocumentKey.fromName(i.referenceValue)}matches(e){const t=DocumentKey.comparator(e.key,this.key);return this.matchesComparison(t)}}class __PRIVATE_KeyFieldInFilter extends FieldFilter{constructor(e,t){super(e,"in",t),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class __PRIVATE_KeyFieldNotInFilter extends FieldFilter{constructor(e,t){super(e,"not-in",t),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function __PRIVATE_extractDocumentKeysFromArrayValue(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>DocumentKey.fromName(i.referenceValue))}class __PRIVATE_ArrayContainsFilter extends FieldFilter{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return isArray(t)&&__PRIVATE_arrayValueContains(t.arrayValue,this.value)}}class __PRIVATE_InFilter extends FieldFilter{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&__PRIVATE_arrayValueContains(this.value.arrayValue,t)}}class __PRIVATE_NotInFilter extends FieldFilter{constructor(e,t){super(e,"not-in",t)}matches(e){if(__PRIVATE_arrayValueContains(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!__PRIVATE_arrayValueContains(this.value.arrayValue,t)}}class __PRIVATE_ArrayContainsAnyFilter extends FieldFilter{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!isArray(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>__PRIVATE_arrayValueContains(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetImpl{constructor(e,t=null,i=[],o=[],a=null,u=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=a,this.startAt=u,this.endAt=f,this.Ie=null}}function __PRIVATE_newTarget(n,e=null,t=[],i=[],o=null,a=null,u=null){return new __PRIVATE_TargetImpl(n,e,t,i,o,a,u)}function __PRIVATE_canonifyTarget(n){const e=__PRIVATE_debugCast(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>__PRIVATE_canonifyFilter(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(a){return a.field.canonicalString()+a.dir}(i)).join(","),__PRIVATE_isNullOrUndefined(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>canonicalId(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>canonicalId(i)).join(",")),e.Ie=t}return e.Ie}function __PRIVATE_targetEquals(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!__PRIVATE_orderByEquals(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!__PRIVATE_filterEquals(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!__PRIVATE_boundEquals(n.startAt,e.startAt)&&__PRIVATE_boundEquals(n.endAt,e.endAt)}function __PRIVATE_targetIsDocumentTarget(n){return DocumentKey.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryImpl{constructor(e,t=null,i=[],o=[],a=null,u="F",f=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=a,this.limitType=u,this.startAt=f,this.endAt=d,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function __PRIVATE_newQuery(n,e,t,i,o,a,u,f){return new __PRIVATE_QueryImpl(n,e,t,i,o,a,u,f)}function __PRIVATE_newQueryForPath(n){return new __PRIVATE_QueryImpl(n)}function __PRIVATE_queryMatchesAllDocuments(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function __PRIVATE_isCollectionGroupQuery(n){return n.collectionGroup!==null}function __PRIVATE_queryNormalizedOrderBy(n){const e=__PRIVATE_debugCast(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ee.push(a),t.add(a.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new SortedSet(FieldPath$1.comparator);return u.filters.forEach(d=>{d.getFlattenedFilters().forEach(p=>{p.isInequality()&&(f=f.add(p.field))})}),f})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ee.push(new OrderBy(a,i))}),t.has(FieldPath$1.keyField().canonicalString())||e.Ee.push(new OrderBy(FieldPath$1.keyField(),i))}return e.Ee}function __PRIVATE_queryToTarget(n){const e=__PRIVATE_debugCast(n);return e.de||(e.de=__PRIVATE__queryToTarget(e,__PRIVATE_queryNormalizedOrderBy(n))),e.de}function __PRIVATE__queryToTarget(n,e){if(n.limitType==="F")return __PRIVATE_newTarget(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const a=o.dir==="desc"?"asc":"desc";return new OrderBy(o.field,a)});const t=n.endAt?new Bound(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Bound(n.startAt.position,n.startAt.inclusive):null;return __PRIVATE_newTarget(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function __PRIVATE_queryWithAddedFilter(n,e){const t=n.filters.concat([e]);return new __PRIVATE_QueryImpl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function __PRIVATE_queryWithLimit(n,e,t){return new __PRIVATE_QueryImpl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function __PRIVATE_queryEquals(n,e){return __PRIVATE_targetEquals(__PRIVATE_queryToTarget(n),__PRIVATE_queryToTarget(e))&&n.limitType===e.limitType}function __PRIVATE_canonifyQuery(n){return`${__PRIVATE_canonifyTarget(__PRIVATE_queryToTarget(n))}|lt:${n.limitType}`}function __PRIVATE_stringifyQuery(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(o=>__PRIVATE_stringifyFilter(o)).join(", ")}]`),__PRIVATE_isNullOrUndefined(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(o=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(o)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(o=>canonicalId(o)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(o=>canonicalId(o)).join(",")),`Target(${i})`}(__PRIVATE_queryToTarget(n))}; limitType=${n.limitType})`}function __PRIVATE_queryMatches(n,e){return e.isFoundDocument()&&function(i,o){const a=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):DocumentKey.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)}(n,e)&&function(i,o){for(const a of __PRIVATE_queryNormalizedOrderBy(i))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0}(n,e)&&function(i,o){for(const a of i.filters)if(!a.matches(o))return!1;return!0}(n,e)&&function(i,o){return!(i.startAt&&!function(u,f,d){const p=__PRIVATE_boundCompareToDocument(u,f,d);return u.inclusive?p<=0:p<0}(i.startAt,__PRIVATE_queryNormalizedOrderBy(i),o)||i.endAt&&!function(u,f,d){const p=__PRIVATE_boundCompareToDocument(u,f,d);return u.inclusive?p>=0:p>0}(i.endAt,__PRIVATE_queryNormalizedOrderBy(i),o))}(n,e)}function __PRIVATE_queryCollectionGroup(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function __PRIVATE_newQueryComparator(n){return(e,t)=>{let i=!1;for(const o of __PRIVATE_queryNormalizedOrderBy(n)){const a=__PRIVATE_compareDocs(o,e,t);if(a!==0)return a;i=i||o.field.isKeyField()}return 0}}function __PRIVATE_compareDocs(n,e,t){const i=n.field.isKeyField()?DocumentKey.comparator(e.key,t.key):function(a,u,f){const d=u.data.field(a),p=f.data.field(a);return d!==null&&p!==null?__PRIVATE_valueCompare(d,p):fail(42886)}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return fail(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectMap{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,a]of i)if(this.equalsFn(o,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return void(o[a]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){forEach(this.inner,(t,i)=>{for(const[o,a]of i)e(o,a)})}isEmpty(){return isEmpty(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt=new SortedMap(DocumentKey.comparator);function __PRIVATE_mutableDocumentMap(){return dt}const At=new SortedMap(DocumentKey.comparator);function documentMap(...n){let e=At;for(const t of n)e=e.insert(t.key,t);return e}function __PRIVATE_convertOverlayedDocumentMapToDocumentMap(n){let e=At;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function __PRIVATE_newOverlayMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newMutationMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newDocumentKeyMap(){return new ObjectMap(n=>n.toString(),(n,e)=>n.isEqual(e))}const Rt=new SortedMap(DocumentKey.comparator),Vt=new SortedSet(DocumentKey.comparator);function __PRIVATE_documentKeySet(...n){let e=Vt;for(const t of n)e=e.add(t);return e}const mt=new SortedSet(__PRIVATE_primitiveComparator);function __PRIVATE_targetIdSet(){return mt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_toDouble(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:__PRIVATE_isNegativeZero(e)?"-0":e}}function __PRIVATE_toInteger(n){return{integerValue:""+n}}function toNumber(n,e){return isSafeInteger(e)?__PRIVATE_toInteger(e):__PRIVATE_toDouble(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransformOperation{constructor(){this._=void 0}}function __PRIVATE_applyTransformOperationToLocalView(n,e,t){return n instanceof __PRIVATE_ServerTimestampTransform?function(o,a){const u={fields:{[ot]:{stringValue:st},[at]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&__PRIVATE_isServerTimestamp(a)&&(a=__PRIVATE_getPreviousValue(a)),a&&(u.fields[_t]=a),{mapValue:u}}(t,e):n instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(n,e):n instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(n,e):function(o,a){const u=__PRIVATE_computeTransformOperationBaseValue(o,a),f=asNumber(u)+asNumber(o.Re);return isInteger(u)&&isInteger(o.Re)?__PRIVATE_toInteger(f):__PRIVATE_toDouble(o.serializer,f)}(n,e)}function __PRIVATE_applyTransformOperationToRemoteDocument(n,e,t){return n instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(n,e):n instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(n,e):t}function __PRIVATE_computeTransformOperationBaseValue(n,e){return n instanceof __PRIVATE_NumericIncrementTransformOperation?function(i){return isInteger(i)||function(a){return!!a&&"doubleValue"in a}(i)}(e)?e:{integerValue:0}:null}class __PRIVATE_ServerTimestampTransform extends TransformOperation{}class __PRIVATE_ArrayUnionTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayUnionTransformOperation(n,e){const t=__PRIVATE_coercedFieldValuesArray(e);for(const i of n.elements)t.some(o=>__PRIVATE_valueEquals(o,i))||t.push(i);return{arrayValue:{values:t}}}class __PRIVATE_ArrayRemoveTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayRemoveTransformOperation(n,e){let t=__PRIVATE_coercedFieldValuesArray(e);for(const i of n.elements)t=t.filter(o=>!__PRIVATE_valueEquals(o,i));return{arrayValue:{values:t}}}class __PRIVATE_NumericIncrementTransformOperation extends TransformOperation{constructor(e,t){super(),this.serializer=e,this.Re=t}}function asNumber(n){return __PRIVATE_normalizeNumber(n.integerValue||n.doubleValue)}function __PRIVATE_coercedFieldValuesArray(n){return isArray(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function __PRIVATE_fieldTransformEquals(n,e){return n.field.isEqual(e.field)&&function(i,o){return i instanceof __PRIVATE_ArrayUnionTransformOperation&&o instanceof __PRIVATE_ArrayUnionTransformOperation||i instanceof __PRIVATE_ArrayRemoveTransformOperation&&o instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_arrayEquals(i.elements,o.elements,__PRIVATE_valueEquals):i instanceof __PRIVATE_NumericIncrementTransformOperation&&o instanceof __PRIVATE_NumericIncrementTransformOperation?__PRIVATE_valueEquals(i.Re,o.Re):i instanceof __PRIVATE_ServerTimestampTransform&&o instanceof __PRIVATE_ServerTimestampTransform}(n.transform,e.transform)}class MutationResult{constructor(e,t){this.version=e,this.transformResults=t}}class Precondition{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Precondition}static exists(e){return new Precondition(void 0,e)}static updateTime(e){return new Precondition(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function __PRIVATE_preconditionIsValidForDocument(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Mutation{}function __PRIVATE_calculateOverlayMutation(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new __PRIVATE_DeleteMutation(n.key,Precondition.none()):new __PRIVATE_SetMutation(n.key,n.data,Precondition.none());{const t=n.data,i=ObjectValue.empty();let o=new SortedSet(FieldPath$1.comparator);for(let a of e.fields)if(!o.has(a)){let u=t.field(a);u===null&&a.length>1&&(a=a.popLast(),u=t.field(a)),u===null?i.delete(a):i.set(a,u),o=o.add(a)}return new __PRIVATE_PatchMutation(n.key,i,new FieldMask(o.toArray()),Precondition.none())}}function __PRIVATE_mutationApplyToRemoteDocument(n,e,t){n instanceof __PRIVATE_SetMutation?function(o,a,u){const f=o.value.clone(),d=__PRIVATE_serverTransformResults(o.fieldTransforms,a,u.transformResults);f.setAll(d),a.convertToFoundDocument(u.version,f).setHasCommittedMutations()}(n,e,t):n instanceof __PRIVATE_PatchMutation?function(o,a,u){if(!__PRIVATE_preconditionIsValidForDocument(o.precondition,a))return void a.convertToUnknownDocument(u.version);const f=__PRIVATE_serverTransformResults(o.fieldTransforms,a,u.transformResults),d=a.data;d.setAll(__PRIVATE_getPatch(o)),d.setAll(f),a.convertToFoundDocument(u.version,d).setHasCommittedMutations()}(n,e,t):function(o,a,u){a.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function __PRIVATE_mutationApplyToLocalView(n,e,t,i){return n instanceof __PRIVATE_SetMutation?function(a,u,f,d){if(!__PRIVATE_preconditionIsValidForDocument(a.precondition,u))return f;const p=a.value.clone(),_=__PRIVATE_localTransformResults(a.fieldTransforms,d,u);return p.setAll(_),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null}(n,e,t,i):n instanceof __PRIVATE_PatchMutation?function(a,u,f,d){if(!__PRIVATE_preconditionIsValidForDocument(a.precondition,u))return f;const p=__PRIVATE_localTransformResults(a.fieldTransforms,d,u),_=u.data;return _.setAll(__PRIVATE_getPatch(a)),_.setAll(p),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),f===null?null:f.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(R=>R.field))}(n,e,t,i):function(a,u,f){return __PRIVATE_preconditionIsValidForDocument(a.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f}(n,e,t)}function __PRIVATE_mutationExtractBaseValue(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),a=__PRIVATE_computeTransformOperationBaseValue(i.transform,o||null);a!=null&&(t===null&&(t=ObjectValue.empty()),t.set(i.field,a))}return t||null}function __PRIVATE_mutationEquals(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&__PRIVATE_arrayEquals(i,o,(a,u)=>__PRIVATE_fieldTransformEquals(a,u))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class __PRIVATE_SetMutation extends Mutation{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class __PRIVATE_PatchMutation extends Mutation{constructor(e,t,i,o,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function __PRIVATE_getPatch(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function __PRIVATE_serverTransformResults(n,e,t){const i=new Map;__PRIVATE_hardAssert(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const a=n[o],u=a.transform,f=e.data.field(a.field);i.set(a.field,__PRIVATE_applyTransformOperationToRemoteDocument(u,f,t[o]))}return i}function __PRIVATE_localTransformResults(n,e,t){const i=new Map;for(const o of n){const a=o.transform,u=t.data.field(o.field);i.set(o.field,__PRIVATE_applyTransformOperationToLocalView(a,u,e))}return i}class __PRIVATE_DeleteMutation extends Mutation{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class __PRIVATE_VerifyMutation extends Mutation{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutationBatch{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const a=this.mutations[o];a.key.isEqual(e.key)&&__PRIVATE_mutationApplyToRemoteDocument(a,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=__PRIVATE_mutationApplyToLocalView(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=__PRIVATE_mutationApplyToLocalView(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=__PRIVATE_newMutationMap();return this.mutations.forEach(o=>{const a=e.get(o.key),u=a.overlayedDocument;let f=this.applyToLocalView(u,a.mutatedFields);f=t.has(o.key)?null:f;const d=__PRIVATE_calculateOverlayMutation(u,f);d!==null&&i.set(o.key,d),u.isValidDocument()||u.convertToNoDocument(SnapshotVersion.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),__PRIVATE_documentKeySet())}isEqual(e){return this.batchId===e.batchId&&__PRIVATE_arrayEquals(this.mutations,e.mutations,(t,i)=>__PRIVATE_mutationEquals(t,i))&&__PRIVATE_arrayEquals(this.baseMutations,e.baseMutations,(t,i)=>__PRIVATE_mutationEquals(t,i))}}class MutationBatchResult{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){__PRIVATE_hardAssert(e.mutations.length===i.length,58842,{fe:e.mutations.length,ge:i.length});let o=function(){return Rt}();const a=e.mutations;for(let u=0;u<a.length;u++)o=o.insert(a[u].key,i[u].version);return new MutationBatchResult(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overlay{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistenceFilter{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,gt;function __PRIVATE_isPermanentError(n){switch(n){case N.OK:return fail(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return fail(15467,{code:n})}}function __PRIVATE_mapCodeFromRpcCode(n){if(n===void 0)return __PRIVATE_logError("GRPC error has no .code"),N.UNKNOWN;switch(n){case ft.OK:return N.OK;case ft.CANCELLED:return N.CANCELLED;case ft.UNKNOWN:return N.UNKNOWN;case ft.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case ft.INTERNAL:return N.INTERNAL;case ft.UNAVAILABLE:return N.UNAVAILABLE;case ft.UNAUTHENTICATED:return N.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case ft.NOT_FOUND:return N.NOT_FOUND;case ft.ALREADY_EXISTS:return N.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return N.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case ft.ABORTED:return N.ABORTED;case ft.OUT_OF_RANGE:return N.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return N.UNIMPLEMENTED;case ft.DATA_LOSS:return N.DATA_LOSS;default:return fail(39323,{code:n})}}(gt=ft||(ft={}))[gt.OK=0]="OK",gt[gt.CANCELLED=1]="CANCELLED",gt[gt.UNKNOWN=2]="UNKNOWN",gt[gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gt[gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gt[gt.NOT_FOUND=5]="NOT_FOUND",gt[gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",gt[gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",gt[gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",gt[gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gt[gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gt[gt.ABORTED=10]="ABORTED",gt[gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",gt[gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",gt[gt.INTERNAL=13]="INTERNAL",gt[gt.UNAVAILABLE=14]="UNAVAILABLE",gt[gt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt=new Integer([4294967295,4294967295],0);function __PRIVATE_getMd5HashValue(n){const e=__PRIVATE_newTextEncoder().encode(n),t=new Md5;return t.update(e),new Uint8Array(t.digest())}function __PRIVATE_get64BitUints(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Integer([t,i],0),new Integer([o,a],0)]}class BloomFilter{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new __PRIVATE_BloomFilterError(`Invalid padding: ${t}`);if(i<0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new __PRIVATE_BloomFilterError(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Integer.fromNumber(this.pe)}we(e,t,i){let o=e.add(t.multiply(Integer.fromNumber(i)));return o.compare(yt)===1&&(o=new Integer([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=__PRIVATE_getMd5HashValue(e),[i,o]=__PRIVATE_get64BitUints(t);for(let a=0;a<this.hashCount;a++){const u=this.we(i,o,a);if(!this.be(u))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),u=new BloomFilter(a,o,t);return i.forEach(f=>u.insert(f)),u}insert(e){if(this.pe===0)return;const t=__PRIVATE_getMd5HashValue(e),[i,o]=__PRIVATE_get64BitUints(t);for(let a=0;a<this.hashCount;a++){const u=this.we(i,o,a);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class __PRIVATE_BloomFilterError extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteEvent{constructor(e,t,i,o,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,TargetChange.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new RemoteEvent(SnapshotVersion.min(),o,new SortedMap(__PRIVATE_primitiveComparator),__PRIVATE_mutableDocumentMap(),__PRIVATE_documentKeySet())}}class TargetChange{constructor(e,t,i,o,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new TargetChange(i,t,__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentWatchChange{constructor(e,t,i,o){this.De=e,this.removedTargetIds=t,this.key=i,this.ve=o}}class __PRIVATE_ExistenceFilterChange{constructor(e,t){this.targetId=e,this.Ce=t}}class __PRIVATE_WatchTargetChange{constructor(e,t,i=ByteString.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class __PRIVATE_TargetState{constructor(){this.Fe=0,this.Me=__PRIVATE_snapshotChangesMap(),this.xe=ByteString.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=__PRIVATE_documentKeySet(),t=__PRIVATE_documentKeySet(),i=__PRIVATE_documentKeySet();return this.Me.forEach((o,a)=>{switch(a){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:fail(38017,{changeType:a})}}),new TargetChange(this.xe,this.Oe,e,t,i)}Qe(){this.Ne=!1,this.Me=__PRIVATE_snapshotChangesMap()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,__PRIVATE_hardAssert(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class __PRIVATE_WatchChangeAggregator{constructor(e){this.ze=e,this.je=new Map,this.He=__PRIVATE_mutableDocumentMap(),this.Je=__PRIVATE_documentTargetMap(),this.Ye=__PRIVATE_documentTargetMap(),this.Ze=new SortedMap(__PRIVATE_primitiveComparator)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const i=this.rt(t);switch(e.state){case 0:this.it(t)&&i.ke(e.resumeToken);break;case 1:i.We(),i.Be||i.Qe(),i.ke(e.resumeToken);break;case 2:i.We(),i.Be||this.removeTarget(t);break;case 3:this.it(t)&&(i.Ge(),i.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),i.ke(e.resumeToken));break;default:fail(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((i,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,i=e.Ce.count,o=this._t(t);if(o){const a=o.target;if(__PRIVATE_targetIsDocumentTarget(a))if(i===0){const u=new DocumentKey(a.path);this.tt(t,u,MutableDocument.newNoDocument(u,SnapshotVersion.min()))}else __PRIVATE_hardAssert(i===1,20013,{expectedCount:i});else{const u=this.ut(t);if(u!==i){const f=this.ct(e),d=f?this.lt(f,e,u):1;if(d!==0){this.st(t);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=t;let u,f;try{u=__PRIVATE_normalizeByteString(i).toUint8Array()}catch(d){if(d instanceof __PRIVATE_Base64DecodeError)return __PRIVATE_logWarn("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{f=new BloomFilter(u,o,a)}catch(d){return __PRIVATE_logWarn(d instanceof __PRIVATE_BloomFilterError?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return f.pe===0?null:f}lt(e,t,i){return t.Ce.count===i-this.Tt(e,t.targetId)?0:2}Tt(e,t){const i=this.ze.getRemoteKeysForTarget(t);let o=0;return i.forEach(a=>{const u=this.ze.Pt(),f=`projects/${u.projectId}/databases/${u.database}/documents/${a.path.canonicalString()}`;e.mightContain(f)||(this.tt(t,a,null),o++)}),o}It(e){const t=new Map;this.je.forEach((a,u)=>{const f=this._t(u);if(f){if(a.current&&__PRIVATE_targetIsDocumentTarget(f.target)){const d=new DocumentKey(f.target.path);this.Et(d).has(u)||this.dt(u,d)||this.tt(u,d,MutableDocument.newNoDocument(d,e))}a.Le&&(t.set(u,a.qe()),a.Qe())}});let i=__PRIVATE_documentKeySet();this.Ye.forEach((a,u)=>{let f=!0;u.forEachWhile(d=>{const p=this._t(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(i=i.add(a))}),this.He.forEach((a,u)=>u.setReadTime(e));const o=new RemoteEvent(e,t,this.Ze,this.He,i);return this.He=__PRIVATE_mutableDocumentMap(),this.Je=__PRIVATE_documentTargetMap(),this.Ye=__PRIVATE_documentTargetMap(),this.Ze=new SortedMap(__PRIVATE_primitiveComparator),o}et(e,t){if(!this.it(e))return;const i=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,i),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,i){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),i&&(this.He=this.He.insert(t,i))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new __PRIVATE_TargetState,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new SortedSet(__PRIVATE_primitiveComparator),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new SortedSet(__PRIVATE_primitiveComparator),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||__PRIVATE_logDebug("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new __PRIVATE_TargetState),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function __PRIVATE_documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function __PRIVATE_snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}const wt={asc:"ASCENDING",desc:"DESCENDING"},bt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},St={and:"AND",or:"OR"};class JsonProtoSerializer{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function __PRIVATE_toInt32Proto(n,e){return n.useProto3Json||__PRIVATE_isNullOrUndefined(e)?e:{value:e}}function toTimestamp(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __PRIVATE_toBytes(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function __PRIVATE_toVersion(n,e){return toTimestamp(n,e.toTimestamp())}function __PRIVATE_fromVersion(n){return __PRIVATE_hardAssert(!!n,49232),SnapshotVersion.fromTimestamp(function(t){const i=__PRIVATE_normalizeTimestamp(t);return new Timestamp(i.seconds,i.nanos)}(n))}function __PRIVATE_toResourceName(n,e){return __PRIVATE_toResourcePath(n,e).canonicalString()}function __PRIVATE_toResourcePath(n,e){const t=function(o){return new ResourcePath(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function __PRIVATE_fromResourceName(n){const e=ResourcePath.fromString(n);return __PRIVATE_hardAssert(__PRIVATE_isValidResourceName(e),10190,{key:e.toString()}),e}function __PRIVATE_toName(n,e){return __PRIVATE_toResourceName(n.databaseId,e.path)}function fromName(n,e){const t=__PRIVATE_fromResourceName(e);if(t.get(1)!==n.databaseId.projectId)throw new FirestoreError(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new FirestoreError(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new DocumentKey(__PRIVATE_extractLocalPathFromResourceName(t))}function __PRIVATE_toQueryPath(n,e){return __PRIVATE_toResourceName(n.databaseId,e)}function __PRIVATE_fromQueryPath(n){const e=__PRIVATE_fromResourceName(n);return e.length===4?ResourcePath.emptyPath():__PRIVATE_extractLocalPathFromResourceName(e)}function __PRIVATE_getEncodedDatabaseId(n){return new ResourcePath(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function __PRIVATE_extractLocalPathFromResourceName(n){return __PRIVATE_hardAssert(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function __PRIVATE_toMutationDocument(n,e,t){return{name:__PRIVATE_toName(n,e),fields:t.value.mapValue.fields}}function __PRIVATE_fromWatchChange(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:fail(39313,{state:p})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],a=function(p,_){return p.useProto3Json?(__PRIVATE_hardAssert(_===void 0||typeof _=="string",58123),ByteString.fromBase64String(_||"")):(__PRIVATE_hardAssert(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),ByteString.fromUint8Array(_||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&function(p){const _=p.code===void 0?N.UNKNOWN:__PRIVATE_mapCodeFromRpcCode(p.code);return new FirestoreError(_,p.message||"")}(u);t=new __PRIVATE_WatchTargetChange(i,o,a,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=fromName(n,i.document.name),a=__PRIVATE_fromVersion(i.document.updateTime),u=i.document.createTime?__PRIVATE_fromVersion(i.document.createTime):SnapshotVersion.min(),f=new ObjectValue({mapValue:{fields:i.document.fields}}),d=MutableDocument.newFoundDocument(o,a,u,f),p=i.targetIds||[],_=i.removedTargetIds||[];t=new __PRIVATE_DocumentWatchChange(p,_,d.key,d)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=fromName(n,i.document),a=i.readTime?__PRIVATE_fromVersion(i.readTime):SnapshotVersion.min(),u=MutableDocument.newNoDocument(o,a),f=i.removedTargetIds||[];t=new __PRIVATE_DocumentWatchChange([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=fromName(n,i.document),a=i.removedTargetIds||[];t=new __PRIVATE_DocumentWatchChange([],a,o,null)}else{if(!("filter"in e))return fail(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:a}=i,u=new ExistenceFilter(o,a),f=i.targetId;t=new __PRIVATE_ExistenceFilterChange(f,u)}}return t}function toMutation(n,e){let t;if(e instanceof __PRIVATE_SetMutation)t={update:__PRIVATE_toMutationDocument(n,e.key,e.value)};else if(e instanceof __PRIVATE_DeleteMutation)t={delete:__PRIVATE_toName(n,e.key)};else if(e instanceof __PRIVATE_PatchMutation)t={update:__PRIVATE_toMutationDocument(n,e.key,e.data),updateMask:__PRIVATE_toDocumentMask(e.fieldMask)};else{if(!(e instanceof __PRIVATE_VerifyMutation))return fail(16599,{ft:e.type});t={verify:__PRIVATE_toName(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(a,u){const f=u.transform;if(f instanceof __PRIVATE_ServerTimestampTransform)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof __PRIVATE_ArrayUnionTransformOperation)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof __PRIVATE_ArrayRemoveTransformOperation)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof __PRIVATE_NumericIncrementTransformOperation)return{fieldPath:u.field.canonicalString(),increment:f.Re};throw fail(20930,{transform:u.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(o,a){return a.updateTime!==void 0?{updateTime:__PRIVATE_toVersion(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:fail(27497)}(n,e.precondition)),t}function __PRIVATE_fromWriteResults(n,e){return n&&n.length>0?(__PRIVATE_hardAssert(e!==void 0,14353),n.map(t=>function(o,a){let u=o.updateTime?__PRIVATE_fromVersion(o.updateTime):__PRIVATE_fromVersion(a);return u.isEqual(SnapshotVersion.min())&&(u=__PRIVATE_fromVersion(a)),new MutationResult(u,o.transformResults||[])}(t,e))):[]}function __PRIVATE_toDocumentsTarget(n,e){return{documents:[__PRIVATE_toQueryPath(n,e.path)]}}function __PRIVATE_toQueryTarget(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=__PRIVATE_toQueryPath(n,o);const a=function(p){if(p.length!==0)return __PRIVATE_toFilter(CompositeFilter.create(p,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const u=function(p){if(p.length!==0)return p.map(_=>function(w){return{field:__PRIVATE_toFieldPathReference(w.field),direction:__PRIVATE_toDirection(w.dir)}}(_))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const f=__PRIVATE_toInt32Proto(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{gt:t,parent:o}}function __PRIVATE_convertQueryTargetToQuery(n){let e=__PRIVATE_fromQueryPath(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){__PRIVATE_hardAssert(i===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let a=[];t.where&&(a=function(R){const w=__PRIVATE_fromFilter(R);return w instanceof CompositeFilter&&__PRIVATE_compositeFilterIsFlatConjunction(w)?w.getFilters():[w]}(t.where));let u=[];t.orderBy&&(u=function(R){return R.map(w=>function(U){return new OrderBy(__PRIVATE_fromFieldPathReference(U.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(U.direction))}(w))}(t.orderBy));let f=null;t.limit&&(f=function(R){let w;return w=typeof R=="object"?R.value:R,__PRIVATE_isNullOrUndefined(w)?null:w}(t.limit));let d=null;t.startAt&&(d=function(R){const w=!!R.before,V=R.values||[];return new Bound(V,w)}(t.startAt));let p=null;return t.endAt&&(p=function(R){const w=!R.before,V=R.values||[];return new Bound(V,w)}(t.endAt)),__PRIVATE_newQuery(e,o,u,a,f,"F",d,p)}function __PRIVATE_toListenRequestLabels(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fail(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function __PRIVATE_fromFilter(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=__PRIVATE_fromFieldPathReference(t.unaryFilter.field);return FieldFilter.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=__PRIVATE_fromFieldPathReference(t.unaryFilter.field);return FieldFilter.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=__PRIVATE_fromFieldPathReference(t.unaryFilter.field);return FieldFilter.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=__PRIVATE_fromFieldPathReference(t.unaryFilter.field);return FieldFilter.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fail(61313);default:return fail(60726)}}(n):n.fieldFilter!==void 0?function(t){return FieldFilter.create(__PRIVATE_fromFieldPathReference(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fail(58110);default:return fail(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return CompositeFilter.create(t.compositeFilter.filters.map(i=>__PRIVATE_fromFilter(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return fail(1026)}}(t.compositeFilter.op))}(n):fail(30097,{filter:n})}function __PRIVATE_toDirection(n){return wt[n]}function __PRIVATE_toOperatorName(n){return bt[n]}function __PRIVATE_toCompositeOperatorName(n){return St[n]}function __PRIVATE_toFieldPathReference(n){return{fieldPath:n.canonicalString()}}function __PRIVATE_fromFieldPathReference(n){return FieldPath$1.fromServerFormat(n.fieldPath)}function __PRIVATE_toFilter(n){return n instanceof FieldFilter?function(t){if(t.op==="=="){if(__PRIVATE_isNanValue(t.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:"IS_NAN"}};if(__PRIVATE_isNullValue(t.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(__PRIVATE_isNanValue(t.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:"IS_NOT_NAN"}};if(__PRIVATE_isNullValue(t.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:__PRIVATE_toOperatorName(t.op),value:t.value}}}(n):n instanceof CompositeFilter?function(t){const i=t.getFilters().map(o=>__PRIVATE_toFilter(o));return i.length===1?i[0]:{compositeFilter:{op:__PRIVATE_toCompositeOperatorName(t.op),filters:i}}}(n):fail(54877,{filter:n})}function __PRIVATE_toDocumentMask(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function __PRIVATE_isValidResourceName(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TargetData{constructor(e,t,i,o,a=SnapshotVersion.min(),u=SnapshotVersion.min(),f=ByteString.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=d}withSequenceNumber(e){return new TargetData(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalSerializer{constructor(e){this.wt=e}}function __PRIVATE_fromBundledQuery(n){const e=__PRIVATE_convertQueryTargetToQuery({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?__PRIVATE_queryWithLimit(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryIndexManager{constructor(){this.Cn=new __PRIVATE_MemoryCollectionParentIndex}addToCollectionParentIndex(e,t){return this.Cn.add(t),PersistencePromise.resolve()}getCollectionParents(e,t){return PersistencePromise.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return PersistencePromise.resolve()}deleteFieldIndex(e,t){return PersistencePromise.resolve()}deleteAllFieldIndexes(e){return PersistencePromise.resolve()}createTargetIndexes(e,t){return PersistencePromise.resolve()}getDocumentsMatchingTarget(e,t){return PersistencePromise.resolve(null)}getIndexType(e,t){return PersistencePromise.resolve(0)}getFieldIndexes(e,t){return PersistencePromise.resolve([])}getNextCollectionGroupToUpdate(e){return PersistencePromise.resolve(null)}getMinOffset(e,t){return PersistencePromise.resolve(IndexOffset.min())}getMinOffsetFromCollectionGroup(e,t){return PersistencePromise.resolve(IndexOffset.min())}updateCollectionGroup(e,t,i){return PersistencePromise.resolve()}updateIndexEntries(e,t){return PersistencePromise.resolve()}}class __PRIVATE_MemoryCollectionParentIndex{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new SortedSet(ResourcePath.comparator),a=!o.has(i);return this.index[t]=o.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new SortedSet(ResourcePath.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mt=41943040;class LruParams{static withCacheSize(e){return new LruParams(e,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */LruParams.DEFAULT_COLLECTION_PERCENTILE=10,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,LruParams.DEFAULT=new LruParams(Mt,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),LruParams.DISABLED=new LruParams(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetIdGenerator{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new __PRIVATE_TargetIdGenerator(0)}static lr(){return new __PRIVATE_TargetIdGenerator(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xt="LruGarbageCollector",Ot=1048576;function __PRIVATE_bufferEntryComparator([n,e],[t,i]){const o=__PRIVATE_primitiveComparator(n,t);return o===0?__PRIVATE_primitiveComparator(e,i):o}class __PRIVATE_RollingSequenceNumberBuffer{constructor(e){this.Er=e,this.buffer=new SortedSet(__PRIVATE_bufferEntryComparator),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();__PRIVATE_bufferEntryComparator(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class __PRIVATE_LruScheduler{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){__PRIVATE_logDebug(xt,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){__PRIVATE_isIndexedDbTransactionError(t)?__PRIVATE_logDebug(xt,"Ignoring IndexedDB error during garbage collection: ",t):await __PRIVATE_ignoreIfPrimaryLeaseLoss(t)}await this.mr(3e5)})}}class __PRIVATE_LruGarbageCollectorImpl{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return PersistencePromise.resolve(__PRIVATE_ListenSequence.le);const i=new __PRIVATE_RollingSequenceNumberBuffer(t);return this.gr.forEachTarget(e,o=>i.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>i.Rr(o))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.gr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(__PRIVATE_logDebug("LruGarbageCollector","Garbage collection skipped; disabled"),PersistencePromise.resolve(Ft)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(__PRIVATE_logDebug("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ft):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let i,o,a,u,f,d,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(R=>(R>this.params.maximumSequenceNumbersToCollect?(__PRIVATE_logDebug("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${R}`),o=this.params.maximumSequenceNumbersToCollect):o=R,u=Date.now(),this.nthSequenceNumber(e,o))).next(R=>(i=R,f=Date.now(),this.removeTargets(e,i,t))).next(R=>(a=R,d=Date.now(),this.removeOrphanedDocuments(e,i))).next(R=>(p=Date.now(),__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${o} in `+(f-u)+`ms
	Removed ${a} targets in `+(d-f)+`ms
	Removed ${R} documents in `+(p-d)+`ms
Total Duration: ${p-_}ms`),PersistencePromise.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:a,documentsRemoved:R})))}}function __PRIVATE_newLruGarbageCollector(n,e){return new __PRIVATE_LruGarbageCollectorImpl(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteDocumentChangeBuffer{constructor(){this.changes=new ObjectMap(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,MutableDocument.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?PersistencePromise.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OverlayedDocument{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LocalDocumentsView{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(i!==null&&__PRIVATE_mutationApplyToLocalView(i.mutation,o,FieldMask.empty(),Timestamp.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,__PRIVATE_documentKeySet()).next(()=>i))}getLocalViewOfDocuments(e,t,i=__PRIVATE_documentKeySet()){const o=__PRIVATE_newOverlayMap();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,i).next(a=>{let u=documentMap();return a.forEach((f,d)=>{u=u.insert(f,d.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const i=__PRIVATE_newOverlayMap();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,__PRIVATE_documentKeySet()))}populateOverlays(e,t,i){const o=[];return i.forEach(a=>{t.has(a)||o.push(a)}),this.documentOverlayCache.getOverlays(e,o).next(a=>{a.forEach((u,f)=>{t.set(u,f)})})}computeViews(e,t,i,o){let a=__PRIVATE_mutableDocumentMap();const u=__PRIVATE_newDocumentKeyMap(),f=function(){return __PRIVATE_newDocumentKeyMap()}();return t.forEach((d,p)=>{const _=i.get(p.key);o.has(p.key)&&(_===void 0||_.mutation instanceof __PRIVATE_PatchMutation)?a=a.insert(p.key,p):_!==void 0?(u.set(p.key,_.mutation.getFieldMask()),__PRIVATE_mutationApplyToLocalView(_.mutation,p,_.mutation.getFieldMask(),Timestamp.now())):u.set(p.key,FieldMask.empty())}),this.recalculateAndSaveOverlays(e,a).next(d=>(d.forEach((p,_)=>u.set(p,_)),t.forEach((p,_)=>{var R;return f.set(p,new OverlayedDocument(_,(R=u.get(p))!==null&&R!==void 0?R:null))}),f))}recalculateAndSaveOverlays(e,t){const i=__PRIVATE_newDocumentKeyMap();let o=new SortedMap((u,f)=>u-f),a=__PRIVATE_documentKeySet();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const f of u)f.keys().forEach(d=>{const p=t.get(d);if(p===null)return;let _=i.get(d)||FieldMask.empty();_=f.applyToLocalView(p,_),i.set(d,_);const R=(o.get(f.batchId)||__PRIVATE_documentKeySet()).add(d);o=o.insert(f.batchId,R)})}).next(()=>{const u=[],f=o.getReverseIterator();for(;f.hasNext();){const d=f.getNext(),p=d.key,_=d.value,R=__PRIVATE_newMutationMap();_.forEach(w=>{if(!a.has(w)){const V=__PRIVATE_calculateOverlayMutation(t.get(w),i.get(w));V!==null&&R.set(w,V),a=a.add(w)}}),u.push(this.documentOverlayCache.saveOverlays(e,p,R))}return PersistencePromise.waitFor(u)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,o){return function(u){return DocumentKey.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):__PRIVATE_isCollectionGroupQuery(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next(a=>{const u=o-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-a.size):PersistencePromise.resolve(__PRIVATE_newOverlayMap());let f=Q,d=a;return u.next(p=>PersistencePromise.forEach(p,(_,R)=>(f<R.largestBatchId&&(f=R.largestBatchId),a.get(_)?PersistencePromise.resolve():this.remoteDocumentCache.getEntry(e,_).next(w=>{d=d.insert(_,w)}))).next(()=>this.populateOverlays(e,p,a)).next(()=>this.computeViews(e,d,p,__PRIVATE_documentKeySet())).next(_=>({batchId:f,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new DocumentKey(t)).next(i=>{let o=documentMap();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const a=t.collectionGroup;let u=documentMap();return this.indexManager.getCollectionParents(e,a).next(f=>PersistencePromise.forEach(f,d=>{const p=function(R,w){return new __PRIVATE_QueryImpl(w,null,R.explicitOrderBy.slice(),R.filters.slice(),R.limit,R.limitType,R.startAt,R.endAt)}(t,d.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,i,o).next(_=>{_.forEach((R,w)=>{u=u.insert(R,w)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,i,o){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(u=>(a=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,a,o))).next(u=>{a.forEach((d,p)=>{const _=p.getKey();u.get(_)===null&&(u=u.insert(_,MutableDocument.newInvalidDocument(_)))});let f=documentMap();return u.forEach((d,p)=>{const _=a.get(d);_!==void 0&&__PRIVATE_mutationApplyToLocalView(_.mutation,p,FieldMask.empty(),Timestamp.now()),__PRIVATE_queryMatches(t,p)&&(f=f.insert(d,p))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryBundleCache{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return PersistencePromise.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:__PRIVATE_fromVersion(o.createTime)}}(t)),PersistencePromise.resolve()}getNamedQuery(e,t){return PersistencePromise.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:__PRIVATE_fromBundledQuery(o.bundledQuery),readTime:__PRIVATE_fromVersion(o.readTime)}}(t)),PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryDocumentOverlayCache{constructor(){this.overlays=new SortedMap(DocumentKey.comparator),this.Qr=new Map}getOverlay(e,t){return PersistencePromise.resolve(this.overlays.get(t))}getOverlays(e,t){const i=__PRIVATE_newOverlayMap();return PersistencePromise.forEach(t,o=>this.getOverlay(e,o).next(a=>{a!==null&&i.set(o,a)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((o,a)=>{this.St(e,t,a)}),PersistencePromise.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Qr.get(i);return o!==void 0&&(o.forEach(a=>this.overlays=this.overlays.remove(a)),this.Qr.delete(i)),PersistencePromise.resolve()}getOverlaysForCollection(e,t,i){const o=__PRIVATE_newOverlayMap(),a=t.length+1,u=new DocumentKey(t.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const d=f.getNext().value,p=d.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&d.largestBatchId>i&&o.set(d.getKey(),d)}return PersistencePromise.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let a=new SortedMap((p,_)=>p-_);const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let _=a.get(p.largestBatchId);_===null&&(_=__PRIVATE_newOverlayMap(),a=a.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const f=__PRIVATE_newOverlayMap(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((p,_)=>f.set(p,_)),!(f.size()>=o)););return PersistencePromise.resolve(f)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const u=this.Qr.get(o.largestBatchId).delete(i.key);this.Qr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new Overlay(t,i));let a=this.Qr.get(t);a===void 0&&(a=__PRIVATE_documentKeySet(),this.Qr.set(t,a)),this.Qr.set(t,a.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryGlobalsCache{constructor(){this.sessionToken=ByteString.EMPTY_BYTE_STRING}getSessionToken(e){return PersistencePromise.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ReferenceSet{constructor(){this.$r=new SortedSet(__PRIVATE_DocReference.Ur),this.Kr=new SortedSet(__PRIVATE_DocReference.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const i=new __PRIVATE_DocReference(e,t);this.$r=this.$r.add(i),this.Kr=this.Kr.add(i)}Gr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.zr(new __PRIVATE_DocReference(e,t))}jr(e,t){e.forEach(i=>this.removeReference(i,t))}Hr(e){const t=new DocumentKey(new ResourcePath([])),i=new __PRIVATE_DocReference(t,e),o=new __PRIVATE_DocReference(t,e+1),a=[];return this.Kr.forEachInRange([i,o],u=>{this.zr(u),a.push(u.key)}),a}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new DocumentKey(new ResourcePath([])),i=new __PRIVATE_DocReference(t,e),o=new __PRIVATE_DocReference(t,e+1);let a=__PRIVATE_documentKeySet();return this.Kr.forEachInRange([i,o],u=>{a=a.add(u.key)}),a}containsKey(e){const t=new __PRIVATE_DocReference(e,0),i=this.$r.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class __PRIVATE_DocReference{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return DocumentKey.comparator(e.key,t.key)||__PRIVATE_primitiveComparator(e.Zr,t.Zr)}static Wr(e,t){return __PRIVATE_primitiveComparator(e.Zr,t.Zr)||DocumentKey.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryMutationQueue{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new SortedSet(__PRIVATE_DocReference.Ur)}checkEmpty(e){return PersistencePromise.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const a=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new MutationBatch(a,t,i,o);this.mutationQueue.push(u);for(const f of o)this.Xr=this.Xr.add(new __PRIVATE_DocReference(f.key,a)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return PersistencePromise.resolve(u)}lookupMutationBatch(e,t){return PersistencePromise.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ti(i),a=o<0?0:o;return PersistencePromise.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return PersistencePromise.resolve(this.mutationQueue.length===0?G:this.nr-1)}getAllMutationBatches(e){return PersistencePromise.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new __PRIVATE_DocReference(t,0),o=new __PRIVATE_DocReference(t,Number.POSITIVE_INFINITY),a=[];return this.Xr.forEachInRange([i,o],u=>{const f=this.ei(u.Zr);a.push(f)}),PersistencePromise.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new SortedSet(__PRIVATE_primitiveComparator);return t.forEach(o=>{const a=new __PRIVATE_DocReference(o,0),u=new __PRIVATE_DocReference(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([a,u],f=>{i=i.add(f.Zr)})}),PersistencePromise.resolve(this.ni(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let a=i;DocumentKey.isDocumentKey(a)||(a=a.child(""));const u=new __PRIVATE_DocReference(new DocumentKey(a),0);let f=new SortedSet(__PRIVATE_primitiveComparator);return this.Xr.forEachWhile(d=>{const p=d.key.path;return!!i.isPrefixOf(p)&&(p.length===o&&(f=f.add(d.Zr)),!0)},u),PersistencePromise.resolve(this.ni(f))}ni(e){const t=[];return e.forEach(i=>{const o=this.ei(i);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){__PRIVATE_hardAssert(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Xr;return PersistencePromise.forEach(t.mutations,o=>{const a=new __PRIVATE_DocReference(o.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=i})}sr(e){}containsKey(e,t){const i=new __PRIVATE_DocReference(t,0),o=this.Xr.firstAfterOrEqual(i);return PersistencePromise.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,PersistencePromise.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryRemoteDocumentCacheImpl{constructor(e){this.ii=e,this.docs=function(){return new SortedMap(DocumentKey.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),a=o?o.size:0,u=this.ii(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return PersistencePromise.resolve(i?i.document.mutableCopy():MutableDocument.newInvalidDocument(t))}getEntries(e,t){let i=__PRIVATE_mutableDocumentMap();return t.forEach(o=>{const a=this.docs.get(o);i=i.insert(o,a?a.document.mutableCopy():MutableDocument.newInvalidDocument(o))}),PersistencePromise.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let a=__PRIVATE_mutableDocumentMap();const u=t.path,f=new DocumentKey(u.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(f);for(;d.hasNext();){const{key:p,value:{document:_}}=d.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||__PRIVATE_indexOffsetComparator(__PRIVATE_newIndexOffsetFromDocument(_),i)<=0||(o.has(_.key)||__PRIVATE_queryMatches(t,_))&&(a=a.insert(_.key,_.mutableCopy()))}return PersistencePromise.resolve(a)}getAllFromCollectionGroup(e,t,i,o){fail(9500)}si(e,t){return PersistencePromise.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new __PRIVATE_MemoryRemoteDocumentChangeBuffer(this)}getSize(e){return PersistencePromise.resolve(this.size)}}class __PRIVATE_MemoryRemoteDocumentChangeBuffer extends RemoteDocumentChangeBuffer{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(i)}),PersistencePromise.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryTargetCache{constructor(e){this.persistence=e,this.oi=new ObjectMap(t=>__PRIVATE_canonifyTarget(t),__PRIVATE_targetEquals),this.lastRemoteSnapshotVersion=SnapshotVersion.min(),this.highestTargetId=0,this._i=0,this.ai=new __PRIVATE_ReferenceSet,this.targetCount=0,this.ui=__PRIVATE_TargetIdGenerator.cr()}forEachTarget(e,t){return this.oi.forEach((i,o)=>t(o)),PersistencePromise.resolve()}getLastRemoteSnapshotVersion(e){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return PersistencePromise.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),PersistencePromise.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this._i&&(this._i=t),PersistencePromise.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new __PRIVATE_TargetIdGenerator(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,PersistencePromise.resolve()}updateTargetData(e,t){return this.Tr(t),PersistencePromise.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,PersistencePromise.resolve()}removeTargets(e,t,i){let o=0;const a=[];return this.oi.forEach((u,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.oi.delete(u),a.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)}),PersistencePromise.waitFor(a).next(()=>o)}getTargetCount(e){return PersistencePromise.resolve(this.targetCount)}getTargetData(e,t){const i=this.oi.get(t)||null;return PersistencePromise.resolve(i)}addMatchingKeys(e,t,i){return this.ai.Gr(t,i),PersistencePromise.resolve()}removeMatchingKeys(e,t,i){this.ai.jr(t,i);const o=this.persistence.referenceDelegate,a=[];return o&&t.forEach(u=>{a.push(o.markPotentiallyOrphaned(e,u))}),PersistencePromise.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),PersistencePromise.resolve()}getMatchingKeysForTargetId(e,t){const i=this.ai.Yr(t);return PersistencePromise.resolve(i)}containsKey(e,t){return PersistencePromise.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryPersistence{constructor(e,t){this.ci={},this.overlays={},this.li=new __PRIVATE_ListenSequence(0),this.hi=!1,this.hi=!0,this.Pi=new __PRIVATE_MemoryGlobalsCache,this.referenceDelegate=e(this),this.Ti=new __PRIVATE_MemoryTargetCache(this),this.indexManager=new __PRIVATE_MemoryIndexManager,this.remoteDocumentCache=function(o){return new __PRIVATE_MemoryRemoteDocumentCacheImpl(o)}(i=>this.referenceDelegate.Ii(i)),this.serializer=new __PRIVATE_LocalSerializer(t),this.Ei=new __PRIVATE_MemoryBundleCache(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new __PRIVATE_MemoryDocumentOverlayCache,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ci[e.toKey()];return i||(i=new __PRIVATE_MemoryMutationQueue(t,this.referenceDelegate),this.ci[e.toKey()]=i),i}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,i){__PRIVATE_logDebug("MemoryPersistence","Starting transaction:",e);const o=new __PRIVATE_MemoryTransaction(this.li.next());return this.referenceDelegate.di(),i(o).next(a=>this.referenceDelegate.Ai(o).next(()=>a)).toPromise().then(a=>(o.raiseOnCommittedEvent(),a))}Ri(e,t){return PersistencePromise.or(Object.values(this.ci).map(i=>()=>i.containsKey(e,t)))}}class __PRIVATE_MemoryTransaction extends PersistenceTransaction{constructor(e){super(),this.currentSequenceNumber=e}}class __PRIVATE_MemoryEagerDelegate{constructor(e){this.persistence=e,this.Vi=new __PRIVATE_ReferenceSet,this.mi=null}static fi(e){return new __PRIVATE_MemoryEagerDelegate(e)}get gi(){if(this.mi)return this.mi;throw fail(60996)}addReference(e,t,i){return this.Vi.addReference(i,t),this.gi.delete(i.toString()),PersistencePromise.resolve()}removeReference(e,t,i){return this.Vi.removeReference(i,t),this.gi.add(i.toString()),PersistencePromise.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),PersistencePromise.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(a=>this.gi.add(a.toString()))}).next(()=>i.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.gi,i=>{const o=DocumentKey.fromPath(i);return this.pi(e,o).next(a=>{a||t.removeEntry(o,SnapshotVersion.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(i=>{i?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return PersistencePromise.or([()=>PersistencePromise.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class __PRIVATE_MemoryLruDelegate{constructor(e,t){this.persistence=e,this.yi=new ObjectMap(i=>__PRIVATE_encodeResourcePath(i.path),(i,o)=>i.isEqual(o)),this.garbageCollector=__PRIVATE_newLruGarbageCollector(this,t)}static fi(e,t){return new __PRIVATE_MemoryLruDelegate(e,t)}di(){}Ai(e){return PersistencePromise.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(o=>i+o))}br(e){let t=0;return this.yr(e,i=>{t++}).next(()=>t)}yr(e,t){return PersistencePromise.forEach(this.yi,(i,o)=>this.Dr(e,i,o).next(a=>a?PersistencePromise.resolve():t(o)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),a=o.newChangeBuffer();return o.si(e,u=>this.Dr(e,u,t).next(f=>{f||(i++,a.removeEntry(u,SnapshotVersion.min()))})).next(()=>a.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),PersistencePromise.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),PersistencePromise.resolve()}removeReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),PersistencePromise.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),PersistencePromise.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=__PRIVATE_estimateByteSize(e.data.value)),t}Dr(e,t,i){return PersistencePromise.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return PersistencePromise.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalViewChanges{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.ds=i,this.As=o}static Rs(e,t){let i=__PRIVATE_documentKeySet(),o=__PRIVATE_documentKeySet();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:o=o.add(a.doc.key)}return new __PRIVATE_LocalViewChanges(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryContext{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryEngine{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return isSafari()?8:__PRIVATE_getAndroidVersion(getUA())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,i,o){const a={result:null};return this.ws(e,t).next(u=>{a.result=u}).next(()=>{if(!a.result)return this.bs(e,t,o,i).next(u=>{a.result=u})}).next(()=>{if(a.result)return;const u=new QueryContext;return this.Ss(e,t,u).next(f=>{if(a.result=f,this.fs)return this.Ds(e,t,u,f.size)})}).next(()=>a.result)}Ds(e,t,i,o){return i.documentReadCount<this.gs?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","SDK will not create cache indexes for query:",__PRIVATE_stringifyQuery(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),PersistencePromise.resolve()):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Query:",__PRIVATE_stringifyQuery(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ps*o?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","The SDK decides to create cache indexes for query:",__PRIVATE_stringifyQuery(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,__PRIVATE_queryToTarget(t))):PersistencePromise.resolve())}ws(e,t){if(__PRIVATE_queryMatchesAllDocuments(t))return PersistencePromise.resolve(null);let i=__PRIVATE_queryToTarget(t);return this.indexManager.getIndexType(e,i).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=__PRIVATE_queryWithLimit(t,null,"F"),i=__PRIVATE_queryToTarget(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(a=>{const u=__PRIVATE_documentKeySet(...a);return this.ys.getDocuments(e,u).next(f=>this.indexManager.getMinOffset(e,i).next(d=>{const p=this.vs(t,f);return this.Cs(t,p,u,d.readTime)?this.ws(e,__PRIVATE_queryWithLimit(t,null,"F")):this.Fs(e,p,t,d)}))})))}bs(e,t,i,o){return __PRIVATE_queryMatchesAllDocuments(t)||o.isEqual(SnapshotVersion.min())?PersistencePromise.resolve(null):this.ys.getDocuments(e,i).next(a=>{const u=this.vs(t,a);return this.Cs(t,u,i,o)?PersistencePromise.resolve(null):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),__PRIVATE_stringifyQuery(t)),this.Fs(e,u,t,__PRIVATE_newIndexOffsetSuccessorFromReadTime(o,Q)).next(f=>f))})}vs(e,t){let i=new SortedSet(__PRIVATE_newQueryComparator(e));return t.forEach((o,a)=>{__PRIVATE_queryMatches(e,a)&&(i=i.add(a))}),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(o)>0)}Ss(e,t,i){return __PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Using full collection scan to execute query:",__PRIVATE_stringifyQuery(t)),this.ys.getDocumentsMatchingQuery(e,t,IndexOffset.min(),i)}Fs(e,t,i,o){return this.ys.getDocumentsMatchingQuery(e,i,o).next(a=>(t.forEach(u=>{a=a.insert(u.key,u)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="LocalStore",$t=3e8;class __PRIVATE_LocalStoreImpl{constructor(e,t,i,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new SortedMap(__PRIVATE_primitiveComparator),this.Os=new ObjectMap(a=>__PRIVATE_canonifyTarget(a),__PRIVATE_targetEquals),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(i)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LocalDocumentsView(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function __PRIVATE_newLocalStore(n,e,t,i){return new __PRIVATE_LocalStoreImpl(n,e,t,i)}async function __PRIVATE_localStoreHandleUserChange(n,e){const t=__PRIVATE_debugCast(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next(a=>(o=a,t.Ls(e),t.mutationQueue.getAllMutationBatches(i))).next(a=>{const u=[],f=[];let d=__PRIVATE_documentKeySet();for(const p of o){u.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}for(const p of a){f.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}return t.localDocuments.getDocuments(i,d).next(p=>({ks:p,removedBatchIds:u,addedBatchIds:f}))})})}function __PRIVATE_localStoreAcknowledgeBatch(n,e){const t=__PRIVATE_debugCast(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=e.batch.keys(),a=t.Bs.newChangeBuffer({trackRemovals:!0});return function(f,d,p,_){const R=p.batch,w=R.keys();let V=PersistencePromise.resolve();return w.forEach(U=>{V=V.next(()=>_.getEntry(d,U)).next(X=>{const b=p.docVersions.get(U);__PRIVATE_hardAssert(b!==null,48541),X.version.compareTo(b)<0&&(R.applyToRemoteDocument(X,p),X.isValidDocument()&&(X.setReadTime(p.commitVersion),_.addEntry(X)))})}),V.next(()=>f.mutationQueue.removeMutationBatch(d,R))}(t,i,e,a).next(()=>a.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(f){let d=__PRIVATE_documentKeySet();for(let p=0;p<f.mutationResults.length;++p)f.mutationResults[p].transformResults.length>0&&(d=d.add(f.batch.mutations[p].key));return d}(e))).next(()=>t.localDocuments.getDocuments(i,o))})}function __PRIVATE_localStoreGetLastRemoteSnapshotVersion(n){const e=__PRIVATE_debugCast(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function __PRIVATE_localStoreApplyRemoteEventToLocalCache(n,e){const t=__PRIVATE_debugCast(n),i=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const u=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const f=[];e.targetChanges.forEach((_,R)=>{const w=o.get(R);if(!w)return;f.push(t.Ti.removeMatchingKeys(a,_.removedDocuments,R).next(()=>t.Ti.addMatchingKeys(a,_.addedDocuments,R)));let V=w.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(R)!==null?V=V.withResumeToken(ByteString.EMPTY_BYTE_STRING,SnapshotVersion.min()).withLastLimboFreeSnapshotVersion(SnapshotVersion.min()):_.resumeToken.approximateByteSize()>0&&(V=V.withResumeToken(_.resumeToken,i)),o=o.insert(R,V),function(X,b,K){return X.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-X.snapshotVersion.toMicroseconds()>=$t?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0}(w,V,_)&&f.push(t.Ti.updateTargetData(a,V))});let d=__PRIVATE_mutableDocumentMap(),p=__PRIVATE_documentKeySet();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(a,_))}),f.push(__PRIVATE_populateDocumentChangeBuffer(a,u,e.documentUpdates).next(_=>{d=_.qs,p=_.Qs})),!i.isEqual(SnapshotVersion.min())){const _=t.Ti.getLastRemoteSnapshotVersion(a).next(R=>t.Ti.setTargetsMetadata(a,a.currentSequenceNumber,i));f.push(_)}return PersistencePromise.waitFor(f).next(()=>u.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,d,p)).next(()=>d)}).then(a=>(t.xs=o,a))}function __PRIVATE_populateDocumentChangeBuffer(n,e,t){let i=__PRIVATE_documentKeySet(),o=__PRIVATE_documentKeySet();return t.forEach(a=>i=i.add(a)),e.getEntries(n,i).next(a=>{let u=__PRIVATE_mutableDocumentMap();return t.forEach((f,d)=>{const p=a.get(f);d.isFoundDocument()!==p.isFoundDocument()&&(o=o.add(f)),d.isNoDocument()&&d.version.isEqual(SnapshotVersion.min())?(e.removeEntry(f,d.readTime),u=u.insert(f,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),u=u.insert(f,d)):__PRIVATE_logDebug(Qt,"Ignoring outdated watch update for ",f,". Current version:",p.version," Watch version:",d.version)}),{qs:u,Qs:o}})}function __PRIVATE_localStoreGetNextMutationBatch(n,e){const t=__PRIVATE_debugCast(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=G),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function __PRIVATE_localStoreAllocateTarget(n,e){const t=__PRIVATE_debugCast(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return t.Ti.getTargetData(i,e).next(a=>a?(o=a,PersistencePromise.resolve(o)):t.Ti.allocateTargetId(i).next(u=>(o=new TargetData(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.Ti.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=t.xs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(i.targetId,i),t.Os.set(e,i.targetId)),i})}async function __PRIVATE_localStoreReleaseTarget(n,e,t){const i=__PRIVATE_debugCast(n),o=i.xs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",a,u=>i.persistence.referenceDelegate.removeTarget(u,o))}catch(u){if(!__PRIVATE_isIndexedDbTransactionError(u))throw u;__PRIVATE_logDebug(Qt,`Failed to update sequence numbers for target ${e}: ${u}`)}i.xs=i.xs.remove(e),i.Os.delete(o.target)}function __PRIVATE_localStoreExecuteQuery(n,e,t){const i=__PRIVATE_debugCast(n);let o=SnapshotVersion.min(),a=__PRIVATE_documentKeySet();return i.persistence.runTransaction("Execute query","readwrite",u=>function(d,p,_){const R=__PRIVATE_debugCast(d),w=R.Os.get(_);return w!==void 0?PersistencePromise.resolve(R.xs.get(w)):R.Ti.getTargetData(p,_)}(i,u,__PRIVATE_queryToTarget(e)).next(f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,i.Ti.getMatchingKeysForTargetId(u,f.targetId).next(d=>{a=d})}).next(()=>i.Ms.getDocumentsMatchingQuery(u,e,t?o:SnapshotVersion.min(),t?a:__PRIVATE_documentKeySet())).next(f=>(__PRIVATE_setMaxReadTime(i,__PRIVATE_queryCollectionGroup(e),f),{documents:f,$s:a})))}function __PRIVATE_setMaxReadTime(n,e,t){let i=n.Ns.get(e)||SnapshotVersion.min();t.forEach((o,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)}),n.Ns.set(e,i)}class __PRIVATE_LocalClientState{constructor(){this.activeTargetIds=__PRIVATE_targetIdSet()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class __PRIVATE_MemorySharedClientState{constructor(){this.xo=new __PRIVATE_LocalClientState,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,i){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new __PRIVATE_LocalClientState,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_NoopConnectivityMonitor{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zt="ConnectivityMonitor";class __PRIVATE_BrowserConnectivityMonitor{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){__PRIVATE_logDebug(zt,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){__PRIVATE_logDebug(zt,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jt=null;function __PRIVATE_generateUniqueDebugId(){return jt===null?jt=function(){return 268435456+Math.round(2147483648*Math.random())}():jt++,"0x"+jt.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ht="RestConnection",Jt={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class __PRIVATE_RestConnection{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${i}/databases/${o}`,this.Go=this.databaseId.database===ut?`project_id=${i}`:`project_id=${i}&database_id=${o}`}zo(e,t,i,o,a){const u=__PRIVATE_generateUniqueDebugId(),f=this.jo(e,t.toUriEncodedString());__PRIVATE_logDebug(Ht,`Sending RPC '${e}' ${u}:`,f,i);const d={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(d,o,a);const{host:p}=new URL(f),_=isCloudWorkstation(p);return this.Jo(e,f,d,i,_).then(R=>(__PRIVATE_logDebug(Ht,`Received RPC '${e}' ${u}: `,R),R),R=>{throw __PRIVATE_logWarn(Ht,`RPC '${e}' ${u} failed with error: `,R,"url: ",f,"request:",i),R})}Yo(e,t,i,o,a,u){return this.zo(e,t,i,o,a)}Ho(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+x}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,a)=>e[a]=o),i&&i.headers.forEach((o,a)=>e[a]=o)}jo(e,t){const i=Jt[e];return`${this.Ko}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_StreamBridge{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class __PRIVATE_WebChannelConnection extends __PRIVATE_RestConnection{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,a){const u=__PRIVATE_generateUniqueDebugId();return new Promise((f,d)=>{const p=new XhrIo;p.setWithCredentials(!0),p.listenOnce(EventType.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case ErrorCode.NO_ERROR:const R=p.getResponseJson();__PRIVATE_logDebug(Yt,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(R)),f(R);break;case ErrorCode.TIMEOUT:__PRIVATE_logDebug(Yt,`RPC '${e}' ${u} timed out`),d(new FirestoreError(N.DEADLINE_EXCEEDED,"Request time out"));break;case ErrorCode.HTTP_ERROR:const w=p.getStatus();if(__PRIVATE_logDebug(Yt,`RPC '${e}' ${u} failed with status:`,w,"response text:",p.getResponseText()),w>0){let V=p.getResponseJson();Array.isArray(V)&&(V=V[0]);const U=V==null?void 0:V.error;if(U&&U.status&&U.message){const X=function(K){const Z=K.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(Z)>=0?Z:N.UNKNOWN}(U.status);d(new FirestoreError(X,U.message))}else d(new FirestoreError(N.UNKNOWN,"Server responded with status "+p.getStatus()))}else d(new FirestoreError(N.UNAVAILABLE,"Connection failed."));break;default:fail(9055,{h_:e,streamId:u,P_:p.getLastErrorCode(),T_:p.getLastError()})}}finally{__PRIVATE_logDebug(Yt,`RPC '${e}' ${u} completed.`)}});const _=JSON.stringify(o);__PRIVATE_logDebug(Yt,`RPC '${e}' ${u} sending request:`,o),p.send(t,"POST",_,i,15)})}I_(e,t,i){const o=__PRIVATE_generateUniqueDebugId(),a=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=createWebChannelTransport(),f=getStatEventTarget(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Ho(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const _=a.join("");__PRIVATE_logDebug(Yt,`Creating RPC '${e}' stream ${o}: ${_}`,d);const R=u.createWebChannel(_,d);this.E_(R);let w=!1,V=!1;const U=new __PRIVATE_StreamBridge({Zo:b=>{V?__PRIVATE_logDebug(Yt,`Not sending because RPC '${e}' stream ${o} is closed:`,b):(w||(__PRIVATE_logDebug(Yt,`Opening RPC '${e}' stream ${o} transport.`),R.open(),w=!0),__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${o} sending:`,b),R.send(b))},Xo:()=>R.close()}),X=(b,K,Z)=>{b.listen(K,oe=>{try{Z(oe)}catch(te){setTimeout(()=>{throw te},0)}})};return X(R,WebChannel.EventType.OPEN,()=>{V||(__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${o} transport opened.`),U.__())}),X(R,WebChannel.EventType.CLOSE,()=>{V||(V=!0,__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${o} transport closed`),U.u_(),this.d_(R))}),X(R,WebChannel.EventType.ERROR,b=>{V||(V=!0,__PRIVATE_logWarn(Yt,`RPC '${e}' stream ${o} transport errored. Name:`,b.name,"Message:",b.message),U.u_(new FirestoreError(N.UNAVAILABLE,"The operation could not be completed")))}),X(R,WebChannel.EventType.MESSAGE,b=>{var K;if(!V){const Z=b.data[0];__PRIVATE_hardAssert(!!Z,16349);const oe=Z,te=(oe==null?void 0:oe.error)||((K=oe[0])===null||K===void 0?void 0:K.error);if(te){__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${o} received error:`,te);const H=te.status;let J=function(E){const W=ft[E];if(W!==void 0)return __PRIVATE_mapCodeFromRpcCode(W)}(H),y=te.message;J===void 0&&(J=N.INTERNAL,y="Unknown error status: "+H+" with message "+te.message),V=!0,U.u_(new FirestoreError(J,y)),R.close()}else __PRIVATE_logDebug(Yt,`RPC '${e}' stream ${o} received:`,Z),U.c_(Z)}}),X(f,Event$1.STAT_EVENT,b=>{b.stat===Stat.PROXY?__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${o} detected buffering proxy`):b.stat===Stat.NOPROXY&&__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{U.a_()},0),U}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function getDocument(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newSerializer(n){return new JsonProtoSerializer(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ExponentialBackoff{constructor(e,t,i=1e3,o=1.5,a=6e4){this.xi=e,this.timerId=t,this.A_=i,this.R_=o,this.V_=a,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),i=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-i);o>0&&__PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="PersistentStream";class __PRIVATE_PersistentStream{constructor(e,t,i,o,a,u,f,d){this.xi=e,this.S_=i,this.D_=o,this.connection=a,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=d,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new __PRIVATE_ExponentialBackoff(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(__PRIVATE_logError(t.toString()),__PRIVATE_logError("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.v_===t&&this.z_(i,o)},i=>{e(()=>{const o=new FirestoreError(N.UNKNOWN,"Fetching auth token failed: "+i.message);return this.j_(o)})})}z_(e,t){const i=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{i(()=>this.listener.e_())}),this.stream.n_(()=>{i(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{i(()=>this.j_(o))}),this.stream.onMessage(o=>{i(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return __PRIVATE_logDebug(Zt,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(__PRIVATE_logDebug(Zt,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class __PRIVATE_PersistentListenStream extends __PRIVATE_PersistentStream{constructor(e,t,i,o,a,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,u),this.serializer=a}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=__PRIVATE_fromWatchChange(this.serializer,e),i=function(a){if(!("targetChange"in a))return SnapshotVersion.min();const u=a.targetChange;return u.targetIds&&u.targetIds.length?SnapshotVersion.min():u.readTime?__PRIVATE_fromVersion(u.readTime):SnapshotVersion.min()}(e);return this.listener.Y_(t,i)}Z_(e){const t={};t.database=__PRIVATE_getEncodedDatabaseId(this.serializer),t.addTarget=function(a,u){let f;const d=u.target;if(f=__PRIVATE_targetIsDocumentTarget(d)?{documents:__PRIVATE_toDocumentsTarget(a,d)}:{query:__PRIVATE_toQueryTarget(a,d).gt},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=__PRIVATE_toBytes(a,u.resumeToken);const p=__PRIVATE_toInt32Proto(a,u.expectedCount);p!==null&&(f.expectedCount=p)}else if(u.snapshotVersion.compareTo(SnapshotVersion.min())>0){f.readTime=toTimestamp(a,u.snapshotVersion.toTimestamp());const p=__PRIVATE_toInt32Proto(a,u.expectedCount);p!==null&&(f.expectedCount=p)}return f}(this.serializer,e);const i=__PRIVATE_toListenRequestLabels(this.serializer,e);i&&(t.labels=i),this.Q_(t)}X_(e){const t={};t.database=__PRIVATE_getEncodedDatabaseId(this.serializer),t.removeTarget=e,this.Q_(t)}}class __PRIVATE_PersistentWriteStream extends __PRIVATE_PersistentStream{constructor(e,t,i,o,a,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,u),this.serializer=a}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return __PRIVATE_hardAssert(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,__PRIVATE_hardAssert(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){__PRIVATE_hardAssert(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=__PRIVATE_fromWriteResults(e.writeResults,e.commitTime),i=__PRIVATE_fromVersion(e.commitTime);return this.listener.ra(i,t)}ia(){const e={};e.database=__PRIVATE_getEncodedDatabaseId(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>toMutation(this.serializer,i))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Datastore{}class __PRIVATE_DatastoreImpl extends Datastore{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new FirestoreError(N.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,i,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.zo(e,__PRIVATE_toResourcePath(t,i),o,a,u)).catch(a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new FirestoreError(N.UNKNOWN,a.toString())})}Yo(e,t,i,o,a){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,f])=>this.connection.Yo(e,__PRIVATE_toResourcePath(t,i),o,u,f,a)).catch(u=>{throw u.name==="FirebaseError"?(u.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new FirestoreError(N.UNKNOWN,u.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class __PRIVATE_OnlineStateTracker{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(__PRIVATE_logError(t),this.ua=!1):__PRIVATE_logDebug("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="RemoteStore";class __PRIVATE_RemoteStoreImpl{constructor(e,t,i,o,a){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=a,this.Ra.No(u=>{i.enqueueAndForget(async()=>{__PRIVATE_canUseNetwork(this)&&(__PRIVATE_logDebug(Xt,"Restarting streams for network reachability change."),await async function(d){const p=__PRIVATE_debugCast(d);p.da.add(4),await __PRIVATE_disableNetworkInternal(p),p.Va.set("Unknown"),p.da.delete(4),await __PRIVATE_enableNetworkInternal(p)}(this))})}),this.Va=new __PRIVATE_OnlineStateTracker(i,o)}}async function __PRIVATE_enableNetworkInternal(n){if(__PRIVATE_canUseNetwork(n))for(const e of n.Aa)await e(!0)}async function __PRIVATE_disableNetworkInternal(n){for(const e of n.Aa)await e(!1)}function __PRIVATE_remoteStoreListen(n,e){const t=__PRIVATE_debugCast(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),__PRIVATE_shouldStartWatchStream(t)?__PRIVATE_startWatchStream(t):__PRIVATE_ensureWatchStream(t).N_()&&__PRIVATE_sendWatchRequest(t,e))}function __PRIVATE_remoteStoreUnlisten(n,e){const t=__PRIVATE_debugCast(n),i=__PRIVATE_ensureWatchStream(t);t.Ea.delete(e),i.N_()&&__PRIVATE_sendUnwatchRequest(t,e),t.Ea.size===0&&(i.N_()?i.k_():__PRIVATE_canUseNetwork(t)&&t.Va.set("Unknown"))}function __PRIVATE_sendWatchRequest(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(SnapshotVersion.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}__PRIVATE_ensureWatchStream(n).Z_(e)}function __PRIVATE_sendUnwatchRequest(n,e){n.ma.Ke(e),__PRIVATE_ensureWatchStream(n).X_(e)}function __PRIVATE_startWatchStream(n){n.ma=new __PRIVATE_WatchChangeAggregator({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),__PRIVATE_ensureWatchStream(n).start(),n.Va.ca()}function __PRIVATE_shouldStartWatchStream(n){return __PRIVATE_canUseNetwork(n)&&!__PRIVATE_ensureWatchStream(n).O_()&&n.Ea.size>0}function __PRIVATE_canUseNetwork(n){return __PRIVATE_debugCast(n).da.size===0}function __PRIVATE_cleanUpWatchStreamState(n){n.ma=void 0}async function __PRIVATE_onWatchStreamConnected(n){n.Va.set("Online")}async function __PRIVATE_onWatchStreamOpen(n){n.Ea.forEach((e,t)=>{__PRIVATE_sendWatchRequest(n,e)})}async function __PRIVATE_onWatchStreamClose(n,e){__PRIVATE_cleanUpWatchStreamState(n),__PRIVATE_shouldStartWatchStream(n)?(n.Va.Pa(e),__PRIVATE_startWatchStream(n)):n.Va.set("Unknown")}async function __PRIVATE_onWatchStreamChange(n,e,t){if(n.Va.set("Online"),e instanceof __PRIVATE_WatchTargetChange&&e.state===2&&e.cause)try{await async function(o,a){const u=a.cause;for(const f of a.targetIds)o.Ea.has(f)&&(await o.remoteSyncer.rejectListen(f,u),o.Ea.delete(f),o.ma.removeTarget(f))}(n,e)}catch(i){__PRIVATE_logDebug(Xt,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await __PRIVATE_disableNetworkUntilRecovery(n,i)}else if(e instanceof __PRIVATE_DocumentWatchChange?n.ma.Xe(e):e instanceof __PRIVATE_ExistenceFilterChange?n.ma.ot(e):n.ma.nt(e),!t.isEqual(SnapshotVersion.min()))try{const i=await __PRIVATE_localStoreGetLastRemoteSnapshotVersion(n.localStore);t.compareTo(i)>=0&&await function(a,u){const f=a.ma.It(u);return f.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const _=a.Ea.get(p);_&&a.Ea.set(p,_.withResumeToken(d.resumeToken,u))}}),f.targetMismatches.forEach((d,p)=>{const _=a.Ea.get(d);if(!_)return;a.Ea.set(d,_.withResumeToken(ByteString.EMPTY_BYTE_STRING,_.snapshotVersion)),__PRIVATE_sendUnwatchRequest(a,d);const R=new TargetData(_.target,d,p,_.sequenceNumber);__PRIVATE_sendWatchRequest(a,R)}),a.remoteSyncer.applyRemoteEvent(f)}(n,t)}catch(i){__PRIVATE_logDebug(Xt,"Failed to raise snapshot:",i),await __PRIVATE_disableNetworkUntilRecovery(n,i)}}async function __PRIVATE_disableNetworkUntilRecovery(n,e,t){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;n.da.add(1),await __PRIVATE_disableNetworkInternal(n),n.Va.set("Offline"),t||(t=()=>__PRIVATE_localStoreGetLastRemoteSnapshotVersion(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{__PRIVATE_logDebug(Xt,"Retrying IndexedDB access"),await t(),n.da.delete(1),await __PRIVATE_enableNetworkInternal(n)})}function __PRIVATE_executeWithRecovery(n,e){return e().catch(t=>__PRIVATE_disableNetworkUntilRecovery(n,t,e))}async function __PRIVATE_fillWritePipeline(n){const e=__PRIVATE_debugCast(n),t=__PRIVATE_ensureWriteStream(e);let i=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:G;for(;__PRIVATE_canAddToWritePipeline(e);)try{const o=await __PRIVATE_localStoreGetNextMutationBatch(e.localStore,i);if(o===null){e.Ia.length===0&&t.k_();break}i=o.batchId,__PRIVATE_addToWritePipeline(e,o)}catch(o){await __PRIVATE_disableNetworkUntilRecovery(e,o)}__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}function __PRIVATE_canAddToWritePipeline(n){return __PRIVATE_canUseNetwork(n)&&n.Ia.length<10}function __PRIVATE_addToWritePipeline(n,e){n.Ia.push(e);const t=__PRIVATE_ensureWriteStream(n);t.N_()&&t.ea&&t.ta(e.mutations)}function __PRIVATE_shouldStartWriteStream(n){return __PRIVATE_canUseNetwork(n)&&!__PRIVATE_ensureWriteStream(n).O_()&&n.Ia.length>0}function __PRIVATE_startWriteStream(n){__PRIVATE_ensureWriteStream(n).start()}async function __PRIVATE_onWriteStreamOpen(n){__PRIVATE_ensureWriteStream(n).ia()}async function __PRIVATE_onWriteHandshakeComplete(n){const e=__PRIVATE_ensureWriteStream(n);for(const t of n.Ia)e.ta(t.mutations)}async function __PRIVATE_onMutationResult(n,e,t){const i=n.Ia.shift(),o=MutationBatchResult.from(i,e,t);await __PRIVATE_executeWithRecovery(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await __PRIVATE_fillWritePipeline(n)}async function __PRIVATE_onWriteStreamClose(n,e){e&&__PRIVATE_ensureWriteStream(n).ea&&await async function(i,o){if(function(u){return __PRIVATE_isPermanentError(u)&&u!==N.ABORTED}(o.code)){const a=i.Ia.shift();__PRIVATE_ensureWriteStream(i).L_(),await __PRIVATE_executeWithRecovery(i,()=>i.remoteSyncer.rejectFailedWrite(a.batchId,o)),await __PRIVATE_fillWritePipeline(i)}}(n,e),__PRIVATE_shouldStartWriteStream(n)&&__PRIVATE_startWriteStream(n)}async function __PRIVATE_remoteStoreHandleCredentialChange(n,e){const t=__PRIVATE_debugCast(n);t.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(Xt,"RemoteStore received new credentials");const i=__PRIVATE_canUseNetwork(t);t.da.add(3),await __PRIVATE_disableNetworkInternal(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await __PRIVATE_enableNetworkInternal(t)}async function __PRIVATE_remoteStoreApplyPrimaryState(n,e){const t=__PRIVATE_debugCast(n);e?(t.da.delete(2),await __PRIVATE_enableNetworkInternal(t)):e||(t.da.add(2),await __PRIVATE_disableNetworkInternal(t),t.Va.set("Unknown"))}function __PRIVATE_ensureWatchStream(n){return n.fa||(n.fa=function(t,i,o){const a=__PRIVATE_debugCast(t);return a.oa(),new __PRIVATE_PersistentListenStream(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{e_:__PRIVATE_onWatchStreamConnected.bind(null,n),n_:__PRIVATE_onWatchStreamOpen.bind(null,n),i_:__PRIVATE_onWatchStreamClose.bind(null,n),Y_:__PRIVATE_onWatchStreamChange.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),__PRIVATE_shouldStartWatchStream(n)?__PRIVATE_startWatchStream(n):n.Va.set("Unknown")):(await n.fa.stop(),__PRIVATE_cleanUpWatchStreamState(n))})),n.fa}function __PRIVATE_ensureWriteStream(n){return n.ga||(n.ga=function(t,i,o){const a=__PRIVATE_debugCast(t);return a.oa(),new __PRIVATE_PersistentWriteStream(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:__PRIVATE_onWriteStreamOpen.bind(null,n),i_:__PRIVATE_onWriteStreamClose.bind(null,n),na:__PRIVATE_onWriteHandshakeComplete.bind(null,n),ra:__PRIVATE_onMutationResult.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await __PRIVATE_fillWritePipeline(n)):(await n.ga.stop(),n.Ia.length>0&&(__PRIVATE_logDebug(Xt,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DelayedOperation{constructor(e,t,i,o,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=a,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,a){const u=Date.now()+i,f=new DelayedOperation(e,t,u,o,a);return f.start(i),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function __PRIVATE_wrapInUserErrorIfRecoverable(n,e){if(__PRIVATE_logError("AsyncQueue",`${e}: ${n}`),__PRIVATE_isIndexedDbTransactionError(n))return new FirestoreError(N.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSet{static emptySet(e){return new DocumentSet(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||DocumentKey.comparator(t.key,i.key):(t,i)=>DocumentKey.comparator(t.key,i.key),this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof DocumentSet)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=i.getNext().key;if(!o.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new DocumentSet;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentChangeSet{constructor(){this.pa=new SortedMap(DocumentKey.comparator)}track(e){const t=e.doc.key,i=this.pa.get(t);i?e.type!==0&&i.type===3?this.pa=this.pa.insert(t,e):e.type===3&&i.type!==1?this.pa=this.pa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.pa=this.pa.remove(t):e.type===1&&i.type===2?this.pa=this.pa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):fail(63341,{Vt:e,ya:i}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,i)=>{e.push(i)}),e}}class ViewSnapshot{constructor(e,t,i,o,a,u,f,d,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=a,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,o,a){const u=[];return t.forEach(f=>{u.push({type:0,doc:f})}),new ViewSnapshot(e,t,DocumentSet.emptySet(t),u,i,o,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&__PRIVATE_queryEquals(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryListenersInfo{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class __PRIVATE_EventManagerImpl{constructor(){this.queries=__PRIVATE_newQueriesObjectMap(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=__PRIVATE_debugCast(t),a=o.queries;o.queries=__PRIVATE_newQueriesObjectMap(),a.forEach((u,f)=>{for(const d of f.Sa)d.onError(i)})})(this,new FirestoreError(N.ABORTED,"Firestore shutting down"))}}function __PRIVATE_newQueriesObjectMap(){return new ObjectMap(n=>__PRIVATE_canonifyQuery(n),__PRIVATE_queryEquals)}async function __PRIVATE_eventManagerListen(n,e){const t=__PRIVATE_debugCast(n);let i=3;const o=e.query;let a=t.queries.get(o);a?!a.Da()&&e.va()&&(i=2):(a=new __PRIVATE_QueryListenersInfo,i=e.va()?0:1);try{switch(i){case 0:a.ba=await t.onListen(o,!0);break;case 1:a.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const f=__PRIVATE_wrapInUserErrorIfRecoverable(u,`Initialization of query '${__PRIVATE_stringifyQuery(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,a),a.Sa.push(e),e.Fa(t.onlineState),a.ba&&e.Ma(a.ba)&&__PRIVATE_raiseSnapshotsInSyncEvent(t)}async function __PRIVATE_eventManagerUnlisten(n,e){const t=__PRIVATE_debugCast(n),i=e.query;let o=3;const a=t.queries.get(i);if(a){const u=a.Sa.indexOf(e);u>=0&&(a.Sa.splice(u,1),a.Sa.length===0?o=e.va()?0:1:!a.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function __PRIVATE_eventManagerOnWatchChange(n,e){const t=__PRIVATE_debugCast(n);let i=!1;for(const o of e){const a=o.query,u=t.queries.get(a);if(u){for(const f of u.Sa)f.Ma(o)&&(i=!0);u.ba=o}}i&&__PRIVATE_raiseSnapshotsInSyncEvent(t)}function __PRIVATE_eventManagerOnWatchError(n,e,t){const i=__PRIVATE_debugCast(n),o=i.queries.get(e);if(o)for(const a of o.Sa)a.onError(t);i.queries.delete(e)}function __PRIVATE_raiseSnapshotsInSyncEvent(n){n.Ca.forEach(e=>{e.next()})}var en,tn;(tn=en||(en={})).xa="default",tn.Cache="cache";class __PRIVATE_QueryListener{constructor(e,t,i){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=i||{}}Ma(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new ViewSnapshot(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const i=t!=="Offline";return(!this.options.Qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=ViewSnapshot.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==en.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AddedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_RemovedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_View{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=__PRIVATE_documentKeySet(),this.mutatedKeys=__PRIVATE_documentKeySet(),this.Za=__PRIVATE_newQueryComparator(e),this.Xa=new DocumentSet(this.Za)}get eu(){return this.Ha}tu(e,t){const i=t?t.nu:new __PRIVATE_DocumentChangeSet,o=t?t.Xa:this.Xa;let a=t?t.mutatedKeys:this.mutatedKeys,u=o,f=!1;const d=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,p=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,R)=>{const w=o.get(_),V=__PRIVATE_queryMatches(this.query,R)?R:null,U=!!w&&this.mutatedKeys.has(w.key),X=!!V&&(V.hasLocalMutations||this.mutatedKeys.has(V.key)&&V.hasCommittedMutations);let b=!1;w&&V?w.data.isEqual(V.data)?U!==X&&(i.track({type:3,doc:V}),b=!0):this.ru(w,V)||(i.track({type:2,doc:V}),b=!0,(d&&this.Za(V,d)>0||p&&this.Za(V,p)<0)&&(f=!0)):!w&&V?(i.track({type:0,doc:V}),b=!0):w&&!V&&(i.track({type:1,doc:w}),b=!0,(d||p)&&(f=!0)),b&&(V?(u=u.add(V),a=X?a.add(_):a.delete(_)):(u=u.delete(_),a=a.delete(_)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),a=a.delete(_.key),i.track({type:1,doc:_})}return{Xa:u,nu:i,Cs:f,mutatedKeys:a}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const a=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const u=e.nu.wa();u.sort((_,R)=>function(V,U){const X=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fail(20277,{Vt:b})}};return X(V)-X(U)}(_.type,R.type)||this.Za(_.doc,R.doc)),this.iu(i),o=o!=null&&o;const f=t&&!o?this.su():[],d=this.Ya.size===0&&this.current&&!o?1:0,p=d!==this.Ja;return this.Ja=d,u.length!==0||p?{snapshot:new ViewSnapshot(this.query,e.Xa,a,u,e.mutatedKeys,d===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),ou:f}:{ou:f}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new __PRIVATE_DocumentChangeSet,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=__PRIVATE_documentKeySet(),this.Xa.forEach(i=>{this._u(i.key)&&(this.Ya=this.Ya.add(i.key))});const t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new __PRIVATE_RemovedLimboDocument(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new __PRIVATE_AddedLimboDocument(i))}),t}au(e){this.Ha=e.$s,this.Ya=__PRIVATE_documentKeySet();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return ViewSnapshot.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const nn="SyncEngine";class __PRIVATE_QueryView{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class LimboResolution{constructor(e){this.key=e,this.cu=!1}}class __PRIVATE_SyncEngineImpl{constructor(e,t,i,o,a,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.lu={},this.hu=new ObjectMap(f=>__PRIVATE_canonifyQuery(f),__PRIVATE_queryEquals),this.Pu=new Map,this.Tu=new Set,this.Iu=new SortedMap(DocumentKey.comparator),this.Eu=new Map,this.du=new __PRIVATE_ReferenceSet,this.Au={},this.Ru=new Map,this.Vu=__PRIVATE_TargetIdGenerator.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function __PRIVATE_syncEngineListen(n,e,t=!0){const i=__PRIVATE_ensureWatchCallbacks(n);let o;const a=i.hu.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),o=a.view.uu()):o=await __PRIVATE_allocateTargetAndMaybeListen(i,e,t,!0),o}async function __PRIVATE_triggerRemoteStoreListen(n,e){const t=__PRIVATE_ensureWatchCallbacks(n);await __PRIVATE_allocateTargetAndMaybeListen(t,e,!0,!1)}async function __PRIVATE_allocateTargetAndMaybeListen(n,e,t,i){const o=await __PRIVATE_localStoreAllocateTarget(n.localStore,__PRIVATE_queryToTarget(e)),a=o.targetId,u=n.sharedClientState.addLocalQueryTarget(a,t);let f;return i&&(f=await __PRIVATE_initializeViewAndComputeSnapshot(n,e,a,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&__PRIVATE_remoteStoreListen(n.remoteStore,o),f}async function __PRIVATE_initializeViewAndComputeSnapshot(n,e,t,i,o){n.fu=(R,w,V)=>async function(X,b,K,Z){let oe=b.view.tu(K);oe.Cs&&(oe=await __PRIVATE_localStoreExecuteQuery(X.localStore,b.query,!1).then(({documents:y})=>b.view.tu(y,oe)));const te=Z&&Z.targetChanges.get(b.targetId),H=Z&&Z.targetMismatches.get(b.targetId)!=null,J=b.view.applyChanges(oe,X.isPrimaryClient,te,H);return __PRIVATE_updateTrackedLimbos(X,b.targetId,J.ou),J.snapshot}(n,R,w,V);const a=await __PRIVATE_localStoreExecuteQuery(n.localStore,e,!0),u=new __PRIVATE_View(e,a.$s),f=u.tu(a.documents),d=TargetChange.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),p=u.applyChanges(f,n.isPrimaryClient,d);__PRIVATE_updateTrackedLimbos(n,t,p.ou);const _=new __PRIVATE_QueryView(e,t,u);return n.hu.set(e,_),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),p.snapshot}async function __PRIVATE_syncEngineUnlisten(n,e,t){const i=__PRIVATE_debugCast(n),o=i.hu.get(e),a=i.Pu.get(o.targetId);if(a.length>1)return i.Pu.set(o.targetId,a.filter(u=>!__PRIVATE_queryEquals(u,e))),void i.hu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await __PRIVATE_localStoreReleaseTarget(i.localStore,o.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(o.targetId),t&&__PRIVATE_remoteStoreUnlisten(i.remoteStore,o.targetId),__PRIVATE_removeAndCleanupTarget(i,o.targetId)}).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)):(__PRIVATE_removeAndCleanupTarget(i,o.targetId),await __PRIVATE_localStoreReleaseTarget(i.localStore,o.targetId,!0))}async function __PRIVATE_triggerRemoteStoreUnlisten(n,e){const t=__PRIVATE_debugCast(n),i=t.hu.get(e),o=t.Pu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),__PRIVATE_remoteStoreUnlisten(t.remoteStore,i.targetId))}async function __PRIVATE_syncEngineWrite(n,e,t){const i=__PRIVATE_syncEngineEnsureWriteCallbacks(n);try{const o=await function(u,f){const d=__PRIVATE_debugCast(u),p=Timestamp.now(),_=f.reduce((V,U)=>V.add(U.key),__PRIVATE_documentKeySet());let R,w;return d.persistence.runTransaction("Locally write mutations","readwrite",V=>{let U=__PRIVATE_mutableDocumentMap(),X=__PRIVATE_documentKeySet();return d.Bs.getEntries(V,_).next(b=>{U=b,U.forEach((K,Z)=>{Z.isValidDocument()||(X=X.add(K))})}).next(()=>d.localDocuments.getOverlayedDocuments(V,U)).next(b=>{R=b;const K=[];for(const Z of f){const oe=__PRIVATE_mutationExtractBaseValue(Z,R.get(Z.key).overlayedDocument);oe!=null&&K.push(new __PRIVATE_PatchMutation(Z.key,oe,__PRIVATE_extractFieldMask(oe.value.mapValue),Precondition.exists(!0)))}return d.mutationQueue.addMutationBatch(V,p,K,f)}).next(b=>{w=b;const K=b.applyToLocalDocumentSet(R,X);return d.documentOverlayCache.saveOverlays(V,b.batchId,K)})}).then(()=>({batchId:w.batchId,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(R)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),function(u,f,d){let p=u.Au[u.currentUser.toKey()];p||(p=new SortedMap(__PRIVATE_primitiveComparator)),p=p.insert(f,d),u.Au[u.currentUser.toKey()]=p}(i,o.batchId,t),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(i,o.changes),await __PRIVATE_fillWritePipeline(i.remoteStore)}catch(o){const a=__PRIVATE_wrapInUserErrorIfRecoverable(o,"Failed to persist write");t.reject(a)}}async function __PRIVATE_syncEngineApplyRemoteEvent(n,e){const t=__PRIVATE_debugCast(n);try{const i=await __PRIVATE_localStoreApplyRemoteEventToLocalCache(t.localStore,e);e.targetChanges.forEach((o,a)=>{const u=t.Eu.get(a);u&&(__PRIVATE_hardAssert(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.cu=!0:o.modifiedDocuments.size>0?__PRIVATE_hardAssert(u.cu,14607):o.removedDocuments.size>0&&(__PRIVATE_hardAssert(u.cu,42227),u.cu=!1))}),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(t,i,e)}catch(i){await __PRIVATE_ignoreIfPrimaryLeaseLoss(i)}}function __PRIVATE_syncEngineApplyOnlineStateChange(n,e,t){const i=__PRIVATE_debugCast(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.hu.forEach((a,u)=>{const f=u.view.Fa(e);f.snapshot&&o.push(f.snapshot)}),function(u,f){const d=__PRIVATE_debugCast(u);d.onlineState=f;let p=!1;d.queries.forEach((_,R)=>{for(const w of R.Sa)w.Fa(f)&&(p=!0)}),p&&__PRIVATE_raiseSnapshotsInSyncEvent(d)}(i.eventManager,e),o.length&&i.lu.Y_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function __PRIVATE_syncEngineRejectListen(n,e,t){const i=__PRIVATE_debugCast(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Eu.get(e),a=o&&o.key;if(a){let u=new SortedMap(DocumentKey.comparator);u=u.insert(a,MutableDocument.newNoDocument(a,SnapshotVersion.min()));const f=__PRIVATE_documentKeySet().add(a),d=new RemoteEvent(SnapshotVersion.min(),new Map,new SortedMap(__PRIVATE_primitiveComparator),u,f);await __PRIVATE_syncEngineApplyRemoteEvent(i,d),i.Iu=i.Iu.remove(a),i.Eu.delete(e),__PRIVATE_pumpEnqueuedLimboResolutions(i)}else await __PRIVATE_localStoreReleaseTarget(i.localStore,e,!1).then(()=>__PRIVATE_removeAndCleanupTarget(i,e,t)).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)}async function __PRIVATE_syncEngineApplySuccessfulWrite(n,e){const t=__PRIVATE_debugCast(n),i=e.batch.batchId;try{const o=await __PRIVATE_localStoreAcknowledgeBatch(t.localStore,e);__PRIVATE_processUserCallback(t,i,null),__PRIVATE_triggerPendingWritesCallbacks(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(t,o)}catch(o){await __PRIVATE_ignoreIfPrimaryLeaseLoss(o)}}async function __PRIVATE_syncEngineRejectFailedWrite(n,e,t){const i=__PRIVATE_debugCast(n);try{const o=await function(u,f){const d=__PRIVATE_debugCast(u);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let _;return d.mutationQueue.lookupMutationBatch(p,f).next(R=>(__PRIVATE_hardAssert(R!==null,37113),_=R.keys(),d.mutationQueue.removeMutationBatch(p,R))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,_,f)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_)).next(()=>d.localDocuments.getDocuments(p,_))})}(i.localStore,e);__PRIVATE_processUserCallback(i,e,t),__PRIVATE_triggerPendingWritesCallbacks(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(i,o)}catch(o){await __PRIVATE_ignoreIfPrimaryLeaseLoss(o)}}function __PRIVATE_triggerPendingWritesCallbacks(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function __PRIVATE_processUserCallback(n,e,t){const i=__PRIVATE_debugCast(n);let o=i.Au[i.currentUser.toKey()];if(o){const a=o.get(e);a&&(t?a.reject(t):a.resolve(),o=o.remove(e)),i.Au[i.currentUser.toKey()]=o}}function __PRIVATE_removeAndCleanupTarget(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Pu.get(e))n.hu.delete(i),t&&n.lu.gu(i,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(i=>{n.du.containsKey(i)||__PRIVATE_removeLimboTarget(n,i)})}function __PRIVATE_removeLimboTarget(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(__PRIVATE_remoteStoreUnlisten(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),__PRIVATE_pumpEnqueuedLimboResolutions(n))}function __PRIVATE_updateTrackedLimbos(n,e,t){for(const i of t)i instanceof __PRIVATE_AddedLimboDocument?(n.du.addReference(i.key,e),__PRIVATE_trackLimboChange(n,i)):i instanceof __PRIVATE_RemovedLimboDocument?(__PRIVATE_logDebug(nn,"Document no longer in limbo: "+i.key),n.du.removeReference(i.key,e),n.du.containsKey(i.key)||__PRIVATE_removeLimboTarget(n,i.key)):fail(19791,{pu:i})}function __PRIVATE_trackLimboChange(n,e){const t=e.key,i=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(i)||(__PRIVATE_logDebug(nn,"New document in limbo: "+t),n.Tu.add(i),__PRIVATE_pumpEnqueuedLimboResolutions(n))}function __PRIVATE_pumpEnqueuedLimboResolutions(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new DocumentKey(ResourcePath.fromString(e)),i=n.Vu.next();n.Eu.set(i,new LimboResolution(t)),n.Iu=n.Iu.insert(t,i),__PRIVATE_remoteStoreListen(n.remoteStore,new TargetData(__PRIVATE_queryToTarget(__PRIVATE_newQueryForPath(t.path)),i,"TargetPurposeLimboResolution",__PRIVATE_ListenSequence.le))}}async function __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(n,e,t){const i=__PRIVATE_debugCast(n),o=[],a=[],u=[];i.hu.isEmpty()||(i.hu.forEach((f,d)=>{u.push(i.fu(d,e,t).then(p=>{var _;if((p||t)&&i.isPrimaryClient){const R=p?!p.fromCache:(_=t==null?void 0:t.targetChanges.get(d.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(d.targetId,R?"current":"not-current")}if(p){o.push(p);const R=__PRIVATE_LocalViewChanges.Rs(d.targetId,p);a.push(R)}}))}),await Promise.all(u),i.lu.Y_(o),await async function(d,p){const _=__PRIVATE_debugCast(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",R=>PersistencePromise.forEach(p,w=>PersistencePromise.forEach(w.ds,V=>_.persistence.referenceDelegate.addReference(R,w.targetId,V)).next(()=>PersistencePromise.forEach(w.As,V=>_.persistence.referenceDelegate.removeReference(R,w.targetId,V)))))}catch(R){if(!__PRIVATE_isIndexedDbTransactionError(R))throw R;__PRIVATE_logDebug(Qt,"Failed to update sequence numbers: "+R)}for(const R of p){const w=R.targetId;if(!R.fromCache){const V=_.xs.get(w),U=V.snapshotVersion,X=V.withLastLimboFreeSnapshotVersion(U);_.xs=_.xs.insert(w,X)}}}(i.localStore,a))}async function __PRIVATE_syncEngineHandleCredentialChange(n,e){const t=__PRIVATE_debugCast(n);if(!t.currentUser.isEqual(e)){__PRIVATE_logDebug(nn,"User change. New user:",e.toKey());const i=await __PRIVATE_localStoreHandleUserChange(t.localStore,e);t.currentUser=e,function(a,u){a.Ru.forEach(f=>{f.forEach(d=>{d.reject(new FirestoreError(N.CANCELLED,u))})}),a.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(t,i.ks)}}function __PRIVATE_syncEngineGetRemoteKeysForTarget(n,e){const t=__PRIVATE_debugCast(n),i=t.Eu.get(e);if(i&&i.cu)return __PRIVATE_documentKeySet().add(i.key);{let o=__PRIVATE_documentKeySet();const a=t.Pu.get(e);if(!a)return o;for(const u of a){const f=t.hu.get(u);o=o.unionWith(f.view.eu)}return o}}function __PRIVATE_ensureWatchCallbacks(n){const e=__PRIVATE_debugCast(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=__PRIVATE_syncEngineApplyRemoteEvent.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=__PRIVATE_syncEngineGetRemoteKeysForTarget.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=__PRIVATE_syncEngineRejectListen.bind(null,e),e.lu.Y_=__PRIVATE_eventManagerOnWatchChange.bind(null,e.eventManager),e.lu.gu=__PRIVATE_eventManagerOnWatchError.bind(null,e.eventManager),e}function __PRIVATE_syncEngineEnsureWriteCallbacks(n){const e=__PRIVATE_debugCast(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=__PRIVATE_syncEngineApplySuccessfulWrite.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=__PRIVATE_syncEngineRejectFailedWrite.bind(null,e),e}class __PRIVATE_MemoryOfflineComponentProvider{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=__PRIVATE_newSerializer(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return __PRIVATE_newLocalStore(this.persistence,new __PRIVATE_QueryEngine,e.initialUser,this.serializer)}Su(e){return new __PRIVATE_MemoryPersistence(__PRIVATE_MemoryEagerDelegate.fi,this.serializer)}bu(e){return new __PRIVATE_MemorySharedClientState}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}__PRIVATE_MemoryOfflineComponentProvider.provider={build:()=>new __PRIVATE_MemoryOfflineComponentProvider};class __PRIVATE_LruGcMemoryOfflineComponentProvider extends __PRIVATE_MemoryOfflineComponentProvider{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){__PRIVATE_hardAssert(this.persistence.referenceDelegate instanceof __PRIVATE_MemoryLruDelegate,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new __PRIVATE_LruScheduler(i,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?LruParams.withCacheSize(this.cacheSizeBytes):LruParams.DEFAULT;return new __PRIVATE_MemoryPersistence(i=>__PRIVATE_MemoryLruDelegate.fi(i,t),this.serializer)}}class OnlineComponentProvider{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=__PRIVATE_syncEngineHandleCredentialChange.bind(null,this.syncEngine),await __PRIVATE_remoteStoreApplyPrimaryState(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new __PRIVATE_EventManagerImpl}()}createDatastore(e){const t=__PRIVATE_newSerializer(e.databaseInfo.databaseId),i=function(a){return new __PRIVATE_WebChannelConnection(a)}(e.databaseInfo);return function(a,u,f,d){return new __PRIVATE_DatastoreImpl(a,u,f,d)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,o,a,u,f){return new __PRIVATE_RemoteStoreImpl(i,o,a,u,f)}(this.localStore,this.datastore,e.asyncQueue,t=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,t,0),function(){return __PRIVATE_BrowserConnectivityMonitor.C()?new __PRIVATE_BrowserConnectivityMonitor:new __PRIVATE_NoopConnectivityMonitor}())}createSyncEngine(e,t){return function(o,a,u,f,d,p,_){const R=new __PRIVATE_SyncEngineImpl(o,a,u,f,d,p);return _&&(R.mu=!0),R}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const a=__PRIVATE_debugCast(o);__PRIVATE_logDebug(Xt,"RemoteStore shutting down."),a.da.add(5),await __PRIVATE_disableNetworkInternal(a),a.Ra.shutdown(),a.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}OnlineComponentProvider.provider={build:()=>new OnlineComponentProvider};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AsyncObserver{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):__PRIVATE_logError("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="FirestoreClient";class FirestoreClient{constructor(e,t,i,o,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=User.UNAUTHENTICATED,this.clientId=__PRIVATE_AutoId.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(i,async u=>{__PRIVATE_logDebug(rn,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(i,u=>(__PRIVATE_logDebug(rn,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new __PRIVATE_Deferred;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=__PRIVATE_wrapInUserErrorIfRecoverable(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function __PRIVATE_setOfflineComponentProvider(n,e){n.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(rn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async o=>{i.isEqual(o)||(await __PRIVATE_localStoreHandleUserChange(e.localStore,o),i=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function __PRIVATE_setOnlineComponentProvider(n,e){n.asyncQueue.verifyOperationInProgress();const t=await __PRIVATE_ensureOfflineComponents(n);__PRIVATE_logDebug(rn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,o)=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,o)),n._onlineComponents=e}async function __PRIVATE_ensureOfflineComponents(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){__PRIVATE_logDebug(rn,"Using user provided OfflineComponentProvider");try{await __PRIVATE_setOfflineComponentProvider(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===N.FAILED_PRECONDITION||o.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;__PRIVATE_logWarn("Error using user provided cache. Falling back to memory cache: "+t),await __PRIVATE_setOfflineComponentProvider(n,new __PRIVATE_MemoryOfflineComponentProvider)}}else __PRIVATE_logDebug(rn,"Using default OfflineComponentProvider"),await __PRIVATE_setOfflineComponentProvider(n,new __PRIVATE_LruGcMemoryOfflineComponentProvider(void 0));return n._offlineComponents}async function __PRIVATE_ensureOnlineComponents(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(__PRIVATE_logDebug(rn,"Using user provided OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(n,n._uninitializedComponentsProvider._online)):(__PRIVATE_logDebug(rn,"Using default OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(n,new OnlineComponentProvider))),n._onlineComponents}function __PRIVATE_getSyncEngine(n){return __PRIVATE_ensureOnlineComponents(n).then(e=>e.syncEngine)}async function __PRIVATE_getEventManager(n){const e=await __PRIVATE_ensureOnlineComponents(n),t=e.eventManager;return t.onListen=__PRIVATE_syncEngineListen.bind(null,e.syncEngine),t.onUnlisten=__PRIVATE_syncEngineUnlisten.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=__PRIVATE_triggerRemoteStoreListen.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=__PRIVATE_triggerRemoteStoreUnlisten.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateNonEmptyArgument(n,e,t){if(!t)throw new FirestoreError(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function __PRIVATE_validateIsNotUsedTogether(n,e,t,i){if(e===!0&&i===!0)throw new FirestoreError(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function __PRIVATE_validateDocumentPath(n){if(!DocumentKey.isDocumentKey(n))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function __PRIVATE_validateCollectionPath(n){if(DocumentKey.isDocumentKey(n))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function __PRIVATE_valueDescription(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":fail(12329,{type:typeof n})}function __PRIVATE_cast(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new FirestoreError(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=__PRIVATE_valueDescription(n);throw new FirestoreError(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="firestore.googleapis.com",_n=!0;class FirestoreSettingsImpl{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new FirestoreError(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=on,this.ssl=_n}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:_n;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mt;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ot)throw new FirestoreError(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}__PRIVATE_validateIsNotUsedTogether("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Firestore$1{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new FirestoreError(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new FirestoreError(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(i.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new FirestoreError(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=sn.get(t);i&&(__PRIVATE_logDebug("ComponentProvider","Removing Datastore"),sn.delete(t),i.terminate())}(this),Promise.resolve()}}function connectFirestoreEmulator(n,e,t,i={}){var o;n=__PRIVATE_cast(n,Firestore$1);const a=isCloudWorkstation(e),u=n._getSettings(),f=Object.assign(Object.assign({},u),{emulatorOptions:n._getEmulatorOptions()}),d=`${e}:${t}`;a&&(pingServer(`https://${d}`),updateEmulatorBanner("Firestore",!0)),u.host!==on&&u.host!==d&&__PRIVATE_logWarn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p=Object.assign(Object.assign({},u),{host:d,ssl:a,emulatorOptions:i});if(!deepEqual(p,f)&&(n._setSettings(p),i.mockUserToken)){let _,R;if(typeof i.mockUserToken=="string")_=i.mockUserToken,R=User.MOCK_USER;else{_=createMockUserToken(i.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const w=i.mockUserToken.sub||i.mockUserToken.user_id;if(!w)throw new FirestoreError(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");R=new User(w)}n._authCredentials=new __PRIVATE_EmulatorAuthCredentialsProvider(new __PRIVATE_OAuthToken(_,R))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Query{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Query(this.firestore,e,this._query)}}class DocumentReference{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CollectionReference(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new DocumentReference(this.firestore,e,this._key)}}class CollectionReference extends Query{constructor(e,t,i){super(e,t,__PRIVATE_newQueryForPath(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new DocumentReference(this.firestore,null,new DocumentKey(e))}withConverter(e){return new CollectionReference(this.firestore,e,this._path)}}function collection(n,e,...t){if(n=getModularInstance(n),__PRIVATE_validateNonEmptyArgument("collection","path",e),n instanceof Firestore$1){const i=ResourcePath.fromString(e,...t);return __PRIVATE_validateCollectionPath(i),new CollectionReference(n,null,i)}{if(!(n instanceof DocumentReference||n instanceof CollectionReference))throw new FirestoreError(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ResourcePath.fromString(e,...t));return __PRIVATE_validateCollectionPath(i),new CollectionReference(n.firestore,null,i)}}function doc(n,e,...t){if(n=getModularInstance(n),arguments.length===1&&(e=__PRIVATE_AutoId.newId()),__PRIVATE_validateNonEmptyArgument("doc","path",e),n instanceof Firestore$1){const i=ResourcePath.fromString(e,...t);return __PRIVATE_validateDocumentPath(i),new DocumentReference(n,null,new DocumentKey(i))}{if(!(n instanceof DocumentReference||n instanceof CollectionReference))throw new FirestoreError(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ResourcePath.fromString(e,...t));return __PRIVATE_validateDocumentPath(i),new DocumentReference(n.firestore,n instanceof CollectionReference?n.converter:null,new DocumentKey(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an="AsyncQueue";class __PRIVATE_AsyncQueueImpl{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this.rc=()=>{const i=getDocument();i&&__PRIVATE_logDebug(an,"Visibility state changed to "+i.visibilityState),this.x_.b_()},this.sc=e;const t=getDocument();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=getDocument();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new __PRIVATE_Deferred;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug(an,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(i=>{throw this.Xu=i,this.ec=!1,__PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",__PRIVATE_getMessageOrStack(i)),i}).then(i=>(this.ec=!1,i))));return this.sc=t,t}enqueueAfterDelay(e,t,i){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=DelayedOperation.createAndSchedule(this,e,t,i,a=>this.uc(a));return this.Zu.push(o),o}oc(){this.Xu&&fail(47125,{cc:__PRIVATE_getMessageOrStack(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function __PRIVATE_getMessageOrStack(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_isPartialObserver(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const a of i)if(a in o&&typeof o[a]=="function")return!0;return!1}(n,["next","error","complete"])}class Firestore extends Firestore$1{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new __PRIVATE_AsyncQueueImpl,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new __PRIVATE_AsyncQueueImpl(e),this._firestoreClient=void 0,await e}}}function getFirestore(n,e){const t=typeof n=="object"?n:getApp(),i=typeof n=="string"?n:ut,o=_getProvider(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const a=getDefaultEmulatorHostnameAndPort("firestore");a&&connectFirestoreEmulator(o,...a)}return o}function ensureFirestoreConfigured(n){if(n._terminated)throw new FirestoreError(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||__PRIVATE_configureFirestore(n),n._firestoreClient}function __PRIVATE_configureFirestore(n){var e,t,i;const o=n._freezeSettings(),a=function(f,d,p,_){return new DatabaseInfo(f,d,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,__PRIVATE_cloneLongPollingOptions(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new FirestoreClient(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&function(f){const d=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(d),_online:d}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bytes{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bytes(ByteString.fromBase64String(e))}catch(t){throw new FirestoreError(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Bytes(ByteString.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldPath{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath$1(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldValue{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GeoPoint{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new FirestoreError(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new FirestoreError(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return __PRIVATE_primitiveComparator(this._lat,e._lat)||__PRIVATE_primitiveComparator(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VectorValue{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,o){if(i.length!==o.length)return!1;for(let a=0;a<i.length;++a)if(i[a]!==o[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn=/^__.*__$/;class ParsedSetData{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,t,this.fieldTransforms):new __PRIVATE_SetMutation(e,this.data,t,this.fieldTransforms)}}class ParsedUpdateData{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function __PRIVATE_isWrite(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fail(40011,{Ic:n})}}class __PRIVATE_ParseContextImpl{constructor(e,t,i,o,a,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,a===void 0&&this.Ec(),this.fieldTransforms=a||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new __PRIVATE_ParseContextImpl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:i,Rc:!1});return o.Vc(e),o}mc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:i,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return __PRIVATE_createError(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(__PRIVATE_isWrite(this.Ic)&&cn.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class __PRIVATE_UserDataReader{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||__PRIVATE_newSerializer(e)}bc(e,t,i,o=!1){return new __PRIVATE_ParseContextImpl({Ic:e,methodName:t,wc:i,path:FieldPath$1.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function __PRIVATE_newUserDataReader(n){const e=n._freezeSettings(),t=__PRIVATE_newSerializer(n._databaseId);return new __PRIVATE_UserDataReader(n._databaseId,!!e.ignoreUndefinedProperties,t)}function __PRIVATE_parseSetData(n,e,t,i,o,a={}){const u=n.bc(a.merge||a.mergeFields?2:0,e,t,o);__PRIVATE_validatePlainObject("Data must be an object, but it was:",u,i);const f=__PRIVATE_parseObject(i,u);let d,p;if(a.merge)d=new FieldMask(u.fieldMask),p=u.fieldTransforms;else if(a.mergeFields){const _=[];for(const R of a.mergeFields){const w=__PRIVATE_fieldPathFromArgument$1(e,R,t);if(!u.contains(w))throw new FirestoreError(N.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);__PRIVATE_fieldMaskContains(_,w)||_.push(w)}d=new FieldMask(_),p=u.fieldTransforms.filter(R=>d.covers(R.field))}else d=null,p=u.fieldTransforms;return new ParsedSetData(new ObjectValue(f),d,p)}class __PRIVATE_DeleteFieldValueImpl extends FieldValue{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof __PRIVATE_DeleteFieldValueImpl}}function __PRIVATE_parseUpdateData(n,e,t,i){const o=n.bc(1,e,t);__PRIVATE_validatePlainObject("Data must be an object, but it was:",o,i);const a=[],u=ObjectValue.empty();forEach(i,(d,p)=>{const _=__PRIVATE_fieldPathFromDotSeparatedString(e,d,t);p=getModularInstance(p);const R=o.mc(_);if(p instanceof __PRIVATE_DeleteFieldValueImpl)a.push(_);else{const w=__PRIVATE_parseData(p,R);w!=null&&(a.push(_),u.set(_,w))}});const f=new FieldMask(a);return new ParsedUpdateData(u,f,o.fieldTransforms)}function __PRIVATE_parseUpdateVarargs(n,e,t,i,o,a){const u=n.bc(1,e,t),f=[__PRIVATE_fieldPathFromArgument$1(e,i,t)],d=[o];if(a.length%2!=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<a.length;w+=2)f.push(__PRIVATE_fieldPathFromArgument$1(e,a[w])),d.push(a[w+1]);const p=[],_=ObjectValue.empty();for(let w=f.length-1;w>=0;--w)if(!__PRIVATE_fieldMaskContains(p,f[w])){const V=f[w];let U=d[w];U=getModularInstance(U);const X=u.mc(V);if(U instanceof __PRIVATE_DeleteFieldValueImpl)p.push(V);else{const b=__PRIVATE_parseData(U,X);b!=null&&(p.push(V),_.set(V,b))}}const R=new FieldMask(p);return new ParsedUpdateData(_,R,u.fieldTransforms)}function __PRIVATE_parseQueryValue(n,e,t,i=!1){return __PRIVATE_parseData(t,n.bc(i?4:3,e))}function __PRIVATE_parseData(n,e){if(__PRIVATE_looksLikeJsonObject(n=getModularInstance(n)))return __PRIVATE_validatePlainObject("Unsupported field value:",e,n),__PRIVATE_parseObject(n,e);if(n instanceof FieldValue)return function(i,o){if(!__PRIVATE_isWrite(o.Ic))throw o.gc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(o);a&&o.fieldTransforms.push(a)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(i,o){const a=[];let u=0;for(const f of i){let d=__PRIVATE_parseData(f,o.fc(u));d==null&&(d={nullValue:"NULL_VALUE"}),a.push(d),u++}return{arrayValue:{values:a}}}(n,e)}return function(i,o){if((i=getModularInstance(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return toNumber(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=Timestamp.fromDate(i);return{timestampValue:toTimestamp(o.serializer,a)}}if(i instanceof Timestamp){const a=new Timestamp(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:toTimestamp(o.serializer,a)}}if(i instanceof GeoPoint)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Bytes)return{bytesValue:__PRIVATE_toBytes(o.serializer,i._byteString)};if(i instanceof DocumentReference){const a=o.databaseId,u=i.firestore._databaseId;if(!u.isEqual(a))throw o.gc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:__PRIVATE_toResourceName(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof VectorValue)return function(u,f){return{mapValue:{fields:{[ct]:{stringValue:Pt},[Tt]:{arrayValue:{values:u.toArray().map(p=>{if(typeof p!="number")throw f.gc("VectorValues must only contain numeric values.");return __PRIVATE_toDouble(f.serializer,p)})}}}}}}(i,o);throw o.gc(`Unsupported field value: ${__PRIVATE_valueDescription(i)}`)}(n,e)}function __PRIVATE_parseObject(n,e){const t={};return isEmpty(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):forEach(n,(i,o)=>{const a=__PRIVATE_parseData(o,e.Ac(i));a!=null&&(t[i]=a)}),{mapValue:{fields:t}}}function __PRIVATE_looksLikeJsonObject(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Timestamp||n instanceof GeoPoint||n instanceof Bytes||n instanceof DocumentReference||n instanceof FieldValue||n instanceof VectorValue)}function __PRIVATE_validatePlainObject(n,e,t){if(!__PRIVATE_looksLikeJsonObject(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const i=__PRIVATE_valueDescription(t);throw i==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+i)}}function __PRIVATE_fieldPathFromArgument$1(n,e,t){if((e=getModularInstance(e))instanceof FieldPath)return e._internalPath;if(typeof e=="string")return __PRIVATE_fieldPathFromDotSeparatedString(n,e);throw __PRIVATE_createError("Field path arguments must be of type string or ",n,!1,void 0,t)}const ln=new RegExp("[~\\*/\\[\\]]");function __PRIVATE_fieldPathFromDotSeparatedString(n,e,t){if(e.search(ln)>=0)throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new FieldPath(...e.split("."))._internalPath}catch{throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function __PRIVATE_createError(n,e,t,i,o){const a=i&&!i.isEmpty(),u=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let d="";return(a||u)&&(d+=" (found",a&&(d+=` in field ${i}`),u&&(d+=` in document ${o}`),d+=")"),new FirestoreError(N.INVALID_ARGUMENT,f+n+d)}function __PRIVATE_fieldMaskContains(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSnapshot$1{constructor(e,t,i,o,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new DocumentReference(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QueryDocumentSnapshot$1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class QueryDocumentSnapshot$1 extends DocumentSnapshot$1{data(){return super.data()}}function __PRIVATE_fieldPathFromArgument(n,e){return typeof e=="string"?__PRIVATE_fieldPathFromDotSeparatedString(n,e):e instanceof FieldPath?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateHasExplicitOrderByForLimitToLast(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new FirestoreError(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AppliableConstraint{}class QueryConstraint extends AppliableConstraint{}function query(n,e,...t){let i=[];e instanceof AppliableConstraint&&i.push(e),i=i.concat(t),function(a){const u=a.filter(d=>d instanceof QueryCompositeFilterConstraint).length,f=a.filter(d=>d instanceof QueryFieldFilterConstraint).length;if(u>1||u>0&&f>0)throw new FirestoreError(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const o of i)n=o._apply(n);return n}class QueryFieldFilterConstraint extends QueryConstraint{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new QueryFieldFilterConstraint(e,t,i)}_apply(e){const t=this._parse(e);return __PRIVATE_validateNewFieldFilter(e._query,t),new Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,t))}_parse(e){const t=__PRIVATE_newUserDataReader(e.firestore);return function(a,u,f,d,p,_,R){let w;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){__PRIVATE_validateDisjunctiveFilterElements(R,_);const U=[];for(const X of R)U.push(__PRIVATE_parseDocumentIdValue(d,a,X));w={arrayValue:{values:U}}}else w=__PRIVATE_parseDocumentIdValue(d,a,R)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||__PRIVATE_validateDisjunctiveFilterElements(R,_),w=__PRIVATE_parseQueryValue(f,u,R,_==="in"||_==="not-in");return FieldFilter.create(p,_,w)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function where(n,e,t){const i=e,o=__PRIVATE_fieldPathFromArgument("where",n);return QueryFieldFilterConstraint._create(o,i,t)}class QueryCompositeFilterConstraint extends AppliableConstraint{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new QueryCompositeFilterConstraint(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:CompositeFilter.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,a){let u=o;const f=a.getFlattenedFilters();for(const d of f)__PRIVATE_validateNewFieldFilter(u,d),u=__PRIVATE_queryWithAddedFilter(u,d)}(e._query,t),new Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function __PRIVATE_parseDocumentIdValue(n,e,t){if(typeof(t=getModularInstance(t))=="string"){if(t==="")throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!__PRIVATE_isCollectionGroupQuery(e)&&t.indexOf("/")!==-1)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ResourcePath.fromString(t));if(!DocumentKey.isDocumentKey(i))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return __PRIVATE_refValue(n,new DocumentKey(i))}if(t instanceof DocumentReference)return __PRIVATE_refValue(n,t._key);throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${__PRIVATE_valueDescription(t)}.`)}function __PRIVATE_validateDisjunctiveFilterElements(n,e){if(!Array.isArray(n)||n.length===0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function __PRIVATE_validateNewFieldFilter(n,e){const t=function(o,a){for(const u of o)for(const f of u.getFlattenedFilters())if(a.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class AbstractUserDataWriter{convertValue(e,t="none"){switch(__PRIVATE_typeOrder(e)){case 0:return null;case 1:return e.booleanValue;case 2:return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(__PRIVATE_normalizeByteString(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw fail(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return forEach(e,(o,a)=>{i[o]=this.convertValue(a,t)}),i}convertVectorValue(e){var t,i,o;const a=(o=(i=(t=e.fields)===null||t===void 0?void 0:t[Tt].arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.map(u=>__PRIVATE_normalizeNumber(u.doubleValue));return new VectorValue(a)}convertGeoPoint(e){return new GeoPoint(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=__PRIVATE_getPreviousValue(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(__PRIVATE_getLocalWriteTime(e));default:return null}}convertTimestamp(e){const t=__PRIVATE_normalizeTimestamp(e);return new Timestamp(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ResourcePath.fromString(e);__PRIVATE_hardAssert(__PRIVATE_isValidResourceName(i),9688,{name:e});const o=new DatabaseId(i.get(1),i.get(3)),a=new DocumentKey(i.popFirst(5));return o.isEqual(t)||__PRIVATE_logError(`Document ${a} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_applyFirestoreDataConverter(n,e,t){let i;return i=n?n.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotMetadata{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class DocumentSnapshot extends DocumentSnapshot$1{constructor(e,t,i,o,a,u){super(e,t,i,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new QueryDocumentSnapshot(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class QueryDocumentSnapshot extends DocumentSnapshot{data(e={}){return super.data(e)}}class QuerySnapshot{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new SnapshotMetadata(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new QueryDocumentSnapshot(this._firestore,this._userDataWriter,i.key,i,new SnapshotMetadata(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,a){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map(f=>{const d=new QueryDocumentSnapshot(o._firestore,o._userDataWriter,f.doc.key,f.doc,new SnapshotMetadata(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:d,oldIndex:-1,newIndex:u++}})}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(f=>a||f.type!==3).map(f=>{const d=new QueryDocumentSnapshot(o._firestore,o._userDataWriter,f.doc.key,f.doc,new SnapshotMetadata(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let p=-1,_=-1;return f.type!==0&&(p=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),_=u.indexOf(f.doc.key)),{type:__PRIVATE_resultChangeType(f.type),doc:d,oldIndex:p,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function __PRIVATE_resultChangeType(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fail(61501,{type:n})}}class __PRIVATE_ExpUserDataWriter extends AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bytes(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new DocumentReference(this.firestore,null,t)}}function updateDoc(n,e,t,...i){n=__PRIVATE_cast(n,DocumentReference);const o=__PRIVATE_cast(n.firestore,Firestore),a=__PRIVATE_newUserDataReader(o);let u;return u=typeof(e=getModularInstance(e))=="string"||e instanceof FieldPath?__PRIVATE_parseUpdateVarargs(a,"updateDoc",n._key,e,t,i):__PRIVATE_parseUpdateData(a,"updateDoc",n._key,e),executeWrite(o,[u.toMutation(n._key,Precondition.exists(!0))])}function deleteDoc(n){return executeWrite(__PRIVATE_cast(n.firestore,Firestore),[new __PRIVATE_DeleteMutation(n._key,Precondition.none())])}function addDoc(n,e){const t=__PRIVATE_cast(n.firestore,Firestore),i=doc(n),o=__PRIVATE_applyFirestoreDataConverter(n.converter,e);return executeWrite(t,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(n.firestore),"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,Precondition.exists(!1))]).then(()=>i)}function onSnapshot(n,...e){var t,i,o;n=getModularInstance(n);let a={includeMetadataChanges:!1,source:"default"},u=0;typeof e[u]!="object"||__PRIVATE_isPartialObserver(e[u])||(a=e[u],u++);const f={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(__PRIVATE_isPartialObserver(e[u])){const R=e[u];e[u]=(t=R.next)===null||t===void 0?void 0:t.bind(R),e[u+1]=(i=R.error)===null||i===void 0?void 0:i.bind(R),e[u+2]=(o=R.complete)===null||o===void 0?void 0:o.bind(R)}let d,p,_;if(n instanceof DocumentReference)p=__PRIVATE_cast(n.firestore,Firestore),_=__PRIVATE_newQueryForPath(n._key.path),d={next:R=>{e[u]&&e[u](__PRIVATE_convertToDocSnapshot(p,n,R))},error:e[u+1],complete:e[u+2]};else{const R=__PRIVATE_cast(n,Query);p=__PRIVATE_cast(R.firestore,Firestore),_=R._query;const w=new __PRIVATE_ExpUserDataWriter(p);d={next:V=>{e[u]&&e[u](new QuerySnapshot(p,w,R,V))},error:e[u+1],complete:e[u+2]},__PRIVATE_validateHasExplicitOrderByForLimitToLast(n._query)}return function(w,V,U,X){const b=new __PRIVATE_AsyncObserver(X),K=new __PRIVATE_QueryListener(V,b,U);return w.asyncQueue.enqueueAndForget(async()=>__PRIVATE_eventManagerListen(await __PRIVATE_getEventManager(w),K)),()=>{b.xu(),w.asyncQueue.enqueueAndForget(async()=>__PRIVATE_eventManagerUnlisten(await __PRIVATE_getEventManager(w),K))}}(ensureFirestoreConfigured(p),_,f,d)}function executeWrite(n,e){return function(i,o){const a=new __PRIVATE_Deferred;return i.asyncQueue.enqueueAndForget(async()=>__PRIVATE_syncEngineWrite(await __PRIVATE_getSyncEngine(i),o,a)),a.promise}(ensureFirestoreConfigured(n),e)}function __PRIVATE_convertToDocSnapshot(n,e,t){const i=t.docs.get(e._key),o=new __PRIVATE_ExpUserDataWriter(n);return new DocumentSnapshot(n,o,e._key,i,new SnapshotMetadata(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){x=o})(SDK_VERSION),_registerComponent(new Component("firestore",(i,{instanceIdentifier:o,options:a})=>{const u=i.getProvider("app").getImmediate(),f=new Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(i.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(u,i.getProvider("app-check-internal")),function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new FirestoreError(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(p.options.projectId,_)}(u,o),u);return a=Object.assign({useFetchStreams:t},a),f._setSettings(a),f},"PUBLIC").setMultipleInstances(!0)),registerVersion(F,M,e),registerVersion(F,M,"esm2017")})();function __rest(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}typeof SuppressedError=="function"&&SuppressedError;function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/auth");function _logWarn(n,...e){logClient.logLevel<=LogLevel.WARN&&logClient.warn(`Auth (${SDK_VERSION}): ${n}`,...e)}function _logError(n,...e){logClient.logLevel<=LogLevel.ERROR&&logClient.error(`Auth (${SDK_VERSION}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(n,...e){throw createErrorInternal(n,...e)}function _createError(n,...e){return createErrorInternal(n,...e)}function _errorWithCustomMessage(n,e,t){const i=Object.assign(Object.assign({},prodErrorMap()),{[e]:t});return new ErrorFactory("auth","Firebase",i).create(e,{appName:n.name})}function _serverAppCurrentUserOperationNotSupportedError(n){return _errorWithCustomMessage(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function createErrorInternal(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return _DEFAULT_AUTH_ERROR_FACTORY.create(n,...e)}function _assert(n,e,...t){if(!n)throw createErrorInternal(e,...t)}function debugFail(n){const e="INTERNAL ASSERTION FAILED: "+n;throw _logError(e),new Error(e)}function debugAssert(n,e){n||debugFail(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _getCurrentScheme(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(e,t){this.shortDelay=e,this.longDelay=t,debugAssert(t>e,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(n,e){debugAssert(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CookieAuthProxiedEndpoints=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function _performApiRequest(n,e,t,i,o={}){return _performFetchWithErrorHandling(n,o,async()=>{let a={},u={};i&&(e==="GET"?u=i:a={body:JSON.stringify(i)});const f=querystring(Object.assign({key:n.config.apiKey},u)).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const p=Object.assign({method:e,headers:d},a);return isCloudflareWorker()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&isCloudWorkstation(n.emulatorConfig.host)&&(p.credentials="include"),FetchProvider.fetch()(await _getFinalTarget(n,n.config.apiHost,t,f),p)})}async function _performFetchWithErrorHandling(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},SERVER_ERROR_MAP),e);try{const o=new NetworkTimeout(n),a=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await a.json();if("needConfirmation"in u)throw _makeTaggedError(n,"account-exists-with-different-credential",u);if(a.ok&&!("errorMessage"in u))return u;{const f=a.ok?u.errorMessage:u.error.message,[d,p]=f.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(n,"credential-already-in-use",u);if(d==="EMAIL_EXISTS")throw _makeTaggedError(n,"email-already-in-use",u);if(d==="USER_DISABLED")throw _makeTaggedError(n,"user-disabled",u);const _=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw _errorWithCustomMessage(n,_,p);_fail(n,_)}}catch(o){if(o instanceof FirebaseError)throw o;_fail(n,"network-request-failed",{message:String(o)})}}async function _performSignInRequest(n,e,t,i,o={}){const a=await _performApiRequest(n,e,t,i,o);return"mfaPendingCredential"in a&&_fail(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function _getFinalTarget(n,e,t,i){const o=`${e}${t}?${i}`,a=n,u=a.config.emulator?_emulatorUrl(n.config,o):`${n.config.apiScheme}://${o}`;return CookieAuthProxiedEndpoints.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(u).toString():u}function _parseEnforcementState(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class NetworkTimeout{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(_createError(this.auth,"network-request-failed")),DEFAULT_API_TIMEOUT_MS.get())})}}function _makeTaggedError(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=_createError(n,e,i);return o.customData._tokenResponse=t,o}function isEnterprise(n){return n!==void 0&&n.enterprise!==void 0}class RecaptchaConfig{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return _parseEnforcementState(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function getRecaptchaConfig(n,e){return _performApiRequest(n,"GET","/v2/recaptchaConfig",_addTidIfNecessary(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(n,e){return _performApiRequest(n,"POST","/v1/accounts:delete",e)}async function getAccountInfo(n,e){return _performApiRequest(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function getIdTokenResult(n,e=!1){const t=getModularInstance(n),i=await t.getIdToken(e),o=_parseToken(i);_assert(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const a=typeof o.firebase=="object"?o.firebase:void 0,u=a==null?void 0:a.sign_in_provider;return{claims:o,token:i,authTime:utcTimestampToDateString(secondsStringToMilliseconds(o.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(o.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(o.exp)),signInProvider:u||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function secondsStringToMilliseconds(n){return Number(n)*1e3}function _parseToken(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const o=base64Decode(t);return o?JSON.parse(o):(_logError("Failed to decode base64 JWT payload"),null)}catch(o){return _logError("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function _tokenExpiresIn(n){const e=_parseToken(n);return _assert(e,"internal-error"),_assert(typeof e.exp<"u","internal-error"),_assert(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof FirebaseError&&isUserInvalidated(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function isUserInvalidated({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(n){var e;const t=n.auth,i=await n.getIdToken(),o=await _logoutIfInvalidated(n,getAccountInfo(t,{idToken:i}));_assert(o==null?void 0:o.users.length,t,"internal-error");const a=o.users[0];n._notifyReloadListener(a);const u=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?extractProviderData(a.providerUserInfo):[],f=mergeProviderData(n.providerData,u),d=n.isAnonymous,p=!(n.email&&a.passwordHash)&&!(f!=null&&f.length),_=d?p:!1,R={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:f,metadata:new UserMetadata(a.createdAt,a.lastLoginAt),isAnonymous:_};Object.assign(n,R)}async function reload(n){const e=getModularInstance(n);await _reloadWithoutSaving(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mergeProviderData(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function extractProviderData(n){return n.map(e=>{var{providerId:t}=e,i=__rest(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(n,e){const t=await _performFetchWithErrorHandling(n,{},async()=>{const i=querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:a}=n.config,u=await _getFinalTarget(n,o,"/v1/token",`key=${a}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:f,body:i};return n.emulatorConfig&&isCloudWorkstation(n.emulatorConfig.host)&&(d.credentials="include"),FetchProvider.fetch()(u,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function revokeToken(n,e){return _performApiRequest(n,"POST","/v2/accounts:revokeToken",_addTidIfNecessary(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert(e.idToken,"internal-error"),_assert(typeof e.idToken<"u","internal-error"),_assert(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_assert(e.length!==0,"internal-error");const t=_tokenExpiresIn(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(_assert(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:a}=await requestStsToken(e,t);this.updateTokensAndExpiration(i,o,Number(a))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:a}=t,u=new StsTokenManager;return i&&(_assert(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),o&&(_assert(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),a&&(_assert(typeof a=="number","internal-error",{appName:e}),u.expirationTime=a),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(n,e){_assert(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class UserImpl{constructor(e){var{uid:t,auth:i,stsTokenManager:o}=e,a=__rest(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new UserMetadata(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new UserImpl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_isFirebaseServerApp(this.auth.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this.auth));const e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,o,a,u,f,d,p,_;const R=(i=t.displayName)!==null&&i!==void 0?i:void 0,w=(o=t.email)!==null&&o!==void 0?o:void 0,V=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,U=(u=t.photoURL)!==null&&u!==void 0?u:void 0,X=(f=t.tenantId)!==null&&f!==void 0?f:void 0,b=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,K=(p=t.createdAt)!==null&&p!==void 0?p:void 0,Z=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:oe,emailVerified:te,isAnonymous:H,providerData:J,stsTokenManager:y}=t;_assert(oe&&y,e,"internal-error");const g=StsTokenManager.fromJSON(this.name,y);_assert(typeof oe=="string",e,"internal-error"),assertStringOrUndefined(R,e.name),assertStringOrUndefined(w,e.name),_assert(typeof te=="boolean",e,"internal-error"),_assert(typeof H=="boolean",e,"internal-error"),assertStringOrUndefined(V,e.name),assertStringOrUndefined(U,e.name),assertStringOrUndefined(X,e.name),assertStringOrUndefined(b,e.name),assertStringOrUndefined(K,e.name),assertStringOrUndefined(Z,e.name);const E=new UserImpl({uid:oe,auth:e,email:w,emailVerified:te,displayName:R,isAnonymous:H,photoURL:U,phoneNumber:V,tenantId:X,stsTokenManager:g,createdAt:K,lastLoginAt:Z});return J&&Array.isArray(J)&&(E.providerData=J.map(W=>Object.assign({},W))),b&&(E._redirectEventId=b),E}static async _fromIdTokenResponse(e,t,i=!1){const o=new StsTokenManager;o.updateFromServerResponse(t);const a=new UserImpl({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await _reloadWithoutSaving(a),a}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];_assert(o.localId!==void 0,"internal-error");const a=o.providerUserInfo!==void 0?extractProviderData(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!(a!=null&&a.length),f=new StsTokenManager;f.updateFromIdToken(i);const d=new UserImpl({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:u}),p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new UserMetadata(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(a!=null&&a.length)};return Object.assign(d,p),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(n){debugAssert(n instanceof Function,"Expected a class definition");let e=instanceCache.get(n);return e?(debugAssert(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,instanceCache.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(n,e,t){return`firebase:${n}:${e}:${t}`}class PersistenceUserManager{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:a}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,o.apiKey,a),this.fullPersistenceKey=_persistenceKeyName("persistence",o.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await getAccountInfo(this.auth,{idToken:e}).catch(()=>{});return t?UserImpl._fromGetAccountInfoResponse(this.auth,t,e):null}return UserImpl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),e,i);const o=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=o[0]||_getInstance(inMemoryPersistence);const u=_persistenceKeyName(i,e.config.apiKey,e.name);let f=null;for(const p of t)try{const _=await p._get(u);if(_){let R;if(typeof _=="string"){const w=await getAccountInfo(e,{idToken:_}).catch(()=>{});if(!w)break;R=await UserImpl._fromGetAccountInfoResponse(e,w,_)}else R=UserImpl._fromJSON(e,_);p!==a&&(f=R),a=p;break}}catch{}const d=o.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!d.length?new PersistenceUserManager(a,e,i):(a=d[0],f&&await a._set(u,f.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(u)}catch{}})),new PersistenceUserManager(a,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_isIEMobile(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_isFirefox(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_isBlackBerry(e))return"Blackberry";if(_isWebOS(e))return"Webos";if(_isSafari(e))return"Safari";if((e.includes("chrome/")||_isChromeIOS(e))&&!e.includes("edge/"))return"Chrome";if(_isAndroid(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function _isFirefox(n=getUA()){return/firefox\//i.test(n)}function _isSafari(n=getUA()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _isChromeIOS(n=getUA()){return/crios\//i.test(n)}function _isIEMobile(n=getUA()){return/iemobile/i.test(n)}function _isAndroid(n=getUA()){return/android/i.test(n)}function _isBlackBerry(n=getUA()){return/blackberry/i.test(n)}function _isWebOS(n=getUA()){return/webos/i.test(n)}function _isIOS(n=getUA()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function _isIOSStandalone(n=getUA()){var e;return _isIOS(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(n=getUA()){return _isIOS(n)||_isAndroid(n)||_isWebOS(n)||_isBlackBerry(n)||/windows phone/i.test(n)||_isIEMobile(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(n,e=[]){let t;switch(n){case"Browser":t=_getBrowserName(getUA());break;case"Worker":t=`${_getBrowserName(getUA())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${SDK_VERSION}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthMiddlewareQueue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=a=>new Promise((u,f)=>{try{const d=e(a);u(d)}catch(d){f(d)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getPasswordPolicy(n,e={}){return _performApiRequest(n,"GET","/v2/passwordPolicy",_addTidIfNecessary(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MINIMUM_MIN_PASSWORD_LENGTH=6;class PasswordPolicyImpl{constructor(e){var t,i,o,a;const u=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=u.minPasswordLength)!==null&&t!==void 0?t:MINIMUM_MIN_PASSWORD_LENGTH,u.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=u.maxPasswordLength),u.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=u.containsLowercaseCharacter),u.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=u.containsUppercaseCharacter),u.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=u.containsNumericCharacter),u.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=u.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,o,a,u,f;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(i=d.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(o=d.containsLowercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(a=d.containsUppercaseLetter)!==null&&a!==void 0?a:!0),d.isValid&&(d.isValid=(u=d.containsNumericCharacter)!==null&&u!==void 0?u:!0),d.isValid&&(d.isValid=(f=d.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),d}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_getInstance(t)),this._initializationPromise=this.queue(async()=>{var i,o,a;if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await getAccountInfo(this,{idToken:e}),i=await UserImpl._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(_isFirebaseServerApp(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(f,f))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let o=i,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=o==null?void 0:o._redirectEventId,d=await this.tryRedirectSignIn(e);(!u||u===f)&&(d!=null&&d.user)&&(o=d.user,a=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(o)}catch(u){o=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return _assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_isFirebaseServerApp(this.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this));const t=e?getModularInstance(e):null;return t&&_assert(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_assert(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _getPasswordPolicy(this),t=new PasswordPolicyImpl(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await revokeToken(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_getInstance(e)||this._popupRedirectResolver;_assert(t,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(_assert(f,this,"internal-error"),f.then(()=>{u||a(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,i,o);return()=>{u=!0,d()}}else{const d=e.addObserver(t);return()=>{u=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(_isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&_logWarn(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function _castAuth(n){return getModularInstance(n)}class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=createSubscribe(t=>this.observer=t)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let externalJSProvider={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _setExternalJSProvider(n){externalJSProvider=n}function _loadJS(n){return externalJSProvider.loadJS(n)}function _recaptchaEnterpriseScriptUrl(){return externalJSProvider.recaptchaEnterpriseScript}function _gapiScriptUrl(){return externalJSProvider.gapiScript}function _generateCallbackName(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class MockGreCAPTCHATopLevel{constructor(){this.enterprise=new MockGreCAPTCHA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class MockGreCAPTCHA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const RECAPTCHA_ENTERPRISE_VERIFIER_TYPE="recaptcha-enterprise",FAKE_TOKEN="NO_RECAPTCHA";class RecaptchaEnterpriseVerifier{constructor(e){this.type=RECAPTCHA_ENTERPRISE_VERIFIER_TYPE,this.auth=_castAuth(e)}async verify(e="verify",t=!1){async function i(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(u,f)=>{getRecaptchaConfig(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const p=new RecaptchaConfig(d);return a.tenantId==null?a._agentRecaptchaConfig=p:a._tenantRecaptchaConfigs[a.tenantId]=p,u(p.siteKey)}}).catch(d=>{f(d)})})}function o(a,u,f){const d=window.grecaptcha;isEnterprise(d)?d.enterprise.ready(()=>{d.enterprise.execute(a,{action:e}).then(p=>{u(p)}).catch(()=>{u(FAKE_TOKEN)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new MockGreCAPTCHATopLevel().execute("siteKey",{action:"verify"}):new Promise((a,u)=>{i(this.auth).then(f=>{if(!t&&isEnterprise(window.grecaptcha))o(f,a,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let d=_recaptchaEnterpriseScriptUrl();d.length!==0&&(d+=f),_loadJS(d).then(()=>{o(f,a,u)}).catch(p=>{u(p)})}}).catch(f=>{u(f)})})}}async function injectRecaptchaFields(n,e,t,i=!1,o=!1){const a=new RecaptchaEnterpriseVerifier(n);let u;if(o)u=FAKE_TOKEN;else try{u=await a.verify(t)}catch{u=await a.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const d=f.phoneEnrollmentInfo.phoneNumber,p=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const d=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:u}):Object.assign(f,{captchaResponse:u}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function handleRecaptchaFlow(n,e,t,i,o){var a;if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await injectRecaptchaFields(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await injectRecaptchaFields(n,e,t,t==="getOobCode");return i(n,f)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(n,e){const t=_getProvider(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),a=t.getOptions();if(deepEqual(a,e??{}))return o;_fail(o,"already-initialized")}return t.initialize({options:e})}function _initializeAuthInstance(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(_getInstance);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function connectAuthEmulator(n,e,t){const i=_castAuth(n);_assert(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,a=extractProtocol(e),{host:u,port:f}=extractHostAndPort(e),d=f===null?"":`:${f}`,p={url:`${a}//${u}${d}/`},_=Object.freeze({host:u,port:f,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){_assert(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),_assert(deepEqual(p,i.config.emulator)&&deepEqual(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,isCloudWorkstation(u)?(pingServer(`${a}//${u}${d}`),updateEmulatorBanner("Auth",!0)):emitEmulatorWarning()}function extractProtocol(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function extractHostAndPort(n){const e=extractProtocol(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const a=o[1];return{host:a,port:parsePort(i.substr(a.length+1))}}else{const[a,u]=i.split(":");return{host:a,port:parsePort(u)}}}function parsePort(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function emitEmulatorWarning(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,t){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}}async function linkEmailPassword(n,e){return _performApiRequest(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithPassword(n,e){return _performSignInRequest(n,"POST","/v1/accounts:signInWithPassword",_addTidIfNecessary(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithEmailLink$1(n,e){return _performSignInRequest(n,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(n,e))}async function signInWithEmailLinkForLinking(n,e){return _performSignInRequest(n,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthCredential extends AuthCredential{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new EmailAuthCredential(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new EmailAuthCredential(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,t,"signInWithPassword",signInWithPassword);case"emailLink":return signInWithEmailLink$1(e,{email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,i,"signUpPassword",linkEmailPassword);case"emailLink":return signInWithEmailLinkForLinking(e,{idToken:t,email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(n,e){return _performSignInRequest(n,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_fail("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o}=t,a=__rest(t,["providerId","signInMethod"]);if(!i||!o)return null;const u=new OAuthCredential(i,o);return u.idToken=a.idToken||void 0,u.accessToken=a.accessToken||void 0,u.secret=a.secret,u.nonce=a.nonce,u.pendingToken=a.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return signInWithIdp(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,signInWithIdp(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,signInWithIdp(e,t)}buildRequest(){const e={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=querystring(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parseMode(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function parseDeepLink(n){const e=querystringDecode(extractQuerystring(n)).link,t=e?querystringDecode(extractQuerystring(e)).deep_link_id:null,i=querystringDecode(extractQuerystring(n)).deep_link_id;return(i?querystringDecode(extractQuerystring(i)).link:null)||i||t||e||n}class ActionCodeURL{constructor(e){var t,i,o,a,u,f;const d=querystringDecode(extractQuerystring(e)),p=(t=d.apiKey)!==null&&t!==void 0?t:null,_=(i=d.oobCode)!==null&&i!==void 0?i:null,R=parseMode((o=d.mode)!==null&&o!==void 0?o:null);_assert(p&&_&&R,"argument-error"),this.apiKey=p,this.operation=R,this.code=_,this.continueUrl=(a=d.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(u=d.lang)!==null&&u!==void 0?u:null,this.tenantId=(f=d.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=parseDeepLink(e);try{return new ActionCodeURL(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthProvider{constructor(){this.providerId=EmailAuthProvider.PROVIDER_ID}static credential(e,t){return EmailAuthCredential._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ActionCodeURL.parseLink(t);return _assert(i,"argument-error"),EmailAuthCredential._fromEmailAndCode(e,i.code,i.tenantId)}}EmailAuthProvider.PROVIDER_ID="password";EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD="password";EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return GoogleAuthProvider.credential(t,i)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,t){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return TwitterAuthProvider.credential(t,i)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signUp(n,e){return _performSignInRequest(n,"POST","/v1/accounts:signUp",_addTidIfNecessary(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const a=await UserImpl._fromIdTokenResponse(e,i,o),u=providerIdForResponse(i);return new UserCredentialImpl({user:a,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=providerIdForResponse(i);return new UserCredentialImpl({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function providerIdForResponse(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(e,t,i,o){var a;super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new MultiFactorError(e,t,i,o)}}function _processCredentialSavingMfaContextIfNecessary(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(n,a,e,i):a})}async function _link$1(n,e,t=!1){const i=await _logoutIfInvalidated(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return UserCredentialImpl._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(n,e,t=!1){const{auth:i}=n;if(_isFirebaseServerApp(i.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(i));const o="reauthenticate";try{const a=await _logoutIfInvalidated(n,_processCredentialSavingMfaContextIfNecessary(i,o,e,n),t);_assert(a.idToken,i,"internal-error");const u=_parseToken(a.idToken);_assert(u,i,"internal-error");const{sub:f}=u;return _assert(n.uid===f,i,"user-mismatch"),UserCredentialImpl._forOperation(n,o,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&_fail(i,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(n,e,t=!1){if(_isFirebaseServerApp(n.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(n));const i="signIn",o=await _processCredentialSavingMfaContextIfNecessary(n,i,e),a=await UserCredentialImpl._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(a.user),a}async function signInWithCredential(n,e){return _signInWithCredential(_castAuth(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function recachePasswordPolicy(n){const e=_castAuth(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function createUserWithEmailAndPassword(n,e,t){if(_isFirebaseServerApp(n.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(n));const i=_castAuth(n),u=await handleRecaptchaFlow(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",signUp).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&recachePasswordPolicy(n),d}),f=await UserCredentialImpl._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(f.user),f}function signInWithEmailAndPassword(n,e,t){return _isFirebaseServerApp(n.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(n)):signInWithCredential(getModularInstance(n),EmailAuthProvider.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&recachePasswordPolicy(n),i})}function onIdTokenChanged(n,e,t,i){return getModularInstance(n).onIdTokenChanged(e,t,i)}function beforeAuthStateChanged(n,e,t){return getModularInstance(n).beforeAuthStateChanged(e,t)}function onAuthStateChanged(n,e,t,i){return getModularInstance(n).onAuthStateChanged(e,t,i)}function signOut(n){return getModularInstance(n).signOut()}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,f,d)=>{this.notifyListeners(u,d)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);_isIE10()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,IE10_LOCAL_STORAGE_SYNC_DELAY):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Receiver(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:a}=t.data,u=this.handlersMap[o];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const f=Array.from(u).map(async p=>p(t.origin,a)),d=await _allSettled(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let a,u;return new Promise((f,d)=>{const p=_generateEventId("",20);o.port1.start();const _=setTimeout(()=>{d(new Error("unsupported_event"))},i);u={messageChannel:o,onMessage(R){const w=R;if(w.data.eventId===p)switch(w.data.status){case"ack":clearTimeout(_),a=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),f(w.data.response);break;default:clearTimeout(_),clearTimeout(a),d(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(n){_window().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return typeof _window().WorkerGlobalScope<"u"&&typeof _window().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function getObjectStore(n,e){return n.transaction([DB_OBJECTSTORE_NAME],e?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const n=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(n).toPromise()}function _openDatabase(){const n=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?e(i):(i.close(),await _deleteDatabase(),e(await _openDatabase()))})})}async function _putObject(n,e,t){const i=getObjectStore(n,!0).put({[DB_DATA_KEYPATH]:e,value:t});return new DBPromise(i).toPromise()}async function getObject(n,e){const t=getObjectStore(n,!1).get(e),i=await new DBPromise(t).toPromise();return i===void 0?null:i.value}function _deleteObject(n,e){const t=getObjectStore(n,!0).delete(e);return new DBPromise(t).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>_TRANSACTION_RETRY_COUNT)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _openDatabase();return await _putObject(e,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject(e,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>_putObject(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>getObject(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_deleteObject(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const a=getObjectStore(o,!1).getAll();return new DBPromise(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:a}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;new Delay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(n,e){return e?_getInstance(e):(_assert(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,t){return signInWithIdp(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function _signIn(n){return _signInWithCredential(n.auth,new IdpCredential(n),n.bypassAuthState)}function _reauth(n){const{auth:e,user:t}=n;return _assert(t,e,"internal-error"),_reauthenticate(t,new IdpCredential(n),n.bypassAuthState)}async function _link(n){const{auth:e,user:t}=n;return _assert(t,e,"internal-error"),_link$1(t,new IdpCredential(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(e,t,i,o,a=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:a,error:u,type:f}=e;if(u){this.reject(u);return}const d={auth:this.auth,requestUri:t,sessionId:i,tenantId:a||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(d))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,t,i,o,a){super(e,t,o,a),this.provider=i,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _assert(e,this.auth,"internal-error"),e}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_POLL_WINDOW_CLOSE_TIMEOUT.get())};e()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=redirectOutcomeMap.get(this.auth._key());if(!e){try{const i=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}redirectOutcomeMap.set(this.auth._key(),e)}return this.bypassAuthState||redirectOutcomeMap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(n,e){const t=pendingRedirectKey(e),i=resolverPersistence(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function _overrideRedirectResult(n,e){redirectOutcomeMap.set(n._key(),e)}function resolverPersistence(n){return _getInstance(n._redirectPersistence)}function pendingRedirectKey(n){return _persistenceKeyName(PENDING_REDIRECT_KEY,n.config.apiKey,n.name)}async function _getRedirectResult(n,e,t=!1){if(_isFirebaseServerApp(n.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(n));const i=_castAuth(n),o=_withDefaultResolver(i,e),u=await new RedirectAction(i,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!isNullRedirectEvent(e)){const o=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(_createError(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}}function eventUid(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function isRedirectEvent(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(n,e={}){return _performApiRequest(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin(n){if(n.config.emulator)return;const{authorizedDomains:e}=await _getProjectConfig(n);for(const t of e)try{if(matchDomain(t))return}catch{}_fail(n,"unauthorized-domain")}function matchDomain(n){const e=_getCurrentUrl(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!HTTP_REGEX.test(t))return!1;if(IP_ADDRESS_REGEX.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const n=_window().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function loadGapi(n){return new Promise((e,t)=>{var i,o,a;function u(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),t(_createError(n,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((o=(i=_window().gapi)===null||i===void 0?void 0:i.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((a=_window().gapi)===null||a===void 0)&&a.load)u();else{const f=_generateCallbackName("iframefcb");return _window()[f]=()=>{gapi.load?u():t(_createError(n,"network-request-failed"))},_loadJS(`${_gapiScriptUrl()}?onload=${f}`).catch(d=>t(d))}}).catch(e=>{throw cachedGApiLoader=null,e})}let cachedGApiLoader=null;function _loadGapi(n){return cachedGApiLoader=cachedGApiLoader||loadGapi(n),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(n){const e=n.config;_assert(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?_emulatorUrl(e,EMULATED_IFRAME_PATH):`https://${n.config.authDomain}/${IFRAME_PATH}`,i={apiKey:e.apiKey,appName:n.name,v:SDK_VERSION},o=EID_FROM_APIHOST.get(n.config.apiHost);o&&(i.eid=o);const a=n._getFrameworks();return a.length&&(i.fw=a.join(",")),`${t}?${querystring(i).slice(1)}`}async function _openIframe(n){const e=await _loadGapi(n),t=_window().gapi;return _assert(t,n,"internal-error"),e.open({where:document.body,url:getIframeUrl(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},i=>new Promise(async(o,a)=>{await i.restyle({setHideOnLeave:!1});const u=_createError(n,"network-request-failed"),f=_window().setTimeout(()=>{a(u)},PING_TIMEOUT.get());function d(){_window().clearTimeout(f),o(i)}i.ping(d).then(d,()=>{a(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(n,e,t,i=DEFAULT_WIDTH,o=DEFAULT_HEIGHT){const a=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const d=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:i.toString(),height:o.toString(),top:a,left:u}),p=getUA().toLowerCase();t&&(f=_isChromeIOS(p)?TARGET_BLANK:t),_isFirefox(p)&&(e=e||FIREFOX_EMPTY_URL,d.scrollbars="yes");const _=Object.entries(d).reduce((w,[V,U])=>`${w}${V}=${U},`,"");if(_isIOSStandalone(p)&&f!=="_self")return openAsNewWindowIOS(e||"",f),new AuthPopup(null);const R=window.open(e||"",f,_);_assert(R,n,"popup-blocked");try{R.focus()}catch{}return new AuthPopup(R)}function openAsNewWindowIOS(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler",FIREBASE_APP_CHECK_FRAGMENT_ID=encodeURIComponent("fac");async function _getRedirectUrl(n,e,t,i,o,a){_assert(n.config.authDomain,n,"auth-domain-config-required"),_assert(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:SDK_VERSION,eventId:o};if(e instanceof FederatedAuthProvider){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",isEmpty$1(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,R]of Object.entries({}))u[_]=R}if(e instanceof BaseOAuthProvider){const _=e.getScopes().filter(R=>R!=="");_.length>0&&(u.scopes=_.join(","))}n.tenantId&&(u.tid=n.tenantId);const f=u;for(const _ of Object.keys(f))f[_]===void 0&&delete f[_];const d=await n._getAppCheckToken(),p=d?`#${FIREBASE_APP_CHECK_FRAGMENT_ID}=${encodeURIComponent(d)}`:"";return`${getHandlerBase(n)}?${querystring(f).slice(1)}${p}`}function getHandlerBase({config:n}){return n.emulator?_emulatorUrl(n,EMULATOR_WIDGET_PATH):`https://${n.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup(e,t,i,o){var a;debugAssert((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const u=await _getRedirectUrl(e,t,i,_getCurrentUrl(),o);return _open(e,u,_generateEventId())}async _openRedirect(e,t,i,o){await this._originValidation(e);const a=await _getRedirectUrl(e,t,i,_getCurrentUrl(),o);return _setWindowLocation(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:a}=this.eventManagers[t];return o?Promise.resolve(o):(debugAssert(a,"If manager is not set, promise should be"),a)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await _openIframe(e),i=new AuthEventManager(e);return t.register("authEvent",o=>(_assert(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},o=>{var a;const u=(a=o==null?void 0:o[0])===null||a===void 0?void 0:a[WEB_STORAGE_SUPPORT_KEY];u!==void 0&&t(!!u),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=_validateOrigin(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;var name="@firebase/auth",version="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function registerAuth(n){_registerComponent(new Component("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=i.options;_assert(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:u,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(n)},p=new AuthImpl(i,o,a,d);return _initializeAuthInstance(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",e=>{const t=_castAuth(e.getProvider("auth").getImmediate());return(i=>new AuthInterop(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name,version,getVersionForPlatform(n)),registerVersion(name,version,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ID_TOKEN_MAX_AGE=5*60,authIdTokenMaxAge=getExperimentalSetting("authIdTokenMaxAge")||DEFAULT_ID_TOKEN_MAX_AGE;let lastPostedIdToken=null;const mintCookieFactory=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>authIdTokenMaxAge)return;const o=t==null?void 0:t.token;lastPostedIdToken!==o&&(lastPostedIdToken=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function getAuth(n=getApp()){const e=_getProvider(n,"auth");if(e.isInitialized())return e.getImmediate();const t=initializeAuth(n,{popupRedirectResolver:browserPopupRedirectResolver,persistence:[indexedDBLocalPersistence,browserLocalPersistence,browserSessionPersistence]}),i=getExperimentalSetting("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(i,location.origin);if(location.origin===a.origin){const u=mintCookieFactory(a.toString());beforeAuthStateChanged(t,u,()=>u(t.currentUser)),onIdTokenChanged(t,f=>u(f))}}const o=getDefaultEmulatorHost("auth");return o&&connectAuthEmulator(t,`http://${o}`),t}function getScriptParentElement(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}_setExternalJSProvider({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const a=_createError("internal-error");a.customData=o,t(a)},i.type="text/javascript",i.charset="UTF-8",getScriptParentElement().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});registerAuth("Browser");const firebaseConfig={apiKey:"AIzaSyDs6je5izuKZ2SZY_aZwoX4O5EVWVUd7Dc",authDomain:"jobtracker-pro-58e13.firebaseapp.com",projectId:"jobtracker-pro-58e13",storageBucket:"jobtracker-pro-58e13.appspot.com",messagingSenderId:"450732084575",appId:"1:450732084575:web:1c6374de027c1b2dd8faea",measurementId:"G-6P112P690J"},app=initializeApp(firebaseConfig),db=getFirestore(app),auth=getAuth(app);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function __awaiter(n,e,t,i){function o(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function f(_){try{p(i.next(_))}catch(R){u(R)}}function d(_){try{p(i.throw(_))}catch(R){u(R)}}function p(_){_.done?a(_.value):o(_.value).then(f,d)}p((i=i.apply(n,[])).next())})}function __generator(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,o,a,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(p){return function(_){return d([p,_])}}function d(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(a=p[0]&2?o.return:p[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,p[1])).done)return a;switch(o=0,a&&(p=[p[0]&2,a.value]),p[0]){case 0:case 1:a=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){t.label=p[1];break}if(p[0]===6&&t.label<a[1]){t.label=a[1],a=p;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(p);break}a[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],o=0}finally{i=a=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var __assign=function(){return __assign=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},__assign.apply(this,arguments)},defaultState=function(n){return{loading:n==null,value:n}},reducer=function(){return function(n,e){switch(e.type){case"error":return __assign(__assign({},n),{error:e.error,loading:!1,value:void 0});case"reset":return defaultState(e.defaultValue);case"value":return __assign(__assign({},n),{error:void 0,loading:!1,value:e.value});default:return n}}},useLoadingValue=function(n){var e=n?n():void 0,t=reactExports.useReducer(reducer(),defaultState(e)),i=t[0],o=t[1],a=reactExports.useCallback(function(){var d=n?n():void 0;o({type:"reset",defaultValue:d})},[n]),u=reactExports.useCallback(function(d){o({type:"error",error:d})},[]),f=reactExports.useCallback(function(d){o({type:"value",value:d})},[]);return reactExports.useMemo(function(){return{error:i.error,loading:i.loading,reset:a,setError:u,setValue:f,value:i.value}},[i.error,i.loading,a,u,f,i.value])},useAuthState=function(n,e){var t=useLoadingValue(function(){return n.currentUser}),i=t.error,o=t.loading,a=t.setError,u=t.setValue,f=t.value;return reactExports.useEffect(function(){var d=onAuthStateChanged(n,function(p){return __awaiter(void 0,void 0,void 0,function(){var _;return __generator(this,function(R){switch(R.label){case 0:return[3,4];case 1:return R.trys.push([1,3,,4]),[4,e.onUserChanged(p)];case 2:return R.sent(),[3,4];case 3:return _=R.sent(),a(_),[3,4];case 4:return u(p),[2]}})})},a);return function(){d()}},[n]),[f,o,i]};const navLinks=[{name:"Dashboard",path:"/dashboard"},{name:"Job Tracker",path:"/tracker"},{name:"Resume Analyzer",path:"/analyzer"},{name:"Keyword Finder",path:"/matcher"},{name:"Resume Matcher",path:"/resume-match"}];function Navbar(){const n=useLocation(),[e]=useAuthState(auth),t=useNavigate(),[i,o]=reactExports.useState(!1),a=async()=>{await signOut(auth),o(!1),t("/")};return jsxRuntimeExports.jsx("nav",{className:"bg-zinc-900 text-white px-6 py-4 shadow-md sticky top-0 z-50",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-blue-400",children:"JobTracker Pro"}),e?jsxRuntimeExports.jsxs("div",{className:"flex gap-6 items-center relative",children:[navLinks.map(u=>jsxRuntimeExports.jsx(Link,{to:u.path,className:`hover:text-blue-400 transition duration-200 ${n.pathname===u.path?"text-blue-500 underline underline-offset-4":""}`,children:u.name},u.path)),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{onClick:()=>o(!i),className:"text-sm px-3 py-1 bg-red-500 rounded hover:bg-red-600",children:"Logout"}),i&&jsxRuntimeExports.jsxs("div",{className:"absolute right-0 mt-2 bg-zinc-800 border border-zinc-700 rounded shadow-md z-50 w-48",children:[jsxRuntimeExports.jsx("p",{className:"px-4 py-2 text-sm text-center",children:"Are you sure?"}),jsxRuntimeExports.jsxs("div",{className:"flex justify-around pb-2",children:[jsxRuntimeExports.jsx("button",{onClick:a,className:"text-green-400 hover:underline",children:"Yes"}),jsxRuntimeExports.jsx("button",{onClick:()=>o(!1),className:"text-red-400 hover:underline",children:"Cancel"})]})]})]})]}):jsxRuntimeExports.jsx(Link,{to:"/auth",className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-white text-sm",children:"Start Now"})]})})}var DefaultContext={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},IconContext=React.createContext&&React.createContext(DefaultContext),_excluded=["attr","size","title"];function _objectWithoutProperties(n,e){if(n==null)return{};var t=_objectWithoutPropertiesLoose(n,e),i,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(o=0;o<a.length;o++)i=a[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function _objectWithoutPropertiesLoose(n,e){if(n==null)return{};var t={};for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},_extends.apply(this,arguments)}function ownKeys(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function _objectSpread(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(i){_defineProperty(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function _defineProperty(n,e,t){return e=_toPropertyKey(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _toPropertyKey(n){var e=_toPrimitive(n,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Tree2Element(n){return n&&n.map((e,t)=>React.createElement(e.tag,_objectSpread({key:t},e.attr),Tree2Element(e.child)))}function GenIcon(n){return e=>React.createElement(IconBase,_extends({attr:_objectSpread({},n.attr)},e),Tree2Element(n.child))}function IconBase(n){var e=t=>{var{attr:i,size:o,title:a}=n,u=_objectWithoutProperties(n,_excluded),f=o||t.size||"1em",d;return t.className&&(d=t.className),n.className&&(d=(d?d+" ":"")+n.className),React.createElement("svg",_extends({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,u,{className:d,style:_objectSpread(_objectSpread({color:n.color||t.color},t.style),n.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),a&&React.createElement("title",null,a),n.children)};return IconContext!==void 0?React.createElement(IconContext.Consumer,null,t=>e(t)):e(DefaultContext)}function FaGithub(n){return GenIcon({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(n)}function FaLinkedin(n){return GenIcon({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"},child:[]}]})(n)}function FaEnvelope(n){return GenIcon({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(n)}function FaPhone(n){return GenIcon({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(n)}function Footer(){return jsxRuntimeExports.jsx("footer",{className:"bg-zinc-900 text-white py-6 mt-10 border-t border-zinc-800",children:jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto px-6 flex flex-col md:flex-row items-center justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center md:text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold",children:" Built using React, Firebase, Tailwind CSS by Thulasi Rahul J"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-zinc-400",children:[" ",new Date().getFullYear()," All rights reserved."]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-6 items-center text-blue-400 text-xl",children:[jsxRuntimeExports.jsx("a",{href:"mailto:chotumandela@gmail.com",className:"hover:text-blue-500 transition",title:"Email",children:jsxRuntimeExports.jsx(FaEnvelope,{})}),jsxRuntimeExports.jsx("a",{href:"tel:+917010510975",className:"hover:text-blue-500 transition",title:"Phone",children:jsxRuntimeExports.jsx(FaPhone,{})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/thulasirahul",target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-500 transition",title:"GitHub",children:jsxRuntimeExports.jsx(FaGithub,{})}),jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/thulasirahulj/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-500 transition",title:"LinkedIn",children:jsxRuntimeExports.jsx(FaLinkedin,{})})]})]})})}function Home(){return jsxRuntimeExports.jsxs("div",{className:"relative overflow-hidden min-h-screen flex flex-col items-center justify-center text-white bg-gradient-to-br from-zinc-900 to-black px-6",children:[jsxRuntimeExports.jsx("div",{className:"blob bg-blue-500 w-96 h-96 top-10 left-[-100px]"}),jsxRuntimeExports.jsx("div",{className:"blob bg-purple-500 w-72 h-72 bottom-20 right-[-80px]"}),jsxRuntimeExports.jsx("div",{className:"blob bg-pink-500 w-80 h-80 top-1/3 right-[-100px]"}),jsxRuntimeExports.jsxs("div",{className:"z-10 text-center max-w-xl",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl sm:text-5xl font-bold mb-4",children:"Welcome to JobTracker Pro"}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 text-lg mb-8",children:"Track your job applications, optimize resumes, and land your dream job  all in one place."}),jsxRuntimeExports.jsx(Link,{to:"/auth",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded text-lg transition",children:"Start Now"})]})]})}function Dashboard(){const[n,e]=reactExports.useState({total:0,interview:0,offer:0});return reactExports.useEffect(()=>{const t=auth.currentUser;if(!t)return;const i=query(collection(db,"applications"),where("userId","==",t.uid)),o=onSnapshot(i,a=>{const u=a.docs.map(f=>f.data());e({total:u.length,interview:u.filter(f=>f.status==="Interview").length,offer:u.filter(f=>f.status==="Offer").length})});return()=>o()},[]),jsxRuntimeExports.jsxs("div",{className:"p-6 text-white min-h-screen flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold mb-8 text-blue-400",children:" Dashboard"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-5xl",children:[jsxRuntimeExports.jsxs("div",{className:"bg-blue-950 bg-opacity-30 p-6 rounded-xl shadow-md hover:scale-105 transition-transform",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-blue-300",children:"Total Applications"}),jsxRuntimeExports.jsx("p",{className:"text-3xl font-bold mt-2",children:n.total})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-950 bg-opacity-30 p-6 rounded-xl shadow-md hover:scale-105 transition-transform",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-blue-300",children:"Interviews Scheduled"}),jsxRuntimeExports.jsx("p",{className:"text-3xl font-bold mt-2",children:n.interview})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-950 bg-opacity-30 p-6 rounded-xl shadow-md hover:scale-105 transition-transform",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-blue-300",children:"Offers Received"}),jsxRuntimeExports.jsx("p",{className:"text-3xl font-bold mt-2",children:n.offer})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-10 w-full max-w-5xl bg-zinc-900 bg-opacity-50 p-6 rounded-xl shadow-md",children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-semibold mb-2 text-blue-400",children:" Insights"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400",children:"Charts and analytics will appear here soon."})]})]})}function JobTracker(){const[n,e]=reactExports.useState([]),[t,i]=reactExports.useState({company:"",role:"",status:"Applied",notes:""}),[o,a]=reactExports.useState(null);reactExports.useEffect(()=>{if(!auth.currentUser)return;const R=query(collection(db,"applications"),where("userId","==",auth.currentUser.uid)),w=onSnapshot(R,V=>{const U=V.docs.map(X=>({id:X.id,...X.data()}));e(U)});return()=>w()},[]);const u=R=>{i({...t,[R.target.name]:R.target.value})},f=async()=>{if(!t.company||!t.role){alert("Company and Role are required.");return}await addDoc(collection(db,"applications"),{...t,userId:auth.currentUser.uid}),i({company:"",role:"",status:"Applied",notes:""})},d=async R=>{await deleteDoc(doc(db,"applications",R))},p=R=>{i(R),a(R.id)},_=async()=>{await updateDoc(doc(db,"applications",o),t),a(null),i({company:"",role:"",status:"Applied",notes:""})};return jsxRuntimeExports.jsxs("div",{className:"max-w-5xl mx-auto mt-10 p-6 text-white min-h-screen flex flex-col",children:[jsxRuntimeExports.jsx("h2",{className:"text-4xl font-bold mb-6 text-blue-400",children:" Job Tracker"}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-950 bg-opacity-30 p-6 rounded-lg shadow-md mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-4",children:[jsxRuntimeExports.jsx("input",{name:"company",value:t.company,onChange:u,placeholder:"Company",className:"p-2 rounded border border-zinc-600 bg-zinc-800 text-white"}),jsxRuntimeExports.jsx("input",{name:"role",value:t.role,onChange:u,placeholder:"Role",className:"p-2 rounded border border-zinc-600 bg-zinc-800 text-white"}),jsxRuntimeExports.jsxs("select",{name:"status",value:t.status,onChange:u,className:"p-2 rounded border border-zinc-600 bg-zinc-800 text-white",children:[jsxRuntimeExports.jsx("option",{value:"Applied",children:"Applied"}),jsxRuntimeExports.jsx("option",{value:"Interview",children:"Interview"}),jsxRuntimeExports.jsx("option",{value:"Offer",children:"Offer"}),jsxRuntimeExports.jsx("option",{value:"Rejected",children:"Rejected"})]}),jsxRuntimeExports.jsx("button",{onClick:o?_:f,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:o?"Update Job":"Add Job"})]}),jsxRuntimeExports.jsx("textarea",{name:"notes",value:t.notes,onChange:u,placeholder:"Notes...",className:"w-full p-2 rounded border border-zinc-600 bg-zinc-800 text-white resize-none",rows:3})]}),n.length===0?jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-center",children:"No jobs tracked yet."}):jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:n.map(R=>jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-4 rounded-lg shadow-md flex justify-between items-start hover:scale-[1.02] transition",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-blue-300",children:R.company}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-400",children:R.role}),jsxRuntimeExports.jsxs("p",{className:"mt-2 text-sm",children:[jsxRuntimeExports.jsx("strong",{children:"Status:"})," ",R.status]}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-300",children:R.notes})]}),jsxRuntimeExports.jsxs("div",{className:"space-x-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>p(R),className:"text-sm px-3 py-1 bg-yellow-400 text-black rounded hover:bg-yellow-500",children:"Edit"}),jsxRuntimeExports.jsx("button",{onClick:()=>d(R.id),className:"text-sm px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700",children:"Delete"})]})]},R.id))})]})}function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(e,t){module.exports=e.pdfjsLib=t()})(globalThis,()=>(()=>{var __webpack_modules__=[,(n,e)=>{var kn;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=ie,e.bytesToString=Be,e.createValidAbsoluteUrl=re,e.getModificationDate=nt,e.getUuid=hn,e.getVerbosityLevel=ve,e.info=Re,e.isArrayBuffer=Se,e.isArrayEqual=rt,e.isNodeJS=void 0,e.normalizeUnicode=Ut,e.objectFromMap=Ze,e.objectSize=Xe,e.setVerbosityLevel=we,e.shadow=Y,e.string32=Ke,e.stringToBytes=ze,e.stringToPDFString=$e,e.stringToUTF8String=et,e.unreachable=ge,e.utf8StringToString=Qe,e.warn=_e;const t=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=t;const i=[1,0,0,1,0,0];e.IDENTITY_MATRIX=i;const o=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=o;const a=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=a;const u=1.35;e.LINE_FACTOR=u;const f=.35;e.LINE_DESCENT_FACTOR=f;const d=f/u;e.BASELINE_FACTOR=d;const p={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=p;const _={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=_;const R="pdfjs_internal_editor_";e.AnnotationEditorPrefix=R;const w={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=w;const V={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=V;const U={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=U;const X={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=X;const b={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=b;const K={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=K;const Z={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=Z;const oe={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=oe;const te={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=te;const H={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=H;const J={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=J;const y={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=y;const g={O:"PageOpen",C:"PageClose"};e.PageActionEventType=g;const E={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=E;const W={NONE:0,BINARY:1};e.CMapCompressionType=W;const v={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=v;const D={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=D;let C=E.WARNINGS;function we(Ye){Number.isInteger(Ye)&&(C=Ye)}function ve(){return C}function Re(Ye){C>=E.INFOS&&console.log(`Info: ${Ye}`)}function _e(Ye){C>=E.WARNINGS&&console.log(`Warning: ${Ye}`)}function ge(Ye){throw new Error(Ye)}function ie(Ye,Ve){Ye||ge(Ve)}function fe(Ye){switch(Ye==null?void 0:Ye.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function re(Ye,Ve=null,Ne=null){if(!Ye)return null;try{if(Ne&&typeof Ye=="string"){if(Ne.addDefaultProtocol&&Ye.startsWith("www.")){const In=Ye.match(/\./g);(In==null?void 0:In.length)>=2&&(Ye=`http://${Ye}`)}if(Ne.tryConvertEncoding)try{Ye=et(Ye)}catch{}}const Dt=Ve?new URL(Ye,Ve):new URL(Ye);if(fe(Dt))return Dt}catch{}return null}function Y(Ye,Ve,Ne,Dt=!1){return Object.defineProperty(Ye,Ve,{value:Ne,enumerable:!Dt,configurable:!0,writable:!1}),Ne}const I=function(){function Ve(Ne,Dt){this.constructor===Ve&&ge("Cannot initialize BaseException."),this.message=Ne,this.name=Dt}return Ve.prototype=new Error,Ve.constructor=Ve,Ve}();e.BaseException=I;class S extends I{constructor(Ve,Ne){super(Ve,"PasswordException"),this.code=Ne}}e.PasswordException=S;class ee extends I{constructor(Ve,Ne){super(Ve,"UnknownErrorException"),this.details=Ne}}e.UnknownErrorException=ee;class le extends I{constructor(Ve){super(Ve,"InvalidPDFException")}}e.InvalidPDFException=le;class ce extends I{constructor(Ve){super(Ve,"MissingPDFException")}}e.MissingPDFException=ce;class he extends I{constructor(Ve,Ne){super(Ve,"UnexpectedResponseException"),this.status=Ne}}e.UnexpectedResponseException=he;class Ee extends I{constructor(Ve){super(Ve,"FormatError")}}e.FormatError=Ee;class be extends I{constructor(Ve){super(Ve,"AbortException")}}e.AbortException=be;function Be(Ye){(typeof Ye!="object"||(Ye==null?void 0:Ye.length)===void 0)&&ge("Invalid argument for bytesToString");const Ve=Ye.length,Ne=8192;if(Ve<Ne)return String.fromCharCode.apply(null,Ye);const Dt=[];for(let In=0;In<Ve;In+=Ne){const Pn=Math.min(In+Ne,Ve),pe=Ye.subarray(In,Pn);Dt.push(String.fromCharCode.apply(null,pe))}return Dt.join("")}function ze(Ye){typeof Ye!="string"&&ge("Invalid argument for stringToBytes");const Ve=Ye.length,Ne=new Uint8Array(Ve);for(let Dt=0;Dt<Ve;++Dt)Ne[Dt]=Ye.charCodeAt(Dt)&255;return Ne}function Ke(Ye){return String.fromCharCode(Ye>>24&255,Ye>>16&255,Ye>>8&255,Ye&255)}function Xe(Ye){return Object.keys(Ye).length}function Ze(Ye){const Ve=Object.create(null);for(const[Ne,Dt]of Ye)Ve[Ne]=Dt;return Ve}function xe(){const Ye=new Uint8Array(4);return Ye[0]=1,new Uint32Array(Ye.buffer,0,1)[0]===1}function De(){try{return new Function(""),!0}catch{return!1}}class se{static get isLittleEndian(){return Y(this,"isLittleEndian",xe())}static get isEvalSupported(){return Y(this,"isEvalSupported",De())}static get isOffscreenCanvasSupported(){return Y(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Y(this,"platform",{isWin:!1,isMac:!1}):Y(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Ve,Ne;return Y(this,"isCSSRoundSupported",(Ne=(Ve=globalThis.CSS)==null?void 0:Ve.supports)==null?void 0:Ne.call(Ve,"width: round(1.5px, 1px)"))}}e.FeatureTest=se;const me=[...Array(256).keys()].map(Ye=>Ye.toString(16).padStart(2,"0"));class Te{static makeHexColor(Ve,Ne,Dt){return`#${me[Ve]}${me[Ne]}${me[Dt]}`}static scaleMinMax(Ve,Ne){let Dt;Ve[0]?(Ve[0]<0&&(Dt=Ne[0],Ne[0]=Ne[1],Ne[1]=Dt),Ne[0]*=Ve[0],Ne[1]*=Ve[0],Ve[3]<0&&(Dt=Ne[2],Ne[2]=Ne[3],Ne[3]=Dt),Ne[2]*=Ve[3],Ne[3]*=Ve[3]):(Dt=Ne[0],Ne[0]=Ne[2],Ne[2]=Dt,Dt=Ne[1],Ne[1]=Ne[3],Ne[3]=Dt,Ve[1]<0&&(Dt=Ne[2],Ne[2]=Ne[3],Ne[3]=Dt),Ne[2]*=Ve[1],Ne[3]*=Ve[1],Ve[2]<0&&(Dt=Ne[0],Ne[0]=Ne[1],Ne[1]=Dt),Ne[0]*=Ve[2],Ne[1]*=Ve[2]),Ne[0]+=Ve[4],Ne[1]+=Ve[4],Ne[2]+=Ve[5],Ne[3]+=Ve[5]}static transform(Ve,Ne){return[Ve[0]*Ne[0]+Ve[2]*Ne[1],Ve[1]*Ne[0]+Ve[3]*Ne[1],Ve[0]*Ne[2]+Ve[2]*Ne[3],Ve[1]*Ne[2]+Ve[3]*Ne[3],Ve[0]*Ne[4]+Ve[2]*Ne[5]+Ve[4],Ve[1]*Ne[4]+Ve[3]*Ne[5]+Ve[5]]}static applyTransform(Ve,Ne){const Dt=Ve[0]*Ne[0]+Ve[1]*Ne[2]+Ne[4],In=Ve[0]*Ne[1]+Ve[1]*Ne[3]+Ne[5];return[Dt,In]}static applyInverseTransform(Ve,Ne){const Dt=Ne[0]*Ne[3]-Ne[1]*Ne[2],In=(Ve[0]*Ne[3]-Ve[1]*Ne[2]+Ne[2]*Ne[5]-Ne[4]*Ne[3])/Dt,Pn=(-Ve[0]*Ne[1]+Ve[1]*Ne[0]+Ne[4]*Ne[1]-Ne[5]*Ne[0])/Dt;return[In,Pn]}static getAxialAlignedBoundingBox(Ve,Ne){const Dt=this.applyTransform(Ve,Ne),In=this.applyTransform(Ve.slice(2,4),Ne),Pn=this.applyTransform([Ve[0],Ve[3]],Ne),pe=this.applyTransform([Ve[2],Ve[1]],Ne);return[Math.min(Dt[0],In[0],Pn[0],pe[0]),Math.min(Dt[1],In[1],Pn[1],pe[1]),Math.max(Dt[0],In[0],Pn[0],pe[0]),Math.max(Dt[1],In[1],Pn[1],pe[1])]}static inverseTransform(Ve){const Ne=Ve[0]*Ve[3]-Ve[1]*Ve[2];return[Ve[3]/Ne,-Ve[1]/Ne,-Ve[2]/Ne,Ve[0]/Ne,(Ve[2]*Ve[5]-Ve[4]*Ve[3])/Ne,(Ve[4]*Ve[1]-Ve[5]*Ve[0])/Ne]}static singularValueDecompose2dScale(Ve){const Ne=[Ve[0],Ve[2],Ve[1],Ve[3]],Dt=Ve[0]*Ne[0]+Ve[1]*Ne[2],In=Ve[0]*Ne[1]+Ve[1]*Ne[3],Pn=Ve[2]*Ne[0]+Ve[3]*Ne[2],pe=Ve[2]*Ne[1]+Ve[3]*Ne[3],We=(Dt+pe)/2,pt=Math.sqrt((Dt+pe)**2-4*(Dt*pe-Pn*In))/2,Lt=We+pt||1,un=We-pt||1;return[Math.sqrt(Lt),Math.sqrt(un)]}static normalizeRect(Ve){const Ne=Ve.slice(0);return Ve[0]>Ve[2]&&(Ne[0]=Ve[2],Ne[2]=Ve[0]),Ve[1]>Ve[3]&&(Ne[1]=Ve[3],Ne[3]=Ve[1]),Ne}static intersect(Ve,Ne){const Dt=Math.max(Math.min(Ve[0],Ve[2]),Math.min(Ne[0],Ne[2])),In=Math.min(Math.max(Ve[0],Ve[2]),Math.max(Ne[0],Ne[2]));if(Dt>In)return null;const Pn=Math.max(Math.min(Ve[1],Ve[3]),Math.min(Ne[1],Ne[3])),pe=Math.min(Math.max(Ve[1],Ve[3]),Math.max(Ne[1],Ne[3]));return Pn>pe?null:[Dt,Pn,In,pe]}static bezierBoundingBox(Ve,Ne,Dt,In,Pn,pe,We,pt){const Lt=[],un=[[],[]];let kt,de,ae,Ae,Me,Ue,qe,tt;for(let An=0;An<2;++An){if(An===0?(de=6*Ve-12*Dt+6*Pn,kt=-3*Ve+9*Dt-9*Pn+3*We,ae=3*Dt-3*Ve):(de=6*Ne-12*In+6*pe,kt=-3*Ne+9*In-9*pe+3*pt,ae=3*In-3*Ne),Math.abs(kt)<1e-12){if(Math.abs(de)<1e-12)continue;Ae=-ae/de,0<Ae&&Ae<1&&Lt.push(Ae);continue}qe=de*de-4*ae*kt,tt=Math.sqrt(qe),!(qe<0)&&(Me=(-de+tt)/(2*kt),0<Me&&Me<1&&Lt.push(Me),Ue=(-de-tt)/(2*kt),0<Ue&&Ue<1&&Lt.push(Ue))}let Wt=Lt.length,Bt;const Et=Wt;for(;Wt--;)Ae=Lt[Wt],Bt=1-Ae,un[0][Wt]=Bt*Bt*Bt*Ve+3*Bt*Bt*Ae*Dt+3*Bt*Ae*Ae*Pn+Ae*Ae*Ae*We,un[1][Wt]=Bt*Bt*Bt*Ne+3*Bt*Bt*Ae*In+3*Bt*Ae*Ae*pe+Ae*Ae*Ae*pt;return un[0][Et]=Ve,un[1][Et]=Ne,un[0][Et+1]=We,un[1][Et+1]=pt,un[0].length=un[1].length=Et+2,[Math.min(...un[0]),Math.min(...un[1]),Math.max(...un[0]),Math.max(...un[1])]}}e.Util=Te;const Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function $e(Ye){if(Ye[0]>=""){let Ne;if(Ye[0]===""&&Ye[1]===""?Ne="utf-16be":Ye[0]===""&&Ye[1]===""?Ne="utf-16le":Ye[0]===""&&Ye[1]===""&&Ye[2]===""&&(Ne="utf-8"),Ne)try{const Dt=new TextDecoder(Ne,{fatal:!0}),In=ze(Ye);return Dt.decode(In)}catch(Dt){_e(`stringToPDFString: "${Dt}".`)}}const Ve=[];for(let Ne=0,Dt=Ye.length;Ne<Dt;Ne++){const In=Ce[Ye.charCodeAt(Ne)];Ve.push(In?String.fromCharCode(In):Ye.charAt(Ne))}return Ve.join("")}function et(Ye){return decodeURIComponent(escape(Ye))}function Qe(Ye){return unescape(encodeURIComponent(Ye))}function Se(Ye){return typeof Ye=="object"&&(Ye==null?void 0:Ye.byteLength)!==void 0}function rt(Ye,Ve){if(Ye.length!==Ve.length)return!1;for(let Ne=0,Dt=Ye.length;Ne<Dt;Ne++)if(Ye[Ne]!==Ve[Ne])return!1;return!0}function nt(Ye=new Date){return[Ye.getUTCFullYear().toString(),(Ye.getUTCMonth()+1).toString().padStart(2,"0"),Ye.getUTCDate().toString().padStart(2,"0"),Ye.getUTCHours().toString().padStart(2,"0"),Ye.getUTCMinutes().toString().padStart(2,"0"),Ye.getUTCSeconds().toString().padStart(2,"0")].join("")}class mn{constructor(){Fe(this,kn,!1);this.promise=new Promise((Ve,Ne)=>{this.resolve=Dt=>{Oe(this,kn,!0),Ve(Dt)},this.reject=Dt=>{Oe(this,kn,!0),Ne(Dt)}})}get settled(){return T(this,kn)}}kn=new WeakMap,e.PromiseCapability=mn;let fn=null,Rn=null;function Ut(Ye){return fn||(fn=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Rn=new Map([["","t"]])),Ye.replaceAll(fn,(Ve,Ne,Dt)=>Ne?Ne.normalize("NFKC"):Rn.get(Dt))}function hn(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Ye=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Ye);else for(let Ve=0;Ve<32;Ve++)Ye[Ve]=Math.floor(Math.random()*255);return Be(Ye)}const bn="pdfjs_internal_id_";e.AnnotationPrefix=bn},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var n,t,i,o,Ys,Za,f,d,p,_,R,w,V,U,X,el,K,Z,Uu,te,H;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(y){if(typeof y=="string"||y instanceof URL?y={url:y}:(0,_util.isArrayBuffer)(y)&&(y={data:y}),typeof y!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!y.url&&!y.data&&!y.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const g=new PDFDocumentLoadingTask,{docId:E}=g,W=y.url?getUrlProp(y.url):null,v=y.data?getDataProp(y.data):null,D=y.httpHeaders||null,C=y.withCredentials===!0,we=y.password??null,ve=y.range instanceof PDFDataRangeTransport?y.range:null,Re=Number.isInteger(y.rangeChunkSize)&&y.rangeChunkSize>0?y.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let _e=y.worker instanceof PDFWorker?y.worker:null;const ge=y.verbosity,ie=typeof y.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(y.docBaseUrl)?y.docBaseUrl:null,fe=typeof y.cMapUrl=="string"?y.cMapUrl:null,re=y.cMapPacked!==!1,Y=y.CMapReaderFactory||DefaultCMapReaderFactory,I=typeof y.standardFontDataUrl=="string"?y.standardFontDataUrl:null,S=y.StandardFontDataFactory||DefaultStandardFontDataFactory,ee=y.stopAtErrors!==!0,le=Number.isInteger(y.maxImageSize)&&y.maxImageSize>-1?y.maxImageSize:-1,ce=y.isEvalSupported!==!1,he=typeof y.isOffscreenCanvasSupported=="boolean"?y.isOffscreenCanvasSupported:!_util.isNodeJS,Ee=Number.isInteger(y.canvasMaxAreaInBytes)?y.canvasMaxAreaInBytes:-1,be=typeof y.disableFontFace=="boolean"?y.disableFontFace:_util.isNodeJS,Be=y.fontExtraProperties===!0,ze=y.enableXfa===!0,Ke=y.ownerDocument||globalThis.document,Xe=y.disableRange===!0,Ze=y.disableStream===!0,xe=y.disableAutoFetch===!0,De=y.pdfBug===!0,se=ve?ve.length:y.length??NaN,me=typeof y.useSystemFonts=="boolean"?y.useSystemFonts:!_util.isNodeJS&&!be,Te=typeof y.useWorkerFetch=="boolean"?y.useWorkerFetch:Y===_display_utils.DOMCMapReaderFactory&&S===_display_utils.DOMStandardFontDataFactory&&fe&&I&&(0,_display_utils.isValidFetchUrl)(fe,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(I,document.baseURI),Ce=y.canvasFactory||new DefaultCanvasFactory({ownerDocument:Ke}),$e=y.filterFactory||new DefaultFilterFactory({docId:E,ownerDocument:Ke}),et=null;(0,_util.setVerbosityLevel)(ge);const Qe={canvasFactory:Ce,filterFactory:$e};if(Te||(Qe.cMapReaderFactory=new Y({baseUrl:fe,isCompressed:re}),Qe.standardFontDataFactory=new S({baseUrl:I})),!_e){const nt={verbosity:ge,port:_worker_options.GlobalWorkerOptions.workerPort};_e=nt.port?PDFWorker.fromPort(nt):new PDFWorker(nt),g._worker=_e}const Se={docId:E,apiVersion:"3.11.174",data:v,password:we,disableAutoFetch:xe,rangeChunkSize:Re,length:se,docBaseUrl:ie,enableXfa:ze,evaluatorOptions:{maxImageSize:le,disableFontFace:be,ignoreErrors:ee,isEvalSupported:ce,isOffscreenCanvasSupported:he,canvasMaxAreaInBytes:Ee,fontExtraProperties:Be,useSystemFonts:me,cMapUrl:Te?fe:null,standardFontDataUrl:Te?I:null}},rt={ignoreErrors:ee,isEvalSupported:ce,disableFontFace:be,fontExtraProperties:Be,enableXfa:ze,ownerDocument:Ke,disableAutoFetch:xe,pdfBug:De,styleElement:et};return _e.promise.then(function(){if(g.destroyed)throw new Error("Loading aborted");const nt=_fetchDocument(_e,Se),mn=new Promise(function(fn){let Rn;ve?Rn=new _transport_stream.PDFDataTransportStream({length:se,initialData:ve.initialData,progressiveDone:ve.progressiveDone,contentDispositionFilename:ve.contentDispositionFilename,disableRange:Xe,disableStream:Ze},ve):v||(Rn=(hn=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(hn):(0,_display_utils.isValidFetchUrl)(hn.url)?new _displayFetch_stream.PDFFetchStream(hn):new _displayNetwork.PDFNetworkStream(hn))({url:W,length:se,httpHeaders:D,withCredentials:C,rangeChunkSize:Re,disableRange:Xe,disableStream:Ze})),fn(Rn)});return Promise.all([nt,mn]).then(function([fn,Rn]){if(g.destroyed)throw new Error("Loading aborted");const Ut=new _message_handler.MessageHandler(E,fn,_e.port),hn=new WorkerTransport(Ut,g,Rn,rt,Qe);g._transport=hn,Ut.send("Ready",null)})}).catch(g._capability.reject),g}async function _fetchDocument(y,g){if(y.destroyed)throw new Error("Worker was destroyed");const E=await y.messageHandler.sendWithPromise("GetDocRequest",g,g.data?[g.data.buffer]:null);if(y.destroyed)throw new Error("Worker was destroyed");return E}function getUrlProp(y){if(y instanceof URL)return y.href;try{return new URL(y,window.location).href}catch{if(_util.isNodeJS&&typeof y=="string")return y}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(y){if(_util.isNodeJS&&typeof Buffer<"u"&&y instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(y instanceof Uint8Array&&y.byteLength===y.buffer.byteLength)return y;if(typeof y=="string")return(0,_util.stringToBytes)(y);if(typeof y=="object"&&!isNaN(y==null?void 0:y.length)||(0,_util.isArrayBuffer)(y))return new Uint8Array(y);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Mo(e,n)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var g,E,W;this.destroyed=!0;try{(g=this._worker)!=null&&g.port&&(this._worker._pendingDestroy=!0),await((E=this._transport)==null?void 0:E.destroy())}catch(v){throw(W=this._worker)!=null&&W.port&&delete this._worker._pendingDestroy,v}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};n=new WeakMap,Fe(e,n,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(g,E,W=!1,v=null){this.length=g,this.initialData=E,this.progressiveDone=W,this.contentDispositionFilename=v,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(g){this._rangeListeners.push(g)}addProgressListener(g){this._progressListeners.push(g)}addProgressiveReadListener(g){this._progressiveReadListeners.push(g)}addProgressiveDoneListener(g){this._progressiveDoneListeners.push(g)}onDataRange(g,E){for(const W of this._rangeListeners)W(g,E)}onDataProgress(g,E){this._readyCapability.promise.then(()=>{for(const W of this._progressListeners)W(g,E)})}onDataProgressiveRead(g){this._readyCapability.promise.then(()=>{for(const E of this._progressiveReadListeners)E(g)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const g of this._progressiveDoneListeners)g()})}transportReady(){this._readyCapability.resolve()}requestDataRange(g,E){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(g,E){this._pdfInfo=g,this._transport=E,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(W=>{if(!W)return W;const v=[];for(const D in W)v.push(...W[D]);return v}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(g){return this._transport.getPage(g)}getPageIndex(g){return this._transport.getPageIndex(g)}getDestinations(){return this._transport.getDestinations()}getDestination(g){return this._transport.getDestination(g)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(g=!1){return this._transport.startCleanup(g||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(g,E,W,v=!1){Fe(this,o);Fe(this,t,null);Fe(this,i,!1);this._pageIndex=g,this._pageInfo=E,this._transport=W,this._stats=v?new _display_utils.StatTimer:null,this._pdfBug=v,this.commonObjs=W.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:g,rotation:E=this.rotate,offsetX:W=0,offsetY:v=0,dontFlip:D=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:g,rotation:E,offsetX:W,offsetY:v,dontFlip:D})}getAnnotations({intent:g="display"}={}){const E=this._transport.getRenderingIntent(g);return this._transport.getAnnotations(this._pageIndex,E.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var g;return((g=this._transport._htmlForXfa)==null?void 0:g.children[this._pageIndex])||null}render({canvasContext:g,viewport:E,intent:W="display",annotationMode:v=_util.AnnotationMode.ENABLE,transform:D=null,background:C=null,optionalContentConfigPromise:we=null,annotationCanvasMap:ve=null,pageColors:Re=null,printAnnotationStorage:_e=null}){var S,ee;(S=this._stats)==null||S.time("Overall");const ge=this._transport.getRenderingIntent(W,v,_e);Oe(this,i,!1),Pe(this,o,Za).call(this),we||(we=this._transport.getOptionalContentConfig());let ie=this._intentStates.get(ge.cacheKey);ie||(ie=Object.create(null),this._intentStates.set(ge.cacheKey,ie)),ie.streamReaderCancelTimeout&&(clearTimeout(ie.streamReaderCancelTimeout),ie.streamReaderCancelTimeout=null);const fe=!!(ge.renderingIntent&_util.RenderingIntentFlag.PRINT);ie.displayReadyCapability||(ie.displayReadyCapability=new _util.PromiseCapability,ie.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(ee=this._stats)==null||ee.time("Page Request"),this._pumpOperatorList(ge));const re=le=>{var ce,he;ie.renderTasks.delete(Y),(this._maybeCleanupAfterRender||fe)&&Oe(this,i,!0),Pe(this,o,Ys).call(this,!fe),le?(Y.capability.reject(le),this._abortOperatorList({intentState:ie,reason:le instanceof Error?le:new Error(le)})):Y.capability.resolve(),(ce=this._stats)==null||ce.timeEnd("Rendering"),(he=this._stats)==null||he.timeEnd("Overall")},Y=new InternalRenderTask({callback:re,params:{canvasContext:g,viewport:E,transform:D,background:C},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:ve,operatorList:ie.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!fe,pdfBug:this._pdfBug,pageColors:Re});(ie.renderTasks||(ie.renderTasks=new Set)).add(Y);const I=Y.task;return Promise.all([ie.displayReadyCapability.promise,we]).then(([le,ce])=>{var he;if(this.destroyed){re();return}(he=this._stats)==null||he.time("Rendering"),Y.initializeGraphics({transparency:le,optionalContentConfig:ce}),Y.operatorListChanged()}).catch(re),I}getOperatorList({intent:g="display",annotationMode:E=_util.AnnotationMode.ENABLE,printAnnotationStorage:W=null}={}){var ve;function v(){C.operatorList.lastChunk&&(C.opListReadCapability.resolve(C.operatorList),C.renderTasks.delete(we))}const D=this._transport.getRenderingIntent(g,E,W,!0);let C=this._intentStates.get(D.cacheKey);C||(C=Object.create(null),this._intentStates.set(D.cacheKey,C));let we;return C.opListReadCapability||(we=Object.create(null),we.operatorListChanged=v,C.opListReadCapability=new _util.PromiseCapability,(C.renderTasks||(C.renderTasks=new Set)).add(we),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(ve=this._stats)==null||ve.time("Page Request"),this._pumpOperatorList(D)),C.opListReadCapability.promise}streamTextContent({includeMarkedContent:g=!1,disableNormalization:E=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:g===!0,disableNormalization:E===!0},{highWaterMark:100,size(v){return v.items.length}})}getTextContent(g={}){if(this._transport._htmlForXfa)return this.getXfa().then(W=>_xfa_text.XfaText.textContent(W));const E=this.streamTextContent(g);return new Promise(function(W,v){function D(){C.read().then(function({value:ve,done:Re}){if(Re){W(we);return}Object.assign(we.styles,ve.styles),we.items.push(...ve.items),D()},v)}const C=E.getReader(),we={items:[],styles:Object.create(null)};D()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const g=[];for(const E of this._intentStates.values())if(this._abortOperatorList({intentState:E,reason:new Error("Page was destroyed."),force:!0}),!E.opListReadCapability)for(const W of E.renderTasks)g.push(W.completed),W.cancel();return this.objs.clear(),Oe(this,i,!1),Pe(this,o,Za).call(this),Promise.all(g)}cleanup(g=!1){Oe(this,i,!0);const E=Pe(this,o,Ys).call(this,!1);return g&&E&&this._stats&&(this._stats=new _display_utils.StatTimer),E}_startRenderPage(g,E){var v,D;const W=this._intentStates.get(E);W&&((v=this._stats)==null||v.timeEnd("Page Request"),(D=W.displayReadyCapability)==null||D.resolve(g))}_renderPageChunk(g,E){for(let W=0,v=g.length;W<v;W++)E.operatorList.fnArray.push(g.fnArray[W]),E.operatorList.argsArray.push(g.argsArray[W]);E.operatorList.lastChunk=g.lastChunk,E.operatorList.separateAnnots=g.separateAnnots;for(const W of E.renderTasks)W.operatorListChanged();g.lastChunk&&Pe(this,o,Ys).call(this,!0)}_pumpOperatorList({renderingIntent:g,cacheKey:E,annotationStorageSerializable:W}){const{map:v,transfers:D}=W,we=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:g,cacheKey:E,annotationStorage:v},D).getReader(),ve=this._intentStates.get(E);ve.streamReader=we;const Re=()=>{we.read().then(({value:_e,done:ge})=>{if(ge){ve.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(_e,ve),Re())},_e=>{if(ve.streamReader=null,!this._transport.destroyed){if(ve.operatorList){ve.operatorList.lastChunk=!0;for(const ge of ve.renderTasks)ge.operatorListChanged();Pe(this,o,Ys).call(this,!0)}if(ve.displayReadyCapability)ve.displayReadyCapability.reject(_e);else if(ve.opListReadCapability)ve.opListReadCapability.reject(_e);else throw _e}})};Re()}_abortOperatorList({intentState:g,reason:E,force:W=!1}){if(g.streamReader){if(g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null),!W){if(g.renderTasks.size>0)return;if(E instanceof _display_utils.RenderingCancelledException){let v=RENDERING_CANCELLED_TIMEOUT;E.extraDelay>0&&E.extraDelay<1e3&&(v+=E.extraDelay),g.streamReaderCancelTimeout=setTimeout(()=>{g.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:g,reason:E,force:!0})},v);return}}if(g.streamReader.cancel(new _util.AbortException(E.message)).catch(()=>{}),g.streamReader=null,!this._transport.destroyed){for(const[v,D]of this._intentStates)if(D===g){this._intentStates.delete(v);break}this.cleanup()}}}get stats(){return this._stats}}t=new WeakMap,i=new WeakMap,o=new WeakSet,Ys=function(g=!1){if(Pe(this,o,Za).call(this),!T(this,i)||this.destroyed)return!1;if(g)return Oe(this,t,setTimeout(()=>{Oe(this,t,null),Pe(this,o,Ys).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:E,operatorList:W}of this._intentStates.values())if(E.size>0||!W.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Oe(this,i,!1),!0},Za=function(){T(this,t)&&(clearTimeout(T(this,t)),Oe(this,t,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Fe(this,f,new Set);Fe(this,d,Promise.resolve())}postMessage(g,E){const W={data:structuredClone(g,E?{transfer:E}:null)};T(this,d).then(()=>{for(const v of T(this,f))v.call(this,W)})}addEventListener(g,E){T(this,f).add(E)}removeEventListener(g,E){T(this,f).delete(E)}terminate(){T(this,f).clear()}}f=new WeakMap,d=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const y=(p=document==null?void 0:document.currentScript)==null?void 0:p.src;y&&(PDFWorkerUtil.fallbackWorkerSrc=y.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(y,g){let E;try{if(E=new URL(y),!E.origin||E.origin==="null")return!1}catch{return!1}const W=new URL(g,E);return E.origin===W.origin},PDFWorkerUtil.createCDNWrapper=function(y){const g=`importScripts("${y}");`;return URL.createObjectURL(new Blob([g]))}}const _PDFWorker=class _PDFWorker{constructor({name:y=null,port:g=null,verbosity:E=(0,_util.getVerbosityLevel)()}={}){var W;if(this.name=y,this.destroyed=!1,this.verbosity=E,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,g){if((W=T(_PDFWorker,_))!=null&&W.has(g))throw new Error("Cannot use more than one PDFWorker per port.");(T(_PDFWorker,_)||Oe(_PDFWorker,_,new WeakMap)).set(g,this),this._initializeFromPort(g);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(y){this._port=y,this._messageHandler=new _message_handler.MessageHandler("main","worker",y),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:y}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,y)||(y=PDFWorkerUtil.createCDNWrapper(new URL(y,window.location).href));const g=new Worker(y),E=new _message_handler.MessageHandler("main","worker",g),W=()=>{g.removeEventListener("error",v),E.destroy(),g.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},v=()=>{this._webWorker||W()};g.addEventListener("error",v),E.on("test",C=>{if(g.removeEventListener("error",v),this.destroyed){W();return}C?(this._messageHandler=E,this._port=g,this._webWorker=g,this._readyCapability.resolve(),E.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),E.destroy(),g.terminate())}),E.on("ready",C=>{if(g.removeEventListener("error",v),this.destroyed){W();return}try{D()}catch{this._setupFakeWorker()}});const D=()=>{const C=new Uint8Array;E.send("test",C,[C.buffer])};D();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(y=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const g=new LoopbackPort;this._port=g;const E=`fake${PDFWorkerUtil.fakeWorkerId++}`,W=new _message_handler.MessageHandler(E+"_worker",E,g);y.setup(W,g);const v=new _message_handler.MessageHandler(E,E+"_worker",g);this._messageHandler=v,this._readyCapability.resolve(),v.send("configure",{verbosity:this.verbosity})}).catch(y=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${y.message}".`))})}destroy(){var y;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(y=T(_PDFWorker,_))==null||y.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(y){var E;if(!(y!=null&&y.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const g=(E=T(this,_))==null?void 0:E.get(y.port);if(g){if(g._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return g}return new _PDFWorker(y)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var y;try{return((y=globalThis.pdfjsWorker)==null?void 0:y.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};_=new WeakMap,Fe(_PDFWorker,_);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(g,E,W,v,D){Fe(this,X);Fe(this,R,new Map);Fe(this,w,new Map);Fe(this,V,new Map);Fe(this,U,null);this.messageHandler=g,this.loadingTask=E,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:v.ownerDocument,styleElement:v.styleElement}),this._params=v,this.canvasFactory=D.canvasFactory,this.filterFactory=D.filterFactory,this.cMapReaderFactory=D.cMapReaderFactory,this.standardFontDataFactory=D.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=W,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(g,E=_util.AnnotationMode.ENABLE,W=null,v=!1){let D=_util.RenderingIntentFlag.DISPLAY,C=_annotation_storage.SerializableEmpty;switch(g){case"any":D=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":D=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${g}`)}switch(E){case _util.AnnotationMode.DISABLE:D+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:D+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:D+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,C=(D&_util.RenderingIntentFlag.PRINT&&W instanceof _annotation_storage.PrintAnnotationStorage?W:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${E}`)}return v&&(D+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:D,cacheKey:`${D}_${C.hash}`,annotationStorageSerializable:C}}destroy(){var W;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(W=T(this,U))==null||W.reject(new Error("Worker was destroyed during onPassword callback"));const g=[];for(const v of T(this,w).values())g.push(v._destroy());T(this,w).clear(),T(this,V).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const E=this.messageHandler.sendWithPromise("Terminate",null);return g.push(E),Promise.all(g).then(()=>{var v;this.commonObjs.clear(),this.fontLoader.clear(),T(this,R).clear(),this.filterFactory.destroy(),(v=this._networkStream)==null||v.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:g,loadingTask:E}=this;g.on("GetReader",(W,v)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=D=>{this._lastProgress={loaded:D.loaded,total:D.total}},v.onPull=()=>{this._fullReader.read().then(function({value:D,done:C}){if(C){v.close();return}(0,_util.assert)(D instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),v.enqueue(new Uint8Array(D),1,[D])}).catch(D=>{v.error(D)})},v.onCancel=D=>{this._fullReader.cancel(D),v.ready.catch(C=>{if(!this.destroyed)throw C})}}),g.on("ReaderHeadersReady",W=>{const v=new _util.PromiseCapability,D=this._fullReader;return D.headersReady.then(()=>{var C;(!D.isStreamingSupported||!D.isRangeSupported)&&(this._lastProgress&&((C=E.onProgress)==null||C.call(E,this._lastProgress)),D.onProgress=we=>{var ve;(ve=E.onProgress)==null||ve.call(E,{loaded:we.loaded,total:we.total})}),v.resolve({isStreamingSupported:D.isStreamingSupported,isRangeSupported:D.isRangeSupported,contentLength:D.contentLength})},v.reject),v.promise}),g.on("GetRangeReader",(W,v)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const D=this._networkStream.getRangeReader(W.begin,W.end);if(!D){v.close();return}v.onPull=()=>{D.read().then(function({value:C,done:we}){if(we){v.close();return}(0,_util.assert)(C instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),v.enqueue(new Uint8Array(C),1,[C])}).catch(C=>{v.error(C)})},v.onCancel=C=>{D.cancel(C),v.ready.catch(we=>{if(!this.destroyed)throw we})}}),g.on("GetDoc",({pdfInfo:W})=>{this._numPages=W.numPages,this._htmlForXfa=W.htmlForXfa,delete W.htmlForXfa,E._capability.resolve(new PDFDocumentProxy(W,this))}),g.on("DocException",function(W){let v;switch(W.name){case"PasswordException":v=new _util.PasswordException(W.message,W.code);break;case"InvalidPDFException":v=new _util.InvalidPDFException(W.message);break;case"MissingPDFException":v=new _util.MissingPDFException(W.message);break;case"UnexpectedResponseException":v=new _util.UnexpectedResponseException(W.message,W.status);break;case"UnknownErrorException":v=new _util.UnknownErrorException(W.message,W.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}E._capability.reject(v)}),g.on("PasswordRequest",W=>{if(Oe(this,U,new _util.PromiseCapability),E.onPassword){const v=D=>{D instanceof Error?T(this,U).reject(D):T(this,U).resolve({password:D})};try{E.onPassword(v,W.code)}catch(D){T(this,U).reject(D)}}else T(this,U).reject(new _util.PasswordException(W.message,W.code));return T(this,U).promise}),g.on("DataLoaded",W=>{var v;(v=E.onProgress)==null||v.call(E,{loaded:W.length,total:W.length}),this.downloadInfoCapability.resolve(W)}),g.on("StartRenderPage",W=>{if(this.destroyed)return;T(this,w).get(W.pageIndex)._startRenderPage(W.transparency,W.cacheKey)}),g.on("commonobj",([W,v,D])=>{var C;if(!this.destroyed&&!this.commonObjs.has(W))switch(v){case"Font":const we=this._params;if("error"in D){const _e=D.error;(0,_util.warn)(`Error during font loading: ${_e}`),this.commonObjs.resolve(W,_e);break}const ve=we.pdfBug&&((C=globalThis.FontInspector)!=null&&C.enabled)?(_e,ge)=>globalThis.FontInspector.fontAdded(_e,ge):null,Re=new _font_loader.FontFaceObject(D,{isEvalSupported:we.isEvalSupported,disableFontFace:we.disableFontFace,ignoreErrors:we.ignoreErrors,inspectFont:ve});this.fontLoader.bind(Re).catch(_e=>g.sendWithPromise("FontFallback",{id:W})).finally(()=>{!we.fontExtraProperties&&Re.data&&(Re.data=null),this.commonObjs.resolve(W,Re)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(W,D);break;default:throw new Error(`Got unknown common object type ${v}`)}}),g.on("obj",([W,v,D,C])=>{var ve;if(this.destroyed)return;const we=T(this,w).get(v);if(!we.objs.has(W))switch(D){case"Image":if(we.objs.resolve(W,C),C){let Re;if(C.bitmap){const{width:_e,height:ge}=C;Re=_e*ge*4}else Re=((ve=C.data)==null?void 0:ve.length)||0;Re>_util.MAX_IMAGE_SIZE_TO_CACHE&&(we._maybeCleanupAfterRender=!0)}break;case"Pattern":we.objs.resolve(W,C);break;default:throw new Error(`Got unknown object type ${D}`)}}),g.on("DocProgress",W=>{var v;this.destroyed||(v=E.onProgress)==null||v.call(E,{loaded:W.loaded,total:W.total})}),g.on("FetchBuiltInCMap",W=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(W):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),g.on("FetchStandardFontData",W=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(W):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var W;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:g,transfers:E}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:g,filename:((W=this._fullReader)==null?void 0:W.filename)??null},E).finally(()=>{this.annotationStorage.resetModified()})}getPage(g){if(!Number.isInteger(g)||g<=0||g>this._numPages)return Promise.reject(new Error("Invalid page request."));const E=g-1,W=T(this,V).get(E);if(W)return W;const v=this.messageHandler.sendWithPromise("GetPage",{pageIndex:E}).then(D=>{if(this.destroyed)throw new Error("Transport destroyed");const C=new PDFPageProxy(E,D,this,this._params.pdfBug);return T(this,w).set(E,C),C});return T(this,V).set(E,v),v}getPageIndex(g){return typeof g!="object"||g===null||!Number.isInteger(g.num)||g.num<0||!Number.isInteger(g.gen)||g.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:g.num,gen:g.gen})}getAnnotations(g,E){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:g,intent:E})}getFieldObjects(){return Pe(this,X,el).call(this,"GetFieldObjects")}hasJSActions(){return Pe(this,X,el).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(g){return typeof g!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:g})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Pe(this,X,el).call(this,"GetDocJSActions")}getPageJSActions(g){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:g})}getStructTree(g){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:g})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(g=>new _optional_content_config.OptionalContentConfig(g))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const g="GetMetadata",E=T(this,R).get(g);if(E)return E;const W=this.messageHandler.sendWithPromise(g,null).then(v=>{var D,C;return{info:v[0],metadata:v[1]?new _metadata.Metadata(v[1]):null,contentDispositionFilename:((D=this._fullReader)==null?void 0:D.filename)??null,contentLength:((C=this._fullReader)==null?void 0:C.contentLength)??null}});return T(this,R).set(g,W),W}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(g=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const E of T(this,w).values())if(!E.cleanup())throw new Error(`startCleanup: Page ${E.pageNumber} is currently rendering.`);this.commonObjs.clear(),g||this.fontLoader.clear(),T(this,R).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:g,enableXfa:E}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:g,enableXfa:E})}}R=new WeakMap,w=new WeakMap,V=new WeakMap,U=new WeakMap,X=new WeakSet,el=function(g,E=null){const W=T(this,R).get(g);if(W)return W;const v=this.messageHandler.sendWithPromise(g,E);return T(this,R).set(g,v),v};class PDFObjects{constructor(){Fe(this,Z);Fe(this,K,Object.create(null))}get(g,E=null){if(E){const v=Pe(this,Z,Uu).call(this,g);return v.capability.promise.then(()=>E(v.data)),null}const W=T(this,K)[g];if(!(W!=null&&W.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${g}.`);return W.data}has(g){const E=T(this,K)[g];return(E==null?void 0:E.capability.settled)||!1}resolve(g,E=null){const W=Pe(this,Z,Uu).call(this,g);W.data=E,W.capability.resolve()}clear(){var g;for(const E in T(this,K)){const{data:W}=T(this,K)[E];(g=W==null?void 0:W.bitmap)==null||g.close()}Oe(this,K,Object.create(null))}}K=new WeakMap,Z=new WeakSet,Uu=function(g){var E;return(E=T(this,K))[g]||(E[g]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(g){Fe(this,te,null);Oe(this,te,g),this.onContinue=null}get promise(){return T(this,te).capability.promise}cancel(g=0){T(this,te).cancel(null,g)}get separateAnnots(){const{separateAnnots:g}=T(this,te).operatorList;if(!g)return!1;const{annotationCanvasMap:E}=T(this,te);return g.form||g.canvas&&(E==null?void 0:E.size)>0}}te=new WeakMap,exports.RenderTask=RenderTask;const J=class J{constructor({callback:g,params:E,objs:W,commonObjs:v,annotationCanvasMap:D,operatorList:C,pageIndex:we,canvasFactory:ve,filterFactory:Re,useRequestAnimationFrame:_e=!1,pdfBug:ge=!1,pageColors:ie=null}){this.callback=g,this.params=E,this.objs=W,this.commonObjs=v,this.annotationCanvasMap=D,this.operatorListIdx=null,this.operatorList=C,this._pageIndex=we,this.canvasFactory=ve,this.filterFactory=Re,this._pdfBug=ge,this.pageColors=ie,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=_e===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=E.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:g=!1,optionalContentConfig:E}){var we,ve;if(this.cancelled)return;if(this._canvas){if(T(J,H).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");T(J,H).add(this._canvas)}this._pdfBug&&((we=globalThis.StepperManager)!=null&&we.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:W,viewport:v,transform:D,background:C}=this.params;this.gfx=new _canvas.CanvasGraphics(W,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:E},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:D,viewport:v,transparency:g,background:C}),this.operatorListIdx=0,this.graphicsReady=!0,(ve=this.graphicsReadyCallback)==null||ve.call(this)}cancel(g=null,E=0){var W;this.running=!1,this.cancelled=!0,(W=this.gfx)==null||W.endDrawing(),T(J,H).delete(this._canvas),this.callback(g||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,E))}operatorListChanged(){var g;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(g=this.stepper)==null||g.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),T(J,H).delete(this._canvas),this.callback())))}};H=new WeakMap,Fe(J,H,new WeakSet);let InternalRenderTask=J;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(n,e,t)=>{var p,_,R,Sd,V;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var i=t(1),o=t(4),a=t(8);const u=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=u;class f{constructor(){Fe(this,R);Fe(this,p,!1);Fe(this,_,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(X,b){const K=T(this,_).get(X);return K===void 0?b:Object.assign(b,K)}getRawValue(X){return T(this,_).get(X)}remove(X){if(T(this,_).delete(X),T(this,_).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const b of T(this,_).values())if(b instanceof o.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(X,b){const K=T(this,_).get(X);let Z=!1;if(K!==void 0)for(const[oe,te]of Object.entries(b))K[oe]!==te&&(Z=!0,K[oe]=te);else Z=!0,T(this,_).set(X,b);Z&&Pe(this,R,Sd).call(this),b instanceof o.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(b.constructor._type)}has(X){return T(this,_).has(X)}getAll(){return T(this,_).size>0?(0,i.objectFromMap)(T(this,_)):null}setAll(X){for(const[b,K]of Object.entries(X))this.setValue(b,K)}get size(){return T(this,_).size}resetModified(){T(this,p)&&(Oe(this,p,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new d(this)}get serializable(){if(T(this,_).size===0)return u;const X=new Map,b=new a.MurmurHash3_64,K=[],Z=Object.create(null);let oe=!1;for(const[te,H]of T(this,_)){const J=H instanceof o.AnnotationEditor?H.serialize(!1,Z):H;J&&(X.set(te,J),b.update(`${te}:${JSON.stringify(J)}`),oe||(oe=!!J.bitmap))}if(oe)for(const te of X.values())te.bitmap&&K.push(te.bitmap);return X.size>0?{map:X,hash:b.hexdigest(),transfers:K}:u}}p=new WeakMap,_=new WeakMap,R=new WeakSet,Sd=function(){T(this,p)||(Oe(this,p,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=f;class d extends f{constructor(b){super();Fe(this,V);const{map:K,hash:Z,transfers:oe}=b.serializable,te=structuredClone(K,oe?{transfer:oe}:null);Oe(this,V,{map:te,hash:Z,transfers:oe})}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return T(this,V)}}V=new WeakMap,e.PrintAnnotationStorage=d},(n,e,t)=>{var d,p,_,R,w,V,U,X,b,K,Z,oe,te,H,J,ju,Bu,E,zu,Wu,wd,bd,Cd,$u,xd;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var i=t(5),o=t(1),a=t(6);const _e=class _e{constructor(ie){Fe(this,J);Fe(this,d,"");Fe(this,p,!1);Fe(this,_,null);Fe(this,R,null);Fe(this,w,null);Fe(this,V,!1);Fe(this,U,null);Fe(this,X,this.focusin.bind(this));Fe(this,b,this.focusout.bind(this));Fe(this,K,!1);Fe(this,Z,!1);Fe(this,oe,!1);Un(this,"_initialOptions",Object.create(null));Un(this,"_uiManager",null);Un(this,"_focusEventsAllowed",!0);Un(this,"_l10nPromise",null);Fe(this,te,!1);Fe(this,H,_e._zIndex++);this.constructor===_e&&(0,o.unreachable)("Cannot initialize AnnotationEditor."),this.parent=ie.parent,this.id=ie.id,this.width=this.height=null,this.pageIndex=ie.parent.pageIndex,this.name=ie.name,this.div=null,this._uiManager=ie.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=ie.isCentered,this._structTreeParentId=null;const{rotation:fe,rawDims:{pageWidth:re,pageHeight:Y,pageX:I,pageY:S}}=this.parent.viewport;this.rotation=fe,this.pageRotation=(360+fe-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[re,Y],this.pageTranslation=[I,S];const[ee,le]=this.parentDimensions;this.x=ie.x/ee,this.y=ie.y/le,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,o.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(ie){const fe=new f({id:ie.parent.getNextId(),parent:ie.parent,uiManager:ie._uiManager});fe.annotationElementId=ie.annotationElementId,fe.deleted=!0,fe._uiManager.addToAnnotationStorage(fe)}static initialize(ie,fe=null){if(_e._l10nPromise||(_e._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(Y=>[Y,ie.get(Y)]))),fe!=null&&fe.strings)for(const Y of fe.strings)_e._l10nPromise.set(Y,ie.get(Y));if(_e._borderLineWidth!==-1)return;const re=getComputedStyle(document.documentElement);_e._borderLineWidth=parseFloat(re.getPropertyValue("--outline-width"))||0}static updateDefaultParams(ie,fe){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(ie){return!1}static paste(ie,fe){(0,o.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return T(this,te)}set _isDraggable(ie){var fe;Oe(this,te,ie),(fe=this.div)==null||fe.classList.toggle("draggable",ie)}center(){const[ie,fe]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*fe/(ie*2),this.y+=this.width*ie/(fe*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*fe/(ie*2),this.y-=this.width*ie/(fe*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(ie){this._uiManager.addCommands(ie)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=T(this,H)}setParent(ie){ie!==null&&(this.pageIndex=ie.pageIndex,this.pageDimensions=ie.pageDimensions),this.parent=ie}focusin(ie){this._focusEventsAllowed&&(T(this,K)?Oe(this,K,!1):this.parent.setSelected(this))}focusout(ie){var re;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const fe=ie.relatedTarget;fe!=null&&fe.closest(`#${this.id}`)||(ie.preventDefault(),(re=this.parent)!=null&&re.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(ie,fe,re,Y){const[I,S]=this.parentDimensions;[re,Y]=this.screenToPageTranslation(re,Y),this.x=(ie+re)/I,this.y=(fe+Y)/S,this.fixAndSetPosition()}translate(ie,fe){Pe(this,J,ju).call(this,this.parentDimensions,ie,fe)}translateInPage(ie,fe){Pe(this,J,ju).call(this,this.pageDimensions,ie,fe),this.div.scrollIntoView({block:"nearest"})}drag(ie,fe){const[re,Y]=this.parentDimensions;if(this.x+=ie/re,this.y+=fe/Y,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ce,y:he}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ce,he)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:I,y:S}=this;const[ee,le]=Pe(this,J,Bu).call(this);I+=ee,S+=le,this.div.style.left=`${(100*I).toFixed(2)}%`,this.div.style.top=`${(100*S).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[ie,fe]=this.pageDimensions;let{x:re,y:Y,width:I,height:S}=this;switch(I*=ie,S*=fe,re*=ie,Y*=fe,this.rotation){case 0:re=Math.max(0,Math.min(ie-I,re)),Y=Math.max(0,Math.min(fe-S,Y));break;case 90:re=Math.max(0,Math.min(ie-S,re)),Y=Math.min(fe,Math.max(I,Y));break;case 180:re=Math.min(ie,Math.max(I,re)),Y=Math.min(fe,Math.max(S,Y));break;case 270:re=Math.min(ie,Math.max(S,re)),Y=Math.max(0,Math.min(fe-I,Y));break}this.x=re/=ie,this.y=Y/=fe;const[ee,le]=Pe(this,J,Bu).call(this);re+=ee,Y+=le;const{style:ce}=this.div;ce.left=`${(100*re).toFixed(2)}%`,ce.top=`${(100*Y).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(ie,fe){var re;return Pe(re=_e,E,zu).call(re,ie,fe,this.parentRotation)}pageTranslationToScreen(ie,fe){var re;return Pe(re=_e,E,zu).call(re,ie,fe,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:ie,pageDimensions:[fe,re]}=this,Y=fe*ie,I=re*ie;return o.FeatureTest.isCSSRoundSupported?[Math.round(Y),Math.round(I)]:[Y,I]}setDims(ie,fe){var I;const[re,Y]=this.parentDimensions;this.div.style.width=`${(100*ie/re).toFixed(2)}%`,T(this,V)||(this.div.style.height=`${(100*fe/Y).toFixed(2)}%`),(I=T(this,_))==null||I.classList.toggle("small",ie<_e.SMALL_EDITOR_SIZE||fe<_e.SMALL_EDITOR_SIZE)}fixDims(){const{style:ie}=this.div,{height:fe,width:re}=ie,Y=re.endsWith("%"),I=!T(this,V)&&fe.endsWith("%");if(Y&&I)return;const[S,ee]=this.parentDimensions;Y||(ie.width=`${(100*parseFloat(re)/S).toFixed(2)}%`),!T(this,V)&&!I&&(ie.height=`${(100*parseFloat(fe)/ee).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(T(this,_))return;const ie=Oe(this,_,document.createElement("button"));ie.className="altText";const fe=await _e._l10nPromise.get("editor_alt_text_button_label");ie.textContent=fe,ie.setAttribute("aria-label",fe),ie.tabIndex="0",ie.addEventListener("contextmenu",a.noContextMenu),ie.addEventListener("pointerdown",re=>re.stopPropagation()),ie.addEventListener("click",re=>{re.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),ie.addEventListener("keydown",re=>{re.target===ie&&re.key==="Enter"&&(re.preventDefault(),this._uiManager.editAltText(this))}),Pe(this,J,$u).call(this),this.div.append(ie),_e.SMALL_EDITOR_SIZE||(_e.SMALL_EDITOR_SIZE=Math.min(128,Math.round(ie.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:T(this,d),decorative:T(this,p)}}set altTextData({altText:ie,decorative:fe}){T(this,d)===ie&&T(this,p)===fe||(Oe(this,d,ie),Oe(this,p,fe),Pe(this,J,$u).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",T(this,X)),this.div.addEventListener("focusout",T(this,b));const[ie,fe]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*fe/ie).toFixed(2)}%`,this.div.style.maxHeight=`${(100*ie/fe).toFixed(2)}%`);const[re,Y]=this.getInitialTranslation();return this.translate(re,Y),(0,i.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(ie){const{isMac:fe}=o.FeatureTest.platform;if(ie.button!==0||ie.ctrlKey&&fe){ie.preventDefault();return}Oe(this,K,!0),Pe(this,J,xd).call(this,ie)}moveInDOM(){var ie;(ie=this.parent)==null||ie.moveEditorInDOM(this)}_setParentAndPosition(ie,fe,re){ie.changeParent(this),this.x=fe,this.y=re,this.fixAndSetPosition()}getRect(ie,fe){const re=this.parentScale,[Y,I]=this.pageDimensions,[S,ee]=this.pageTranslation,le=ie/re,ce=fe/re,he=this.x*Y,Ee=this.y*I,be=this.width*Y,Be=this.height*I;switch(this.rotation){case 0:return[he+le+S,I-Ee-ce-Be+ee,he+le+be+S,I-Ee-ce+ee];case 90:return[he+ce+S,I-Ee+le+ee,he+ce+Be+S,I-Ee+le+be+ee];case 180:return[he-le-be+S,I-Ee+ce+ee,he-le+S,I-Ee+ce+Be+ee];case 270:return[he-ce-Be+S,I-Ee-le-be+ee,he-ce+S,I-Ee-le+ee];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(ie,fe){const[re,Y,I,S]=ie,ee=I-re,le=S-Y;switch(this.rotation){case 0:return[re,fe-S,ee,le];case 90:return[re,fe-Y,le,ee];case 180:return[I,fe-Y,ee,le];case 270:return[I,fe-S,le,ee];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Oe(this,oe,!0)}disableEditMode(){Oe(this,oe,!1)}isInEditMode(){return T(this,oe)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var ie,fe;(ie=this.div)==null||ie.addEventListener("focusin",T(this,X)),(fe=this.div)==null||fe.addEventListener("focusout",T(this,b))}serialize(ie=!1,fe=null){(0,o.unreachable)("An editor must be serializable")}static deserialize(ie,fe,re){const Y=new this.prototype.constructor({parent:fe,id:fe.getNextId(),uiManager:re});Y.rotation=ie.rotation;const[I,S]=Y.pageDimensions,[ee,le,ce,he]=Y.getRectInCurrentCoords(ie.rect,S);return Y.x=ee/I,Y.y=le/S,Y.width=ce/I,Y.height=he/S,Y}remove(){var ie;this.div.removeEventListener("focusin",T(this,X)),this.div.removeEventListener("focusout",T(this,b)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(ie=T(this,_))==null||ie.remove(),Oe(this,_,null),Oe(this,R,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Pe(this,J,wd).call(this),T(this,U).classList.remove("hidden"))}select(){var ie;this.makeResizable(),(ie=this.div)==null||ie.classList.add("selectedEditor")}unselect(){var ie,fe,re;(ie=T(this,U))==null||ie.classList.add("hidden"),(fe=this.div)==null||fe.classList.remove("selectedEditor"),(re=this.div)!=null&&re.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(ie,fe){}disableEditing(){T(this,_)&&(T(this,_).hidden=!0)}enableEditing(){T(this,_)&&(T(this,_).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return T(this,Z)}set isEditing(ie){Oe(this,Z,ie),this.parent&&(ie?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(ie,fe){Oe(this,V,!0);const re=ie/fe,{style:Y}=this.div;Y.aspectRatio=re,Y.height="auto"}static get MIN_SIZE(){return 16}};d=new WeakMap,p=new WeakMap,_=new WeakMap,R=new WeakMap,w=new WeakMap,V=new WeakMap,U=new WeakMap,X=new WeakMap,b=new WeakMap,K=new WeakMap,Z=new WeakMap,oe=new WeakMap,te=new WeakMap,H=new WeakMap,J=new WeakSet,ju=function([ie,fe],re,Y){[re,Y]=this.screenToPageTranslation(re,Y),this.x+=re/ie,this.y+=Y/fe,this.fixAndSetPosition()},Bu=function(){const[ie,fe]=this.parentDimensions,{_borderLineWidth:re}=_e,Y=re/ie,I=re/fe;switch(this.rotation){case 90:return[-Y,I];case 180:return[Y,I];case 270:return[Y,-I];default:return[-Y,-I]}},E=new WeakSet,zu=function(ie,fe,re){switch(re){case 90:return[fe,-ie];case 180:return[-ie,-fe];case 270:return[-fe,ie];default:return[ie,fe]}},Wu=function(ie){switch(ie){case 90:{const[fe,re]=this.pageDimensions;return[0,-fe/re,re/fe,0]}case 180:return[-1,0,0,-1];case 270:{const[fe,re]=this.pageDimensions;return[0,fe/re,-re/fe,0]}default:return[1,0,0,1]}},wd=function(){if(T(this,U))return;Oe(this,U,document.createElement("div")),T(this,U).classList.add("resizers");const ie=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||ie.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const fe of ie){const re=document.createElement("div");T(this,U).append(re),re.classList.add("resizer",fe),re.addEventListener("pointerdown",Pe(this,J,bd).bind(this,fe)),re.addEventListener("contextmenu",a.noContextMenu)}this.div.prepend(T(this,U))},bd=function(ie,fe){fe.preventDefault();const{isMac:re}=o.FeatureTest.platform;if(fe.button!==0||fe.ctrlKey&&re)return;const Y=Pe(this,J,Cd).bind(this,ie),I=this._isDraggable;this._isDraggable=!1;const S={passive:!0,capture:!0};window.addEventListener("pointermove",Y,S);const ee=this.x,le=this.y,ce=this.width,he=this.height,Ee=this.parent.div.style.cursor,be=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(fe.target).cursor;const Be=()=>{this._isDraggable=I,window.removeEventListener("pointerup",Be),window.removeEventListener("blur",Be),window.removeEventListener("pointermove",Y,S),this.parent.div.style.cursor=Ee,this.div.style.cursor=be;const ze=this.x,Ke=this.y,Xe=this.width,Ze=this.height;ze===ee&&Ke===le&&Xe===ce&&Ze===he||this.addCommands({cmd:()=>{this.width=Xe,this.height=Ze,this.x=ze,this.y=Ke;const[xe,De]=this.parentDimensions;this.setDims(xe*Xe,De*Ze),this.fixAndSetPosition()},undo:()=>{this.width=ce,this.height=he,this.x=ee,this.y=le;const[xe,De]=this.parentDimensions;this.setDims(xe*ce,De*he),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Be),window.addEventListener("blur",Be)},Cd=function(ie,fe){const[re,Y]=this.parentDimensions,I=this.x,S=this.y,ee=this.width,le=this.height,ce=_e.MIN_SIZE/re,he=_e.MIN_SIZE/Y,Ee=Ut=>Math.round(Ut*1e4)/1e4,be=Pe(this,J,Wu).call(this,this.rotation),Be=(Ut,hn)=>[be[0]*Ut+be[2]*hn,be[1]*Ut+be[3]*hn],ze=Pe(this,J,Wu).call(this,360-this.rotation),Ke=(Ut,hn)=>[ze[0]*Ut+ze[2]*hn,ze[1]*Ut+ze[3]*hn];let Xe,Ze,xe=!1,De=!1;switch(ie){case"topLeft":xe=!0,Xe=(Ut,hn)=>[0,0],Ze=(Ut,hn)=>[Ut,hn];break;case"topMiddle":Xe=(Ut,hn)=>[Ut/2,0],Ze=(Ut,hn)=>[Ut/2,hn];break;case"topRight":xe=!0,Xe=(Ut,hn)=>[Ut,0],Ze=(Ut,hn)=>[0,hn];break;case"middleRight":De=!0,Xe=(Ut,hn)=>[Ut,hn/2],Ze=(Ut,hn)=>[0,hn/2];break;case"bottomRight":xe=!0,Xe=(Ut,hn)=>[Ut,hn],Ze=(Ut,hn)=>[0,0];break;case"bottomMiddle":Xe=(Ut,hn)=>[Ut/2,hn],Ze=(Ut,hn)=>[Ut/2,0];break;case"bottomLeft":xe=!0,Xe=(Ut,hn)=>[0,hn],Ze=(Ut,hn)=>[Ut,0];break;case"middleLeft":De=!0,Xe=(Ut,hn)=>[0,hn/2],Ze=(Ut,hn)=>[Ut,hn/2];break}const se=Xe(ee,le),me=Ze(ee,le);let Te=Be(...me);const Ce=Ee(I+Te[0]),$e=Ee(S+Te[1]);let et=1,Qe=1,[Se,rt]=this.screenToPageTranslation(fe.movementX,fe.movementY);if([Se,rt]=Ke(Se/re,rt/Y),xe){const Ut=Math.hypot(ee,le);et=Qe=Math.max(Math.min(Math.hypot(me[0]-se[0]-Se,me[1]-se[1]-rt)/Ut,1/ee,1/le),ce/ee,he/le)}else De?et=Math.max(ce,Math.min(1,Math.abs(me[0]-se[0]-Se)))/ee:Qe=Math.max(he,Math.min(1,Math.abs(me[1]-se[1]-rt)))/le;const nt=Ee(ee*et),mn=Ee(le*Qe);Te=Be(...Ze(nt,mn));const fn=Ce-Te[0],Rn=$e-Te[1];this.width=nt,this.height=mn,this.x=fn,this.y=Rn,this.setDims(re*nt,Y*mn),this.fixAndSetPosition()},$u=async function(){var re;const ie=T(this,_);if(!ie)return;if(!T(this,d)&&!T(this,p)){ie.classList.remove("done"),(re=T(this,R))==null||re.remove();return}_e._l10nPromise.get("editor_alt_text_edit_button_label").then(Y=>{ie.setAttribute("aria-label",Y)});let fe=T(this,R);if(!fe){Oe(this,R,fe=document.createElement("span")),fe.className="tooltip",fe.setAttribute("role","tooltip");const Y=fe.id=`alt-text-tooltip-${this.id}`;ie.setAttribute("aria-describedby",Y);const I=100;ie.addEventListener("mouseenter",()=>{Oe(this,w,setTimeout(()=>{Oe(this,w,null),T(this,R).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},I))}),ie.addEventListener("mouseleave",()=>{var S;clearTimeout(T(this,w)),Oe(this,w,null),(S=T(this,R))==null||S.classList.remove("show")})}ie.classList.add("done"),fe.innerText=T(this,p)?await _e._l10nPromise.get("editor_alt_text_decorative_tooltip"):T(this,d),fe.parentNode||ie.append(fe)},xd=function(ie){if(!this._isDraggable)return;const fe=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let re,Y;fe&&(re={passive:!0,capture:!0},Y=S=>{const[ee,le]=this.screenToPageTranslation(S.movementX,S.movementY);this._uiManager.dragSelectedEditors(ee,le)},window.addEventListener("pointermove",Y,re));const I=()=>{if(window.removeEventListener("pointerup",I),window.removeEventListener("blur",I),fe&&window.removeEventListener("pointermove",Y,re),Oe(this,K,!1),!this._uiManager.endDragSession()){const{isMac:S}=o.FeatureTest.platform;ie.ctrlKey&&!S||ie.shiftKey||ie.metaKey&&S?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",I),window.addEventListener("blur",I)},Fe(_e,E),Un(_e,"_borderLineWidth",-1),Un(_e,"_colorManager",new i.ColorManager),Un(_e,"_zIndex",1),Un(_e,"SMALL_EDITOR_SIZE",0);let u=_e;e.AnnotationEditor=u;class f extends u{constructor(ie){super(ie),this.annotationElementId=ie.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(n,e,t)=>{var V,U,X,b,K,Hu,te,H,J,y,g,kd,v,D,C,we,ve,Re,_e,ge,ie,fe,re,Y,I,S,ee,le,ce,he,Ee,be,Be,ze,Ke,Xe,Ze,xe,De,se,me,Te,Ce,$e,et,Qe,Se,Dd,qu,Gu,tl,Ku,Xu,Hr,No,Vd,Md,Yu,Fo,Qu;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=a,e.opacityToHex=u;var i=t(1),o=t(6);function a(Pn,pe,We){for(const pt of We)pe.addEventListener(pt,Pn[pt].bind(Pn))}function u(Pn){return Math.round(Math.min(255,Math.max(1,255*Pn))).toString(16).padStart(2,"0")}class f{constructor(){Fe(this,V,0)}getId(){return`${i.AnnotationEditorPrefix}${Mo(this,V)._++}`}}V=new WeakMap;const oe=class oe{constructor(){Fe(this,K);Fe(this,U,(0,i.getUuid)());Fe(this,X,0);Fe(this,b,null)}static get _isSVGFittingCanvas(){const pe='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',pt=new OffscreenCanvas(1,3).getContext("2d"),Lt=new Image;Lt.src=pe;const un=Lt.decode().then(()=>(pt.drawImage(Lt,0,0,1,1,0,0,1,3),new Uint32Array(pt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,i.shadow)(this,"_isSVGFittingCanvas",un)}async getFromFile(pe){const{lastModified:We,name:pt,size:Lt,type:un}=pe;return Pe(this,K,Hu).call(this,`${We}_${pt}_${Lt}_${un}`,pe)}async getFromUrl(pe){return Pe(this,K,Hu).call(this,pe,pe)}async getFromId(pe){T(this,b)||Oe(this,b,new Map);const We=T(this,b).get(pe);return We?We.bitmap?(We.refCounter+=1,We):We.file?this.getFromFile(We.file):this.getFromUrl(We.url):null}getSvgUrl(pe){const We=T(this,b).get(pe);return We!=null&&We.isSvg?We.svgUrl:null}deleteId(pe){T(this,b)||Oe(this,b,new Map);const We=T(this,b).get(pe);We&&(We.refCounter-=1,We.refCounter===0&&(We.bitmap=null))}isValidId(pe){return pe.startsWith(`image_${T(this,U)}_`)}};U=new WeakMap,X=new WeakMap,b=new WeakMap,K=new WeakSet,Hu=async function(pe,We){T(this,b)||Oe(this,b,new Map);let pt=T(this,b).get(pe);if(pt===null)return null;if(pt!=null&&pt.bitmap)return pt.refCounter+=1,pt;try{pt||(pt={bitmap:null,id:`image_${T(this,U)}_${Mo(this,X)._++}`,refCounter:0,isSvg:!1});let Lt;if(typeof We=="string"){pt.url=We;const un=await fetch(We);if(!un.ok)throw new Error(un.statusText);Lt=await un.blob()}else Lt=pt.file=We;if(Lt.type==="image/svg+xml"){const un=oe._isSVGFittingCanvas,kt=new FileReader,de=new Image,ae=new Promise((Ae,Me)=>{de.onload=()=>{pt.bitmap=de,pt.isSvg=!0,Ae()},kt.onload=async()=>{const Ue=pt.svgUrl=kt.result;de.src=await un?`${Ue}#svgView(preserveAspectRatio(none))`:Ue},de.onerror=kt.onerror=Me});kt.readAsDataURL(Lt),await ae}else pt.bitmap=await createImageBitmap(Lt);pt.refCounter=1}catch(Lt){console.error(Lt),pt=null}return T(this,b).set(pe,pt),pt&&T(this,b).set(pt.id,pt),pt};let d=oe;class p{constructor(pe=128){Fe(this,te,[]);Fe(this,H,!1);Fe(this,J);Fe(this,y,-1);Oe(this,J,pe)}add({cmd:pe,undo:We,mustExec:pt,type:Lt=NaN,overwriteIfSameType:un=!1,keepUndo:kt=!1}){if(pt&&pe(),T(this,H))return;const de={cmd:pe,undo:We,type:Lt};if(T(this,y)===-1){T(this,te).length>0&&(T(this,te).length=0),Oe(this,y,0),T(this,te).push(de);return}if(un&&T(this,te)[T(this,y)].type===Lt){kt&&(de.undo=T(this,te)[T(this,y)].undo),T(this,te)[T(this,y)]=de;return}const ae=T(this,y)+1;ae===T(this,J)?T(this,te).splice(0,1):(Oe(this,y,ae),ae<T(this,te).length&&T(this,te).splice(ae)),T(this,te).push(de)}undo(){T(this,y)!==-1&&(Oe(this,H,!0),T(this,te)[T(this,y)].undo(),Oe(this,H,!1),Oe(this,y,T(this,y)-1))}redo(){T(this,y)<T(this,te).length-1&&(Oe(this,y,T(this,y)+1),Oe(this,H,!0),T(this,te)[T(this,y)].cmd(),Oe(this,H,!1))}hasSomethingToUndo(){return T(this,y)!==-1}hasSomethingToRedo(){return T(this,y)<T(this,te).length-1}destroy(){Oe(this,te,null)}}te=new WeakMap,H=new WeakMap,J=new WeakMap,y=new WeakMap,e.CommandManager=p;class _{constructor(pe){Fe(this,g);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:We}=i.FeatureTest.platform;for(const[pt,Lt,un={}]of pe)for(const kt of pt){const de=kt.startsWith("mac+");We&&de?(this.callbacks.set(kt.slice(4),{callback:Lt,options:un}),this.allKeys.add(kt.split("+").at(-1))):!We&&!de&&(this.callbacks.set(kt,{callback:Lt,options:un}),this.allKeys.add(kt.split("+").at(-1)))}}exec(pe,We){if(!this.allKeys.has(We.key))return;const pt=this.callbacks.get(Pe(this,g,kd).call(this,We));if(!pt)return;const{callback:Lt,options:{bubbles:un=!1,args:kt=[],checker:de=null}}=pt;de&&!de(pe,We)||(Lt.bind(pe,...kt)(),un||(We.stopPropagation(),We.preventDefault()))}}g=new WeakSet,kd=function(pe){pe.altKey&&this.buffer.push("alt"),pe.ctrlKey&&this.buffer.push("ctrl"),pe.metaKey&&this.buffer.push("meta"),pe.shiftKey&&this.buffer.push("shift"),this.buffer.push(pe.key);const We=this.buffer.join("+");return this.buffer.length=0,We},e.KeyboardManager=_;const W=class W{get _colors(){const pe=new Map([["CanvasText",null],["Canvas",null]]);return(0,o.getColorValues)(pe),(0,i.shadow)(this,"_colors",pe)}convert(pe){const We=(0,o.getRGB)(pe);if(!window.matchMedia("(forced-colors: active)").matches)return We;for(const[pt,Lt]of this._colors)if(Lt.every((un,kt)=>un===We[kt]))return W._colorsMapping.get(pt);return We}getHexCode(pe){const We=this._colors.get(pe);return We?i.Util.makeHexColor(...We):pe}};Un(W,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let R=W;e.ColorManager=R;const In=class In{constructor(pe,We,pt,Lt,un,kt){Fe(this,Se);Fe(this,v,null);Fe(this,D,new Map);Fe(this,C,new Map);Fe(this,we,null);Fe(this,ve,null);Fe(this,Re,new p);Fe(this,_e,0);Fe(this,ge,new Set);Fe(this,ie,null);Fe(this,fe,null);Fe(this,re,new Set);Fe(this,Y,null);Fe(this,I,new f);Fe(this,S,!1);Fe(this,ee,!1);Fe(this,le,null);Fe(this,ce,i.AnnotationEditorType.NONE);Fe(this,he,new Set);Fe(this,Ee,null);Fe(this,be,this.blur.bind(this));Fe(this,Be,this.focus.bind(this));Fe(this,ze,this.copy.bind(this));Fe(this,Ke,this.cut.bind(this));Fe(this,Xe,this.paste.bind(this));Fe(this,Ze,this.keydown.bind(this));Fe(this,xe,this.onEditingAction.bind(this));Fe(this,De,this.onPageChanging.bind(this));Fe(this,se,this.onScaleChanging.bind(this));Fe(this,me,this.onRotationChanging.bind(this));Fe(this,Te,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Fe(this,Ce,[0,0]);Fe(this,$e,null);Fe(this,et,null);Fe(this,Qe,null);Oe(this,et,pe),Oe(this,Qe,We),Oe(this,we,pt),this._eventBus=Lt,this._eventBus._on("editingaction",T(this,xe)),this._eventBus._on("pagechanging",T(this,De)),this._eventBus._on("scalechanging",T(this,se)),this._eventBus._on("rotationchanging",T(this,me)),Oe(this,ve,un.annotationStorage),Oe(this,Y,un.filterFactory),Oe(this,Ee,kt),this.viewParameters={realScale:o.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const pe=In.prototype,We=un=>{const{activeElement:kt}=document;return kt&&T(un,et).contains(kt)&&un.hasSomethingToControl()},pt=this.TRANSLATE_SMALL,Lt=this.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new _([[["ctrl+a","mac+meta+a"],pe.selectAll],[["ctrl+z","mac+meta+z"],pe.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],pe.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],pe.delete],[["Escape","mac+Escape"],pe.unselectAll],[["ArrowLeft","mac+ArrowLeft"],pe.translateSelectedEditors,{args:[-pt,0],checker:We}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],pe.translateSelectedEditors,{args:[-Lt,0],checker:We}],[["ArrowRight","mac+ArrowRight"],pe.translateSelectedEditors,{args:[pt,0],checker:We}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],pe.translateSelectedEditors,{args:[Lt,0],checker:We}],[["ArrowUp","mac+ArrowUp"],pe.translateSelectedEditors,{args:[0,-pt],checker:We}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],pe.translateSelectedEditors,{args:[0,-Lt],checker:We}],[["ArrowDown","mac+ArrowDown"],pe.translateSelectedEditors,{args:[0,pt],checker:We}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],pe.translateSelectedEditors,{args:[0,Lt],checker:We}]]))}destroy(){Pe(this,Se,tl).call(this),Pe(this,Se,qu).call(this),this._eventBus._off("editingaction",T(this,xe)),this._eventBus._off("pagechanging",T(this,De)),this._eventBus._off("scalechanging",T(this,se)),this._eventBus._off("rotationchanging",T(this,me));for(const pe of T(this,C).values())pe.destroy();T(this,C).clear(),T(this,D).clear(),T(this,re).clear(),Oe(this,v,null),T(this,he).clear(),T(this,Re).destroy(),T(this,we).destroy()}get hcmFilter(){return(0,i.shadow)(this,"hcmFilter",T(this,Ee)?T(this,Y).addHCMFilter(T(this,Ee).foreground,T(this,Ee).background):"none")}get direction(){return(0,i.shadow)(this,"direction",getComputedStyle(T(this,et)).direction)}editAltText(pe){var We;(We=T(this,we))==null||We.editAltText(this,pe)}onPageChanging({pageNumber:pe}){Oe(this,_e,pe-1)}focusMainContainer(){T(this,et).focus()}findParent(pe,We){for(const pt of T(this,C).values()){const{x:Lt,y:un,width:kt,height:de}=pt.div.getBoundingClientRect();if(pe>=Lt&&pe<=Lt+kt&&We>=un&&We<=un+de)return pt}return null}disableUserSelect(pe=!1){T(this,Qe).classList.toggle("noUserSelect",pe)}addShouldRescale(pe){T(this,re).add(pe)}removeShouldRescale(pe){T(this,re).delete(pe)}onScaleChanging({scale:pe}){this.commitOrRemove(),this.viewParameters.realScale=pe*o.PixelsPerInch.PDF_TO_CSS_UNITS;for(const We of T(this,re))We.onScaleChanging()}onRotationChanging({pagesRotation:pe}){this.commitOrRemove(),this.viewParameters.rotation=pe}addToAnnotationStorage(pe){!pe.isEmpty()&&T(this,ve)&&!T(this,ve).has(pe.id)&&T(this,ve).setValue(pe.id,pe)}blur(){if(!this.hasSelection)return;const{activeElement:pe}=document;for(const We of T(this,he))if(We.div.contains(pe)){Oe(this,le,[We,pe]),We._focusEventsAllowed=!1;break}}focus(){if(!T(this,le))return;const[pe,We]=T(this,le);Oe(this,le,null),We.addEventListener("focusin",()=>{pe._focusEventsAllowed=!0},{once:!0}),We.focus()}addEditListeners(){Pe(this,Se,Gu).call(this),Pe(this,Se,Ku).call(this)}removeEditListeners(){Pe(this,Se,tl).call(this),Pe(this,Se,Xu).call(this)}copy(pe){var pt;if(pe.preventDefault(),(pt=T(this,v))==null||pt.commitOrRemove(),!this.hasSelection)return;const We=[];for(const Lt of T(this,he)){const un=Lt.serialize(!0);un&&We.push(un)}We.length!==0&&pe.clipboardData.setData("application/pdfjs",JSON.stringify(We))}cut(pe){this.copy(pe),this.delete()}paste(pe){pe.preventDefault();const{clipboardData:We}=pe;for(const un of We.items)for(const kt of T(this,fe))if(kt.isHandlingMimeForPasting(un.type)){kt.paste(un,this.currentLayer);return}let pt=We.getData("application/pdfjs");if(!pt)return;try{pt=JSON.parse(pt)}catch(un){(0,i.warn)(`paste: "${un.message}".`);return}if(!Array.isArray(pt))return;this.unselectAll();const Lt=this.currentLayer;try{const un=[];for(const ae of pt){const Ae=Lt.deserialize(ae);if(!Ae)return;un.push(Ae)}const kt=()=>{for(const ae of un)Pe(this,Se,Yu).call(this,ae);Pe(this,Se,Qu).call(this,un)},de=()=>{for(const ae of un)ae.remove()};this.addCommands({cmd:kt,undo:de,mustExec:!0})}catch(un){(0,i.warn)(`paste: "${un.message}".`)}}keydown(pe){var We;(We=this.getActive())!=null&&We.shouldGetKeyboardEvents()||In._keyboardManager.exec(this,pe)}onEditingAction(pe){["undo","redo","delete","selectAll"].includes(pe.name)&&this[pe.name]()}setEditingState(pe){pe?(Pe(this,Se,Dd).call(this),Pe(this,Se,Gu).call(this),Pe(this,Se,Ku).call(this),Pe(this,Se,Hr).call(this,{isEditing:T(this,ce)!==i.AnnotationEditorType.NONE,isEmpty:Pe(this,Se,Fo).call(this),hasSomethingToUndo:T(this,Re).hasSomethingToUndo(),hasSomethingToRedo:T(this,Re).hasSomethingToRedo(),hasSelectedEditor:!1})):(Pe(this,Se,qu).call(this),Pe(this,Se,tl).call(this),Pe(this,Se,Xu).call(this),Pe(this,Se,Hr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(pe){if(!T(this,fe)){Oe(this,fe,pe);for(const We of T(this,fe))Pe(this,Se,No).call(this,We.defaultPropertiesToUpdate)}}getId(){return T(this,I).getId()}get currentLayer(){return T(this,C).get(T(this,_e))}getLayer(pe){return T(this,C).get(pe)}get currentPageIndex(){return T(this,_e)}addLayer(pe){T(this,C).set(pe.pageIndex,pe),T(this,S)?pe.enable():pe.disable()}removeLayer(pe){T(this,C).delete(pe.pageIndex)}updateMode(pe,We=null){if(T(this,ce)!==pe){if(Oe(this,ce,pe),pe===i.AnnotationEditorType.NONE){this.setEditingState(!1),Pe(this,Se,Md).call(this);return}this.setEditingState(!0),Pe(this,Se,Vd).call(this),this.unselectAll();for(const pt of T(this,C).values())pt.updateMode(pe);if(We){for(const pt of T(this,D).values())if(pt.annotationElementId===We){this.setSelected(pt),pt.enterInEditMode();break}}}}updateToolbar(pe){pe!==T(this,ce)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:pe})}updateParams(pe,We){if(T(this,fe)){if(pe===i.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(pe);return}for(const pt of T(this,he))pt.updateParams(pe,We);for(const pt of T(this,fe))pt.updateDefaultParams(pe,We)}}enableWaiting(pe=!1){if(T(this,ee)!==pe){Oe(this,ee,pe);for(const We of T(this,C).values())pe?We.disableClick():We.enableClick(),We.div.classList.toggle("waiting",pe)}}getEditors(pe){const We=[];for(const pt of T(this,D).values())pt.pageIndex===pe&&We.push(pt);return We}getEditor(pe){return T(this,D).get(pe)}addEditor(pe){T(this,D).set(pe.id,pe)}removeEditor(pe){var We;T(this,D).delete(pe.id),this.unselect(pe),(!pe.annotationElementId||!T(this,ge).has(pe.annotationElementId))&&((We=T(this,ve))==null||We.remove(pe.id))}addDeletedAnnotationElement(pe){T(this,ge).add(pe.annotationElementId),pe.deleted=!0}isDeletedAnnotationElement(pe){return T(this,ge).has(pe)}removeDeletedAnnotationElement(pe){T(this,ge).delete(pe.annotationElementId),pe.deleted=!1}setActiveEditor(pe){T(this,v)!==pe&&(Oe(this,v,pe),pe&&Pe(this,Se,No).call(this,pe.propertiesToUpdate))}toggleSelected(pe){if(T(this,he).has(pe)){T(this,he).delete(pe),pe.unselect(),Pe(this,Se,Hr).call(this,{hasSelectedEditor:this.hasSelection});return}T(this,he).add(pe),pe.select(),Pe(this,Se,No).call(this,pe.propertiesToUpdate),Pe(this,Se,Hr).call(this,{hasSelectedEditor:!0})}setSelected(pe){for(const We of T(this,he))We!==pe&&We.unselect();T(this,he).clear(),T(this,he).add(pe),pe.select(),Pe(this,Se,No).call(this,pe.propertiesToUpdate),Pe(this,Se,Hr).call(this,{hasSelectedEditor:!0})}isSelected(pe){return T(this,he).has(pe)}unselect(pe){pe.unselect(),T(this,he).delete(pe),Pe(this,Se,Hr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return T(this,he).size!==0}undo(){T(this,Re).undo(),Pe(this,Se,Hr).call(this,{hasSomethingToUndo:T(this,Re).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Pe(this,Se,Fo).call(this)})}redo(){T(this,Re).redo(),Pe(this,Se,Hr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:T(this,Re).hasSomethingToRedo(),isEmpty:Pe(this,Se,Fo).call(this)})}addCommands(pe){T(this,Re).add(pe),Pe(this,Se,Hr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Pe(this,Se,Fo).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const pe=[...T(this,he)],We=()=>{for(const Lt of pe)Lt.remove()},pt=()=>{for(const Lt of pe)Pe(this,Se,Yu).call(this,Lt)};this.addCommands({cmd:We,undo:pt,mustExec:!0})}commitOrRemove(){var pe;(pe=T(this,v))==null||pe.commitOrRemove()}hasSomethingToControl(){return T(this,v)||this.hasSelection}selectAll(){for(const pe of T(this,he))pe.commit();Pe(this,Se,Qu).call(this,T(this,D).values())}unselectAll(){if(T(this,v)){T(this,v).commitOrRemove();return}if(this.hasSelection){for(const pe of T(this,he))pe.unselect();T(this,he).clear(),Pe(this,Se,Hr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(pe,We,pt=!1){if(pt||this.commitOrRemove(),!this.hasSelection)return;T(this,Ce)[0]+=pe,T(this,Ce)[1]+=We;const[Lt,un]=T(this,Ce),kt=[...T(this,he)],de=1e3;T(this,$e)&&clearTimeout(T(this,$e)),Oe(this,$e,setTimeout(()=>{Oe(this,$e,null),T(this,Ce)[0]=T(this,Ce)[1]=0,this.addCommands({cmd:()=>{for(const ae of kt)T(this,D).has(ae.id)&&ae.translateInPage(Lt,un)},undo:()=>{for(const ae of kt)T(this,D).has(ae.id)&&ae.translateInPage(-Lt,-un)},mustExec:!1})},de));for(const ae of kt)ae.translateInPage(pe,We)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Oe(this,ie,new Map);for(const pe of T(this,he))T(this,ie).set(pe,{savedX:pe.x,savedY:pe.y,savedPageIndex:pe.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!T(this,ie))return!1;this.disableUserSelect(!1);const pe=T(this,ie);Oe(this,ie,null);let We=!1;for(const[{x:Lt,y:un,pageIndex:kt},de]of pe)de.newX=Lt,de.newY=un,de.newPageIndex=kt,We||(We=Lt!==de.savedX||un!==de.savedY||kt!==de.savedPageIndex);if(!We)return!1;const pt=(Lt,un,kt,de)=>{if(T(this,D).has(Lt.id)){const ae=T(this,C).get(de);ae?Lt._setParentAndPosition(ae,un,kt):(Lt.pageIndex=de,Lt.x=un,Lt.y=kt)}};return this.addCommands({cmd:()=>{for(const[Lt,{newX:un,newY:kt,newPageIndex:de}]of pe)pt(Lt,un,kt,de)},undo:()=>{for(const[Lt,{savedX:un,savedY:kt,savedPageIndex:de}]of pe)pt(Lt,un,kt,de)},mustExec:!0}),!0}dragSelectedEditors(pe,We){if(T(this,ie))for(const pt of T(this,ie).keys())pt.drag(pe,We)}rebuild(pe){if(pe.parent===null){const We=this.getLayer(pe.pageIndex);We?(We.changeParent(pe),We.addOrRebuild(pe)):(this.addEditor(pe),this.addToAnnotationStorage(pe),pe.rebuild())}else pe.parent.addOrRebuild(pe)}isActive(pe){return T(this,v)===pe}getActive(){return T(this,v)}getMode(){return T(this,ce)}get imageManager(){return(0,i.shadow)(this,"imageManager",new d)}};v=new WeakMap,D=new WeakMap,C=new WeakMap,we=new WeakMap,ve=new WeakMap,Re=new WeakMap,_e=new WeakMap,ge=new WeakMap,ie=new WeakMap,fe=new WeakMap,re=new WeakMap,Y=new WeakMap,I=new WeakMap,S=new WeakMap,ee=new WeakMap,le=new WeakMap,ce=new WeakMap,he=new WeakMap,Ee=new WeakMap,be=new WeakMap,Be=new WeakMap,ze=new WeakMap,Ke=new WeakMap,Xe=new WeakMap,Ze=new WeakMap,xe=new WeakMap,De=new WeakMap,se=new WeakMap,me=new WeakMap,Te=new WeakMap,Ce=new WeakMap,$e=new WeakMap,et=new WeakMap,Qe=new WeakMap,Se=new WeakSet,Dd=function(){window.addEventListener("focus",T(this,Be)),window.addEventListener("blur",T(this,be))},qu=function(){window.removeEventListener("focus",T(this,Be)),window.removeEventListener("blur",T(this,be))},Gu=function(){window.addEventListener("keydown",T(this,Ze),{capture:!0})},tl=function(){window.removeEventListener("keydown",T(this,Ze),{capture:!0})},Ku=function(){document.addEventListener("copy",T(this,ze)),document.addEventListener("cut",T(this,Ke)),document.addEventListener("paste",T(this,Xe))},Xu=function(){document.removeEventListener("copy",T(this,ze)),document.removeEventListener("cut",T(this,Ke)),document.removeEventListener("paste",T(this,Xe))},Hr=function(pe){Object.entries(pe).some(([pt,Lt])=>T(this,Te)[pt]!==Lt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(T(this,Te),pe)})},No=function(pe){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:pe})},Vd=function(){if(!T(this,S)){Oe(this,S,!0);for(const pe of T(this,C).values())pe.enable()}},Md=function(){if(this.unselectAll(),T(this,S)){Oe(this,S,!1);for(const pe of T(this,C).values())pe.disable()}},Yu=function(pe){const We=T(this,C).get(pe.pageIndex);We?We.addOrRebuild(pe):this.addEditor(pe)},Fo=function(){if(T(this,D).size===0)return!0;if(T(this,D).size===1)for(const pe of T(this,D).values())return pe.isEmpty();return!1},Qu=function(pe){T(this,he).clear();for(const We of pe)We.isEmpty()||(T(this,he).add(We),We.select());Pe(this,Se,Hr).call(this,{hasSelectedEditor:!0})},Un(In,"TRANSLATE_SMALL",1),Un(In,"TRANSLATE_BIG",10);let w=In;e.AnnotationEditorUIManager=w},(n,e,t)=>{var _e,ge,ie,fe,re,Y,I,S,ee,le,ce,he,Qs,Js,Ju,nl,rl,Oo,Lo;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=y,e.getColorValues=D,e.getCurrentTransform=C,e.getCurrentTransformInverse=we,e.getFilenameFromUrl=K,e.getPdfFilenameFromUrl=Z,e.getRGB=v,e.getXfaPageViewport=W,e.isDataScheme=X,e.isPdfFile=b,e.isValidFetchUrl=te,e.loadScript=J,e.noContextMenu=H,e.setLayerDimensions=ve;var i=t(7),o=t(1);const a="http://www.w3.org/2000/svg",Re=class Re{};Un(Re,"CSS",96),Un(Re,"PDF",72),Un(Re,"PDF_TO_CSS_UNITS",Re.CSS/Re.PDF);let u=Re;e.PixelsPerInch=u;class f extends i.BaseFilterFactory{constructor({docId:se,ownerDocument:me=globalThis.document}={}){super();Fe(this,he);Fe(this,_e);Fe(this,ge);Fe(this,ie);Fe(this,fe);Fe(this,re);Fe(this,Y);Fe(this,I);Fe(this,S);Fe(this,ee);Fe(this,le);Fe(this,ce,0);Oe(this,ie,se),Oe(this,fe,me)}addFilter(se){if(!se)return"none";let me=T(this,he,Qs).get(se);if(me)return me;let Te,Ce,$e,et;if(se.length===1){const nt=se[0],mn=new Array(256);for(let fn=0;fn<256;fn++)mn[fn]=nt[fn]/255;et=Te=Ce=$e=mn.join(",")}else{const[nt,mn,fn]=se,Rn=new Array(256),Ut=new Array(256),hn=new Array(256);for(let bn=0;bn<256;bn++)Rn[bn]=nt[bn]/255,Ut[bn]=mn[bn]/255,hn[bn]=fn[bn]/255;Te=Rn.join(","),Ce=Ut.join(","),$e=hn.join(","),et=`${Te}${Ce}${$e}`}if(me=T(this,he,Qs).get(et),me)return T(this,he,Qs).set(se,me),me;const Qe=`g_${T(this,ie)}_transfer_map_${Mo(this,ce)._++}`,Se=`url(#${Qe})`;T(this,he,Qs).set(se,Se),T(this,he,Qs).set(et,Se);const rt=Pe(this,he,nl).call(this,Qe);return Pe(this,he,Oo).call(this,Te,Ce,$e,rt),Se}addHCMFilter(se,me){var mn;const Te=`${se}-${me}`;if(T(this,Y)===Te)return T(this,I);if(Oe(this,Y,Te),Oe(this,I,"none"),(mn=T(this,re))==null||mn.remove(),!se||!me)return T(this,I);const Ce=Pe(this,he,Lo).call(this,se);se=o.Util.makeHexColor(...Ce);const $e=Pe(this,he,Lo).call(this,me);if(me=o.Util.makeHexColor(...$e),T(this,he,Js).style.color="",se==="#000000"&&me==="#ffffff"||se===me)return T(this,I);const et=new Array(256);for(let fn=0;fn<=255;fn++){const Rn=fn/255;et[fn]=Rn<=.03928?Rn/12.92:((Rn+.055)/1.055)**2.4}const Qe=et.join(","),Se=`g_${T(this,ie)}_hcm_filter`,rt=Oe(this,S,Pe(this,he,nl).call(this,Se));Pe(this,he,Oo).call(this,Qe,Qe,Qe,rt),Pe(this,he,Ju).call(this,rt);const nt=(fn,Rn)=>{const Ut=Ce[fn]/255,hn=$e[fn]/255,bn=new Array(Rn+1);for(let kn=0;kn<=Rn;kn++)bn[kn]=Ut+kn/Rn*(hn-Ut);return bn.join(",")};return Pe(this,he,Oo).call(this,nt(0,5),nt(1,5),nt(2,5),rt),Oe(this,I,`url(#${Se})`),T(this,I)}addHighlightHCMFilter(se,me,Te,Ce){var hn;const $e=`${se}-${me}-${Te}-${Ce}`;if(T(this,ee)===$e)return T(this,le);if(Oe(this,ee,$e),Oe(this,le,"none"),(hn=T(this,S))==null||hn.remove(),!se||!me)return T(this,le);const[et,Qe]=[se,me].map(Pe(this,he,Lo).bind(this));let Se=Math.round(.2126*et[0]+.7152*et[1]+.0722*et[2]),rt=Math.round(.2126*Qe[0]+.7152*Qe[1]+.0722*Qe[2]),[nt,mn]=[Te,Ce].map(Pe(this,he,Lo).bind(this));rt<Se&&([Se,rt,nt,mn]=[rt,Se,mn,nt]),T(this,he,Js).style.color="";const fn=(bn,kn,Ye)=>{const Ve=new Array(256),Ne=(rt-Se)/Ye,Dt=bn/255,In=(kn-bn)/(255*Ye);let Pn=0;for(let pe=0;pe<=Ye;pe++){const We=Math.round(Se+pe*Ne),pt=Dt+pe*In;for(let Lt=Pn;Lt<=We;Lt++)Ve[Lt]=pt;Pn=We+1}for(let pe=Pn;pe<256;pe++)Ve[pe]=Ve[Pn-1];return Ve.join(",")},Rn=`g_${T(this,ie)}_hcm_highlight_filter`,Ut=Oe(this,S,Pe(this,he,nl).call(this,Rn));return Pe(this,he,Ju).call(this,Ut),Pe(this,he,Oo).call(this,fn(nt[0],mn[0],5),fn(nt[1],mn[1],5),fn(nt[2],mn[2],5),Ut),Oe(this,le,`url(#${Rn})`),T(this,le)}destroy(se=!1){se&&(T(this,I)||T(this,le))||(T(this,ge)&&(T(this,ge).parentNode.parentNode.remove(),Oe(this,ge,null)),T(this,_e)&&(T(this,_e).clear(),Oe(this,_e,null)),Oe(this,ce,0))}}_e=new WeakMap,ge=new WeakMap,ie=new WeakMap,fe=new WeakMap,re=new WeakMap,Y=new WeakMap,I=new WeakMap,S=new WeakMap,ee=new WeakMap,le=new WeakMap,ce=new WeakMap,he=new WeakSet,Qs=function(){return T(this,_e)||Oe(this,_e,new Map)},Js=function(){if(!T(this,ge)){const se=T(this,fe).createElement("div"),{style:me}=se;me.visibility="hidden",me.contain="strict",me.width=me.height=0,me.position="absolute",me.top=me.left=0,me.zIndex=-1;const Te=T(this,fe).createElementNS(a,"svg");Te.setAttribute("width",0),Te.setAttribute("height",0),Oe(this,ge,T(this,fe).createElementNS(a,"defs")),se.append(Te),Te.append(T(this,ge)),T(this,fe).body.append(se)}return T(this,ge)},Ju=function(se){const me=T(this,fe).createElementNS(a,"feColorMatrix");me.setAttribute("type","matrix"),me.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),se.append(me)},nl=function(se){const me=T(this,fe).createElementNS(a,"filter");return me.setAttribute("color-interpolation-filters","sRGB"),me.setAttribute("id",se),T(this,he,Js).append(me),me},rl=function(se,me,Te){const Ce=T(this,fe).createElementNS(a,me);Ce.setAttribute("type","discrete"),Ce.setAttribute("tableValues",Te),se.append(Ce)},Oo=function(se,me,Te,Ce){const $e=T(this,fe).createElementNS(a,"feComponentTransfer");Ce.append($e),Pe(this,he,rl).call(this,$e,"feFuncR",se),Pe(this,he,rl).call(this,$e,"feFuncG",me),Pe(this,he,rl).call(this,$e,"feFuncB",Te)},Lo=function(se){return T(this,he,Js).style.color=se,v(getComputedStyle(T(this,he,Js)).getPropertyValue("color"))},e.DOMFilterFactory=f;class d extends i.BaseCanvasFactory{constructor({ownerDocument:De=globalThis.document}={}){super(),this._document=De}_createCanvas(De,se){const me=this._document.createElement("canvas");return me.width=De,me.height=se,me}}e.DOMCanvasFactory=d;async function p(xe,De=!1){if(te(xe,document.baseURI)){const se=await fetch(xe);if(!se.ok)throw new Error(se.statusText);return De?new Uint8Array(await se.arrayBuffer()):(0,o.stringToBytes)(await se.text())}return new Promise((se,me)=>{const Te=new XMLHttpRequest;Te.open("GET",xe,!0),De&&(Te.responseType="arraybuffer"),Te.onreadystatechange=()=>{if(Te.readyState===XMLHttpRequest.DONE){if(Te.status===200||Te.status===0){let Ce;if(De&&Te.response?Ce=new Uint8Array(Te.response):!De&&Te.responseText&&(Ce=(0,o.stringToBytes)(Te.responseText)),Ce){se(Ce);return}}me(new Error(Te.statusText))}},Te.send(null)})}class _ extends i.BaseCMapReaderFactory{_fetchData(De,se){return p(De,this.isCompressed).then(me=>({cMapData:me,compressionType:se}))}}e.DOMCMapReaderFactory=_;class R extends i.BaseStandardFontDataFactory{_fetchData(De){return p(De,!0)}}e.DOMStandardFontDataFactory=R;class w extends i.BaseSVGFactory{_createSVG(De){return document.createElementNS(a,De)}}e.DOMSVGFactory=w;class V{constructor({viewBox:De,scale:se,rotation:me,offsetX:Te=0,offsetY:Ce=0,dontFlip:$e=!1}){this.viewBox=De,this.scale=se,this.rotation=me,this.offsetX=Te,this.offsetY=Ce;const et=(De[2]+De[0])/2,Qe=(De[3]+De[1])/2;let Se,rt,nt,mn;switch(me%=360,me<0&&(me+=360),me){case 180:Se=-1,rt=0,nt=0,mn=1;break;case 90:Se=0,rt=1,nt=1,mn=0;break;case 270:Se=0,rt=-1,nt=-1,mn=0;break;case 0:Se=1,rt=0,nt=0,mn=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}$e&&(nt=-nt,mn=-mn);let fn,Rn,Ut,hn;Se===0?(fn=Math.abs(Qe-De[1])*se+Te,Rn=Math.abs(et-De[0])*se+Ce,Ut=(De[3]-De[1])*se,hn=(De[2]-De[0])*se):(fn=Math.abs(et-De[0])*se+Te,Rn=Math.abs(Qe-De[1])*se+Ce,Ut=(De[2]-De[0])*se,hn=(De[3]-De[1])*se),this.transform=[Se*se,rt*se,nt*se,mn*se,fn-Se*se*et-nt*se*Qe,Rn-rt*se*et-mn*se*Qe],this.width=Ut,this.height=hn}get rawDims(){const{viewBox:De}=this;return(0,o.shadow)(this,"rawDims",{pageWidth:De[2]-De[0],pageHeight:De[3]-De[1],pageX:De[0],pageY:De[1]})}clone({scale:De=this.scale,rotation:se=this.rotation,offsetX:me=this.offsetX,offsetY:Te=this.offsetY,dontFlip:Ce=!1}={}){return new V({viewBox:this.viewBox.slice(),scale:De,rotation:se,offsetX:me,offsetY:Te,dontFlip:Ce})}convertToViewportPoint(De,se){return o.Util.applyTransform([De,se],this.transform)}convertToViewportRectangle(De){const se=o.Util.applyTransform([De[0],De[1]],this.transform),me=o.Util.applyTransform([De[2],De[3]],this.transform);return[se[0],se[1],me[0],me[1]]}convertToPdfPoint(De,se){return o.Util.applyInverseTransform([De,se],this.transform)}}e.PageViewport=V;class U extends o.BaseException{constructor(De,se=0){super(De,"RenderingCancelledException"),this.extraDelay=se}}e.RenderingCancelledException=U;function X(xe){const De=xe.length;let se=0;for(;se<De&&xe[se].trim()==="";)se++;return xe.substring(se,se+5).toLowerCase()==="data:"}function b(xe){return typeof xe=="string"&&/\.pdf$/i.test(xe)}function K(xe,De=!1){return De||([xe]=xe.split(/[#?]/,1)),xe.substring(xe.lastIndexOf("/")+1)}function Z(xe,De="document.pdf"){if(typeof xe!="string")return De;if(X(xe))return(0,o.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),De;const se=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,me=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Te=se.exec(xe);let Ce=me.exec(Te[1])||me.exec(Te[2])||me.exec(Te[3]);if(Ce&&(Ce=Ce[0],Ce.includes("%")))try{Ce=me.exec(decodeURIComponent(Ce))[0]}catch{}return Ce||De}class oe{constructor(){Un(this,"started",Object.create(null));Un(this,"times",[])}time(De){De in this.started&&(0,o.warn)(`Timer is already running for ${De}`),this.started[De]=Date.now()}timeEnd(De){De in this.started||(0,o.warn)(`Timer has not been started for ${De}`),this.times.push({name:De,start:this.started[De],end:Date.now()}),delete this.started[De]}toString(){const De=[];let se=0;for(const{name:me}of this.times)se=Math.max(me.length,se);for(const{name:me,start:Te,end:Ce}of this.times)De.push(`${me.padEnd(se)} ${Ce-Te}ms
`);return De.join("")}}e.StatTimer=oe;function te(xe,De){try{const{protocol:se}=De?new URL(xe,De):new URL(xe);return se==="http:"||se==="https:"}catch{return!1}}function H(xe){xe.preventDefault()}function J(xe,De=!1){return new Promise((se,me)=>{const Te=document.createElement("script");Te.src=xe,Te.onload=function(Ce){De&&Te.remove(),se(Ce)},Te.onerror=function(){me(new Error(`Cannot load script at: ${Te.src}`))},(document.head||document.documentElement).append(Te)})}function y(xe){console.log("Deprecated API usage: "+xe)}let g;class E{static toDateObject(De){if(!De||typeof De!="string")return null;g||(g=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const se=g.exec(De);if(!se)return null;const me=parseInt(se[1],10);let Te=parseInt(se[2],10);Te=Te>=1&&Te<=12?Te-1:0;let Ce=parseInt(se[3],10);Ce=Ce>=1&&Ce<=31?Ce:1;let $e=parseInt(se[4],10);$e=$e>=0&&$e<=23?$e:0;let et=parseInt(se[5],10);et=et>=0&&et<=59?et:0;let Qe=parseInt(se[6],10);Qe=Qe>=0&&Qe<=59?Qe:0;const Se=se[7]||"Z";let rt=parseInt(se[8],10);rt=rt>=0&&rt<=23?rt:0;let nt=parseInt(se[9],10)||0;return nt=nt>=0&&nt<=59?nt:0,Se==="-"?($e+=rt,et+=nt):Se==="+"&&($e-=rt,et-=nt),new Date(Date.UTC(me,Te,Ce,$e,et,Qe))}}e.PDFDateString=E;function W(xe,{scale:De=1,rotation:se=0}){const{width:me,height:Te}=xe.attributes.style,Ce=[0,0,parseInt(me),parseInt(Te)];return new V({viewBox:Ce,scale:De,rotation:se})}function v(xe){if(xe.startsWith("#")){const De=parseInt(xe.slice(1),16);return[(De&16711680)>>16,(De&65280)>>8,De&255]}return xe.startsWith("rgb(")?xe.slice(4,-1).split(",").map(De=>parseInt(De)):xe.startsWith("rgba(")?xe.slice(5,-1).split(",").map(De=>parseInt(De)).slice(0,3):((0,o.warn)(`Not a valid color format: "${xe}"`),[0,0,0])}function D(xe){const De=document.createElement("span");De.style.visibility="hidden",document.body.append(De);for(const se of xe.keys()){De.style.color=se;const me=window.getComputedStyle(De).color;xe.set(se,v(me))}De.remove()}function C(xe){const{a:De,b:se,c:me,d:Te,e:Ce,f:$e}=xe.getTransform();return[De,se,me,Te,Ce,$e]}function we(xe){const{a:De,b:se,c:me,d:Te,e:Ce,f:$e}=xe.getTransform().invertSelf();return[De,se,me,Te,Ce,$e]}function ve(xe,De,se=!1,me=!0){if(De instanceof V){const{pageWidth:Te,pageHeight:Ce}=De.rawDims,{style:$e}=xe,et=o.FeatureTest.isCSSRoundSupported,Qe=`var(--scale-factor) * ${Te}px`,Se=`var(--scale-factor) * ${Ce}px`,rt=et?`round(${Qe}, 1px)`:`calc(${Qe})`,nt=et?`round(${Se}, 1px)`:`calc(${Se})`;!se||De.rotation%180===0?($e.width=rt,$e.height=nt):($e.width=nt,$e.height=rt)}me&&xe.setAttribute("data-main-rotation",De.rotation)}},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var i=t(1);class o{constructor(){this.constructor===o&&(0,i.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(_){return"none"}addHCMFilter(_,R){return"none"}addHighlightHCMFilter(_,R,w,V){return"none"}destroy(_=!1){}}e.BaseFilterFactory=o;class a{constructor(){this.constructor===a&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(_,R){if(_<=0||R<=0)throw new Error("Invalid canvas size");const w=this._createCanvas(_,R);return{canvas:w,context:w.getContext("2d")}}reset(_,R,w){if(!_.canvas)throw new Error("Canvas is not specified");if(R<=0||w<=0)throw new Error("Invalid canvas size");_.canvas.width=R,_.canvas.height=w}destroy(_){if(!_.canvas)throw new Error("Canvas is not specified");_.canvas.width=0,_.canvas.height=0,_.canvas=null,_.context=null}_createCanvas(_,R){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=a;class u{constructor({baseUrl:_=null,isCompressed:R=!0}){this.constructor===u&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=_,this.isCompressed=R}async fetch({name:_}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!_)throw new Error("CMap name must be specified.");const R=this.baseUrl+_+(this.isCompressed?".bcmap":""),w=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(R,w).catch(V=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${R}`)})}_fetchData(_,R){(0,i.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=u;class f{constructor({baseUrl:_=null}){this.constructor===f&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=_}async fetch({filename:_}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!_)throw new Error("Font filename must be specified.");const R=`${this.baseUrl}${_}`;return this._fetchData(R).catch(w=>{throw new Error(`Unable to load font data at: ${R}`)})}_fetchData(_){(0,i.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=f;class d{constructor(){this.constructor===d&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(_,R,w=!1){if(_<=0||R<=0)throw new Error("Invalid SVG dimensions");const V=this._createSVG("svg:svg");return V.setAttribute("version","1.1"),w||(V.setAttribute("width",`${_}px`),V.setAttribute("height",`${R}px`)),V.setAttribute("preserveAspectRatio","none"),V.setAttribute("viewBox",`0 0 ${_} ${R}`),V}createElement(_){if(typeof _!="string")throw new Error("Invalid SVG element type");return this._createSVG(_)}_createSVG(_){(0,i.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=d},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var i=t(1);const o=3285377520,a=4294901760,u=65535;class f{constructor(p){this.h1=p?p&4294967295:o,this.h2=p?p&4294967295:o}update(p){let _,R;if(typeof p=="string"){_=new Uint8Array(p.length*2),R=0;for(let y=0,g=p.length;y<g;y++){const E=p.charCodeAt(y);E<=255?_[R++]=E:(_[R++]=E>>>8,_[R++]=E&255)}}else if((0,i.isArrayBuffer)(p))_=p.slice(),R=_.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const w=R>>2,V=R-w*4,U=new Uint32Array(_.buffer,0,w);let X=0,b=0,K=this.h1,Z=this.h2;const oe=3432918353,te=461845907,H=oe&u,J=te&u;for(let y=0;y<w;y++)y&1?(X=U[y],X=X*oe&a|X*H&u,X=X<<15|X>>>17,X=X*te&a|X*J&u,K^=X,K=K<<13|K>>>19,K=K*5+3864292196):(b=U[y],b=b*oe&a|b*H&u,b=b<<15|b>>>17,b=b*te&a|b*J&u,Z^=b,Z=Z<<13|Z>>>19,Z=Z*5+3864292196);switch(X=0,V){case 3:X^=_[w*4+2]<<16;case 2:X^=_[w*4+1]<<8;case 1:X^=_[w*4],X=X*oe&a|X*H&u,X=X<<15|X>>>17,X=X*te&a|X*J&u,w&1?K^=X:Z^=X}this.h1=K,this.h2=Z}hexdigest(){let p=this.h1,_=this.h2;return p^=_>>>1,p=p*3981806797&a|p*36045&u,_=_*4283543511&a|((_<<16|p>>>16)*2950163797&a)>>>16,p^=_>>>1,p=p*444984403&a|p*60499&u,_=_*3301882366&a|((_<<16|p>>>16)*3120437893&a)>>>16,p^=_>>>1,(p>>>0).toString(16).padStart(8,"0")+(_>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=f},(n,e,t)=>{var u;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var i=t(1);class o{constructor({ownerDocument:d=globalThis.document,styleElement:p=null}){Fe(this,u,new Set);this._document=d,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(d){this.nativeFontFaces.add(d),this._document.fonts.add(d)}removeNativeFontFace(d){this.nativeFontFaces.delete(d),this._document.fonts.delete(d)}insertRule(d){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const p=this.styleElement.sheet;p.insertRule(d,p.cssRules.length)}clear(){for(const d of this.nativeFontFaces)this._document.fonts.delete(d);this.nativeFontFaces.clear(),T(this,u).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(d){if(!(!d||T(this,u).has(d.loadedName))){if((0,i.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:p,src:_,style:R}=d,w=new FontFace(p,_,R);this.addNativeFontFace(w);try{await w.load(),T(this,u).add(p)}catch{(0,i.warn)(`Cannot load system font: ${d.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(w)}return}(0,i.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(d){if(d.attached||d.missingFile&&!d.systemFontInfo)return;if(d.attached=!0,d.systemFontInfo){await this.loadSystemFont(d.systemFontInfo);return}if(this.isFontLoadingAPISupported){const _=d.createNativeFontFace();if(_){this.addNativeFontFace(_);try{await _.loaded}catch(R){throw(0,i.warn)(`Failed to load font '${_.family}': '${R}'.`),d.disableFontFace=!0,R}}return}const p=d.createFontFaceRule();if(p){if(this.insertRule(p),this.isSyncFontLoadingSupported)return;await new Promise(_=>{const R=this._queueLoadingCallback(_);this._prepareFontLoadEvent(d,R)})}}get isFontLoadingAPISupported(){var p;const d=!!((p=this._document)!=null&&p.fonts);return(0,i.shadow)(this,"isFontLoadingAPISupported",d)}get isSyncFontLoadingSupported(){let d=!1;return(i.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(d=!0),(0,i.shadow)(this,"isSyncFontLoadingSupported",d)}_queueLoadingCallback(d){function p(){for((0,i.assert)(!R.done,"completeRequest() cannot be called twice."),R.done=!0;_.length>0&&_[0].done;){const w=_.shift();setTimeout(w.callback,0)}}const{loadingRequests:_}=this,R={done:!1,complete:p,callback:d};return _.push(R),R}get _loadTestFont(){const d=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,i.shadow)(this,"_loadTestFont",d)}_prepareFontLoadEvent(d,p){function _(v,D){return v.charCodeAt(D)<<24|v.charCodeAt(D+1)<<16|v.charCodeAt(D+2)<<8|v.charCodeAt(D+3)&255}function R(v,D,C,we){const ve=v.substring(0,D),Re=v.substring(D+C);return ve+we+Re}let w,V;const U=this._document.createElement("canvas");U.width=1,U.height=1;const X=U.getContext("2d");let b=0;function K(v,D){if(++b>30){(0,i.warn)("Load test font never loaded."),D();return}if(X.font="30px "+v,X.fillText(".",0,20),X.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(K.bind(null,v,D))}const Z=`lt${Date.now()}${this.loadTestFontId++}`;let oe=this._loadTestFont;oe=R(oe,976,Z.length,Z);const H=16,J=1482184792;let y=_(oe,H);for(w=0,V=Z.length-3;w<V;w+=4)y=y-J+_(Z,w)|0;w<Z.length&&(y=y-J+_(Z+"XXX",w)|0),oe=R(oe,H,4,(0,i.string32)(y));const g=`url(data:font/opentype;base64,${btoa(oe)});`,E=`@font-face {font-family:"${Z}";src:${g}}`;this.insertRule(E);const W=this._document.createElement("div");W.style.visibility="hidden",W.style.width=W.style.height="10px",W.style.position="absolute",W.style.top=W.style.left="0px";for(const v of[d.loadedName,Z]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=v,W.append(D)}this._document.body.append(W),K(Z,()=>{W.remove(),p.complete()})}}u=new WeakMap,e.FontLoader=o;class a{constructor(d,{isEvalSupported:p=!0,disableFontFace:_=!1,ignoreErrors:R=!1,inspectFont:w=null}){this.compiledGlyphs=Object.create(null);for(const V in d)this[V]=d[V];this.isEvalSupported=p!==!1,this.disableFontFace=_===!0,this.ignoreErrors=R===!0,this._inspectFont=w}createNativeFontFace(){var p;if(!this.data||this.disableFontFace)return null;let d;if(!this.cssFontInfo)d=new FontFace(this.loadedName,this.data,{});else{const _={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(_.style=`oblique ${this.cssFontInfo.italicAngle}deg`),d=new FontFace(this.cssFontInfo.fontFamily,this.data,_)}return(p=this._inspectFont)==null||p.call(this,this),d}createFontFaceRule(){var R;if(!this.data||this.disableFontFace)return null;const d=(0,i.bytesToString)(this.data),p=`url(data:${this.mimetype};base64,${btoa(d)});`;let _;if(!this.cssFontInfo)_=`@font-face {font-family:"${this.loadedName}";src:${p}}`;else{let w=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(w+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),_=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${w}src:${p}}`}return(R=this._inspectFont)==null||R.call(this,this,p),_}getPathGenerator(d,p){if(this.compiledGlyphs[p]!==void 0)return this.compiledGlyphs[p];let _;try{_=d.get(this.loadedName+"_path_"+p)}catch(R){if(!this.ignoreErrors)throw R;return(0,i.warn)(`getPathGenerator - ignoring character: "${R}".`),this.compiledGlyphs[p]=function(w,V){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const R=[];for(const w of _){const V=w.args!==void 0?w.args.join(","):"";R.push("c.",w.cmd,"(",V,`);
`)}return this.compiledGlyphs[p]=new Function("c","size",R.join(""))}return this.compiledGlyphs[p]=function(R,w){for(const V of _)V.cmd==="scale"&&(V.args=[w,-w]),R[V.cmd].apply(R,V.args)}}}e.FontFaceObject=a},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var i=t(7);t(1);const o=function(p){return new Promise((_,R)=>{require$$5.readFile(p,(V,U)=>{if(V||!U){R(new Error(V));return}_(new Uint8Array(U))})})};class a extends i.BaseFilterFactory{}e.NodeFilterFactory=a;class u extends i.BaseCanvasFactory{_createCanvas(_,R){return require$$5.createCanvas(_,R)}}e.NodeCanvasFactory=u;class f extends i.BaseCMapReaderFactory{_fetchData(_,R){return o(_).then(w=>({cMapData:w,compressionType:R}))}}e.NodeCMapReaderFactory=f;class d extends i.BaseStandardFontDataFactory{_fetchData(_){return o(_)}}e.NodeStandardFontDataFactory=d},(n,e,t)=>{var ge,Zu,ec;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var i=t(1),o=t(6),a=t(12),u=t(13);const f=16,d=100,p=4096,_=15,R=10,w=1e3,V=16;function U(Y,I){if(Y._removeMirroring)throw new Error("Context is already forwarding operations.");Y.__originalSave=Y.save,Y.__originalRestore=Y.restore,Y.__originalRotate=Y.rotate,Y.__originalScale=Y.scale,Y.__originalTranslate=Y.translate,Y.__originalTransform=Y.transform,Y.__originalSetTransform=Y.setTransform,Y.__originalResetTransform=Y.resetTransform,Y.__originalClip=Y.clip,Y.__originalMoveTo=Y.moveTo,Y.__originalLineTo=Y.lineTo,Y.__originalBezierCurveTo=Y.bezierCurveTo,Y.__originalRect=Y.rect,Y.__originalClosePath=Y.closePath,Y.__originalBeginPath=Y.beginPath,Y._removeMirroring=()=>{Y.save=Y.__originalSave,Y.restore=Y.__originalRestore,Y.rotate=Y.__originalRotate,Y.scale=Y.__originalScale,Y.translate=Y.__originalTranslate,Y.transform=Y.__originalTransform,Y.setTransform=Y.__originalSetTransform,Y.resetTransform=Y.__originalResetTransform,Y.clip=Y.__originalClip,Y.moveTo=Y.__originalMoveTo,Y.lineTo=Y.__originalLineTo,Y.bezierCurveTo=Y.__originalBezierCurveTo,Y.rect=Y.__originalRect,Y.closePath=Y.__originalClosePath,Y.beginPath=Y.__originalBeginPath,delete Y._removeMirroring},Y.save=function(){I.save(),this.__originalSave()},Y.restore=function(){I.restore(),this.__originalRestore()},Y.translate=function(ee,le){I.translate(ee,le),this.__originalTranslate(ee,le)},Y.scale=function(ee,le){I.scale(ee,le),this.__originalScale(ee,le)},Y.transform=function(ee,le,ce,he,Ee,be){I.transform(ee,le,ce,he,Ee,be),this.__originalTransform(ee,le,ce,he,Ee,be)},Y.setTransform=function(ee,le,ce,he,Ee,be){I.setTransform(ee,le,ce,he,Ee,be),this.__originalSetTransform(ee,le,ce,he,Ee,be)},Y.resetTransform=function(){I.resetTransform(),this.__originalResetTransform()},Y.rotate=function(ee){I.rotate(ee),this.__originalRotate(ee)},Y.clip=function(ee){I.clip(ee),this.__originalClip(ee)},Y.moveTo=function(S,ee){I.moveTo(S,ee),this.__originalMoveTo(S,ee)},Y.lineTo=function(S,ee){I.lineTo(S,ee),this.__originalLineTo(S,ee)},Y.bezierCurveTo=function(S,ee,le,ce,he,Ee){I.bezierCurveTo(S,ee,le,ce,he,Ee),this.__originalBezierCurveTo(S,ee,le,ce,he,Ee)},Y.rect=function(S,ee,le,ce){I.rect(S,ee,le,ce),this.__originalRect(S,ee,le,ce)},Y.closePath=function(){I.closePath(),this.__originalClosePath()},Y.beginPath=function(){I.beginPath(),this.__originalBeginPath()}}class X{constructor(I){this.canvasFactory=I,this.cache=Object.create(null)}getCanvas(I,S,ee){let le;return this.cache[I]!==void 0?(le=this.cache[I],this.canvasFactory.reset(le,S,ee)):(le=this.canvasFactory.create(S,ee),this.cache[I]=le),le}delete(I){delete this.cache[I]}clear(){for(const I in this.cache){const S=this.cache[I];this.canvasFactory.destroy(S),delete this.cache[I]}}}function b(Y,I,S,ee,le,ce,he,Ee,be,Be){const[ze,Ke,Xe,Ze,xe,De]=(0,o.getCurrentTransform)(Y);if(Ke===0&&Xe===0){const Te=he*ze+xe,Ce=Math.round(Te),$e=Ee*Ze+De,et=Math.round($e),Qe=(he+be)*ze+xe,Se=Math.abs(Math.round(Qe)-Ce)||1,rt=(Ee+Be)*Ze+De,nt=Math.abs(Math.round(rt)-et)||1;return Y.setTransform(Math.sign(ze),0,0,Math.sign(Ze),Ce,et),Y.drawImage(I,S,ee,le,ce,0,0,Se,nt),Y.setTransform(ze,Ke,Xe,Ze,xe,De),[Se,nt]}if(ze===0&&Ze===0){const Te=Ee*Xe+xe,Ce=Math.round(Te),$e=he*Ke+De,et=Math.round($e),Qe=(Ee+Be)*Xe+xe,Se=Math.abs(Math.round(Qe)-Ce)||1,rt=(he+be)*Ke+De,nt=Math.abs(Math.round(rt)-et)||1;return Y.setTransform(0,Math.sign(Ke),Math.sign(Xe),0,Ce,et),Y.drawImage(I,S,ee,le,ce,0,0,nt,Se),Y.setTransform(ze,Ke,Xe,Ze,xe,De),[nt,Se]}Y.drawImage(I,S,ee,le,ce,he,Ee,be,Be);const se=Math.hypot(ze,Ke),me=Math.hypot(Xe,Ze);return[se*be,me*Be]}function K(Y){const{width:I,height:S}=Y;if(I>w||S>w)return null;const ee=1e3,le=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),ce=I+1;let he=new Uint8Array(ce*(S+1)),Ee,be,Be;const ze=I+7&-8;let Ke=new Uint8Array(ze*S),Xe=0;for(const me of Y.data){let Te=128;for(;Te>0;)Ke[Xe++]=me&Te?0:255,Te>>=1}let Ze=0;for(Xe=0,Ke[Xe]!==0&&(he[0]=1,++Ze),be=1;be<I;be++)Ke[Xe]!==Ke[Xe+1]&&(he[be]=Ke[Xe]?2:1,++Ze),Xe++;for(Ke[Xe]!==0&&(he[be]=2,++Ze),Ee=1;Ee<S;Ee++){Xe=Ee*ze,Be=Ee*ce,Ke[Xe-ze]!==Ke[Xe]&&(he[Be]=Ke[Xe]?1:8,++Ze);let me=(Ke[Xe]?4:0)+(Ke[Xe-ze]?8:0);for(be=1;be<I;be++)me=(me>>2)+(Ke[Xe+1]?4:0)+(Ke[Xe-ze+1]?8:0),le[me]&&(he[Be+be]=le[me],++Ze),Xe++;if(Ke[Xe-ze]!==Ke[Xe]&&(he[Be+be]=Ke[Xe]?2:4,++Ze),Ze>ee)return null}for(Xe=ze*(S-1),Be=Ee*ce,Ke[Xe]!==0&&(he[Be]=8,++Ze),be=1;be<I;be++)Ke[Xe]!==Ke[Xe+1]&&(he[Be+be]=Ke[Xe]?4:8,++Ze),Xe++;if(Ke[Xe]!==0&&(he[Be+be]=4,++Ze),Ze>ee)return null;const xe=new Int32Array([0,ce,-1,0,-ce,0,0,0,1]),De=new Path2D;for(Ee=0;Ze&&Ee<=S;Ee++){let me=Ee*ce;const Te=me+I;for(;me<Te&&!he[me];)me++;if(me===Te)continue;De.moveTo(me%ce,Ee);const Ce=me;let $e=he[me];do{const et=xe[$e];do me+=et;while(!he[me]);const Qe=he[me];Qe!==5&&Qe!==10?($e=Qe,he[me]=0):($e=Qe&51*$e>>4,he[me]&=$e>>2|$e<<2),De.lineTo(me%ce,me/ce|0),he[me]||--Ze}while(Ce!==me);--Ee}return Ke=null,he=null,function(me){me.save(),me.scale(1/I,-1/S),me.translate(0,-S),me.fill(De),me.beginPath(),me.restore()}}class Z{constructor(I,S){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,I,S])}clone(){const I=Object.create(this);return I.clipBox=this.clipBox.slice(),I}setCurrentPoint(I,S){this.x=I,this.y=S}updatePathMinMax(I,S,ee){[S,ee]=i.Util.applyTransform([S,ee],I),this.minX=Math.min(this.minX,S),this.minY=Math.min(this.minY,ee),this.maxX=Math.max(this.maxX,S),this.maxY=Math.max(this.maxY,ee)}updateRectMinMax(I,S){const ee=i.Util.applyTransform(S,I),le=i.Util.applyTransform(S.slice(2),I);this.minX=Math.min(this.minX,ee[0],le[0]),this.minY=Math.min(this.minY,ee[1],le[1]),this.maxX=Math.max(this.maxX,ee[0],le[0]),this.maxY=Math.max(this.maxY,ee[1],le[1])}updateScalingPathMinMax(I,S){i.Util.scaleMinMax(I,S),this.minX=Math.min(this.minX,S[0]),this.maxX=Math.max(this.maxX,S[1]),this.minY=Math.min(this.minY,S[2]),this.maxY=Math.max(this.maxY,S[3])}updateCurvePathMinMax(I,S,ee,le,ce,he,Ee,be,Be,ze){const Ke=i.Util.bezierBoundingBox(S,ee,le,ce,he,Ee,be,Be);if(ze){ze[0]=Math.min(ze[0],Ke[0],Ke[2]),ze[1]=Math.max(ze[1],Ke[0],Ke[2]),ze[2]=Math.min(ze[2],Ke[1],Ke[3]),ze[3]=Math.max(ze[3],Ke[1],Ke[3]);return}this.updateRectMinMax(I,Ke)}getPathBoundingBox(I=a.PathType.FILL,S=null){const ee=[this.minX,this.minY,this.maxX,this.maxY];if(I===a.PathType.STROKE){S||(0,i.unreachable)("Stroke bounding box must include transform.");const le=i.Util.singularValueDecompose2dScale(S),ce=le[0]*this.lineWidth/2,he=le[1]*this.lineWidth/2;ee[0]-=ce,ee[1]-=he,ee[2]+=ce,ee[3]+=he}return ee}updateClipFromPath(){const I=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(I||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(I){this.clipBox=I,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(I=a.PathType.FILL,S=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(I,S))}}function oe(Y,I){if(typeof ImageData<"u"&&I instanceof ImageData){Y.putImageData(I,0,0);return}const S=I.height,ee=I.width,le=S%V,ce=(S-le)/V,he=le===0?ce:ce+1,Ee=Y.createImageData(ee,V);let be=0,Be;const ze=I.data,Ke=Ee.data;let Xe,Ze,xe,De;if(I.kind===i.ImageKind.GRAYSCALE_1BPP){const se=ze.byteLength,me=new Uint32Array(Ke.buffer,0,Ke.byteLength>>2),Te=me.length,Ce=ee+7>>3,$e=4294967295,et=i.FeatureTest.isLittleEndian?4278190080:255;for(Xe=0;Xe<he;Xe++){for(xe=Xe<ce?V:le,Be=0,Ze=0;Ze<xe;Ze++){const Qe=se-be;let Se=0;const rt=Qe>Ce?ee:Qe*8-7,nt=rt&-8;let mn=0,fn=0;for(;Se<nt;Se+=8)fn=ze[be++],me[Be++]=fn&128?$e:et,me[Be++]=fn&64?$e:et,me[Be++]=fn&32?$e:et,me[Be++]=fn&16?$e:et,me[Be++]=fn&8?$e:et,me[Be++]=fn&4?$e:et,me[Be++]=fn&2?$e:et,me[Be++]=fn&1?$e:et;for(;Se<rt;Se++)mn===0&&(fn=ze[be++],mn=128),me[Be++]=fn&mn?$e:et,mn>>=1}for(;Be<Te;)me[Be++]=0;Y.putImageData(Ee,0,Xe*V)}}else if(I.kind===i.ImageKind.RGBA_32BPP){for(Ze=0,De=ee*V*4,Xe=0;Xe<ce;Xe++)Ke.set(ze.subarray(be,be+De)),be+=De,Y.putImageData(Ee,0,Ze),Ze+=V;Xe<he&&(De=ee*le*4,Ke.set(ze.subarray(be,be+De)),Y.putImageData(Ee,0,Ze))}else if(I.kind===i.ImageKind.RGB_24BPP)for(xe=V,De=ee*xe,Xe=0;Xe<he;Xe++){for(Xe>=ce&&(xe=le,De=ee*xe),Be=0,Ze=De;Ze--;)Ke[Be++]=ze[be++],Ke[Be++]=ze[be++],Ke[Be++]=ze[be++],Ke[Be++]=255;Y.putImageData(Ee,0,Xe*V)}else throw new Error(`bad image kind: ${I.kind}`)}function te(Y,I){if(I.bitmap){Y.drawImage(I.bitmap,0,0);return}const S=I.height,ee=I.width,le=S%V,ce=(S-le)/V,he=le===0?ce:ce+1,Ee=Y.createImageData(ee,V);let be=0;const Be=I.data,ze=Ee.data;for(let Ke=0;Ke<he;Ke++){const Xe=Ke<ce?V:le;({srcPos:be}=(0,u.convertBlackAndWhiteToRGBA)({src:Be,srcPos:be,dest:ze,width:ee,height:Xe,nonBlackColor:0})),Y.putImageData(Ee,0,Ke*V)}}function H(Y,I){const S=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const ee of S)Y[ee]!==void 0&&(I[ee]=Y[ee]);Y.setLineDash!==void 0&&(I.setLineDash(Y.getLineDash()),I.lineDashOffset=Y.lineDashOffset)}function J(Y){if(Y.strokeStyle=Y.fillStyle="#000000",Y.fillRule="nonzero",Y.globalAlpha=1,Y.lineWidth=1,Y.lineCap="butt",Y.lineJoin="miter",Y.miterLimit=10,Y.globalCompositeOperation="source-over",Y.font="10px sans-serif",Y.setLineDash!==void 0&&(Y.setLineDash([]),Y.lineDashOffset=0),!i.isNodeJS){const{filter:I}=Y;I!=="none"&&I!==""&&(Y.filter="none")}}function y(Y,I,S,ee){const le=Y.length;for(let ce=3;ce<le;ce+=4){const he=Y[ce];if(he===0)Y[ce-3]=I,Y[ce-2]=S,Y[ce-1]=ee;else if(he<255){const Ee=255-he;Y[ce-3]=Y[ce-3]*he+I*Ee>>8,Y[ce-2]=Y[ce-2]*he+S*Ee>>8,Y[ce-1]=Y[ce-1]*he+ee*Ee>>8}}}function g(Y,I,S){const ee=Y.length,le=1/255;for(let ce=3;ce<ee;ce+=4){const he=S?S[Y[ce]]:Y[ce];I[ce]=I[ce]*he*le|0}}function E(Y,I,S){const ee=Y.length;for(let le=3;le<ee;le+=4){const ce=Y[le-3]*77+Y[le-2]*152+Y[le-1]*28;I[le]=S?I[le]*S[ce>>8]>>8:I[le]*ce>>16}}function W(Y,I,S,ee,le,ce,he,Ee,be,Be,ze){const Ke=!!ce,Xe=Ke?ce[0]:0,Ze=Ke?ce[1]:0,xe=Ke?ce[2]:0,De=le==="Luminosity"?E:g,me=Math.min(ee,Math.ceil(1048576/S));for(let Te=0;Te<ee;Te+=me){const Ce=Math.min(me,ee-Te),$e=Y.getImageData(Ee-Be,Te+(be-ze),S,Ce),et=I.getImageData(Ee,Te+be,S,Ce);Ke&&y($e.data,Xe,Ze,xe),De($e.data,et.data,he),I.putImageData(et,Ee,Te+be)}}function v(Y,I,S,ee){const le=ee[0],ce=ee[1],he=ee[2]-le,Ee=ee[3]-ce;he===0||Ee===0||(W(I.context,S,he,Ee,I.subtype,I.backdrop,I.transferMap,le,ce,I.offsetX,I.offsetY),Y.save(),Y.globalAlpha=1,Y.globalCompositeOperation="source-over",Y.setTransform(1,0,0,1,0,0),Y.drawImage(S.canvas,0,0),Y.restore())}function D(Y,I){const S=i.Util.singularValueDecompose2dScale(Y);S[0]=Math.fround(S[0]),S[1]=Math.fround(S[1]);const ee=Math.fround((globalThis.devicePixelRatio||1)*o.PixelsPerInch.PDF_TO_CSS_UNITS);return I!==void 0?I:S[0]<=ee||S[1]<=ee}const C=["butt","round","square"],we=["miter","round","bevel"],ve={},Re={},re=class re{constructor(I,S,ee,le,ce,{optionalContentConfig:he,markedContentStack:Ee=null},be,Be){Fe(this,ge);this.ctx=I,this.current=new Z(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=S,this.objs=ee,this.canvasFactory=le,this.filterFactory=ce,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Ee||[],this.optionalContentConfig=he,this.cachedCanvases=new X(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=be,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=Be,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(I,S=null){return typeof I=="string"?I.startsWith("g_")?this.commonObjs.get(I):this.objs.get(I):S}beginDrawing({transform:I,viewport:S,transparency:ee=!1,background:le=null}){const ce=this.ctx.canvas.width,he=this.ctx.canvas.height,Ee=this.ctx.fillStyle;if(this.ctx.fillStyle=le||"#ffffff",this.ctx.fillRect(0,0,ce,he),this.ctx.fillStyle=Ee,ee){const be=this.cachedCanvases.getCanvas("transparent",ce,he);this.compositeCtx=this.ctx,this.transparentCanvas=be.canvas,this.ctx=be.context,this.ctx.save(),this.ctx.transform(...(0,o.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),J(this.ctx),I&&(this.ctx.transform(...I),this.outputScaleX=I[0],this.outputScaleY=I[0]),this.ctx.transform(...S.transform),this.viewportScale=S.scale,this.baseTransform=(0,o.getCurrentTransform)(this.ctx)}executeOperatorList(I,S,ee,le){const ce=I.argsArray,he=I.fnArray;let Ee=S||0;const be=ce.length;if(be===Ee)return Ee;const Be=be-Ee>R&&typeof ee=="function",ze=Be?Date.now()+_:0;let Ke=0;const Xe=this.commonObjs,Ze=this.objs;let xe;for(;;){if(le!==void 0&&Ee===le.nextBreakPoint)return le.breakIt(Ee,ee),Ee;if(xe=he[Ee],xe!==i.OPS.dependency)this[xe].apply(this,ce[Ee]);else for(const De of ce[Ee]){const se=De.startsWith("g_")?Xe:Ze;if(!se.has(De))return se.get(De,ee),Ee}if(Ee++,Ee===be)return Ee;if(Be&&++Ke>R){if(Date.now()>ze)return ee(),Ee;Ke=0}}}endDrawing(){Pe(this,ge,Zu).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const I of this._cachedBitmapsMap.values()){for(const S of I.values())typeof HTMLCanvasElement<"u"&&S instanceof HTMLCanvasElement&&(S.width=S.height=0);I.clear()}this._cachedBitmapsMap.clear(),Pe(this,ge,ec).call(this)}_scaleImage(I,S){const ee=I.width,le=I.height;let ce=Math.max(Math.hypot(S[0],S[1]),1),he=Math.max(Math.hypot(S[2],S[3]),1),Ee=ee,be=le,Be="prescale1",ze,Ke;for(;ce>2&&Ee>1||he>2&&be>1;){let Xe=Ee,Ze=be;ce>2&&Ee>1&&(Xe=Ee>=16384?Math.floor(Ee/2)-1||1:Math.ceil(Ee/2),ce/=Ee/Xe),he>2&&be>1&&(Ze=be>=16384?Math.floor(be/2)-1||1:Math.ceil(be)/2,he/=be/Ze),ze=this.cachedCanvases.getCanvas(Be,Xe,Ze),Ke=ze.context,Ke.clearRect(0,0,Xe,Ze),Ke.drawImage(I,0,0,Ee,be,0,0,Xe,Ze),I=ze.canvas,Ee=Xe,be=Ze,Be=Be==="prescale1"?"prescale2":"prescale1"}return{img:I,paintWidth:Ee,paintHeight:be}}_createMaskCanvas(I){const S=this.ctx,{width:ee,height:le}=I,ce=this.current.fillColor,he=this.current.patternFill,Ee=(0,o.getCurrentTransform)(S);let be,Be,ze,Ke;if((I.bitmap||I.data)&&I.count>1){const Se=I.bitmap||I.data.buffer;Be=JSON.stringify(he?Ee:[Ee.slice(0,4),ce]),be=this._cachedBitmapsMap.get(Se),be||(be=new Map,this._cachedBitmapsMap.set(Se,be));const rt=be.get(Be);if(rt&&!he){const nt=Math.round(Math.min(Ee[0],Ee[2])+Ee[4]),mn=Math.round(Math.min(Ee[1],Ee[3])+Ee[5]);return{canvas:rt,offsetX:nt,offsetY:mn}}ze=rt}ze||(Ke=this.cachedCanvases.getCanvas("maskCanvas",ee,le),te(Ke.context,I));let Xe=i.Util.transform(Ee,[1/ee,0,0,-1/le,0,0]);Xe=i.Util.transform(Xe,[1,0,0,1,0,-le]);const Ze=i.Util.applyTransform([0,0],Xe),xe=i.Util.applyTransform([ee,le],Xe),De=i.Util.normalizeRect([Ze[0],Ze[1],xe[0],xe[1]]),se=Math.round(De[2]-De[0])||1,me=Math.round(De[3]-De[1])||1,Te=this.cachedCanvases.getCanvas("fillCanvas",se,me),Ce=Te.context,$e=Math.min(Ze[0],xe[0]),et=Math.min(Ze[1],xe[1]);Ce.translate(-$e,-et),Ce.transform(...Xe),ze||(ze=this._scaleImage(Ke.canvas,(0,o.getCurrentTransformInverse)(Ce)),ze=ze.img,be&&he&&be.set(Be,ze)),Ce.imageSmoothingEnabled=D((0,o.getCurrentTransform)(Ce),I.interpolate),b(Ce,ze,0,0,ze.width,ze.height,0,0,ee,le),Ce.globalCompositeOperation="source-in";const Qe=i.Util.transform((0,o.getCurrentTransformInverse)(Ce),[1,0,0,1,-$e,-et]);return Ce.fillStyle=he?ce.getPattern(S,this,Qe,a.PathType.FILL):ce,Ce.fillRect(0,0,ee,le),be&&!he&&(this.cachedCanvases.delete("fillCanvas"),be.set(Be,Te.canvas)),{canvas:Te.canvas,offsetX:Math.round($e),offsetY:Math.round(et)}}setLineWidth(I){I!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=I,this.ctx.lineWidth=I}setLineCap(I){this.ctx.lineCap=C[I]}setLineJoin(I){this.ctx.lineJoin=we[I]}setMiterLimit(I){this.ctx.miterLimit=I}setDash(I,S){const ee=this.ctx;ee.setLineDash!==void 0&&(ee.setLineDash(I),ee.lineDashOffset=S)}setRenderingIntent(I){}setFlatness(I){}setGState(I){for(const[S,ee]of I)switch(S){case"LW":this.setLineWidth(ee);break;case"LC":this.setLineCap(ee);break;case"LJ":this.setLineJoin(ee);break;case"ML":this.setMiterLimit(ee);break;case"D":this.setDash(ee[0],ee[1]);break;case"RI":this.setRenderingIntent(ee);break;case"FL":this.setFlatness(ee);break;case"Font":this.setFont(ee[0],ee[1]);break;case"CA":this.current.strokeAlpha=ee;break;case"ca":this.current.fillAlpha=ee,this.ctx.globalAlpha=ee;break;case"BM":this.ctx.globalCompositeOperation=ee;break;case"SMask":this.current.activeSMask=ee?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(ee);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const I=this.inSMaskMode;this.current.activeSMask&&!I?this.beginSMaskMode():!this.current.activeSMask&&I&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const I=this.ctx.canvas.width,S=this.ctx.canvas.height,ee="smaskGroupAt"+this.groupLevel,le=this.cachedCanvases.getCanvas(ee,I,S);this.suspendedCtx=this.ctx,this.ctx=le.context;const ce=this.ctx;ce.setTransform(...(0,o.getCurrentTransform)(this.suspendedCtx)),H(this.suspendedCtx,ce),U(ce,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),H(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(I){if(!this.current.activeSMask)return;I?(I[0]=Math.floor(I[0]),I[1]=Math.floor(I[1]),I[2]=Math.ceil(I[2]),I[3]=Math.ceil(I[3])):I=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const S=this.current.activeSMask,ee=this.suspendedCtx;v(ee,S,this.ctx,I),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(H(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const I=this.current;this.stateStack.push(I),this.current=I.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),H(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(I,S,ee,le,ce,he){this.ctx.transform(I,S,ee,le,ce,he),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(I,S,ee){const le=this.ctx,ce=this.current;let he=ce.x,Ee=ce.y,be,Be;const ze=(0,o.getCurrentTransform)(le),Ke=ze[0]===0&&ze[3]===0||ze[1]===0&&ze[2]===0,Xe=Ke?ee.slice(0):null;for(let Ze=0,xe=0,De=I.length;Ze<De;Ze++)switch(I[Ze]|0){case i.OPS.rectangle:he=S[xe++],Ee=S[xe++];const se=S[xe++],me=S[xe++],Te=he+se,Ce=Ee+me;le.moveTo(he,Ee),se===0||me===0?le.lineTo(Te,Ce):(le.lineTo(Te,Ee),le.lineTo(Te,Ce),le.lineTo(he,Ce)),Ke||ce.updateRectMinMax(ze,[he,Ee,Te,Ce]),le.closePath();break;case i.OPS.moveTo:he=S[xe++],Ee=S[xe++],le.moveTo(he,Ee),Ke||ce.updatePathMinMax(ze,he,Ee);break;case i.OPS.lineTo:he=S[xe++],Ee=S[xe++],le.lineTo(he,Ee),Ke||ce.updatePathMinMax(ze,he,Ee);break;case i.OPS.curveTo:be=he,Be=Ee,he=S[xe+4],Ee=S[xe+5],le.bezierCurveTo(S[xe],S[xe+1],S[xe+2],S[xe+3],he,Ee),ce.updateCurvePathMinMax(ze,be,Be,S[xe],S[xe+1],S[xe+2],S[xe+3],he,Ee,Xe),xe+=6;break;case i.OPS.curveTo2:be=he,Be=Ee,le.bezierCurveTo(he,Ee,S[xe],S[xe+1],S[xe+2],S[xe+3]),ce.updateCurvePathMinMax(ze,be,Be,he,Ee,S[xe],S[xe+1],S[xe+2],S[xe+3],Xe),he=S[xe+2],Ee=S[xe+3],xe+=4;break;case i.OPS.curveTo3:be=he,Be=Ee,he=S[xe+2],Ee=S[xe+3],le.bezierCurveTo(S[xe],S[xe+1],he,Ee,he,Ee),ce.updateCurvePathMinMax(ze,be,Be,S[xe],S[xe+1],he,Ee,he,Ee,Xe),xe+=4;break;case i.OPS.closePath:le.closePath();break}Ke&&ce.updateScalingPathMinMax(ze,Xe),ce.setCurrentPoint(he,Ee)}closePath(){this.ctx.closePath()}stroke(I=!0){const S=this.ctx,ee=this.current.strokeColor;S.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof ee=="object"&&(ee!=null&&ee.getPattern)?(S.save(),S.strokeStyle=ee.getPattern(S,this,(0,o.getCurrentTransformInverse)(S),a.PathType.STROKE),this.rescaleAndStroke(!1),S.restore()):this.rescaleAndStroke(!0)),I&&this.consumePath(this.current.getClippedPathBoundingBox()),S.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(I=!0){const S=this.ctx,ee=this.current.fillColor,le=this.current.patternFill;let ce=!1;le&&(S.save(),S.fillStyle=ee.getPattern(S,this,(0,o.getCurrentTransformInverse)(S),a.PathType.FILL),ce=!0);const he=this.current.getClippedPathBoundingBox();this.contentVisible&&he!==null&&(this.pendingEOFill?(S.fill("evenodd"),this.pendingEOFill=!1):S.fill()),ce&&S.restore(),I&&this.consumePath(he)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=ve}eoClip(){this.pendingClip=Re}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const I=this.pendingTextPaths,S=this.ctx;if(I===void 0){S.beginPath();return}S.save(),S.beginPath();for(const ee of I)S.setTransform(...ee.transform),S.translate(ee.x,ee.y),ee.addToPath(S,ee.fontSize);S.restore(),S.clip(),S.beginPath(),delete this.pendingTextPaths}setCharSpacing(I){this.current.charSpacing=I}setWordSpacing(I){this.current.wordSpacing=I}setHScale(I){this.current.textHScale=I/100}setLeading(I){this.current.leading=-I}setFont(I,S){var ze;const ee=this.commonObjs.get(I),le=this.current;if(!ee)throw new Error(`Can't find font for ${I}`);if(le.fontMatrix=ee.fontMatrix||i.FONT_IDENTITY_MATRIX,(le.fontMatrix[0]===0||le.fontMatrix[3]===0)&&(0,i.warn)("Invalid font matrix for font "+I),S<0?(S=-S,le.fontDirection=-1):le.fontDirection=1,this.current.font=ee,this.current.fontSize=S,ee.isType3Font)return;const ce=ee.loadedName||"sans-serif",he=((ze=ee.systemFontInfo)==null?void 0:ze.css)||`"${ce}", ${ee.fallbackName}`;let Ee="normal";ee.black?Ee="900":ee.bold&&(Ee="bold");const be=ee.italic?"italic":"normal";let Be=S;S<f?Be=f:S>d&&(Be=d),this.current.fontSizeScale=S/Be,this.ctx.font=`${be} ${Ee} ${Be}px ${he}`}setTextRenderingMode(I){this.current.textRenderingMode=I}setTextRise(I){this.current.textRise=I}moveText(I,S){this.current.x=this.current.lineX+=I,this.current.y=this.current.lineY+=S}setLeadingMoveText(I,S){this.setLeading(-S),this.moveText(I,S)}setTextMatrix(I,S,ee,le,ce,he){this.current.textMatrix=[I,S,ee,le,ce,he],this.current.textMatrixScale=Math.hypot(I,S),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(I,S,ee,le){const ce=this.ctx,he=this.current,Ee=he.font,be=he.textRenderingMode,Be=he.fontSize/he.fontSizeScale,ze=be&i.TextRenderingMode.FILL_STROKE_MASK,Ke=!!(be&i.TextRenderingMode.ADD_TO_PATH_FLAG),Xe=he.patternFill&&!Ee.missingFile;let Ze;(Ee.disableFontFace||Ke||Xe)&&(Ze=Ee.getPathGenerator(this.commonObjs,I)),Ee.disableFontFace||Xe?(ce.save(),ce.translate(S,ee),ce.beginPath(),Ze(ce,Be),le&&ce.setTransform(...le),(ze===i.TextRenderingMode.FILL||ze===i.TextRenderingMode.FILL_STROKE)&&ce.fill(),(ze===i.TextRenderingMode.STROKE||ze===i.TextRenderingMode.FILL_STROKE)&&ce.stroke(),ce.restore()):((ze===i.TextRenderingMode.FILL||ze===i.TextRenderingMode.FILL_STROKE)&&ce.fillText(I,S,ee),(ze===i.TextRenderingMode.STROKE||ze===i.TextRenderingMode.FILL_STROKE)&&ce.strokeText(I,S,ee)),Ke&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,o.getCurrentTransform)(ce),x:S,y:ee,fontSize:Be,addToPath:Ze})}get isFontSubpixelAAEnabled(){const{context:I}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);I.scale(1.5,1),I.fillText("I",0,10);const S=I.getImageData(0,0,10,10).data;let ee=!1;for(let le=3;le<S.length;le+=4)if(S[le]>0&&S[le]<255){ee=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",ee)}showText(I){const S=this.current,ee=S.font;if(ee.isType3Font)return this.showType3Text(I);const le=S.fontSize;if(le===0)return;const ce=this.ctx,he=S.fontSizeScale,Ee=S.charSpacing,be=S.wordSpacing,Be=S.fontDirection,ze=S.textHScale*Be,Ke=I.length,Xe=ee.vertical,Ze=Xe?1:-1,xe=ee.defaultVMetrics,De=le*S.fontMatrix[0],se=S.textRenderingMode===i.TextRenderingMode.FILL&&!ee.disableFontFace&&!S.patternFill;ce.save(),ce.transform(...S.textMatrix),ce.translate(S.x,S.y+S.textRise),Be>0?ce.scale(ze,-1):ce.scale(ze,1);let me;if(S.patternFill){ce.save();const Qe=S.fillColor.getPattern(ce,this,(0,o.getCurrentTransformInverse)(ce),a.PathType.FILL);me=(0,o.getCurrentTransform)(ce),ce.restore(),ce.fillStyle=Qe}let Te=S.lineWidth;const Ce=S.textMatrixScale;if(Ce===0||Te===0){const Qe=S.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;(Qe===i.TextRenderingMode.STROKE||Qe===i.TextRenderingMode.FILL_STROKE)&&(Te=this.getSinglePixelWidth())}else Te/=Ce;if(he!==1&&(ce.scale(he,he),Te/=he),ce.lineWidth=Te,ee.isInvalidPDFjsFont){const Qe=[];let Se=0;for(const rt of I)Qe.push(rt.unicode),Se+=rt.width;ce.fillText(Qe.join(""),0,0),S.x+=Se*De*ze,ce.restore(),this.compose();return}let $e=0,et;for(et=0;et<Ke;++et){const Qe=I[et];if(typeof Qe=="number"){$e+=Ze*Qe*le/1e3;continue}let Se=!1;const rt=(Qe.isSpace?be:0)+Ee,nt=Qe.fontChar,mn=Qe.accent;let fn,Rn,Ut=Qe.width;if(Xe){const bn=Qe.vmetric||xe,kn=-(Qe.vmetric?bn[1]:Ut*.5)*De,Ye=bn[2]*De;Ut=bn?-bn[0]:Ut,fn=kn/he,Rn=($e+Ye)/he}else fn=$e/he,Rn=0;if(ee.remeasure&&Ut>0){const bn=ce.measureText(nt).width*1e3/le*he;if(Ut<bn&&this.isFontSubpixelAAEnabled){const kn=Ut/bn;Se=!0,ce.save(),ce.scale(kn,1),fn/=kn}else Ut!==bn&&(fn+=(Ut-bn)/2e3*le/he)}if(this.contentVisible&&(Qe.isInFont||ee.missingFile)){if(se&&!mn)ce.fillText(nt,fn,Rn);else if(this.paintChar(nt,fn,Rn,me),mn){const bn=fn+le*mn.offset.x/he,kn=Rn-le*mn.offset.y/he;this.paintChar(mn.fontChar,bn,kn,me)}}const hn=Xe?Ut*De-rt*Be:Ut*De+rt*Be;$e+=hn,Se&&ce.restore()}Xe?S.y-=$e:S.x+=$e*ze,ce.restore(),this.compose()}showType3Text(I){const S=this.ctx,ee=this.current,le=ee.font,ce=ee.fontSize,he=ee.fontDirection,Ee=le.vertical?1:-1,be=ee.charSpacing,Be=ee.wordSpacing,ze=ee.textHScale*he,Ke=ee.fontMatrix||i.FONT_IDENTITY_MATRIX,Xe=I.length,Ze=ee.textRenderingMode===i.TextRenderingMode.INVISIBLE;let xe,De,se,me;if(!(Ze||ce===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,S.save(),S.transform(...ee.textMatrix),S.translate(ee.x,ee.y),S.scale(ze,he),xe=0;xe<Xe;++xe){if(De=I[xe],typeof De=="number"){me=Ee*De*ce/1e3,this.ctx.translate(me,0),ee.x+=me*ze;continue}const Te=(De.isSpace?Be:0)+be,Ce=le.charProcOperatorList[De.operatorListId];if(!Ce){(0,i.warn)(`Type3 character "${De.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=De,this.save(),S.scale(ce,ce),S.transform(...Ke),this.executeOperatorList(Ce),this.restore()),se=i.Util.applyTransform([De.width,0],Ke)[0]*ce+Te,S.translate(se,0),ee.x+=se*ze}S.restore(),this.processingType3=null}}setCharWidth(I,S){}setCharWidthAndBounds(I,S,ee,le,ce,he){this.ctx.rect(ee,le,ce-ee,he-le),this.ctx.clip(),this.endPath()}getColorN_Pattern(I){let S;if(I[0]==="TilingPattern"){const ee=I[1],le=this.baseTransform||(0,o.getCurrentTransform)(this.ctx),ce={createCanvasGraphics:he=>new re(he,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};S=new a.TilingPattern(I,ee,this.ctx,ce,le)}else S=this._getPattern(I[1],I[2]);return S}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(I,S,ee){const le=i.Util.makeHexColor(I,S,ee);this.ctx.strokeStyle=le,this.current.strokeColor=le}setFillRGBColor(I,S,ee){const le=i.Util.makeHexColor(I,S,ee);this.ctx.fillStyle=le,this.current.fillColor=le,this.current.patternFill=!1}_getPattern(I,S=null){let ee;return this.cachedPatterns.has(I)?ee=this.cachedPatterns.get(I):(ee=(0,a.getShadingPattern)(this.getObject(I)),this.cachedPatterns.set(I,ee)),S&&(ee.matrix=S),ee}shadingFill(I){if(!this.contentVisible)return;const S=this.ctx;this.save();const ee=this._getPattern(I);S.fillStyle=ee.getPattern(S,this,(0,o.getCurrentTransformInverse)(S),a.PathType.SHADING);const le=(0,o.getCurrentTransformInverse)(S);if(le){const{width:ce,height:he}=S.canvas,[Ee,be,Be,ze]=i.Util.getAxialAlignedBoundingBox([0,0,ce,he],le);this.ctx.fillRect(Ee,be,Be-Ee,ze-be)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(I,S){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(I)&&I.length===6&&this.transform(...I),this.baseTransform=(0,o.getCurrentTransform)(this.ctx),S)){const ee=S[2]-S[0],le=S[3]-S[1];this.ctx.rect(S[0],S[1],ee,le),this.current.updateRectMinMax((0,o.getCurrentTransform)(this.ctx),S),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(I){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const S=this.ctx;I.isolated||(0,i.info)("TODO: Support non-isolated groups."),I.knockout&&(0,i.warn)("Knockout groups not supported.");const ee=(0,o.getCurrentTransform)(S);if(I.matrix&&S.transform(...I.matrix),!I.bbox)throw new Error("Bounding box is required.");let le=i.Util.getAxialAlignedBoundingBox(I.bbox,(0,o.getCurrentTransform)(S));const ce=[0,0,S.canvas.width,S.canvas.height];le=i.Util.intersect(le,ce)||[0,0,0,0];const he=Math.floor(le[0]),Ee=Math.floor(le[1]);let be=Math.max(Math.ceil(le[2])-he,1),Be=Math.max(Math.ceil(le[3])-Ee,1),ze=1,Ke=1;be>p&&(ze=be/p,be=p),Be>p&&(Ke=Be/p,Be=p),this.current.startNewPathAndClipBox([0,0,be,Be]);let Xe="groupAt"+this.groupLevel;I.smask&&(Xe+="_smask_"+this.smaskCounter++%2);const Ze=this.cachedCanvases.getCanvas(Xe,be,Be),xe=Ze.context;xe.scale(1/ze,1/Ke),xe.translate(-he,-Ee),xe.transform(...ee),I.smask?this.smaskStack.push({canvas:Ze.canvas,context:xe,offsetX:he,offsetY:Ee,scaleX:ze,scaleY:Ke,subtype:I.smask.subtype,backdrop:I.smask.backdrop,transferMap:I.smask.transferMap||null,startTransformInverse:null}):(S.setTransform(1,0,0,1,0,0),S.translate(he,Ee),S.scale(ze,Ke),S.save()),H(S,xe),this.ctx=xe,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(S),this.groupLevel++}endGroup(I){if(!this.contentVisible)return;this.groupLevel--;const S=this.ctx,ee=this.groupStack.pop();if(this.ctx=ee,this.ctx.imageSmoothingEnabled=!1,I.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const le=(0,o.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...le);const ce=i.Util.getAxialAlignedBoundingBox([0,0,S.canvas.width,S.canvas.height],le);this.ctx.drawImage(S.canvas,0,0),this.ctx.restore(),this.compose(ce)}}beginAnnotation(I,S,ee,le,ce){if(Pe(this,ge,Zu).call(this),J(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(S)&&S.length===4){const he=S[2]-S[0],Ee=S[3]-S[1];if(ce&&this.annotationCanvasMap){ee=ee.slice(),ee[4]-=S[0],ee[5]-=S[1],S=S.slice(),S[0]=S[1]=0,S[2]=he,S[3]=Ee;const[be,Be]=i.Util.singularValueDecompose2dScale((0,o.getCurrentTransform)(this.ctx)),{viewportScale:ze}=this,Ke=Math.ceil(he*this.outputScaleX*ze),Xe=Math.ceil(Ee*this.outputScaleY*ze);this.annotationCanvas=this.canvasFactory.create(Ke,Xe);const{canvas:Ze,context:xe}=this.annotationCanvas;this.annotationCanvasMap.set(I,Ze),this.annotationCanvas.savedCtx=this.ctx,this.ctx=xe,this.ctx.save(),this.ctx.setTransform(be,0,0,-Be,0,Ee*Be),J(this.ctx)}else J(this.ctx),this.ctx.rect(S[0],S[1],he,Ee),this.ctx.clip(),this.endPath()}this.current=new Z(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...ee),this.transform(...le)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Pe(this,ge,ec).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(I){if(!this.contentVisible)return;const S=I.count;I=this.getObject(I.data,I),I.count=S;const ee=this.ctx,le=this.processingType3;if(le&&(le.compiled===void 0&&(le.compiled=K(I)),le.compiled)){le.compiled(ee);return}const ce=this._createMaskCanvas(I),he=ce.canvas;ee.save(),ee.setTransform(1,0,0,1,0,0),ee.drawImage(he,ce.offsetX,ce.offsetY),ee.restore(),this.compose()}paintImageMaskXObjectRepeat(I,S,ee=0,le=0,ce,he){if(!this.contentVisible)return;I=this.getObject(I.data,I);const Ee=this.ctx;Ee.save();const be=(0,o.getCurrentTransform)(Ee);Ee.transform(S,ee,le,ce,0,0);const Be=this._createMaskCanvas(I);Ee.setTransform(1,0,0,1,Be.offsetX-be[4],Be.offsetY-be[5]);for(let ze=0,Ke=he.length;ze<Ke;ze+=2){const Xe=i.Util.transform(be,[S,ee,le,ce,he[ze],he[ze+1]]),[Ze,xe]=i.Util.applyTransform([0,0],Xe);Ee.drawImage(Be.canvas,Ze,xe)}Ee.restore(),this.compose()}paintImageMaskXObjectGroup(I){if(!this.contentVisible)return;const S=this.ctx,ee=this.current.fillColor,le=this.current.patternFill;for(const ce of I){const{data:he,width:Ee,height:be,transform:Be}=ce,ze=this.cachedCanvases.getCanvas("maskCanvas",Ee,be),Ke=ze.context;Ke.save();const Xe=this.getObject(he,ce);te(Ke,Xe),Ke.globalCompositeOperation="source-in",Ke.fillStyle=le?ee.getPattern(Ke,this,(0,o.getCurrentTransformInverse)(S),a.PathType.FILL):ee,Ke.fillRect(0,0,Ee,be),Ke.restore(),S.save(),S.transform(...Be),S.scale(1,-1),b(S,ze.canvas,0,0,Ee,be,0,-1,1,1),S.restore()}this.compose()}paintImageXObject(I){if(!this.contentVisible)return;const S=this.getObject(I);if(!S){(0,i.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(S)}paintImageXObjectRepeat(I,S,ee,le){if(!this.contentVisible)return;const ce=this.getObject(I);if(!ce){(0,i.warn)("Dependent image isn't ready yet");return}const he=ce.width,Ee=ce.height,be=[];for(let Be=0,ze=le.length;Be<ze;Be+=2)be.push({transform:[S,0,0,ee,le[Be],le[Be+1]],x:0,y:0,w:he,h:Ee});this.paintInlineImageXObjectGroup(ce,be)}applyTransferMapsToCanvas(I){return this.current.transferMaps!=="none"&&(I.filter=this.current.transferMaps,I.drawImage(I.canvas,0,0),I.filter="none"),I.canvas}applyTransferMapsToBitmap(I){if(this.current.transferMaps==="none")return I.bitmap;const{bitmap:S,width:ee,height:le}=I,ce=this.cachedCanvases.getCanvas("inlineImage",ee,le),he=ce.context;return he.filter=this.current.transferMaps,he.drawImage(S,0,0),he.filter="none",ce.canvas}paintInlineImageXObject(I){if(!this.contentVisible)return;const S=I.width,ee=I.height,le=this.ctx;if(this.save(),!i.isNodeJS){const{filter:Ee}=le;Ee!=="none"&&Ee!==""&&(le.filter="none")}le.scale(1/S,-1/ee);let ce;if(I.bitmap)ce=this.applyTransferMapsToBitmap(I);else if(typeof HTMLElement=="function"&&I instanceof HTMLElement||!I.data)ce=I;else{const be=this.cachedCanvases.getCanvas("inlineImage",S,ee).context;oe(be,I),ce=this.applyTransferMapsToCanvas(be)}const he=this._scaleImage(ce,(0,o.getCurrentTransformInverse)(le));le.imageSmoothingEnabled=D((0,o.getCurrentTransform)(le),I.interpolate),b(le,he.img,0,0,he.paintWidth,he.paintHeight,0,-ee,S,ee),this.compose(),this.restore()}paintInlineImageXObjectGroup(I,S){if(!this.contentVisible)return;const ee=this.ctx;let le;if(I.bitmap)le=I.bitmap;else{const ce=I.width,he=I.height,be=this.cachedCanvases.getCanvas("inlineImage",ce,he).context;oe(be,I),le=this.applyTransferMapsToCanvas(be)}for(const ce of S)ee.save(),ee.transform(...ce.transform),ee.scale(1,-1),b(ee,le,ce.x,ce.y,ce.w,ce.h,0,-1,1,1),ee.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(I){}markPointProps(I,S){}beginMarkedContent(I){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(I,S){I==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(S)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(I){const S=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(I);const ee=this.ctx;this.pendingClip&&(S||(this.pendingClip===Re?ee.clip("evenodd"):ee.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),ee.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const I=(0,o.getCurrentTransform)(this.ctx);if(I[1]===0&&I[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(I[0]),Math.abs(I[3]));else{const S=Math.abs(I[0]*I[3]-I[2]*I[1]),ee=Math.hypot(I[0],I[2]),le=Math.hypot(I[1],I[3]);this._cachedGetSinglePixelWidth=Math.max(ee,le)/S}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:I}=this.current,{a:S,b:ee,c:le,d:ce}=this.ctx.getTransform();let he,Ee;if(ee===0&&le===0){const be=Math.abs(S),Be=Math.abs(ce);if(be===Be)if(I===0)he=Ee=1/be;else{const ze=be*I;he=Ee=ze<1?1/ze:1}else if(I===0)he=1/be,Ee=1/Be;else{const ze=be*I,Ke=Be*I;he=ze<1?1/ze:1,Ee=Ke<1?1/Ke:1}}else{const be=Math.abs(S*ce-ee*le),Be=Math.hypot(S,ee),ze=Math.hypot(le,ce);if(I===0)he=ze/be,Ee=Be/be;else{const Ke=I*be;he=ze>Ke?ze/Ke:1,Ee=Be>Ke?Be/Ke:1}}this._cachedScaleForStroking[0]=he,this._cachedScaleForStroking[1]=Ee}return this._cachedScaleForStroking}rescaleAndStroke(I){const{ctx:S}=this,{lineWidth:ee}=this.current,[le,ce]=this.getScaleForStroking();if(S.lineWidth=ee||1,le===1&&ce===1){S.stroke();return}const he=S.getLineDash();if(I&&S.save(),S.scale(le,ce),he.length>0){const Ee=Math.max(le,ce);S.setLineDash(he.map(be=>be/Ee)),S.lineDashOffset/=Ee}S.stroke(),I&&S.restore()}isContentVisible(){for(let I=this.markedContentStack.length-1;I>=0;I--)if(!this.markedContentStack[I].visible)return!1;return!0}};ge=new WeakSet,Zu=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ec=function(){if(this.pageColors){const I=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(I!=="none"){const S=this.ctx.filter;this.ctx.filter=I,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=S}}};let _e=re;e.CanvasGraphics=_e;for(const Y in i.OPS)_e.prototype[Y]!==void 0&&(_e.prototype[i.OPS[Y]]=_e.prototype[Y])},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=V;var i=t(1),o=t(6);const a={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=a;function u(K,Z){if(!Z)return;const oe=Z[2]-Z[0],te=Z[3]-Z[1],H=new Path2D;H.rect(Z[0],Z[1],oe,te),K.clip(H)}class f{constructor(){this.constructor===f&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class d extends f{constructor(Z){super(),this._type=Z[1],this._bbox=Z[2],this._colorStops=Z[3],this._p0=Z[4],this._p1=Z[5],this._r0=Z[6],this._r1=Z[7],this.matrix=null}_createGradient(Z){let oe;this._type==="axial"?oe=Z.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(oe=Z.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const te of this._colorStops)oe.addColorStop(te[0],te[1]);return oe}getPattern(Z,oe,te,H){let J;if(H===a.STROKE||H===a.FILL){const y=oe.current.getClippedPathBoundingBox(H,(0,o.getCurrentTransform)(Z))||[0,0,0,0],g=Math.ceil(y[2]-y[0])||1,E=Math.ceil(y[3]-y[1])||1,W=oe.cachedCanvases.getCanvas("pattern",g,E,!0),v=W.context;v.clearRect(0,0,v.canvas.width,v.canvas.height),v.beginPath(),v.rect(0,0,v.canvas.width,v.canvas.height),v.translate(-y[0],-y[1]),te=i.Util.transform(te,[1,0,0,1,y[0],y[1]]),v.transform(...oe.baseTransform),this.matrix&&v.transform(...this.matrix),u(v,this._bbox),v.fillStyle=this._createGradient(v),v.fill(),J=Z.createPattern(W.canvas,"no-repeat");const D=new DOMMatrix(te);J.setTransform(D)}else u(Z,this._bbox),J=this._createGradient(Z);return J}}function p(K,Z,oe,te,H,J,y,g){const E=Z.coords,W=Z.colors,v=K.data,D=K.width*4;let C;E[oe+1]>E[te+1]&&(C=oe,oe=te,te=C,C=J,J=y,y=C),E[te+1]>E[H+1]&&(C=te,te=H,H=C,C=y,y=g,g=C),E[oe+1]>E[te+1]&&(C=oe,oe=te,te=C,C=J,J=y,y=C);const we=(E[oe]+Z.offsetX)*Z.scaleX,ve=(E[oe+1]+Z.offsetY)*Z.scaleY,Re=(E[te]+Z.offsetX)*Z.scaleX,_e=(E[te+1]+Z.offsetY)*Z.scaleY,ge=(E[H]+Z.offsetX)*Z.scaleX,ie=(E[H+1]+Z.offsetY)*Z.scaleY;if(ve>=ie)return;const fe=W[J],re=W[J+1],Y=W[J+2],I=W[y],S=W[y+1],ee=W[y+2],le=W[g],ce=W[g+1],he=W[g+2],Ee=Math.round(ve),be=Math.round(ie);let Be,ze,Ke,Xe,Ze,xe,De,se;for(let me=Ee;me<=be;me++){if(me<_e){const Qe=me<ve?0:(ve-me)/(ve-_e);Be=we-(we-Re)*Qe,ze=fe-(fe-I)*Qe,Ke=re-(re-S)*Qe,Xe=Y-(Y-ee)*Qe}else{let Qe;me>ie?Qe=1:_e===ie?Qe=0:Qe=(_e-me)/(_e-ie),Be=Re-(Re-ge)*Qe,ze=I-(I-le)*Qe,Ke=S-(S-ce)*Qe,Xe=ee-(ee-he)*Qe}let Te;me<ve?Te=0:me>ie?Te=1:Te=(ve-me)/(ve-ie),Ze=we-(we-ge)*Te,xe=fe-(fe-le)*Te,De=re-(re-ce)*Te,se=Y-(Y-he)*Te;const Ce=Math.round(Math.min(Be,Ze)),$e=Math.round(Math.max(Be,Ze));let et=D*me+Ce*4;for(let Qe=Ce;Qe<=$e;Qe++)Te=(Be-Qe)/(Be-Ze),Te<0?Te=0:Te>1&&(Te=1),v[et++]=ze-(ze-xe)*Te|0,v[et++]=Ke-(Ke-De)*Te|0,v[et++]=Xe-(Xe-se)*Te|0,v[et++]=255}}function _(K,Z,oe){const te=Z.coords,H=Z.colors;let J,y;switch(Z.type){case"lattice":const g=Z.verticesPerRow,E=Math.floor(te.length/g)-1,W=g-1;for(J=0;J<E;J++){let v=J*g;for(let D=0;D<W;D++,v++)p(K,oe,te[v],te[v+1],te[v+g],H[v],H[v+1],H[v+g]),p(K,oe,te[v+g+1],te[v+1],te[v+g],H[v+g+1],H[v+1],H[v+g])}break;case"triangles":for(J=0,y=te.length;J<y;J+=3)p(K,oe,te[J],te[J+1],te[J+2],H[J],H[J+1],H[J+2]);break;default:throw new Error("illegal figure")}}class R extends f{constructor(Z){super(),this._coords=Z[2],this._colors=Z[3],this._figures=Z[4],this._bounds=Z[5],this._bbox=Z[7],this._background=Z[8],this.matrix=null}_createMeshCanvas(Z,oe,te){const g=Math.floor(this._bounds[0]),E=Math.floor(this._bounds[1]),W=Math.ceil(this._bounds[2])-g,v=Math.ceil(this._bounds[3])-E,D=Math.min(Math.ceil(Math.abs(W*Z[0]*1.1)),3e3),C=Math.min(Math.ceil(Math.abs(v*Z[1]*1.1)),3e3),we=W/D,ve=v/C,Re={coords:this._coords,colors:this._colors,offsetX:-g,offsetY:-E,scaleX:1/we,scaleY:1/ve},_e=D+2*2,ge=C+2*2,ie=te.getCanvas("mesh",_e,ge,!1),fe=ie.context,re=fe.createImageData(D,C);if(oe){const I=re.data;for(let S=0,ee=I.length;S<ee;S+=4)I[S]=oe[0],I[S+1]=oe[1],I[S+2]=oe[2],I[S+3]=255}for(const I of this._figures)_(re,I,Re);return fe.putImageData(re,2,2),{canvas:ie.canvas,offsetX:g-2*we,offsetY:E-2*ve,scaleX:we,scaleY:ve}}getPattern(Z,oe,te,H){u(Z,this._bbox);let J;if(H===a.SHADING)J=i.Util.singularValueDecompose2dScale((0,o.getCurrentTransform)(Z));else if(J=i.Util.singularValueDecompose2dScale(oe.baseTransform),this.matrix){const g=i.Util.singularValueDecompose2dScale(this.matrix);J=[J[0]*g[0],J[1]*g[1]]}const y=this._createMeshCanvas(J,H===a.SHADING?null:this._background,oe.cachedCanvases);return H!==a.SHADING&&(Z.setTransform(...oe.baseTransform),this.matrix&&Z.transform(...this.matrix)),Z.translate(y.offsetX,y.offsetY),Z.scale(y.scaleX,y.scaleY),Z.createPattern(y.canvas,"no-repeat")}}class w extends f{getPattern(){return"hotpink"}}function V(K){switch(K[0]){case"RadialAxial":return new d(K);case"Mesh":return new R(K);case"Dummy":return new w}throw new Error(`Unknown IR type: ${K[0]}`)}const U={COLORED:1,UNCOLORED:2},b=class b{constructor(Z,oe,te,H,J){this.operatorList=Z[2],this.matrix=Z[3]||[1,0,0,1,0,0],this.bbox=Z[4],this.xstep=Z[5],this.ystep=Z[6],this.paintType=Z[7],this.tilingType=Z[8],this.color=oe,this.ctx=te,this.canvasGraphicsFactory=H,this.baseTransform=J}createPatternCanvas(Z){const oe=this.operatorList,te=this.bbox,H=this.xstep,J=this.ystep,y=this.paintType,g=this.tilingType,E=this.color,W=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+g);const v=te[0],D=te[1],C=te[2],we=te[3],ve=i.Util.singularValueDecompose2dScale(this.matrix),Re=i.Util.singularValueDecompose2dScale(this.baseTransform),_e=[ve[0]*Re[0],ve[1]*Re[1]],ge=this.getSizeAndScale(H,this.ctx.canvas.width,_e[0]),ie=this.getSizeAndScale(J,this.ctx.canvas.height,_e[1]),fe=Z.cachedCanvases.getCanvas("pattern",ge.size,ie.size,!0),re=fe.context,Y=W.createCanvasGraphics(re);Y.groupLevel=Z.groupLevel,this.setFillAndStrokeStyleToContext(Y,y,E);let I=v,S=D,ee=C,le=we;return v<0&&(I=0,ee+=Math.abs(v)),D<0&&(S=0,le+=Math.abs(D)),re.translate(-(ge.scale*I),-(ie.scale*S)),Y.transform(ge.scale,0,0,ie.scale,0,0),re.save(),this.clipBbox(Y,I,S,ee,le),Y.baseTransform=(0,o.getCurrentTransform)(Y.ctx),Y.executeOperatorList(oe),Y.endDrawing(),{canvas:fe.canvas,scaleX:ge.scale,scaleY:ie.scale,offsetX:I,offsetY:S}}getSizeAndScale(Z,oe,te){Z=Math.abs(Z);const H=Math.max(b.MAX_PATTERN_SIZE,oe);let J=Math.ceil(Z*te);return J>=H?J=H:te=J/Z,{scale:te,size:J}}clipBbox(Z,oe,te,H,J){const y=H-oe,g=J-te;Z.ctx.rect(oe,te,y,g),Z.current.updateRectMinMax((0,o.getCurrentTransform)(Z.ctx),[oe,te,H,J]),Z.clip(),Z.endPath()}setFillAndStrokeStyleToContext(Z,oe,te){const H=Z.ctx,J=Z.current;switch(oe){case U.COLORED:const y=this.ctx;H.fillStyle=y.fillStyle,H.strokeStyle=y.strokeStyle,J.fillColor=y.fillStyle,J.strokeColor=y.strokeStyle;break;case U.UNCOLORED:const g=i.Util.makeHexColor(te[0],te[1],te[2]);H.fillStyle=g,H.strokeStyle=g,J.fillColor=g,J.strokeColor=g;break;default:throw new i.FormatError(`Unsupported paint type: ${oe}`)}}getPattern(Z,oe,te,H){let J=te;H!==a.SHADING&&(J=i.Util.transform(J,oe.baseTransform),this.matrix&&(J=i.Util.transform(J,this.matrix)));const y=this.createPatternCanvas(oe);let g=new DOMMatrix(J);g=g.translate(y.offsetX,y.offsetY),g=g.scale(1/y.scaleX,1/y.scaleY);const E=Z.createPattern(y.canvas,"repeat");return E.setTransform(g),E}};Un(b,"MAX_PATTERN_SIZE",3e3);let X=b;e.TilingPattern=X},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=a,e.convertToRGBA=o,e.grayToRGBA=f;var i=t(1);function o(d){switch(d.kind){case i.ImageKind.GRAYSCALE_1BPP:return a(d);case i.ImageKind.RGB_24BPP:return u(d)}return null}function a({src:d,srcPos:p=0,dest:_,width:R,height:w,nonBlackColor:V=4294967295,inverseDecode:U=!1}){const X=i.FeatureTest.isLittleEndian?4278190080:255,[b,K]=U?[V,X]:[X,V],Z=R>>3,oe=R&7,te=d.length;_=new Uint32Array(_.buffer);let H=0;for(let J=0;J<w;J++){for(const g=p+Z;p<g;p++){const E=p<te?d[p]:255;_[H++]=E&128?K:b,_[H++]=E&64?K:b,_[H++]=E&32?K:b,_[H++]=E&16?K:b,_[H++]=E&8?K:b,_[H++]=E&4?K:b,_[H++]=E&2?K:b,_[H++]=E&1?K:b}if(oe===0)continue;const y=p<te?d[p++]:255;for(let g=0;g<oe;g++)_[H++]=y&1<<7-g?K:b}return{srcPos:p,destPos:H}}function u({src:d,srcPos:p=0,dest:_,destPos:R=0,width:w,height:V}){let U=0;const X=d.length>>2,b=new Uint32Array(d.buffer,p,X);if(i.FeatureTest.isLittleEndian){for(;U<X-2;U+=3,R+=4){const K=b[U],Z=b[U+1],oe=b[U+2];_[R]=K|4278190080,_[R+1]=K>>>24|Z<<8|4278190080,_[R+2]=Z>>>16|oe<<16|4278190080,_[R+3]=oe>>>8|4278190080}for(let K=U*4,Z=d.length;K<Z;K+=3)_[R++]=d[K]|d[K+1]<<8|d[K+2]<<16|4278190080}else{for(;U<X-2;U+=3,R+=4){const K=b[U],Z=b[U+1],oe=b[U+2];_[R]=K|255,_[R+1]=K<<24|Z>>>8|255,_[R+2]=Z<<16|oe>>>16|255,_[R+3]=oe<<8|255}for(let K=U*4,Z=d.length;K<Z;K+=3)_[R++]=d[K]<<24|d[K+1]<<16|d[K+2]<<8|255}return{srcPos:p,destPos:R}}function f(d,p){if(i.FeatureTest.isLittleEndian)for(let _=0,R=d.length;_<R;_++)p[_]=d[_]*65793|4278190080;else for(let _=0,R=d.length;_<R;_++)p[_]=d[_]*16843008|255}},(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const t=Object.create(null);e.GlobalWorkerOptions=t,t.workerPort=null,t.workerSrc=""},(n,e,t)=>{var d,Nd,Fd,il;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var i=t(1);const o={DATA:1,ERROR:2},a={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function u(w){switch(w instanceof Error||typeof w=="object"&&w!==null||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),w.name){case"AbortException":return new i.AbortException(w.message);case"MissingPDFException":return new i.MissingPDFException(w.message);case"PasswordException":return new i.PasswordException(w.message,w.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(w.message,w.status);case"UnknownErrorException":return new i.UnknownErrorException(w.message,w.details);default:return new i.UnknownErrorException(w.message,w.toString())}}class f{constructor(V,U,X){Fe(this,d);this.sourceName=V,this.targetName=U,this.comObj=X,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=b=>{const K=b.data;if(K.targetName!==this.sourceName)return;if(K.stream){Pe(this,d,Fd).call(this,K);return}if(K.callback){const oe=K.callbackId,te=this.callbackCapabilities[oe];if(!te)throw new Error(`Cannot resolve callback ${oe}`);if(delete this.callbackCapabilities[oe],K.callback===o.DATA)te.resolve(K.data);else if(K.callback===o.ERROR)te.reject(u(K.reason));else throw new Error("Unexpected callback case");return}const Z=this.actionHandler[K.action];if(!Z)throw new Error(`Unknown action from worker: ${K.action}`);if(K.callbackId){const oe=this.sourceName,te=K.sourceName;new Promise(function(H){H(Z(K.data))}).then(function(H){X.postMessage({sourceName:oe,targetName:te,callback:o.DATA,callbackId:K.callbackId,data:H})},function(H){X.postMessage({sourceName:oe,targetName:te,callback:o.ERROR,callbackId:K.callbackId,reason:u(H)})});return}if(K.streamId){Pe(this,d,Nd).call(this,K);return}Z(K.data)},X.addEventListener("message",this._onComObjOnMessage)}on(V,U){const X=this.actionHandler;if(X[V])throw new Error(`There is already an actionName called "${V}"`);X[V]=U}send(V,U,X){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:V,data:U},X)}sendWithPromise(V,U,X){const b=this.callbackId++,K=new i.PromiseCapability;this.callbackCapabilities[b]=K;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:V,callbackId:b,data:U},X)}catch(Z){K.reject(Z)}return K.promise}sendWithStream(V,U,X,b){const K=this.streamId++,Z=this.sourceName,oe=this.targetName,te=this.comObj;return new ReadableStream({start:H=>{const J=new i.PromiseCapability;return this.streamControllers[K]={controller:H,startCall:J,pullCall:null,cancelCall:null,isClosed:!1},te.postMessage({sourceName:Z,targetName:oe,action:V,streamId:K,data:U,desiredSize:H.desiredSize},b),J.promise},pull:H=>{const J=new i.PromiseCapability;return this.streamControllers[K].pullCall=J,te.postMessage({sourceName:Z,targetName:oe,stream:a.PULL,streamId:K,desiredSize:H.desiredSize}),J.promise},cancel:H=>{(0,i.assert)(H instanceof Error,"cancel must have a valid reason");const J=new i.PromiseCapability;return this.streamControllers[K].cancelCall=J,this.streamControllers[K].isClosed=!0,te.postMessage({sourceName:Z,targetName:oe,stream:a.CANCEL,streamId:K,reason:u(H)}),J.promise}},X)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}d=new WeakSet,Nd=function(V){const U=V.streamId,X=this.sourceName,b=V.sourceName,K=this.comObj,Z=this,oe=this.actionHandler[V.action],te={enqueue(H,J=1,y){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=J,g>0&&this.desiredSize<=0&&(this.sinkCapability=new i.PromiseCapability,this.ready=this.sinkCapability.promise),K.postMessage({sourceName:X,targetName:b,stream:a.ENQUEUE,streamId:U,chunk:H},y)},close(){this.isCancelled||(this.isCancelled=!0,K.postMessage({sourceName:X,targetName:b,stream:a.CLOSE,streamId:U}),delete Z.streamSinks[U])},error(H){(0,i.assert)(H instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,K.postMessage({sourceName:X,targetName:b,stream:a.ERROR,streamId:U,reason:u(H)}))},sinkCapability:new i.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:V.desiredSize,ready:null};te.sinkCapability.resolve(),te.ready=te.sinkCapability.promise,this.streamSinks[U]=te,new Promise(function(H){H(oe(V.data,te))}).then(function(){K.postMessage({sourceName:X,targetName:b,stream:a.START_COMPLETE,streamId:U,success:!0})},function(H){K.postMessage({sourceName:X,targetName:b,stream:a.START_COMPLETE,streamId:U,reason:u(H)})})},Fd=function(V){const U=V.streamId,X=this.sourceName,b=V.sourceName,K=this.comObj,Z=this.streamControllers[U],oe=this.streamSinks[U];switch(V.stream){case a.START_COMPLETE:V.success?Z.startCall.resolve():Z.startCall.reject(u(V.reason));break;case a.PULL_COMPLETE:V.success?Z.pullCall.resolve():Z.pullCall.reject(u(V.reason));break;case a.PULL:if(!oe){K.postMessage({sourceName:X,targetName:b,stream:a.PULL_COMPLETE,streamId:U,success:!0});break}oe.desiredSize<=0&&V.desiredSize>0&&oe.sinkCapability.resolve(),oe.desiredSize=V.desiredSize,new Promise(function(te){var H;te((H=oe.onPull)==null?void 0:H.call(oe))}).then(function(){K.postMessage({sourceName:X,targetName:b,stream:a.PULL_COMPLETE,streamId:U,success:!0})},function(te){K.postMessage({sourceName:X,targetName:b,stream:a.PULL_COMPLETE,streamId:U,reason:u(te)})});break;case a.ENQUEUE:if((0,i.assert)(Z,"enqueue should have stream controller"),Z.isClosed)break;Z.controller.enqueue(V.chunk);break;case a.CLOSE:if((0,i.assert)(Z,"close should have stream controller"),Z.isClosed)break;Z.isClosed=!0,Z.controller.close(),Pe(this,d,il).call(this,Z,U);break;case a.ERROR:(0,i.assert)(Z,"error should have stream controller"),Z.controller.error(u(V.reason)),Pe(this,d,il).call(this,Z,U);break;case a.CANCEL_COMPLETE:V.success?Z.cancelCall.resolve():Z.cancelCall.reject(u(V.reason)),Pe(this,d,il).call(this,Z,U);break;case a.CANCEL:if(!oe)break;new Promise(function(te){var H;te((H=oe.onCancel)==null?void 0:H.call(oe,u(V.reason)))}).then(function(){K.postMessage({sourceName:X,targetName:b,stream:a.CANCEL_COMPLETE,streamId:U,success:!0})},function(te){K.postMessage({sourceName:X,targetName:b,stream:a.CANCEL_COMPLETE,streamId:U,reason:u(te)})}),oe.sinkCapability.reject(u(V.reason)),oe.isCancelled=!0,delete this.streamSinks[U];break;default:throw new Error("Unexpected stream case")}},il=async function(V,U){var X,b,K;await Promise.allSettled([(X=V.startCall)==null?void 0:X.promise,(b=V.pullCall)==null?void 0:b.promise,(K=V.cancelCall)==null?void 0:K.promise]),delete this.streamControllers[U]},e.MessageHandler=f},(n,e,t)=>{var a,u;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var i=t(1);class o{constructor({parsedData:d,rawData:p}){Fe(this,a);Fe(this,u);Oe(this,a,d),Oe(this,u,p)}getRaw(){return T(this,u)}get(d){return T(this,a).get(d)??null}getAll(){return(0,i.objectFromMap)(T(this,a))}has(d){return T(this,a).has(d)}}a=new WeakMap,u=new WeakMap,e.Metadata=o},(n,e,t)=>{var d,p,_,R,w,V,tc;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var i=t(1),o=t(8);const a=Symbol("INTERNAL");class u{constructor(b,K){Fe(this,d,!0);this.name=b,this.intent=K}get visible(){return T(this,d)}_setVisible(b,K){b!==a&&(0,i.unreachable)("Internal method `_setVisible` called."),Oe(this,d,K)}}d=new WeakMap;class f{constructor(b){Fe(this,V);Fe(this,p,null);Fe(this,_,new Map);Fe(this,R,null);Fe(this,w,null);if(this.name=null,this.creator=null,b!==null){this.name=b.name,this.creator=b.creator,Oe(this,w,b.order);for(const K of b.groups)T(this,_).set(K.id,new u(K.name,K.intent));if(b.baseState==="OFF")for(const K of T(this,_).values())K._setVisible(a,!1);for(const K of b.on)T(this,_).get(K)._setVisible(a,!0);for(const K of b.off)T(this,_).get(K)._setVisible(a,!1);Oe(this,R,this.getHash())}}isVisible(b){if(T(this,_).size===0)return!0;if(!b)return(0,i.warn)("Optional content group not defined."),!0;if(b.type==="OCG")return T(this,_).has(b.id)?T(this,_).get(b.id).visible:((0,i.warn)(`Optional content group not found: ${b.id}`),!0);if(b.type==="OCMD"){if(b.expression)return Pe(this,V,tc).call(this,b.expression);if(!b.policy||b.policy==="AnyOn"){for(const K of b.ids){if(!T(this,_).has(K))return(0,i.warn)(`Optional content group not found: ${K}`),!0;if(T(this,_).get(K).visible)return!0}return!1}else if(b.policy==="AllOn"){for(const K of b.ids){if(!T(this,_).has(K))return(0,i.warn)(`Optional content group not found: ${K}`),!0;if(!T(this,_).get(K).visible)return!1}return!0}else if(b.policy==="AnyOff"){for(const K of b.ids){if(!T(this,_).has(K))return(0,i.warn)(`Optional content group not found: ${K}`),!0;if(!T(this,_).get(K).visible)return!0}return!1}else if(b.policy==="AllOff"){for(const K of b.ids){if(!T(this,_).has(K))return(0,i.warn)(`Optional content group not found: ${K}`),!0;if(T(this,_).get(K).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${b.policy}.`),!0}return(0,i.warn)(`Unknown group type ${b.type}.`),!0}setVisibility(b,K=!0){if(!T(this,_).has(b)){(0,i.warn)(`Optional content group not found: ${b}`);return}T(this,_).get(b)._setVisible(a,!!K),Oe(this,p,null)}get hasInitialVisibility(){return T(this,R)===null||this.getHash()===T(this,R)}getOrder(){return T(this,_).size?T(this,w)?T(this,w).slice():[...T(this,_).keys()]:null}getGroups(){return T(this,_).size>0?(0,i.objectFromMap)(T(this,_)):null}getGroup(b){return T(this,_).get(b)||null}getHash(){if(T(this,p)!==null)return T(this,p);const b=new o.MurmurHash3_64;for(const[K,Z]of T(this,_))b.update(`${K}:${Z.visible}`);return Oe(this,p,b.hexdigest())}}p=new WeakMap,_=new WeakMap,R=new WeakMap,w=new WeakMap,V=new WeakSet,tc=function(b){const K=b.length;if(K<2)return!0;const Z=b[0];for(let oe=1;oe<K;oe++){const te=b[oe];let H;if(Array.isArray(te))H=Pe(this,V,tc).call(this,te);else if(T(this,_).has(te))H=T(this,_).get(te).visible;else return(0,i.warn)(`Optional content group not found: ${te}`),!0;switch(Z){case"And":if(!H)return!1;break;case"Or":if(H)return!0;break;case"Not":return!H;default:return!0}}return Z==="And"},e.OptionalContentConfig=f},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var i=t(1),o=t(6);class a{constructor({length:p,initialData:_,progressiveDone:R=!1,contentDispositionFilename:w=null,disableRange:V=!1,disableStream:U=!1},X){if((0,i.assert)(X,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=R,this._contentDispositionFilename=w,(_==null?void 0:_.length)>0){const b=_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength?_.buffer:new Uint8Array(_).buffer;this._queuedChunks.push(b)}this._pdfDataRangeTransport=X,this._isStreamingSupported=!U,this._isRangeSupported=!V,this._contentLength=p,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((b,K)=>{this._onReceiveData({begin:b,chunk:K})}),this._pdfDataRangeTransport.addProgressListener((b,K)=>{this._onProgress({loaded:b,total:K})}),this._pdfDataRangeTransport.addProgressiveReadListener(b=>{this._onReceiveData({chunk:b})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:p,chunk:_}){const R=_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength?_.buffer:new Uint8Array(_).buffer;if(p===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(R):this._queuedChunks.push(R);else{const w=this._rangeReaders.some(function(V){return V._begin!==p?!1:(V._enqueue(R),!0)});(0,i.assert)(w,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var p;return((p=this._fullRequestReader)==null?void 0:p._loaded)??0}_onProgress(p){var _,R,w,V;p.total===void 0?(R=(_=this._rangeReaders[0])==null?void 0:_.onProgress)==null||R.call(_,{loaded:p.loaded}):(V=(w=this._fullRequestReader)==null?void 0:w.onProgress)==null||V.call(w,{loaded:p.loaded,total:p.total})}_onProgressiveDone(){var p;(p=this._fullRequestReader)==null||p.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(p){const _=this._rangeReaders.indexOf(p);_>=0&&this._rangeReaders.splice(_,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const p=this._queuedChunks;return this._queuedChunks=null,new u(this,p,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(p,_){if(_<=this._progressiveDataLength)return null;const R=new f(this,p,_);return this._pdfDataRangeTransport.requestDataRange(p,_),this._rangeReaders.push(R),R}cancelAllRequests(p){var _;(_=this._fullRequestReader)==null||_.cancel(p);for(const R of this._rangeReaders.slice(0))R.cancel(p);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=a;class u{constructor(p,_,R=!1,w=null){this._stream=p,this._done=R||!1,this._filename=(0,o.isPdfFile)(w)?w:null,this._queuedChunks=_||[],this._loaded=0;for(const V of this._queuedChunks)this._loaded+=V.byteLength;this._requests=[],this._headersReady=Promise.resolve(),p._fullRequestReader=this,this.onProgress=null}_enqueue(p){this._done||(this._requests.length>0?this._requests.shift().resolve({value:p,done:!1}):this._queuedChunks.push(p),this._loaded+=p.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=new i.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class f{constructor(p,_,R){this._stream=p,this._begin=_,this._end=R,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(p){if(!this._done){if(this._requests.length===0)this._queuedChunk=p;else{this._requests.shift().resolve({value:p,done:!1});for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const _=this._queuedChunk;return this._queuedChunk=null,{value:_,done:!1}}if(this._done)return{value:void 0,done:!0};const p=new i.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var i=t(1),o=t(20);function a(R,w,V){return{method:"GET",headers:R,signal:V.signal,mode:"cors",credentials:w?"include":"same-origin",redirect:"follow"}}function u(R){const w=new Headers;for(const V in R){const U=R[V];U!==void 0&&w.append(V,U)}return w}function f(R){return R instanceof Uint8Array?R.buffer:R instanceof ArrayBuffer?R:((0,i.warn)(`getArrayBuffer - unexpected data format: ${R}`),new Uint8Array(R).buffer)}class d{constructor(w){this.source=w,this.isHttp=/^https?:/i.test(w.url),this.httpHeaders=this.isHttp&&w.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var w;return((w=this._fullRequestReader)==null?void 0:w._loaded)??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new p(this),this._fullRequestReader}getRangeReader(w,V){if(V<=this._progressiveDataLength)return null;const U=new _(this,w,V);return this._rangeRequestReaders.push(U),U}cancelAllRequests(w){var V;(V=this._fullRequestReader)==null||V.cancel(w);for(const U of this._rangeRequestReaders.slice(0))U.cancel(w)}}e.PDFFetchStream=d;class p{constructor(w){this._stream=w,this._reader=null,this._loaded=0,this._filename=null;const V=w.source;this._withCredentials=V.withCredentials||!1,this._contentLength=V.length,this._headersCapability=new i.PromiseCapability,this._disableRange=V.disableRange||!1,this._rangeChunkSize=V.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!V.disableStream,this._isRangeSupported=!V.disableRange,this._headers=u(this._stream.httpHeaders);const U=V.url;fetch(U,a(this._headers,this._withCredentials,this._abortController)).then(X=>{if(!(0,o.validateResponseStatus)(X.status))throw(0,o.createResponseStatusError)(X.status,U);this._reader=X.body.getReader(),this._headersCapability.resolve();const b=oe=>X.headers.get(oe),{allowRangeRequests:K,suggestedLength:Z}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:b,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=K,this._contentLength=Z||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(b),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var U;await this._headersCapability.promise;const{value:w,done:V}=await this._reader.read();return V?{value:w,done:V}:(this._loaded+=w.byteLength,(U=this.onProgress)==null||U.call(this,{loaded:this._loaded,total:this._contentLength}),{value:f(w),done:!1})}cancel(w){var V;(V=this._reader)==null||V.cancel(w),this._abortController.abort()}}class _{constructor(w,V,U){this._stream=w,this._reader=null,this._loaded=0;const X=w.source;this._withCredentials=X.withCredentials||!1,this._readCapability=new i.PromiseCapability,this._isStreamingSupported=!X.disableStream,this._abortController=new AbortController,this._headers=u(this._stream.httpHeaders),this._headers.append("Range",`bytes=${V}-${U-1}`);const b=X.url;fetch(b,a(this._headers,this._withCredentials,this._abortController)).then(K=>{if(!(0,o.validateResponseStatus)(K.status))throw(0,o.createResponseStatusError)(K.status,b);this._readCapability.resolve(),this._reader=K.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var U;await this._readCapability.promise;const{value:w,done:V}=await this._reader.read();return V?{value:w,done:V}:(this._loaded+=w.byteLength,(U=this.onProgress)==null||U.call(this,{loaded:this._loaded}),{value:f(w),done:!1})}cancel(w){var V;(V=this._reader)==null||V.cancel(w),this._abortController.abort()}}},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=d,e.extractFilenameFromHeader=f,e.validateRangeRequestCapabilities=u,e.validateResponseStatus=p;var i=t(1),o=t(21),a=t(6);function u({getResponseHeader:_,isHttp:R,rangeChunkSize:w,disableRange:V}){const U={allowRangeRequests:!1,suggestedLength:void 0},X=parseInt(_("Content-Length"),10);return!Number.isInteger(X)||(U.suggestedLength=X,X<=2*w)||V||!R||_("Accept-Ranges")!=="bytes"||(_("Content-Encoding")||"identity")!=="identity"||(U.allowRangeRequests=!0),U}function f(_){const R=_("Content-Disposition");if(R){let w=(0,o.getFilenameFromContentDispositionHeader)(R);if(w.includes("%"))try{w=decodeURIComponent(w)}catch{}if((0,a.isPdfFile)(w))return w}return null}function d(_,R){return _===404||_===0&&R.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+R+'".'):new i.UnexpectedResponseException(`Unexpected server response (${_}) while retrieving PDF "${R}".`,_)}function p(_){return _===200||_===206}},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=o;var i=t(1);function o(a){let u=!0,f=d("filename\\*","i").exec(a);if(f){f=f[1];let X=w(f);return X=unescape(X),X=V(X),X=U(X),_(X)}if(f=R(a),f){const X=U(f);return _(X)}if(f=d("filename","i").exec(a),f){f=f[1];let X=w(f);return X=U(X),_(X)}function d(X,b){return new RegExp("(?:^|;)\\s*"+X+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function p(X,b){if(X){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const K=new TextDecoder(X,{fatal:!0}),Z=(0,i.stringToBytes)(b);b=K.decode(Z),u=!1}catch{}}return b}function _(X){return u&&/[\x80-\xff]/.test(X)&&(X=p("utf-8",X),u&&(X=p("iso-8859-1",X))),X}function R(X){const b=[];let K;const Z=d("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(K=Z.exec(X))!==null;){let[,te,H,J]=K;if(te=parseInt(te,10),te in b){if(te===0)break;continue}b[te]=[H,J]}const oe=[];for(let te=0;te<b.length&&te in b;++te){let[H,J]=b[te];J=w(J),H&&(J=unescape(J),te===0&&(J=V(J))),oe.push(J)}return oe.join("")}function w(X){if(X.startsWith('"')){const b=X.slice(1).split('\\"');for(let K=0;K<b.length;++K){const Z=b[K].indexOf('"');Z!==-1&&(b[K]=b[K].slice(0,Z),b.length=K+1),b[K]=b[K].replaceAll(/\\(.)/g,"$1")}X=b.join('"')}return X}function V(X){const b=X.indexOf("'");if(b===-1)return X;const K=X.slice(0,b),oe=X.slice(b+1).replace(/^[^']*'/,"");return p(K,oe)}function U(X){return!X.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(X)?X:X.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,K,Z,oe){if(Z==="q"||Z==="Q")return oe=oe.replaceAll("_"," "),oe=oe.replaceAll(/=([0-9a-fA-F]{2})/g,function(te,H){return String.fromCharCode(parseInt(H,16))}),p(K,oe);try{oe=atob(oe)}catch{}return p(K,oe)})}return""}},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var i=t(1),o=t(20);const a=200,u=206;function f(w){const V=w.response;return typeof V!="string"?V:(0,i.stringToBytes)(V).buffer}class d{constructor(V,U={}){this.url=V,this.isHttp=/^https?:/i.test(V),this.httpHeaders=this.isHttp&&U.httpHeaders||Object.create(null),this.withCredentials=U.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(V,U,X){const b={begin:V,end:U};for(const K in X)b[K]=X[K];return this.request(b)}requestFull(V){return this.request(V)}request(V){const U=new XMLHttpRequest,X=this.currXhrId++,b=this.pendingRequests[X]={xhr:U};U.open("GET",this.url),U.withCredentials=this.withCredentials;for(const K in this.httpHeaders){const Z=this.httpHeaders[K];Z!==void 0&&U.setRequestHeader(K,Z)}return this.isHttp&&"begin"in V&&"end"in V?(U.setRequestHeader("Range",`bytes=${V.begin}-${V.end-1}`),b.expectedStatus=u):b.expectedStatus=a,U.responseType="arraybuffer",V.onError&&(U.onerror=function(K){V.onError(U.status)}),U.onreadystatechange=this.onStateChange.bind(this,X),U.onprogress=this.onProgress.bind(this,X),b.onHeadersReceived=V.onHeadersReceived,b.onDone=V.onDone,b.onError=V.onError,b.onProgress=V.onProgress,U.send(null),X}onProgress(V,U){var b;const X=this.pendingRequests[V];X&&((b=X.onProgress)==null||b.call(X,U))}onStateChange(V,U){var te,H,J;const X=this.pendingRequests[V];if(!X)return;const b=X.xhr;if(b.readyState>=2&&X.onHeadersReceived&&(X.onHeadersReceived(),delete X.onHeadersReceived),b.readyState!==4||!(V in this.pendingRequests))return;if(delete this.pendingRequests[V],b.status===0&&this.isHttp){(te=X.onError)==null||te.call(X,b.status);return}const K=b.status||a;if(!(K===a&&X.expectedStatus===u)&&K!==X.expectedStatus){(H=X.onError)==null||H.call(X,b.status);return}const oe=f(b);if(K===u){const y=b.getResponseHeader("Content-Range"),g=/bytes (\d+)-(\d+)\/(\d+)/.exec(y);X.onDone({begin:parseInt(g[1],10),chunk:oe})}else oe?X.onDone({begin:0,chunk:oe}):(J=X.onError)==null||J.call(X,b.status)}getRequestXhr(V){return this.pendingRequests[V].xhr}isPendingRequest(V){return V in this.pendingRequests}abortRequest(V){const U=this.pendingRequests[V].xhr;delete this.pendingRequests[V],U.abort()}}class p{constructor(V){this._source=V,this._manager=new d(V.url,{httpHeaders:V.httpHeaders,withCredentials:V.withCredentials}),this._rangeChunkSize=V.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(V){const U=this._rangeRequestReaders.indexOf(V);U>=0&&this._rangeRequestReaders.splice(U,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _(this._manager,this._source),this._fullRequestReader}getRangeReader(V,U){const X=new R(this._manager,V,U);return X.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(X),X}cancelAllRequests(V){var U;(U=this._fullRequestReader)==null||U.cancel(V);for(const X of this._rangeRequestReaders.slice(0))X.cancel(V)}}e.PDFNetworkStream=p;class _{constructor(V,U){this._manager=V;const X={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=U.url,this._fullRequestId=V.requestFull(X),this._headersReceivedCapability=new i.PromiseCapability,this._disableRange=U.disableRange||!1,this._contentLength=U.length,this._rangeChunkSize=U.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const V=this._fullRequestId,U=this._manager.getRequestXhr(V),X=Z=>U.getResponseHeader(Z),{allowRangeRequests:b,suggestedLength:K}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:X,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});b&&(this._isRangeSupported=!0),this._contentLength=K||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(X),this._isRangeSupported&&this._manager.abortRequest(V),this._headersReceivedCapability.resolve()}_onDone(V){if(V&&(this._requests.length>0?this._requests.shift().resolve({value:V.chunk,done:!1}):this._cachedChunks.push(V.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const U of this._requests)U.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(V){this._storedError=(0,o.createResponseStatusError)(V,this._url),this._headersReceivedCapability.reject(this._storedError);for(const U of this._requests)U.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(V){var U;(U=this.onProgress)==null||U.call(this,{loaded:V.loaded,total:V.lengthComputable?V.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const V=new i.PromiseCapability;return this._requests.push(V),V.promise}cancel(V){this._done=!0,this._headersReceivedCapability.reject(V);for(const U of this._requests)U.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class R{constructor(V,U,X){this._manager=V;const b={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=V.url,this._requestId=V.requestRange(U,X,b),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var V;(V=this.onClosed)==null||V.call(this,this)}_onDone(V){const U=V.chunk;this._requests.length>0?this._requests.shift().resolve({value:U,done:!1}):this._queuedChunk=U,this._done=!0;for(const X of this._requests)X.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(V){this._storedError=(0,o.createResponseStatusError)(V,this._url);for(const U of this._requests)U.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(V){var U;this.isStreamingSupported||(U=this.onProgress)==null||U.call(this,{loaded:V.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const U=this._queuedChunk;return this._queuedChunk=null,{value:U,done:!1}}if(this._done)return{value:void 0,done:!0};const V=new i.PromiseCapability;return this._requests.push(V),V.promise}cancel(V){this._done=!0;for(const U of this._requests)U.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var i=t(1),o=t(20);const a=/^file:\/\/\/[a-zA-Z]:\//;function u(X){const b=require$$5,K=b.parse(X);return K.protocol==="file:"||K.host?K:/^[a-z]:[/\\]/i.test(X)?b.parse(`file:///${X}`):(K.host||(K.protocol="file:"),K)}class f{constructor(b){this.source=b,this.url=u(b.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&b.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var b;return((b=this._fullRequestReader)==null?void 0:b._loaded)??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new V(this):new R(this),this._fullRequestReader}getRangeReader(b,K){if(K<=this._progressiveDataLength)return null;const Z=this.isFsUrl?new U(this,b,K):new w(this,b,K);return this._rangeRequestReaders.push(Z),Z}cancelAllRequests(b){var K;(K=this._fullRequestReader)==null||K.cancel(b);for(const Z of this._rangeRequestReaders.slice(0))Z.cancel(b)}}e.PDFNodeStream=f;class d{constructor(b){this._url=b.url,this._done=!1,this._storedError=null,this.onProgress=null;const K=b.source;this._contentLength=K.length,this._loaded=0,this._filename=null,this._disableRange=K.disableRange||!1,this._rangeChunkSize=K.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!K.disableStream,this._isRangeSupported=!K.disableRange,this._readableStream=null,this._readCapability=new i.PromiseCapability,this._headersCapability=new i.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Z;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const b=this._readableStream.read();return b===null?(this._readCapability=new i.PromiseCapability,this.read()):(this._loaded+=b.length,(Z=this.onProgress)==null||Z.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(b).buffer,done:!1})}cancel(b){if(!this._readableStream){this._error(b);return}this._readableStream.destroy(b)}_error(b){this._storedError=b,this._readCapability.resolve()}_setReadableStream(b){this._readableStream=b,b.on("readable",()=>{this._readCapability.resolve()}),b.on("end",()=>{b.destroy(),this._done=!0,this._readCapability.resolve()}),b.on("error",K=>{this._error(K)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p{constructor(b){this._url=b.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new i.PromiseCapability;const K=b.source;this._isStreamingSupported=!K.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Z;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const b=this._readableStream.read();return b===null?(this._readCapability=new i.PromiseCapability,this.read()):(this._loaded+=b.length,(Z=this.onProgress)==null||Z.call(this,{loaded:this._loaded}),{value:new Uint8Array(b).buffer,done:!1})}cancel(b){if(!this._readableStream){this._error(b);return}this._readableStream.destroy(b)}_error(b){this._storedError=b,this._readCapability.resolve()}_setReadableStream(b){this._readableStream=b,b.on("readable",()=>{this._readCapability.resolve()}),b.on("end",()=>{b.destroy(),this._done=!0,this._readCapability.resolve()}),b.on("error",K=>{this._error(K)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function _(X,b){return{protocol:X.protocol,auth:X.auth,host:X.hostname,port:X.port,path:X.path,method:"GET",headers:b}}class R extends d{constructor(b){super(b);const K=Z=>{if(Z.statusCode===404){const J=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=J,this._headersCapability.reject(J);return}this._headersCapability.resolve(),this._setReadableStream(Z);const oe=J=>this._readableStream.headers[J.toLowerCase()],{allowRangeRequests:te,suggestedLength:H}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:oe,isHttp:b.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=te,this._contentLength=H||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(oe)};if(this._request=null,this._url.protocol==="http:"){const Z=require$$5;this._request=Z.request(_(this._url,b.httpHeaders),K)}else{const Z=require$$5;this._request=Z.request(_(this._url,b.httpHeaders),K)}this._request.on("error",Z=>{this._storedError=Z,this._headersCapability.reject(Z)}),this._request.end()}}class w extends p{constructor(b,K,Z){super(b),this._httpHeaders={};for(const te in b.httpHeaders){const H=b.httpHeaders[te];H!==void 0&&(this._httpHeaders[te]=H)}this._httpHeaders.Range=`bytes=${K}-${Z-1}`;const oe=te=>{if(te.statusCode===404){const H=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=H;return}this._setReadableStream(te)};if(this._request=null,this._url.protocol==="http:"){const te=require$$5;this._request=te.request(_(this._url,this._httpHeaders),oe)}else{const te=require$$5;this._request=te.request(_(this._url,this._httpHeaders),oe)}this._request.on("error",te=>{this._storedError=te}),this._request.end()}}class V extends d{constructor(b){super(b);let K=decodeURIComponent(this._url.path);a.test(this._url.href)&&(K=K.replace(/^\//,""));const Z=require$$5;Z.lstat(K,(oe,te)=>{if(oe){oe.code==="ENOENT"&&(oe=new i.MissingPDFException(`Missing PDF "${K}".`)),this._storedError=oe,this._headersCapability.reject(oe);return}this._contentLength=te.size,this._setReadableStream(Z.createReadStream(K)),this._headersCapability.resolve()})}}class U extends p{constructor(b,K,Z){super(b);let oe=decodeURIComponent(this._url.path);a.test(this._url.href)&&(oe=oe.replace(/^\//,""));const te=require$$5;this._setReadableStream(te.createReadStream(oe,{start:K,end:Z-1}))}}},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var i=t(6),o=t(1);const a={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},u="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",d=["butt","round","square"],p=["miter","round","bevel"],_=function(te,H="",J=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!J)return URL.createObjectURL(new Blob([te],{type:H}));const y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let g=`data:${H};base64,`;for(let E=0,W=te.length;E<W;E+=3){const v=te[E]&255,D=te[E+1]&255,C=te[E+2]&255,we=v>>2,ve=(v&3)<<4|D>>4,Re=E+1<W?(D&15)<<2|C>>6:64,_e=E+2<W?C&63:64;g+=y[we]+y[ve]+y[Re]+y[_e]}return g},R=function(){const te=new Uint8Array([137,80,78,71,13,10,26,10]),H=12,J=new Int32Array(256);for(let C=0;C<256;C++){let we=C;for(let ve=0;ve<8;ve++)we=we&1?3988292384^we>>1&2147483647:we>>1&2147483647;J[C]=we}function y(C,we,ve){let Re=-1;for(let _e=we;_e<ve;_e++){const ge=(Re^C[_e])&255,ie=J[ge];Re=Re>>>8^ie}return Re^-1}function g(C,we,ve,Re){let _e=Re;const ge=we.length;ve[_e]=ge>>24&255,ve[_e+1]=ge>>16&255,ve[_e+2]=ge>>8&255,ve[_e+3]=ge&255,_e+=4,ve[_e]=C.charCodeAt(0)&255,ve[_e+1]=C.charCodeAt(1)&255,ve[_e+2]=C.charCodeAt(2)&255,ve[_e+3]=C.charCodeAt(3)&255,_e+=4,ve.set(we,_e),_e+=we.length;const ie=y(ve,Re+4,_e);ve[_e]=ie>>24&255,ve[_e+1]=ie>>16&255,ve[_e+2]=ie>>8&255,ve[_e+3]=ie&255}function E(C,we,ve){let Re=1,_e=0;for(let ge=we;ge<ve;++ge)Re=(Re+(C[ge]&255))%65521,_e=(_e+Re)%65521;return _e<<16|Re}function W(C){if(!o.isNodeJS)return v(C);try{const we=parseInt(process.versions.node)>=8?C:Buffer.from(C),ve=require$$5.deflateSync(we,{level:9});return ve instanceof Uint8Array?ve:new Uint8Array(ve)}catch(we){(0,o.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+we)}return v(C)}function v(C){let we=C.length;const ve=65535,Re=Math.ceil(we/ve),_e=new Uint8Array(2+we+Re*5+4);let ge=0;_e[ge++]=120,_e[ge++]=156;let ie=0;for(;we>ve;)_e[ge++]=0,_e[ge++]=255,_e[ge++]=255,_e[ge++]=0,_e[ge++]=0,_e.set(C.subarray(ie,ie+ve),ge),ge+=ve,ie+=ve,we-=ve;_e[ge++]=1,_e[ge++]=we&255,_e[ge++]=we>>8&255,_e[ge++]=~we&65535&255,_e[ge++]=(~we&65535)>>8&255,_e.set(C.subarray(ie),ge),ge+=C.length-ie;const fe=E(C,0,C.length);return _e[ge++]=fe>>24&255,_e[ge++]=fe>>16&255,_e[ge++]=fe>>8&255,_e[ge++]=fe&255,_e}function D(C,we,ve,Re){const _e=C.width,ge=C.height;let ie,fe,re;const Y=C.data;switch(we){case o.ImageKind.GRAYSCALE_1BPP:fe=0,ie=1,re=_e+7>>3;break;case o.ImageKind.RGB_24BPP:fe=2,ie=8,re=_e*3;break;case o.ImageKind.RGBA_32BPP:fe=6,ie=8,re=_e*4;break;default:throw new Error("invalid format")}const I=new Uint8Array((1+re)*ge);let S=0,ee=0;for(let Be=0;Be<ge;++Be)I[S++]=0,I.set(Y.subarray(ee,ee+re),S),ee+=re,S+=re;if(we===o.ImageKind.GRAYSCALE_1BPP&&Re){S=0;for(let Be=0;Be<ge;Be++){S++;for(let ze=0;ze<re;ze++)I[S++]^=255}}const le=new Uint8Array([_e>>24&255,_e>>16&255,_e>>8&255,_e&255,ge>>24&255,ge>>16&255,ge>>8&255,ge&255,ie,fe,0,0,0]),ce=W(I),he=te.length+H*3+le.length+ce.length,Ee=new Uint8Array(he);let be=0;return Ee.set(te,be),be+=te.length,g("IHDR",le,Ee,be),be+=H+le.length,g("IDATA",ce,Ee,be),be+=H+ce.length,g("IEND",new Uint8Array(0),Ee,be),_(Ee,"image/png",ve)}return function(we,ve,Re){const _e=we.kind===void 0?o.ImageKind.GRAYSCALE_1BPP:we.kind;return D(we,_e,ve,Re)}}();class w{constructor(){this.fontSizeScale=1,this.fontWeight=a.fontWeight,this.fontSize=0,this.textMatrix=o.IDENTITY_MATRIX,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=o.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=a.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(H,J){this.x=H,this.y=J}}function V(te){let H=[];const J=[];for(const y of te){if(y.fn==="save"){H.push({fnId:92,fn:"group",items:[]}),J.push(H),H=H.at(-1).items;continue}y.fn==="restore"?H=J.pop():H.push(y)}return H}function U(te){if(Number.isInteger(te))return te.toString();const H=te.toFixed(10);let J=H.length-1;if(H[J]!=="0")return H;do J--;while(H[J]==="0");return H.substring(0,H[J]==="."?J:J+1)}function X(te){if(te[4]===0&&te[5]===0){if(te[1]===0&&te[2]===0)return te[0]===1&&te[3]===1?"":`scale(${U(te[0])} ${U(te[3])})`;if(te[0]===te[3]&&te[1]===-te[2]){const H=Math.acos(te[0])*180/Math.PI;return`rotate(${U(H)})`}}else if(te[0]===1&&te[1]===0&&te[2]===0&&te[3]===1)return`translate(${U(te[4])} ${U(te[5])})`;return`matrix(${U(te[0])} ${U(te[1])} ${U(te[2])} ${U(te[3])} ${U(te[4])} ${U(te[5])})`}let b=0,K=0,Z=0;class oe{constructor(H,J,y=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new w,this.transformMatrix=o.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=H,this.objs=J,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!y,this._operatorIdMapping=[];for(const g in o.OPS)this._operatorIdMapping[o.OPS[g]]=g}getObject(H,J=null){return typeof H=="string"?H.startsWith("g_")?this.commonObjs.get(H):this.objs.get(H):J}save(){this.transformStack.push(this.transformMatrix);const H=this.current;this.extraStack.push(H),this.current=H.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(H){this.save(),this.executeOpTree(H),this.restore()}loadDependencies(H){const J=H.fnArray,y=H.argsArray;for(let g=0,E=J.length;g<E;g++)if(J[g]===o.OPS.dependency)for(const W of y[g]){const v=W.startsWith("g_")?this.commonObjs:this.objs,D=new Promise(C=>{v.get(W,C)});this.current.dependencies.push(D)}return Promise.all(this.current.dependencies)}transform(H,J,y,g,E,W){const v=[H,J,y,g,E,W];this.transformMatrix=o.Util.transform(this.transformMatrix,v),this.tgrp=null}getSVG(H,J){this.viewport=J;const y=this._initialize(J);return this.loadDependencies(H).then(()=>(this.transformMatrix=o.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(H)),y))}convertOpList(H){const J=this._operatorIdMapping,y=H.argsArray,g=H.fnArray,E=[];for(let W=0,v=g.length;W<v;W++){const D=g[W];E.push({fnId:D,fn:J[D],args:y[W]})}return V(E)}executeOpTree(H){for(const J of H){const y=J.fn,g=J.fnId,E=J.args;switch(g|0){case o.OPS.beginText:this.beginText();break;case o.OPS.dependency:break;case o.OPS.setLeading:this.setLeading(E);break;case o.OPS.setLeadingMoveText:this.setLeadingMoveText(E[0],E[1]);break;case o.OPS.setFont:this.setFont(E);break;case o.OPS.showText:this.showText(E[0]);break;case o.OPS.showSpacedText:this.showText(E[0]);break;case o.OPS.endText:this.endText();break;case o.OPS.moveText:this.moveText(E[0],E[1]);break;case o.OPS.setCharSpacing:this.setCharSpacing(E[0]);break;case o.OPS.setWordSpacing:this.setWordSpacing(E[0]);break;case o.OPS.setHScale:this.setHScale(E[0]);break;case o.OPS.setTextMatrix:this.setTextMatrix(E[0],E[1],E[2],E[3],E[4],E[5]);break;case o.OPS.setTextRise:this.setTextRise(E[0]);break;case o.OPS.setTextRenderingMode:this.setTextRenderingMode(E[0]);break;case o.OPS.setLineWidth:this.setLineWidth(E[0]);break;case o.OPS.setLineJoin:this.setLineJoin(E[0]);break;case o.OPS.setLineCap:this.setLineCap(E[0]);break;case o.OPS.setMiterLimit:this.setMiterLimit(E[0]);break;case o.OPS.setFillRGBColor:this.setFillRGBColor(E[0],E[1],E[2]);break;case o.OPS.setStrokeRGBColor:this.setStrokeRGBColor(E[0],E[1],E[2]);break;case o.OPS.setStrokeColorN:this.setStrokeColorN(E);break;case o.OPS.setFillColorN:this.setFillColorN(E);break;case o.OPS.shadingFill:this.shadingFill(E[0]);break;case o.OPS.setDash:this.setDash(E[0],E[1]);break;case o.OPS.setRenderingIntent:this.setRenderingIntent(E[0]);break;case o.OPS.setFlatness:this.setFlatness(E[0]);break;case o.OPS.setGState:this.setGState(E[0]);break;case o.OPS.fill:this.fill();break;case o.OPS.eoFill:this.eoFill();break;case o.OPS.stroke:this.stroke();break;case o.OPS.fillStroke:this.fillStroke();break;case o.OPS.eoFillStroke:this.eoFillStroke();break;case o.OPS.clip:this.clip("nonzero");break;case o.OPS.eoClip:this.clip("evenodd");break;case o.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case o.OPS.paintImageXObject:this.paintImageXObject(E[0]);break;case o.OPS.paintInlineImageXObject:this.paintInlineImageXObject(E[0]);break;case o.OPS.paintImageMaskXObject:this.paintImageMaskXObject(E[0]);break;case o.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(E[0],E[1]);break;case o.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case o.OPS.closePath:this.closePath();break;case o.OPS.closeStroke:this.closeStroke();break;case o.OPS.closeFillStroke:this.closeFillStroke();break;case o.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case o.OPS.nextLine:this.nextLine();break;case o.OPS.transform:this.transform(E[0],E[1],E[2],E[3],E[4],E[5]);break;case o.OPS.constructPath:this.constructPath(E[0],E[1]);break;case o.OPS.endPath:this.endPath();break;case 92:this.group(J.items);break;default:(0,o.warn)(`Unimplemented operator ${y}`);break}}}setWordSpacing(H){this.current.wordSpacing=H}setCharSpacing(H){this.current.charSpacing=H}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(H,J,y,g,E,W){const v=this.current;v.textMatrix=v.lineMatrix=[H,J,y,g,E,W],v.textMatrixScale=Math.hypot(H,J),v.x=v.lineX=0,v.y=v.lineY=0,v.xcoords=[],v.ycoords=[],v.tspan=this.svgFactory.createElement("svg:tspan"),v.tspan.setAttributeNS(null,"font-family",v.fontFamily),v.tspan.setAttributeNS(null,"font-size",`${U(v.fontSize)}px`),v.tspan.setAttributeNS(null,"y",U(-v.y)),v.txtElement=this.svgFactory.createElement("svg:text"),v.txtElement.append(v.tspan)}beginText(){const H=this.current;H.x=H.lineX=0,H.y=H.lineY=0,H.textMatrix=o.IDENTITY_MATRIX,H.lineMatrix=o.IDENTITY_MATRIX,H.textMatrixScale=1,H.tspan=this.svgFactory.createElement("svg:tspan"),H.txtElement=this.svgFactory.createElement("svg:text"),H.txtgrp=this.svgFactory.createElement("svg:g"),H.xcoords=[],H.ycoords=[]}moveText(H,J){const y=this.current;y.x=y.lineX+=H,y.y=y.lineY+=J,y.xcoords=[],y.ycoords=[],y.tspan=this.svgFactory.createElement("svg:tspan"),y.tspan.setAttributeNS(null,"font-family",y.fontFamily),y.tspan.setAttributeNS(null,"font-size",`${U(y.fontSize)}px`),y.tspan.setAttributeNS(null,"y",U(-y.y))}showText(H){const J=this.current,y=J.font,g=J.fontSize;if(g===0)return;const E=J.fontSizeScale,W=J.charSpacing,v=J.wordSpacing,D=J.fontDirection,C=J.textHScale*D,we=y.vertical,ve=we?1:-1,Re=y.defaultVMetrics,_e=g*J.fontMatrix[0];let ge=0;for(const re of H){if(re===null){ge+=D*v;continue}else if(typeof re=="number"){ge+=ve*re*g/1e3;continue}const Y=(re.isSpace?v:0)+W,I=re.fontChar;let S,ee,le=re.width;if(we){let he;const Ee=re.vmetric||Re;he=re.vmetric?Ee[1]:le*.5,he=-he*_e;const be=Ee[2]*_e;le=Ee?-Ee[0]:le,S=he/E,ee=(ge+be)/E}else S=ge/E,ee=0;(re.isInFont||y.missingFile)&&(J.xcoords.push(J.x+S),we&&J.ycoords.push(-J.y+ee),J.tspan.textContent+=I);const ce=we?le*_e-Y*D:le*_e+Y*D;ge+=ce}J.tspan.setAttributeNS(null,"x",J.xcoords.map(U).join(" ")),we?J.tspan.setAttributeNS(null,"y",J.ycoords.map(U).join(" ")):J.tspan.setAttributeNS(null,"y",U(-J.y)),we?J.y-=ge:J.x+=ge*C,J.tspan.setAttributeNS(null,"font-family",J.fontFamily),J.tspan.setAttributeNS(null,"font-size",`${U(J.fontSize)}px`),J.fontStyle!==a.fontStyle&&J.tspan.setAttributeNS(null,"font-style",J.fontStyle),J.fontWeight!==a.fontWeight&&J.tspan.setAttributeNS(null,"font-weight",J.fontWeight);const ie=J.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;if(ie===o.TextRenderingMode.FILL||ie===o.TextRenderingMode.FILL_STROKE?(J.fillColor!==a.fillColor&&J.tspan.setAttributeNS(null,"fill",J.fillColor),J.fillAlpha<1&&J.tspan.setAttributeNS(null,"fill-opacity",J.fillAlpha)):J.textRenderingMode===o.TextRenderingMode.ADD_TO_PATH?J.tspan.setAttributeNS(null,"fill","transparent"):J.tspan.setAttributeNS(null,"fill","none"),ie===o.TextRenderingMode.STROKE||ie===o.TextRenderingMode.FILL_STROKE){const re=1/(J.textMatrixScale||1);this._setStrokeAttributes(J.tspan,re)}let fe=J.textMatrix;J.textRise!==0&&(fe=fe.slice(),fe[5]+=J.textRise),J.txtElement.setAttributeNS(null,"transform",`${X(fe)} scale(${U(C)}, -1)`),J.txtElement.setAttributeNS(u,"xml:space","preserve"),J.txtElement.append(J.tspan),J.txtgrp.append(J.txtElement),this._ensureTransformGroup().append(J.txtElement)}setLeadingMoveText(H,J){this.setLeading(-J),this.moveText(H,J)}addFontStyle(H){if(!H.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const J=_(H.data,H.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${H.loadedName}"; src: url(${J}); }
`}setFont(H){const J=this.current,y=this.commonObjs.get(H[0]);let g=H[1];J.font=y,this.embedFonts&&!y.missingFile&&!this.embeddedFonts[y.loadedName]&&(this.addFontStyle(y),this.embeddedFonts[y.loadedName]=y),J.fontMatrix=y.fontMatrix||o.FONT_IDENTITY_MATRIX;let E="normal";y.black?E="900":y.bold&&(E="bold");const W=y.italic?"italic":"normal";g<0?(g=-g,J.fontDirection=-1):J.fontDirection=1,J.fontSize=g,J.fontFamily=y.loadedName,J.fontWeight=E,J.fontStyle=W,J.tspan=this.svgFactory.createElement("svg:tspan"),J.tspan.setAttributeNS(null,"y",U(-J.y)),J.xcoords=[],J.ycoords=[]}endText(){var J;const H=this.current;H.textRenderingMode&o.TextRenderingMode.ADD_TO_PATH_FLAG&&((J=H.txtElement)!=null&&J.hasChildNodes())&&(H.element=H.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(H){H>0&&(this.current.lineWidth=H)}setLineCap(H){this.current.lineCap=d[H]}setLineJoin(H){this.current.lineJoin=p[H]}setMiterLimit(H){this.current.miterLimit=H}setStrokeAlpha(H){this.current.strokeAlpha=H}setStrokeRGBColor(H,J,y){this.current.strokeColor=o.Util.makeHexColor(H,J,y)}setFillAlpha(H){this.current.fillAlpha=H}setFillRGBColor(H,J,y){this.current.fillColor=o.Util.makeHexColor(H,J,y),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(H){this.current.strokeColor=this._makeColorN_Pattern(H)}setFillColorN(H){this.current.fillColor=this._makeColorN_Pattern(H)}shadingFill(H){const{width:J,height:y}=this.viewport,g=o.Util.inverseTransform(this.transformMatrix),[E,W,v,D]=o.Util.getAxialAlignedBoundingBox([0,0,J,y],g),C=this.svgFactory.createElement("svg:rect");C.setAttributeNS(null,"x",E),C.setAttributeNS(null,"y",W),C.setAttributeNS(null,"width",v-E),C.setAttributeNS(null,"height",D-W),C.setAttributeNS(null,"fill",this._makeShadingPattern(H)),this.current.fillAlpha<1&&C.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(C)}_makeColorN_Pattern(H){return H[0]==="TilingPattern"?this._makeTilingPattern(H):this._makeShadingPattern(H)}_makeTilingPattern(H){const J=H[1],y=H[2],g=H[3]||o.IDENTITY_MATRIX,[E,W,v,D]=H[4],C=H[5],we=H[6],ve=H[7],Re=`shading${Z++}`,[_e,ge,ie,fe]=o.Util.normalizeRect([...o.Util.applyTransform([E,W],g),...o.Util.applyTransform([v,D],g)]),[re,Y]=o.Util.singularValueDecompose2dScale(g),I=C*re,S=we*Y,ee=this.svgFactory.createElement("svg:pattern");ee.setAttributeNS(null,"id",Re),ee.setAttributeNS(null,"patternUnits","userSpaceOnUse"),ee.setAttributeNS(null,"width",I),ee.setAttributeNS(null,"height",S),ee.setAttributeNS(null,"x",`${_e}`),ee.setAttributeNS(null,"y",`${ge}`);const le=this.svg,ce=this.transformMatrix,he=this.current.fillColor,Ee=this.current.strokeColor,be=this.svgFactory.create(ie-_e,fe-ge);if(this.svg=be,this.transformMatrix=g,ve===2){const Be=o.Util.makeHexColor(...J);this.current.fillColor=Be,this.current.strokeColor=Be}return this.executeOpTree(this.convertOpList(y)),this.svg=le,this.transformMatrix=ce,this.current.fillColor=he,this.current.strokeColor=Ee,ee.append(be.childNodes[0]),this.defs.append(ee),`url(#${Re})`}_makeShadingPattern(H){switch(typeof H=="string"&&(H=this.objs.get(H)),H[0]){case"RadialAxial":const J=`shading${Z++}`,y=H[3];let g;switch(H[1]){case"axial":const E=H[4],W=H[5];g=this.svgFactory.createElement("svg:linearGradient"),g.setAttributeNS(null,"id",J),g.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),g.setAttributeNS(null,"x1",E[0]),g.setAttributeNS(null,"y1",E[1]),g.setAttributeNS(null,"x2",W[0]),g.setAttributeNS(null,"y2",W[1]);break;case"radial":const v=H[4],D=H[5],C=H[6],we=H[7];g=this.svgFactory.createElement("svg:radialGradient"),g.setAttributeNS(null,"id",J),g.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),g.setAttributeNS(null,"cx",D[0]),g.setAttributeNS(null,"cy",D[1]),g.setAttributeNS(null,"r",we),g.setAttributeNS(null,"fx",v[0]),g.setAttributeNS(null,"fy",v[1]),g.setAttributeNS(null,"fr",C);break;default:throw new Error(`Unknown RadialAxial type: ${H[1]}`)}for(const E of y){const W=this.svgFactory.createElement("svg:stop");W.setAttributeNS(null,"offset",E[0]),W.setAttributeNS(null,"stop-color",E[1]),g.append(W)}return this.defs.append(g),`url(#${J})`;case"Mesh":return(0,o.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${H[0]}`)}}setDash(H,J){this.current.dashArray=H,this.current.dashPhase=J}constructPath(H,J){const y=this.current;let g=y.x,E=y.y,W=[],v=0;for(const D of H)switch(D|0){case o.OPS.rectangle:g=J[v++],E=J[v++];const C=J[v++],we=J[v++],ve=g+C,Re=E+we;W.push("M",U(g),U(E),"L",U(ve),U(E),"L",U(ve),U(Re),"L",U(g),U(Re),"Z");break;case o.OPS.moveTo:g=J[v++],E=J[v++],W.push("M",U(g),U(E));break;case o.OPS.lineTo:g=J[v++],E=J[v++],W.push("L",U(g),U(E));break;case o.OPS.curveTo:g=J[v+4],E=J[v+5],W.push("C",U(J[v]),U(J[v+1]),U(J[v+2]),U(J[v+3]),U(g),U(E)),v+=6;break;case o.OPS.curveTo2:W.push("C",U(g),U(E),U(J[v]),U(J[v+1]),U(J[v+2]),U(J[v+3])),g=J[v+2],E=J[v+3],v+=4;break;case o.OPS.curveTo3:g=J[v+2],E=J[v+3],W.push("C",U(J[v]),U(J[v+1]),U(g),U(E),U(g),U(E)),v+=4;break;case o.OPS.closePath:W.push("Z");break}W=W.join(" "),y.path&&H.length>0&&H[0]!==o.OPS.rectangle&&H[0]!==o.OPS.moveTo?W=y.path.getAttributeNS(null,"d")+W:(y.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(y.path)),y.path.setAttributeNS(null,"d",W),y.path.setAttributeNS(null,"fill","none"),y.element=y.path,y.setCurrentPoint(g,E)}endPath(){const H=this.current;if(H.path=null,!this.pendingClip)return;if(!H.element){this.pendingClip=null;return}const J=`clippath${b++}`,y=this.svgFactory.createElement("svg:clipPath");y.setAttributeNS(null,"id",J),y.setAttributeNS(null,"transform",X(this.transformMatrix));const g=H.element.cloneNode(!0);if(this.pendingClip==="evenodd"?g.setAttributeNS(null,"clip-rule","evenodd"):g.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,y.append(g),this.defs.append(y),H.activeClipUrl){H.clipGroup=null;for(const E of this.extraStack)E.clipGroup=null;y.setAttributeNS(null,"clip-path",H.activeClipUrl)}H.activeClipUrl=`url(#${J})`,this.tgrp=null}clip(H){this.pendingClip=H}closePath(){const H=this.current;if(H.path){const J=`${H.path.getAttributeNS(null,"d")}Z`;H.path.setAttributeNS(null,"d",J)}}setLeading(H){this.current.leading=-H}setTextRise(H){this.current.textRise=H}setTextRenderingMode(H){this.current.textRenderingMode=H}setHScale(H){this.current.textHScale=H/100}setRenderingIntent(H){}setFlatness(H){}setGState(H){for(const[J,y]of H)switch(J){case"LW":this.setLineWidth(y);break;case"LC":this.setLineCap(y);break;case"LJ":this.setLineJoin(y);break;case"ML":this.setMiterLimit(y);break;case"D":this.setDash(y[0],y[1]);break;case"RI":this.setRenderingIntent(y);break;case"FL":this.setFlatness(y);break;case"Font":this.setFont(y);break;case"CA":this.setStrokeAlpha(y);break;case"ca":this.setFillAlpha(y);break;default:(0,o.warn)(`Unimplemented graphic state operator ${J}`);break}}fill(){const H=this.current;H.element&&(H.element.setAttributeNS(null,"fill",H.fillColor),H.element.setAttributeNS(null,"fill-opacity",H.fillAlpha),this.endPath())}stroke(){const H=this.current;H.element&&(this._setStrokeAttributes(H.element),H.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(H,J=1){const y=this.current;let g=y.dashArray;J!==1&&g.length>0&&(g=g.map(function(E){return J*E})),H.setAttributeNS(null,"stroke",y.strokeColor),H.setAttributeNS(null,"stroke-opacity",y.strokeAlpha),H.setAttributeNS(null,"stroke-miterlimit",U(y.miterLimit)),H.setAttributeNS(null,"stroke-linecap",y.lineCap),H.setAttributeNS(null,"stroke-linejoin",y.lineJoin),H.setAttributeNS(null,"stroke-width",U(J*y.lineWidth)+"px"),H.setAttributeNS(null,"stroke-dasharray",g.map(U).join(" ")),H.setAttributeNS(null,"stroke-dashoffset",U(J*y.dashPhase)+"px")}eoFill(){var H;(H=this.current.element)==null||H.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var H;(H=this.current.element)==null||H.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const H=this.svgFactory.createElement("svg:rect");H.setAttributeNS(null,"x","0"),H.setAttributeNS(null,"y","0"),H.setAttributeNS(null,"width","1px"),H.setAttributeNS(null,"height","1px"),H.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(H)}paintImageXObject(H){const J=this.getObject(H);if(!J){(0,o.warn)(`Dependent image with object ID ${H} is not ready yet`);return}this.paintInlineImageXObject(J)}paintInlineImageXObject(H,J){const y=H.width,g=H.height,E=R(H,this.forceDataSchema,!!J),W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y","0"),W.setAttributeNS(null,"width",U(y)),W.setAttributeNS(null,"height",U(g)),this.current.element=W,this.clip("nonzero");const v=this.svgFactory.createElement("svg:image");v.setAttributeNS(f,"xlink:href",E),v.setAttributeNS(null,"x","0"),v.setAttributeNS(null,"y",U(-g)),v.setAttributeNS(null,"width",U(y)+"px"),v.setAttributeNS(null,"height",U(g)+"px"),v.setAttributeNS(null,"transform",`scale(${U(1/y)} ${U(-1/g)})`),J?J.append(v):this._ensureTransformGroup().append(v)}paintImageMaskXObject(H){const J=this.getObject(H.data,H);if(J.bitmap){(0,o.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const y=this.current,g=J.width,E=J.height,W=y.fillColor;y.maskId=`mask${K++}`;const v=this.svgFactory.createElement("svg:mask");v.setAttributeNS(null,"id",y.maskId);const D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",U(g)),D.setAttributeNS(null,"height",U(E)),D.setAttributeNS(null,"fill",W),D.setAttributeNS(null,"mask",`url(#${y.maskId})`),this.defs.append(v),this._ensureTransformGroup().append(D),this.paintInlineImageXObject(J,v)}paintFormXObjectBegin(H,J){if(Array.isArray(H)&&H.length===6&&this.transform(H[0],H[1],H[2],H[3],H[4],H[5]),J){const y=J[2]-J[0],g=J[3]-J[1],E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x",J[0]),E.setAttributeNS(null,"y",J[1]),E.setAttributeNS(null,"width",U(y)),E.setAttributeNS(null,"height",U(g)),this.current.element=E,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(H){const J=this.svgFactory.create(H.width,H.height),y=this.svgFactory.createElement("svg:defs");J.append(y),this.defs=y;const g=this.svgFactory.createElement("svg:g");return g.setAttributeNS(null,"transform",X(H.transform)),J.append(g),this.svg=g,J}_ensureClipGroup(){if(!this.current.clipGroup){const H=this.svgFactory.createElement("svg:g");H.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(H),this.current.clipGroup=H}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",X(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=oe},(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class t{static textContent(o){const a=[],u={items:a,styles:Object.create(null)};function f(d){var R;if(!d)return;let p=null;const _=d.name;if(_==="#text")p=d.value;else if(t.shouldBuildText(_))(R=d==null?void 0:d.attributes)!=null&&R.textContent?p=d.attributes.textContent:d.value&&(p=d.value);else return;if(p!==null&&a.push({str:p}),!!d.children)for(const w of d.children)f(w)}return f(o),u}static shouldBuildText(o){return!(o==="textarea"||o==="input"||o==="option"||o==="select")}}e.XfaText=t},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=X,e.updateTextLayer=b;var i=t(1),o=t(6);const a=1e5,u=30,f=.8,d=new Map;function p(K,Z){let oe;if(Z&&i.FeatureTest.isOffscreenCanvasSupported)oe=new OffscreenCanvas(K,K).getContext("2d",{alpha:!1});else{const te=document.createElement("canvas");te.width=te.height=K,oe=te.getContext("2d",{alpha:!1})}return oe}function _(K,Z){const oe=d.get(K);if(oe)return oe;const te=p(u,Z);te.font=`${u}px ${K}`;const H=te.measureText("");let J=H.fontBoundingBoxAscent,y=Math.abs(H.fontBoundingBoxDescent);if(J){const E=J/(J+y);return d.set(K,E),te.canvas.width=te.canvas.height=0,E}te.strokeStyle="red",te.clearRect(0,0,u,u),te.strokeText("g",0,0);let g=te.getImageData(0,0,u,u).data;y=0;for(let E=g.length-1-3;E>=0;E-=4)if(g[E]>0){y=Math.ceil(E/4/u);break}te.clearRect(0,0,u,u),te.strokeText("A",0,u),g=te.getImageData(0,0,u,u).data,J=0;for(let E=0,W=g.length;E<W;E+=4)if(g[E]>0){J=u-Math.floor(E/4/u);break}if(te.canvas.width=te.canvas.height=0,J){const E=J/(J+y);return d.set(K,E),E}return d.set(K,f),f}function R(K,Z,oe){const te=document.createElement("span"),H={angle:0,canvasWidth:0,hasText:Z.str!=="",hasEOL:Z.hasEOL,fontSize:0};K._textDivs.push(te);const J=i.Util.transform(K._transform,Z.transform);let y=Math.atan2(J[1],J[0]);const g=oe[Z.fontName];g.vertical&&(y+=Math.PI/2);const E=Math.hypot(J[2],J[3]),W=E*_(g.fontFamily,K._isOffscreenCanvasSupported);let v,D;y===0?(v=J[4],D=J[5]-W):(v=J[4]+W*Math.sin(y),D=J[5]-W*Math.cos(y));const C="calc(var(--scale-factor)*",we=te.style;K._container===K._rootContainer?(we.left=`${(100*v/K._pageWidth).toFixed(2)}%`,we.top=`${(100*D/K._pageHeight).toFixed(2)}%`):(we.left=`${C}${v.toFixed(2)}px)`,we.top=`${C}${D.toFixed(2)}px)`),we.fontSize=`${C}${E.toFixed(2)}px)`,we.fontFamily=g.fontFamily,H.fontSize=E,te.setAttribute("role","presentation"),te.textContent=Z.str,te.dir=Z.dir,K._fontInspectorEnabled&&(te.dataset.fontName=Z.fontName),y!==0&&(H.angle=y*(180/Math.PI));let ve=!1;if(Z.str.length>1)ve=!0;else if(Z.str!==" "&&Z.transform[0]!==Z.transform[3]){const Re=Math.abs(Z.transform[0]),_e=Math.abs(Z.transform[3]);Re!==_e&&Math.max(Re,_e)/Math.min(Re,_e)>1.5&&(ve=!0)}ve&&(H.canvasWidth=g.vertical?Z.height:Z.width),K._textDivProperties.set(te,H),K._isReadableStream&&K._layoutText(te)}function w(K){const{div:Z,scale:oe,properties:te,ctx:H,prevFontSize:J,prevFontFamily:y}=K,{style:g}=Z;let E="";if(te.canvasWidth!==0&&te.hasText){const{fontFamily:W}=g,{canvasWidth:v,fontSize:D}=te;(J!==D||y!==W)&&(H.font=`${D*oe}px ${W}`,K.prevFontSize=D,K.prevFontFamily=W);const{width:C}=H.measureText(Z.textContent);C>0&&(E=`scaleX(${v*oe/C})`)}te.angle!==0&&(E=`rotate(${te.angle}deg) ${E}`),E.length>0&&(g.transform=E)}function V(K){if(K._canceled)return;const Z=K._textDivs,oe=K._capability;if(Z.length>a){oe.resolve();return}if(!K._isReadableStream)for(const H of Z)K._layoutText(H);oe.resolve()}class U{constructor({textContentSource:Z,container:oe,viewport:te,textDivs:H,textDivProperties:J,textContentItemsStr:y,isOffscreenCanvasSupported:g}){var C;this._textContentSource=Z,this._isReadableStream=Z instanceof ReadableStream,this._container=this._rootContainer=oe,this._textDivs=H||[],this._textContentItemsStr=y||[],this._isOffscreenCanvasSupported=g,this._fontInspectorEnabled=!!((C=globalThis.FontInspector)!=null&&C.enabled),this._reader=null,this._textDivProperties=J||new WeakMap,this._canceled=!1,this._capability=new i.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:te.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:p(0,g)};const{pageWidth:E,pageHeight:W,pageX:v,pageY:D}=te.rawDims;this._transform=[1,0,0,-1,-v,D+W],this._pageWidth=E,this._pageHeight=W,(0,o.setLayerDimensions)(oe,te),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new i.AbortException("TextLayer task cancelled."))}_processItems(Z,oe){for(const te of Z){if(te.str===void 0){if(te.type==="beginMarkedContentProps"||te.type==="beginMarkedContent"){const H=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),te.id!==null&&this._container.setAttribute("id",`${te.id}`),H.append(this._container)}else te.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(te.str),R(this,te,oe)}}_layoutText(Z){const oe=this._layoutTextParams.properties=this._textDivProperties.get(Z);if(this._layoutTextParams.div=Z,w(this._layoutTextParams),oe.hasText&&this._container.append(Z),oe.hasEOL){const te=document.createElement("br");te.setAttribute("role","presentation"),this._container.append(te)}}_render(){const Z=new i.PromiseCapability;let oe=Object.create(null);if(this._isReadableStream){const te=()=>{this._reader.read().then(({value:H,done:J})=>{if(J){Z.resolve();return}Object.assign(oe,H.styles),this._processItems(H.items,oe),te()},Z.reject)};this._reader=this._textContentSource.getReader(),te()}else if(this._textContentSource){const{items:te,styles:H}=this._textContentSource;this._processItems(te,H),Z.resolve()}else throw new Error('No "textContentSource" parameter specified.');Z.promise.then(()=>{oe=null,V(this)},this._capability.reject)}}e.TextLayerRenderTask=U;function X(K){!K.textContentSource&&(K.textContent||K.textContentStream)&&((0,o.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),K.textContentSource=K.textContent||K.textContentStream);const{container:Z,viewport:oe}=K,te=getComputedStyle(Z),H=te.getPropertyValue("visibility"),J=parseFloat(te.getPropertyValue("--scale-factor"));H==="visible"&&(!J||Math.abs(J-oe.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const y=new U(K);return y._render(),y}function b({container:K,viewport:Z,textDivs:oe,textDivProperties:te,isOffscreenCanvasSupported:H,mustRotate:J=!0,mustRescale:y=!0}){if(J&&(0,o.setLayerDimensions)(K,{rotation:Z.rotation}),y){const g=p(0,H),W={prevFontSize:null,prevFontFamily:null,div:null,scale:Z.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:g};for(const v of oe)W.properties=te.get(v),W.div=v,w(W)}}},(n,e,t)=>{var _,R,w,V,U,X,b,K,Z,oe,te,nc,sl,rc,ic;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var i=t(1),o=t(4),a=t(28),u=t(33),f=t(6),d=t(34);const E=class E{constructor({uiManager:v,pageIndex:D,div:C,accessibilityManager:we,annotationLayer:ve,viewport:Re,l10n:_e}){Fe(this,te);Fe(this,_);Fe(this,R,!1);Fe(this,w,null);Fe(this,V,this.pointerup.bind(this));Fe(this,U,this.pointerdown.bind(this));Fe(this,X,new Map);Fe(this,b,!1);Fe(this,K,!1);Fe(this,Z,!1);Fe(this,oe);const ge=[a.FreeTextEditor,u.InkEditor,d.StampEditor];if(!E._initialized){E._initialized=!0;for(const ie of ge)ie.initialize(_e)}v.registerEditorTypes(ge),Oe(this,oe,v),this.pageIndex=D,this.div=C,Oe(this,_,we),Oe(this,w,ve),this.viewport=Re,T(this,oe).addLayer(this)}get isEmpty(){return T(this,X).size===0}updateToolbar(v){T(this,oe).updateToolbar(v)}updateMode(v=T(this,oe).getMode()){Pe(this,te,ic).call(this),v===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),v!==i.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",v===i.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",v===i.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",v===i.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(v){if(!v&&T(this,oe).getMode()!==i.AnnotationEditorType.INK)return;if(!v){for(const C of T(this,X).values())if(C.isEmpty()){C.setInBackground();return}}Pe(this,te,sl).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(v){T(this,oe).setEditingState(v)}addCommands(v){T(this,oe).addCommands(v)}enable(){this.div.style.pointerEvents="auto";const v=new Set;for(const C of T(this,X).values())C.enableEditing(),C.annotationElementId&&v.add(C.annotationElementId);if(!T(this,w))return;const D=T(this,w).getEditableAnnotations();for(const C of D){if(C.hide(),T(this,oe).isDeletedAnnotationElement(C.data.id)||v.has(C.data.id))continue;const we=this.deserialize(C);we&&(this.addOrRebuild(we),we.enableEditing())}}disable(){var D;Oe(this,Z,!0),this.div.style.pointerEvents="none";const v=new Set;for(const C of T(this,X).values()){if(C.disableEditing(),!C.annotationElementId||C.serialize()!==null){v.add(C.annotationElementId);continue}(D=this.getEditableAnnotation(C.annotationElementId))==null||D.show(),C.remove()}if(T(this,w)){const C=T(this,w).getEditableAnnotations();for(const we of C){const{id:ve}=we.data;v.has(ve)||T(this,oe).isDeletedAnnotationElement(ve)||we.show()}}Pe(this,te,ic).call(this),this.isEmpty&&(this.div.hidden=!0),Oe(this,Z,!1)}getEditableAnnotation(v){var D;return((D=T(this,w))==null?void 0:D.getEditableAnnotation(v))||null}setActiveEditor(v){T(this,oe).getActive()!==v&&T(this,oe).setActiveEditor(v)}enableClick(){this.div.addEventListener("pointerdown",T(this,U)),this.div.addEventListener("pointerup",T(this,V))}disableClick(){this.div.removeEventListener("pointerdown",T(this,U)),this.div.removeEventListener("pointerup",T(this,V))}attach(v){T(this,X).set(v.id,v);const{annotationElementId:D}=v;D&&T(this,oe).isDeletedAnnotationElement(D)&&T(this,oe).removeDeletedAnnotationElement(v)}detach(v){var D;T(this,X).delete(v.id),(D=T(this,_))==null||D.removePointerInTextLayer(v.contentDiv),!T(this,Z)&&v.annotationElementId&&T(this,oe).addDeletedAnnotationElement(v)}remove(v){this.detach(v),T(this,oe).removeEditor(v),v.div.contains(document.activeElement)&&setTimeout(()=>{T(this,oe).focusMainContainer()},0),v.div.remove(),v.isAttachedToDOM=!1,T(this,K)||this.addInkEditorIfNeeded(!1)}changeParent(v){var D;v.parent!==this&&(v.annotationElementId&&(T(this,oe).addDeletedAnnotationElement(v.annotationElementId),o.AnnotationEditor.deleteAnnotationElement(v),v.annotationElementId=null),this.attach(v),(D=v.parent)==null||D.detach(v),v.setParent(this),v.div&&v.isAttachedToDOM&&(v.div.remove(),this.div.append(v.div)))}add(v){if(this.changeParent(v),T(this,oe).addEditor(v),this.attach(v),!v.isAttachedToDOM){const D=v.render();this.div.append(D),v.isAttachedToDOM=!0}v.fixAndSetPosition(),v.onceAdded(),T(this,oe).addToAnnotationStorage(v)}moveEditorInDOM(v){var C;if(!v.isAttachedToDOM)return;const{activeElement:D}=document;v.div.contains(D)&&(v._focusEventsAllowed=!1,setTimeout(()=>{v.div.contains(document.activeElement)?v._focusEventsAllowed=!0:(v.div.addEventListener("focusin",()=>{v._focusEventsAllowed=!0},{once:!0}),D.focus())},0)),v._structTreeParentId=(C=T(this,_))==null?void 0:C.moveElementInDOM(this.div,v.div,v.contentDiv,!0)}addOrRebuild(v){v.needsToBeRebuilt()?v.rebuild():this.add(v)}addUndoableEditor(v){const D=()=>v._uiManager.rebuild(v),C=()=>{v.remove()};this.addCommands({cmd:D,undo:C,mustExec:!1})}getNextId(){return T(this,oe).getId()}pasteEditor(v,D){T(this,oe).updateToolbar(v),T(this,oe).updateMode(v);const{offsetX:C,offsetY:we}=Pe(this,te,rc).call(this),ve=this.getNextId(),Re=Pe(this,te,nc).call(this,{parent:this,id:ve,x:C,y:we,uiManager:T(this,oe),isCentered:!0,...D});Re&&this.add(Re)}deserialize(v){switch(v.annotationType??v.annotationEditorType){case i.AnnotationEditorType.FREETEXT:return a.FreeTextEditor.deserialize(v,this,T(this,oe));case i.AnnotationEditorType.INK:return u.InkEditor.deserialize(v,this,T(this,oe));case i.AnnotationEditorType.STAMP:return d.StampEditor.deserialize(v,this,T(this,oe))}return null}addNewEditor(){Pe(this,te,sl).call(this,Pe(this,te,rc).call(this),!0)}setSelected(v){T(this,oe).setSelected(v)}toggleSelected(v){T(this,oe).toggleSelected(v)}isSelected(v){return T(this,oe).isSelected(v)}unselect(v){T(this,oe).unselect(v)}pointerup(v){const{isMac:D}=i.FeatureTest.platform;if(!(v.button!==0||v.ctrlKey&&D)&&v.target===this.div&&T(this,b)){if(Oe(this,b,!1),!T(this,R)){Oe(this,R,!0);return}if(T(this,oe).getMode()===i.AnnotationEditorType.STAMP){T(this,oe).unselectAll();return}Pe(this,te,sl).call(this,v,!1)}}pointerdown(v){if(T(this,b)){Oe(this,b,!1);return}const{isMac:D}=i.FeatureTest.platform;if(v.button!==0||v.ctrlKey&&D||v.target!==this.div)return;Oe(this,b,!0);const C=T(this,oe).getActive();Oe(this,R,!C||C.isEmpty())}findNewParent(v,D,C){const we=T(this,oe).findParent(D,C);return we===null||we===this?!1:(we.changeParent(v),!0)}destroy(){var v,D;((v=T(this,oe).getActive())==null?void 0:v.parent)===this&&(T(this,oe).commitOrRemove(),T(this,oe).setActiveEditor(null));for(const C of T(this,X).values())(D=T(this,_))==null||D.removePointerInTextLayer(C.contentDiv),C.setParent(null),C.isAttachedToDOM=!1,C.div.remove();this.div=null,T(this,X).clear(),T(this,oe).removeLayer(this)}render({viewport:v}){this.viewport=v,(0,f.setLayerDimensions)(this.div,v);for(const D of T(this,oe).getEditors(this.pageIndex))this.add(D);this.updateMode()}update({viewport:v}){T(this,oe).commitOrRemove(),this.viewport=v,(0,f.setLayerDimensions)(this.div,{rotation:v.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:v,pageHeight:D}=this.viewport.rawDims;return[v,D]}};_=new WeakMap,R=new WeakMap,w=new WeakMap,V=new WeakMap,U=new WeakMap,X=new WeakMap,b=new WeakMap,K=new WeakMap,Z=new WeakMap,oe=new WeakMap,te=new WeakSet,nc=function(v){switch(T(this,oe).getMode()){case i.AnnotationEditorType.FREETEXT:return new a.FreeTextEditor(v);case i.AnnotationEditorType.INK:return new u.InkEditor(v);case i.AnnotationEditorType.STAMP:return new d.StampEditor(v)}return null},sl=function(v,D){const C=this.getNextId(),we=Pe(this,te,nc).call(this,{parent:this,id:C,x:v.offsetX,y:v.offsetY,uiManager:T(this,oe),isCentered:D});return we&&this.add(we),we},rc=function(){const{x:v,y:D,width:C,height:we}=this.div.getBoundingClientRect(),ve=Math.max(0,v),Re=Math.max(0,D),_e=Math.min(window.innerWidth,v+C),ge=Math.min(window.innerHeight,D+we),ie=(ve+_e)/2-v,fe=(Re+ge)/2-D,[re,Y]=this.viewport.rotation%180===0?[ie,fe]:[fe,ie];return{offsetX:re,offsetY:Y}},ic=function(){Oe(this,K,!0);for(const v of T(this,X).values())v.isEmpty()&&v.remove();Oe(this,K,!1)},Un(E,"_initialized",!1);let p=E;e.AnnotationEditorLayer=p},(n,e,t)=>{var d,p,_,R,w,V,U,X,b,K,Od,Ld,Ud,Uo,sc,jd,oc;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var i=t(1),o=t(5),a=t(4),u=t(29);const E=class E extends a.AnnotationEditor{constructor(D){super({...D,name:"freeTextEditor"});Fe(this,K);Fe(this,d,this.editorDivBlur.bind(this));Fe(this,p,this.editorDivFocus.bind(this));Fe(this,_,this.editorDivInput.bind(this));Fe(this,R,this.editorDivKeydown.bind(this));Fe(this,w);Fe(this,V,"");Fe(this,U,`${this.id}-editor`);Fe(this,X);Fe(this,b,null);Oe(this,w,D.color||E._defaultColor||a.AnnotationEditor._defaultLineColor),Oe(this,X,D.fontSize||E._defaultFontSize)}static get _keyboardManager(){const D=E.prototype,C=Re=>Re.isEmpty(),we=o.AnnotationEditorUIManager.TRANSLATE_SMALL,ve=o.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new o.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],D.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],D.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],D._translateEmpty,{args:[-we,0],checker:C}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],D._translateEmpty,{args:[-ve,0],checker:C}],[["ArrowRight","mac+ArrowRight"],D._translateEmpty,{args:[we,0],checker:C}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],D._translateEmpty,{args:[ve,0],checker:C}],[["ArrowUp","mac+ArrowUp"],D._translateEmpty,{args:[0,-we],checker:C}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],D._translateEmpty,{args:[0,-ve],checker:C}],[["ArrowDown","mac+ArrowDown"],D._translateEmpty,{args:[0,we],checker:C}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],D._translateEmpty,{args:[0,ve],checker:C}]]))}static initialize(D){a.AnnotationEditor.initialize(D,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const C=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(C.getPropertyValue("--freetext-padding"))}static updateDefaultParams(D,C){switch(D){case i.AnnotationEditorParamsType.FREETEXT_SIZE:E._defaultFontSize=C;break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:E._defaultColor=C;break}}updateParams(D,C){switch(D){case i.AnnotationEditorParamsType.FREETEXT_SIZE:Pe(this,K,Od).call(this,C);break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:Pe(this,K,Ld).call(this,C);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,E._defaultFontSize],[i.AnnotationEditorParamsType.FREETEXT_COLOR,E._defaultColor||a.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,T(this,X)],[i.AnnotationEditorParamsType.FREETEXT_COLOR,T(this,w)]]}_translateEmpty(D,C){this._uiManager.translateSelectedEditors(D,C,!0)}getInitialTranslation(){const D=this.parentScale;return[-E._internalPadding*D,-(E._internalPadding+T(this,X))*D]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(i.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",T(this,R)),this.editorDiv.addEventListener("focus",T(this,p)),this.editorDiv.addEventListener("blur",T(this,d)),this.editorDiv.addEventListener("input",T(this,_)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",T(this,U)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",T(this,R)),this.editorDiv.removeEventListener("focus",T(this,p)),this.editorDiv.removeEventListener("blur",T(this,d)),this.editorDiv.removeEventListener("input",T(this,_)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(D){this._focusEventsAllowed&&(super.focusin(D),D.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var D;if(this.width){Pe(this,K,oc).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(D=this._initialOptions)!=null&&D.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const D=T(this,V),C=Oe(this,V,Pe(this,K,Ud).call(this).trimEnd());if(D===C)return;const we=ve=>{if(Oe(this,V,ve),!ve){this.remove();return}Pe(this,K,sc).call(this),this._uiManager.rebuild(this),Pe(this,K,Uo).call(this)};this.addCommands({cmd:()=>{we(C)},undo:()=>{we(D)},mustExec:!1}),Pe(this,K,Uo).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(D){this.enterInEditMode()}keydown(D){D.target===this.div&&D.key==="Enter"&&(this.enterInEditMode(),D.preventDefault())}editorDivKeydown(D){E._keyboardManager.exec(this,D)}editorDivFocus(D){this.isEditing=!0}editorDivBlur(D){this.isEditing=!1}editorDivInput(D){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let D,C;this.width&&(D=this.x,C=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",T(this,U)),this.enableEditing(),a.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(ve=>{var Re;return(Re=this.editorDiv)==null?void 0:Re.setAttribute("aria-label",ve)}),a.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(ve=>{var Re;return(Re=this.editorDiv)==null?void 0:Re.setAttribute("default-content",ve)}),this.editorDiv.contentEditable=!0;const{style:we}=this.editorDiv;if(we.fontSize=`calc(${T(this,X)}px * var(--scale-factor))`,we.color=T(this,w),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,o.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ve,Re]=this.parentDimensions;if(this.annotationElementId){const{position:_e}=T(this,b);let[ge,ie]=this.getInitialTranslation();[ge,ie]=this.pageTranslationToScreen(ge,ie);const[fe,re]=this.pageDimensions,[Y,I]=this.pageTranslation;let S,ee;switch(this.rotation){case 0:S=D+(_e[0]-Y)/fe,ee=C+this.height-(_e[1]-I)/re;break;case 90:S=D+(_e[0]-Y)/fe,ee=C-(_e[1]-I)/re,[ge,ie]=[ie,-ge];break;case 180:S=D-this.width+(_e[0]-Y)/fe,ee=C-(_e[1]-I)/re,[ge,ie]=[-ge,-ie];break;case 270:S=D+(_e[0]-Y-this.height*re)/fe,ee=C+(_e[1]-I-this.width*fe)/re,[ge,ie]=[-ie,ge];break}this.setAt(S*ve,ee*Re,ge,ie)}else this.setAt(D*ve,C*Re,this.width*ve,this.height*Re);Pe(this,K,sc).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(D,C,we){let ve=null;if(D instanceof u.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:_e,fontColor:ge},rect:ie,rotation:fe,id:re},textContent:Y,textPosition:I,parent:{page:{pageNumber:S}}}=D;if(!Y||Y.length===0)return null;ve=D={annotationType:i.AnnotationEditorType.FREETEXT,color:Array.from(ge),fontSize:_e,value:Y.join(`
`),position:I,pageIndex:S-1,rect:ie,rotation:fe,id:re,deleted:!1}}const Re=super.deserialize(D,C,we);return Oe(Re,X,D.fontSize),Oe(Re,w,i.Util.makeHexColor(...D.color)),Oe(Re,V,D.value),Re.annotationElementId=D.id||null,Oe(Re,b,ve),Re}serialize(D=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const C=E._internalPadding*this.parentScale,we=this.getRect(C,C),ve=a.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:T(this,w)),Re={annotationType:i.AnnotationEditorType.FREETEXT,color:ve,fontSize:T(this,X),value:T(this,V),pageIndex:this.pageIndex,rect:we,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return D?Re:this.annotationElementId&&!Pe(this,K,jd).call(this,Re)?null:(Re.id=this.annotationElementId,Re)}};d=new WeakMap,p=new WeakMap,_=new WeakMap,R=new WeakMap,w=new WeakMap,V=new WeakMap,U=new WeakMap,X=new WeakMap,b=new WeakMap,K=new WeakSet,Od=function(D){const C=ve=>{this.editorDiv.style.fontSize=`calc(${ve}px * var(--scale-factor))`,this.translate(0,-(ve-T(this,X))*this.parentScale),Oe(this,X,ve),Pe(this,K,Uo).call(this)},we=T(this,X);this.addCommands({cmd:()=>{C(D)},undo:()=>{C(we)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ld=function(D){const C=T(this,w);this.addCommands({cmd:()=>{Oe(this,w,this.editorDiv.style.color=D)},undo:()=>{Oe(this,w,this.editorDiv.style.color=C)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ud=function(){const D=this.editorDiv.getElementsByTagName("div");if(D.length===0)return this.editorDiv.innerText;const C=[];for(const we of D)C.push(we.innerText.replace(/\r\n?|\n/,""));return C.join(`
`)},Uo=function(){const[D,C]=this.parentDimensions;let we;if(this.isAttachedToDOM)we=this.div.getBoundingClientRect();else{const{currentLayer:ve,div:Re}=this,_e=Re.style.display;Re.style.display="hidden",ve.div.append(this.div),we=Re.getBoundingClientRect(),Re.remove(),Re.style.display=_e}this.rotation%180===this.parentRotation%180?(this.width=we.width/D,this.height=we.height/C):(this.width=we.height/D,this.height=we.width/C),this.fixAndSetPosition()},sc=function(){if(this.editorDiv.replaceChildren(),!!T(this,V))for(const D of T(this,V).split(`
`)){const C=document.createElement("div");C.append(D?document.createTextNode(D):document.createElement("br")),this.editorDiv.append(C)}},jd=function(D){const{value:C,fontSize:we,color:ve,rect:Re,pageIndex:_e}=T(this,b);return D.value!==C||D.fontSize!==we||D.rect.some((ge,ie)=>Math.abs(ge-Re[ie])>=1)||D.color.some((ge,ie)=>ge!==ve[ie])||D.pageIndex!==_e},oc=function(D=!1){if(!this.annotationElementId)return;if(Pe(this,K,Uo).call(this),!D&&(this.width===0||this.height===0)){setTimeout(()=>Pe(this,K,oc).call(this,!0),0);return}const C=E._internalPadding*this.parentScale;T(this,b).rect=this.getRect(C,C)},Un(E,"_freeTextDefaultContent",""),Un(E,"_internalPadding",0),Un(E,"_defaultColor",null),Un(E,"_defaultFontSize",10),Un(E,"_type","freetext");let f=E;e.FreeTextEditor=f},(n,e,t)=>{var ee,ce,_s,Bd,be,Be,ze,Ke,Xe,Ze,xe,De,se,me,Te,Ce,$e,et,Qe,Se,rt,nt,zd,ol,ac,lc,hn,bn,kn,Ye,Ve,Ne,Dt,uc,Pn,pe,We,pt,Wd,cc;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var i=t(1),o=t(6),a=t(3),u=t(30),f=t(31),d=t(32);const p=1e3,_=9,R=new WeakSet;function w(kt){return{width:kt[2]-kt[0],height:kt[3]-kt[1]}}class V{static create(de){switch(de.data.annotationType){case i.AnnotationType.LINK:return new X(de);case i.AnnotationType.TEXT:return new b(de);case i.AnnotationType.WIDGET:switch(de.data.fieldType){case"Tx":return new Z(de);case"Btn":return de.data.radioButton?new H(de):de.data.checkBox?new te(de):new J(de);case"Ch":return new y(de);case"Sig":return new oe(de)}return new K(de);case i.AnnotationType.POPUP:return new g(de);case i.AnnotationType.FREETEXT:return new W(de);case i.AnnotationType.LINE:return new v(de);case i.AnnotationType.SQUARE:return new D(de);case i.AnnotationType.CIRCLE:return new C(de);case i.AnnotationType.POLYLINE:return new we(de);case i.AnnotationType.CARET:return new Re(de);case i.AnnotationType.INK:return new _e(de);case i.AnnotationType.POLYGON:return new ve(de);case i.AnnotationType.HIGHLIGHT:return new ge(de);case i.AnnotationType.UNDERLINE:return new ie(de);case i.AnnotationType.SQUIGGLY:return new fe(de);case i.AnnotationType.STRIKEOUT:return new re(de);case i.AnnotationType.STAMP:return new Y(de);case i.AnnotationType.FILEATTACHMENT:return new I(de);default:return new U(de)}}}const le=class le{constructor(de,{isRenderable:ae=!1,ignoreBorder:Ae=!1,createQuadrilaterals:Me=!1}={}){Fe(this,ee,!1);this.isRenderable=ae,this.data=de.data,this.layer=de.layer,this.linkService=de.linkService,this.downloadManager=de.downloadManager,this.imageResourcesPath=de.imageResourcesPath,this.renderForms=de.renderForms,this.svgFactory=de.svgFactory,this.annotationStorage=de.annotationStorage,this.enableScripting=de.enableScripting,this.hasJSActions=de.hasJSActions,this._fieldObjects=de.fieldObjects,this.parent=de.parent,ae&&(this.container=this._createContainer(Ae)),Me&&this._createQuadrilaterals()}static _hasPopupData({titleObj:de,contentsObj:ae,richText:Ae}){return!!(de!=null&&de.str||ae!=null&&ae.str||Ae!=null&&Ae.str)}get hasPopupData(){return le._hasPopupData(this.data)}_createContainer(de){const{data:ae,parent:{page:Ae,viewport:Me}}=this,Ue=document.createElement("section");Ue.setAttribute("data-annotation-id",ae.id),this instanceof K||(Ue.tabIndex=p),Ue.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Ue.setAttribute("aria-haspopup","dialog"),ae.noRotate&&Ue.classList.add("norotate");const{pageWidth:qe,pageHeight:tt,pageX:Wt,pageY:Bt}=Me.rawDims;if(!ae.rect||this instanceof g){const{rotation:gn}=ae;return!ae.hasOwnCanvas&&gn!==0&&this.setRotation(gn,Ue),Ue}const{width:Et,height:An}=w(ae.rect),Gt=i.Util.normalizeRect([ae.rect[0],Ae.view[3]-ae.rect[1]+Ae.view[1],ae.rect[2],Ae.view[3]-ae.rect[3]+Ae.view[1]]);if(!de&&ae.borderStyle.width>0){Ue.style.borderWidth=`${ae.borderStyle.width}px`;const gn=ae.borderStyle.horizontalCornerRadius,vn=ae.borderStyle.verticalCornerRadius;if(gn>0||vn>0){const Dn=`calc(${gn}px * var(--scale-factor)) / calc(${vn}px * var(--scale-factor))`;Ue.style.borderRadius=Dn}else if(this instanceof H){const Dn=`calc(${Et}px * var(--scale-factor)) / calc(${An}px * var(--scale-factor))`;Ue.style.borderRadius=Dn}switch(ae.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:Ue.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:Ue.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:Ue.style.borderBottomStyle="solid";break}const xn=ae.borderColor||null;xn?(Oe(this,ee,!0),Ue.style.borderColor=i.Util.makeHexColor(xn[0]|0,xn[1]|0,xn[2]|0)):Ue.style.borderWidth=0}Ue.style.left=`${100*(Gt[0]-Wt)/qe}%`,Ue.style.top=`${100*(Gt[1]-Bt)/tt}%`;const{rotation:Kt}=ae;return ae.hasOwnCanvas||Kt===0?(Ue.style.width=`${100*Et/qe}%`,Ue.style.height=`${100*An/tt}%`):this.setRotation(Kt,Ue),Ue}setRotation(de,ae=this.container){if(!this.data.rect)return;const{pageWidth:Ae,pageHeight:Me}=this.parent.viewport.rawDims,{width:Ue,height:qe}=w(this.data.rect);let tt,Wt;de%180===0?(tt=100*Ue/Ae,Wt=100*qe/Me):(tt=100*qe/Ae,Wt=100*Ue/Me),ae.style.width=`${tt}%`,ae.style.height=`${Wt}%`,ae.setAttribute("data-main-rotation",(360-de)%360)}get _commonActions(){const de=(ae,Ae,Me)=>{const Ue=Me.detail[ae],qe=Ue[0],tt=Ue.slice(1);Me.target.style[Ae]=u.ColorConverters[`${qe}_HTML`](tt),this.annotationStorage.setValue(this.data.id,{[Ae]:u.ColorConverters[`${qe}_rgb`](tt)})};return(0,i.shadow)(this,"_commonActions",{display:ae=>{const{display:Ae}=ae.detail,Me=Ae%2===1;this.container.style.visibility=Me?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Me,noPrint:Ae===1||Ae===2})},print:ae=>{this.annotationStorage.setValue(this.data.id,{noPrint:!ae.detail.print})},hidden:ae=>{const{hidden:Ae}=ae.detail;this.container.style.visibility=Ae?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Ae,noView:Ae})},focus:ae=>{setTimeout(()=>ae.target.focus({preventScroll:!1}),0)},userName:ae=>{ae.target.title=ae.detail.userName},readonly:ae=>{ae.target.disabled=ae.detail.readonly},required:ae=>{this._setRequired(ae.target,ae.detail.required)},bgColor:ae=>{de("bgColor","backgroundColor",ae)},fillColor:ae=>{de("fillColor","backgroundColor",ae)},fgColor:ae=>{de("fgColor","color",ae)},textColor:ae=>{de("textColor","color",ae)},borderColor:ae=>{de("borderColor","borderColor",ae)},strokeColor:ae=>{de("strokeColor","borderColor",ae)},rotation:ae=>{const Ae=ae.detail.rotation;this.setRotation(Ae),this.annotationStorage.setValue(this.data.id,{rotation:Ae})}})}_dispatchEventFromSandbox(de,ae){const Ae=this._commonActions;for(const Me of Object.keys(ae.detail)){const Ue=de[Me]||Ae[Me];Ue==null||Ue(ae)}}_setDefaultPropertiesFromJS(de){if(!this.enableScripting)return;const ae=this.annotationStorage.getRawValue(this.data.id);if(!ae)return;const Ae=this._commonActions;for(const[Me,Ue]of Object.entries(ae)){const qe=Ae[Me];if(qe){const tt={detail:{[Me]:Ue},target:de};qe(tt),delete ae[Me]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:de}=this.data;if(!de)return;const[ae,Ae,Me,Ue]=this.data.rect;if(de.length===1){const[,{x:vn,y:xn},{x:Dn,y:Gn}]=de[0];if(Me===vn&&Ue===xn&&ae===Dn&&Ae===Gn)return}const{style:qe}=this.container;let tt;if(T(this,ee)){const{borderColor:vn,borderWidth:xn}=qe;qe.borderWidth=0,tt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${vn}" stroke-width="${xn}">`],this.container.classList.add("hasBorder")}const Wt=Me-ae,Bt=Ue-Ae,{svgFactory:Et}=this,An=Et.createElement("svg");An.classList.add("quadrilateralsContainer"),An.setAttribute("width",0),An.setAttribute("height",0);const Gt=Et.createElement("defs");An.append(Gt);const Kt=Et.createElement("clipPath"),gn=`clippath_${this.data.id}`;Kt.setAttribute("id",gn),Kt.setAttribute("clipPathUnits","objectBoundingBox"),Gt.append(Kt);for(const[,{x:vn,y:xn},{x:Dn,y:Gn}]of de){const On=Et.createElement("rect"),hr=(Dn-ae)/Wt,_r=(Ue-xn)/Bt,Ar=(vn-Dn)/Wt,Xi=(xn-Gn)/Bt;On.setAttribute("x",hr),On.setAttribute("y",_r),On.setAttribute("width",Ar),On.setAttribute("height",Xi),Kt.append(On),tt==null||tt.push(`<rect vector-effect="non-scaling-stroke" x="${hr}" y="${_r}" width="${Ar}" height="${Xi}"/>`)}T(this,ee)&&(tt.push("</g></svg>')"),qe.backgroundImage=tt.join("")),this.container.append(An),this.container.style.clipPath=`url(#${gn})`}_createPopup(){const{container:de,data:ae}=this;de.setAttribute("aria-haspopup","dialog");const Ae=new g({data:{color:ae.color,titleObj:ae.titleObj,modificationDate:ae.modificationDate,contentsObj:ae.contentsObj,richText:ae.richText,parentRect:ae.rect,borderStyle:0,id:`popup_${ae.id}`,rotation:ae.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Ae.render())}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(de,ae=null){const Ae=[];if(this._fieldObjects){const Me=this._fieldObjects[de];if(Me)for(const{page:Ue,id:qe,exportValues:tt}of Me){if(Ue===-1||qe===ae)continue;const Wt=typeof tt=="string"?tt:null,Bt=document.querySelector(`[data-element-id="${qe}"]`);if(Bt&&!R.has(Bt)){(0,i.warn)(`_getElementsByName - element not allowed: ${qe}`);continue}Ae.push({id:qe,exportValue:Wt,domElement:Bt})}return Ae}for(const Me of document.getElementsByName(de)){const{exportValue:Ue}=Me,qe=Me.getAttribute("data-element-id");qe!==ae&&R.has(Me)&&Ae.push({id:qe,exportValue:Ue,domElement:Me})}return Ae}show(){var de;this.container&&(this.container.hidden=!1),(de=this.popup)==null||de.maybeShow()}hide(){var de;this.container&&(this.container.hidden=!0),(de=this.popup)==null||de.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const de=this.getElementsToTriggerPopup();if(Array.isArray(de))for(const ae of de)ae.classList.add("highlightArea");else de.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:de,data:{id:ae}}=this;this.container.addEventListener("dblclick",()=>{var Ae;(Ae=this.linkService.eventBus)==null||Ae.dispatch("switchannotationeditormode",{source:this,mode:de,editId:ae})})}};ee=new WeakMap;let U=le;class X extends U{constructor(ae,Ae=null){super(ae,{isRenderable:!0,ignoreBorder:!!(Ae!=null&&Ae.ignoreBorder),createQuadrilaterals:!0});Fe(this,ce);this.isTooltipOnly=ae.data.isTooltipOnly}render(){const{data:ae,linkService:Ae}=this,Me=document.createElement("a");Me.setAttribute("data-element-id",ae.id);let Ue=!1;return ae.url?(Ae.addLinkAttributes(Me,ae.url,ae.newWindow),Ue=!0):ae.action?(this._bindNamedAction(Me,ae.action),Ue=!0):ae.attachment?(this._bindAttachment(Me,ae.attachment),Ue=!0):ae.setOCGState?(Pe(this,ce,Bd).call(this,Me,ae.setOCGState),Ue=!0):ae.dest?(this._bindLink(Me,ae.dest),Ue=!0):(ae.actions&&(ae.actions.Action||ae.actions["Mouse Up"]||ae.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Me,ae),Ue=!0),ae.resetForm?(this._bindResetFormAction(Me,ae.resetForm),Ue=!0):this.isTooltipOnly&&!Ue&&(this._bindLink(Me,""),Ue=!0)),this.container.classList.add("linkAnnotation"),Ue&&this.container.append(Me),this.container}_bindLink(ae,Ae){ae.href=this.linkService.getDestinationHash(Ae),ae.onclick=()=>(Ae&&this.linkService.goToDestination(Ae),!1),(Ae||Ae==="")&&Pe(this,ce,_s).call(this)}_bindNamedAction(ae,Ae){ae.href=this.linkService.getAnchorUrl(""),ae.onclick=()=>(this.linkService.executeNamedAction(Ae),!1),Pe(this,ce,_s).call(this)}_bindAttachment(ae,Ae){ae.href=this.linkService.getAnchorUrl(""),ae.onclick=()=>{var Me;return(Me=this.downloadManager)==null||Me.openOrDownloadData(this.container,Ae.content,Ae.filename),!1},Pe(this,ce,_s).call(this)}_bindJSAction(ae,Ae){ae.href=this.linkService.getAnchorUrl("");const Me=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Ue of Object.keys(Ae.actions)){const qe=Me.get(Ue);qe&&(ae[qe]=()=>{var tt;return(tt=this.linkService.eventBus)==null||tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Ae.id,name:Ue}}),!1})}ae.onclick||(ae.onclick=()=>!1),Pe(this,ce,_s).call(this)}_bindResetFormAction(ae,Ae){const Me=ae.onclick;if(Me||(ae.href=this.linkService.getAnchorUrl("")),Pe(this,ce,_s).call(this),!this._fieldObjects){(0,i.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Me||(ae.onclick=()=>!1);return}ae.onclick=()=>{var An;Me==null||Me();const{fields:Ue,refs:qe,include:tt}=Ae,Wt=[];if(Ue.length!==0||qe.length!==0){const Gt=new Set(qe);for(const Kt of Ue){const gn=this._fieldObjects[Kt]||[];for(const{id:vn}of gn)Gt.add(vn)}for(const Kt of Object.values(this._fieldObjects))for(const gn of Kt)Gt.has(gn.id)===tt&&Wt.push(gn)}else for(const Gt of Object.values(this._fieldObjects))Wt.push(...Gt);const Bt=this.annotationStorage,Et=[];for(const Gt of Wt){const{id:Kt}=Gt;switch(Et.push(Kt),Gt.type){case"text":{const vn=Gt.defaultValue||"";Bt.setValue(Kt,{value:vn});break}case"checkbox":case"radiobutton":{const vn=Gt.defaultValue===Gt.exportValues;Bt.setValue(Kt,{value:vn});break}case"combobox":case"listbox":{const vn=Gt.defaultValue||"";Bt.setValue(Kt,{value:vn});break}default:continue}const gn=document.querySelector(`[data-element-id="${Kt}"]`);if(gn){if(!R.has(gn)){(0,i.warn)(`_bindResetFormAction - element not allowed: ${Kt}`);continue}}else continue;gn.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((An=this.linkService.eventBus)==null||An.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Et,name:"ResetForm"}})),!1}}}ce=new WeakSet,_s=function(){this.container.setAttribute("data-internal-link","")},Bd=function(ae,Ae){ae.href=this.linkService.getAnchorUrl(""),ae.onclick=()=>(this.linkService.executeSetOCGState(Ae),!1),Pe(this,ce,_s).call(this)};class b extends U{constructor(de){super(de,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const de=document.createElement("img");return de.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",de.alt="[{{type}} Annotation]",de.dataset.l10nId="text_annotation_type",de.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(de),this.container}}class K extends U{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(de){var ae;this.data.hasOwnCanvas&&(((ae=de.previousSibling)==null?void 0:ae.nodeName)==="CANVAS"&&(de.previousSibling.hidden=!0),de.hidden=!1)}_getKeyModifier(de){const{isWin:ae,isMac:Ae}=i.FeatureTest.platform;return ae&&de.ctrlKey||Ae&&de.metaKey}_setEventListener(de,ae,Ae,Me,Ue){Ae.includes("mouse")?de.addEventListener(Ae,qe=>{var tt;(tt=this.linkService.eventBus)==null||tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Me,value:Ue(qe),shift:qe.shiftKey,modifier:this._getKeyModifier(qe)}})}):de.addEventListener(Ae,qe=>{var tt;if(Ae==="blur"){if(!ae.focused||!qe.relatedTarget)return;ae.focused=!1}else if(Ae==="focus"){if(ae.focused)return;ae.focused=!0}Ue&&((tt=this.linkService.eventBus)==null||tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Me,value:Ue(qe)}}))})}_setEventListeners(de,ae,Ae,Me){var Ue,qe,tt;for(const[Wt,Bt]of Ae)(Bt==="Action"||(Ue=this.data.actions)!=null&&Ue[Bt])&&((Bt==="Focus"||Bt==="Blur")&&(ae||(ae={focused:!1})),this._setEventListener(de,ae,Wt,Bt,Me),Bt==="Focus"&&!((qe=this.data.actions)!=null&&qe.Blur)?this._setEventListener(de,ae,"blur","Blur",null):Bt==="Blur"&&!((tt=this.data.actions)!=null&&tt.Focus)&&this._setEventListener(de,ae,"focus","Focus",null))}_setBackgroundColor(de){const ae=this.data.backgroundColor||null;de.style.backgroundColor=ae===null?"transparent":i.Util.makeHexColor(ae[0],ae[1],ae[2])}_setTextStyle(de){const ae=["left","center","right"],{fontColor:Ae}=this.data.defaultAppearanceData,Me=this.data.defaultAppearanceData.fontSize||_,Ue=de.style;let qe;const tt=2,Wt=Bt=>Math.round(10*Bt)/10;if(this.data.multiLine){const Bt=Math.abs(this.data.rect[3]-this.data.rect[1]-tt),Et=Math.round(Bt/(i.LINE_FACTOR*Me))||1,An=Bt/Et;qe=Math.min(Me,Wt(An/i.LINE_FACTOR))}else{const Bt=Math.abs(this.data.rect[3]-this.data.rect[1]-tt);qe=Math.min(Me,Wt(Bt/i.LINE_FACTOR))}Ue.fontSize=`calc(${qe}px * var(--scale-factor))`,Ue.color=i.Util.makeHexColor(Ae[0],Ae[1],Ae[2]),this.data.textAlignment!==null&&(Ue.textAlign=ae[this.data.textAlignment])}_setRequired(de,ae){ae?de.setAttribute("required",!0):de.removeAttribute("required"),de.setAttribute("aria-required",ae)}}class Z extends K{constructor(de){const ae=de.renderForms||!de.data.hasAppearance&&!!de.data.fieldValue;super(de,{isRenderable:ae})}setPropertyOnSiblings(de,ae,Ae,Me){const Ue=this.annotationStorage;for(const qe of this._getElementsByName(de.name,de.id))qe.domElement&&(qe.domElement[ae]=Ae),Ue.setValue(qe.id,{[Me]:Ae})}render(){var Me,Ue;const de=this.annotationStorage,ae=this.data.id;this.container.classList.add("textWidgetAnnotation");let Ae=null;if(this.renderForms){const qe=de.getValue(ae,{value:this.data.fieldValue});let tt=qe.value||"";const Wt=de.getValue(ae,{charLimit:this.data.maxLen}).charLimit;Wt&&tt.length>Wt&&(tt=tt.slice(0,Wt));let Bt=qe.formattedValue||((Me=this.data.textContent)==null?void 0:Me.join(`
`))||null;Bt&&this.data.comb&&(Bt=Bt.replaceAll(/\s+/g,""));const Et={userValue:tt,formattedValue:Bt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Ae=document.createElement("textarea"),Ae.textContent=Bt??tt,this.data.doNotScroll&&(Ae.style.overflowY="hidden")):(Ae=document.createElement("input"),Ae.type="text",Ae.setAttribute("value",Bt??tt),this.data.doNotScroll&&(Ae.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Ae.hidden=!0),R.add(Ae),Ae.setAttribute("data-element-id",ae),Ae.disabled=this.data.readOnly,Ae.name=this.data.fieldName,Ae.tabIndex=p,this._setRequired(Ae,this.data.required),Wt&&(Ae.maxLength=Wt),Ae.addEventListener("input",Gt=>{de.setValue(ae,{value:Gt.target.value}),this.setPropertyOnSiblings(Ae,"value",Gt.target.value,"value"),Et.formattedValue=null}),Ae.addEventListener("resetform",Gt=>{const Kt=this.data.defaultFieldValue??"";Ae.value=Et.userValue=Kt,Et.formattedValue=null});let An=Gt=>{const{formattedValue:Kt}=Et;Kt!=null&&(Gt.target.value=Kt),Gt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Ae.addEventListener("focus",Kt=>{if(Et.focused)return;const{target:gn}=Kt;Et.userValue&&(gn.value=Et.userValue),Et.lastCommittedValue=gn.value,Et.commitKey=1,Et.focused=!0}),Ae.addEventListener("updatefromsandbox",Kt=>{this.showElementAndHideCanvas(Kt.target);const gn={value(vn){Et.userValue=vn.detail.value??"",de.setValue(ae,{value:Et.userValue.toString()}),vn.target.value=Et.userValue},formattedValue(vn){const{formattedValue:xn}=vn.detail;Et.formattedValue=xn,xn!=null&&vn.target!==document.activeElement&&(vn.target.value=xn),de.setValue(ae,{formattedValue:xn})},selRange(vn){vn.target.setSelectionRange(...vn.detail.selRange)},charLimit:vn=>{var On;const{charLimit:xn}=vn.detail,{target:Dn}=vn;if(xn===0){Dn.removeAttribute("maxLength");return}Dn.setAttribute("maxLength",xn);let Gn=Et.userValue;!Gn||Gn.length<=xn||(Gn=Gn.slice(0,xn),Dn.value=Et.userValue=Gn,de.setValue(ae,{value:Gn}),(On=this.linkService.eventBus)==null||On.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ae,name:"Keystroke",value:Gn,willCommit:!0,commitKey:1,selStart:Dn.selectionStart,selEnd:Dn.selectionEnd}}))}};this._dispatchEventFromSandbox(gn,Kt)}),Ae.addEventListener("keydown",Kt=>{var xn;Et.commitKey=1;let gn=-1;if(Kt.key==="Escape"?gn=0:Kt.key==="Enter"&&!this.data.multiLine?gn=2:Kt.key==="Tab"&&(Et.commitKey=3),gn===-1)return;const{value:vn}=Kt.target;Et.lastCommittedValue!==vn&&(Et.lastCommittedValue=vn,Et.userValue=vn,(xn=this.linkService.eventBus)==null||xn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ae,name:"Keystroke",value:vn,willCommit:!0,commitKey:gn,selStart:Kt.target.selectionStart,selEnd:Kt.target.selectionEnd}}))});const Gt=An;An=null,Ae.addEventListener("blur",Kt=>{var vn;if(!Et.focused||!Kt.relatedTarget)return;Et.focused=!1;const{value:gn}=Kt.target;Et.userValue=gn,Et.lastCommittedValue!==gn&&((vn=this.linkService.eventBus)==null||vn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ae,name:"Keystroke",value:gn,willCommit:!0,commitKey:Et.commitKey,selStart:Kt.target.selectionStart,selEnd:Kt.target.selectionEnd}})),Gt(Kt)}),(Ue=this.data.actions)!=null&&Ue.Keystroke&&Ae.addEventListener("beforeinput",Kt=>{var _r;Et.lastCommittedValue=null;const{data:gn,target:vn}=Kt,{value:xn,selectionStart:Dn,selectionEnd:Gn}=vn;let On=Dn,hr=Gn;switch(Kt.inputType){case"deleteWordBackward":{const Ar=xn.substring(0,Dn).match(/\w*[^\w]*$/);Ar&&(On-=Ar[0].length);break}case"deleteWordForward":{const Ar=xn.substring(Dn).match(/^[^\w]*\w*/);Ar&&(hr+=Ar[0].length);break}case"deleteContentBackward":Dn===Gn&&(On-=1);break;case"deleteContentForward":Dn===Gn&&(hr+=1);break}Kt.preventDefault(),(_r=this.linkService.eventBus)==null||_r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ae,name:"Keystroke",value:xn,change:gn||"",willCommit:!1,selStart:On,selEnd:hr}})}),this._setEventListeners(Ae,Et,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Kt=>Kt.target.value)}if(An&&Ae.addEventListener("blur",An),this.data.comb){const Kt=(this.data.rect[2]-this.data.rect[0])/Wt;Ae.classList.add("comb"),Ae.style.letterSpacing=`calc(${Kt}px * var(--scale-factor) - 1ch)`}}else Ae=document.createElement("div"),Ae.textContent=this.data.fieldValue,Ae.style.verticalAlign="middle",Ae.style.display="table-cell";return this._setTextStyle(Ae),this._setBackgroundColor(Ae),this._setDefaultPropertiesFromJS(Ae),this.container.append(Ae),this.container}}class oe extends K{constructor(de){super(de,{isRenderable:!!de.data.hasOwnCanvas})}}class te extends K{constructor(de){super(de,{isRenderable:de.renderForms})}render(){const de=this.annotationStorage,ae=this.data,Ae=ae.id;let Me=de.getValue(Ae,{value:ae.exportValue===ae.fieldValue}).value;typeof Me=="string"&&(Me=Me!=="Off",de.setValue(Ae,{value:Me})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Ue=document.createElement("input");return R.add(Ue),Ue.setAttribute("data-element-id",Ae),Ue.disabled=ae.readOnly,this._setRequired(Ue,this.data.required),Ue.type="checkbox",Ue.name=ae.fieldName,Me&&Ue.setAttribute("checked",!0),Ue.setAttribute("exportValue",ae.exportValue),Ue.tabIndex=p,Ue.addEventListener("change",qe=>{const{name:tt,checked:Wt}=qe.target;for(const Bt of this._getElementsByName(tt,Ae)){const Et=Wt&&Bt.exportValue===ae.exportValue;Bt.domElement&&(Bt.domElement.checked=Et),de.setValue(Bt.id,{value:Et})}de.setValue(Ae,{value:Wt})}),Ue.addEventListener("resetform",qe=>{const tt=ae.defaultFieldValue||"Off";qe.target.checked=tt===ae.exportValue}),this.enableScripting&&this.hasJSActions&&(Ue.addEventListener("updatefromsandbox",qe=>{const tt={value(Wt){Wt.target.checked=Wt.detail.value!=="Off",de.setValue(Ae,{value:Wt.target.checked})}};this._dispatchEventFromSandbox(tt,qe)}),this._setEventListeners(Ue,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],qe=>qe.target.checked)),this._setBackgroundColor(Ue),this._setDefaultPropertiesFromJS(Ue),this.container.append(Ue),this.container}}class H extends K{constructor(de){super(de,{isRenderable:de.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const de=this.annotationStorage,ae=this.data,Ae=ae.id;let Me=de.getValue(Ae,{value:ae.fieldValue===ae.buttonValue}).value;typeof Me=="string"&&(Me=Me!==ae.buttonValue,de.setValue(Ae,{value:Me}));const Ue=document.createElement("input");if(R.add(Ue),Ue.setAttribute("data-element-id",Ae),Ue.disabled=ae.readOnly,this._setRequired(Ue,this.data.required),Ue.type="radio",Ue.name=ae.fieldName,Me&&Ue.setAttribute("checked",!0),Ue.tabIndex=p,Ue.addEventListener("change",qe=>{const{name:tt,checked:Wt}=qe.target;for(const Bt of this._getElementsByName(tt,Ae))de.setValue(Bt.id,{value:!1});de.setValue(Ae,{value:Wt})}),Ue.addEventListener("resetform",qe=>{const tt=ae.defaultFieldValue;qe.target.checked=tt!=null&&tt===ae.buttonValue}),this.enableScripting&&this.hasJSActions){const qe=ae.buttonValue;Ue.addEventListener("updatefromsandbox",tt=>{const Wt={value:Bt=>{const Et=qe===Bt.detail.value;for(const An of this._getElementsByName(Bt.target.name)){const Gt=Et&&An.id===Ae;An.domElement&&(An.domElement.checked=Gt),de.setValue(An.id,{value:Gt})}}};this._dispatchEventFromSandbox(Wt,tt)}),this._setEventListeners(Ue,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],tt=>tt.target.checked)}return this._setBackgroundColor(Ue),this._setDefaultPropertiesFromJS(Ue),this.container.append(Ue),this.container}}class J extends X{constructor(de){super(de,{ignoreBorder:de.data.hasAppearance})}render(){const de=super.render();de.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(de.title=this.data.alternativeText);const ae=de.lastChild;return this.enableScripting&&this.hasJSActions&&ae&&(this._setDefaultPropertiesFromJS(ae),ae.addEventListener("updatefromsandbox",Ae=>{this._dispatchEventFromSandbox({},Ae)})),de}}class y extends K{constructor(de){super(de,{isRenderable:de.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const de=this.annotationStorage,ae=this.data.id,Ae=de.getValue(ae,{value:this.data.fieldValue}),Me=document.createElement("select");R.add(Me),Me.setAttribute("data-element-id",ae),Me.disabled=this.data.readOnly,this._setRequired(Me,this.data.required),Me.name=this.data.fieldName,Me.tabIndex=p;let Ue=this.data.combo&&this.data.options.length>0;this.data.combo||(Me.size=this.data.options.length,this.data.multiSelect&&(Me.multiple=!0)),Me.addEventListener("resetform",Et=>{const An=this.data.defaultFieldValue;for(const Gt of Me.options)Gt.selected=Gt.value===An});for(const Et of this.data.options){const An=document.createElement("option");An.textContent=Et.displayValue,An.value=Et.exportValue,Ae.value.includes(Et.exportValue)&&(An.setAttribute("selected",!0),Ue=!1),Me.append(An)}let qe=null;if(Ue){const Et=document.createElement("option");Et.value=" ",Et.setAttribute("hidden",!0),Et.setAttribute("selected",!0),Me.prepend(Et),qe=()=>{Et.remove(),Me.removeEventListener("input",qe),qe=null},Me.addEventListener("input",qe)}const tt=Et=>{const An=Et?"value":"textContent",{options:Gt,multiple:Kt}=Me;return Kt?Array.prototype.filter.call(Gt,gn=>gn.selected).map(gn=>gn[An]):Gt.selectedIndex===-1?null:Gt[Gt.selectedIndex][An]};let Wt=tt(!1);const Bt=Et=>{const An=Et.target.options;return Array.prototype.map.call(An,Gt=>({displayValue:Gt.textContent,exportValue:Gt.value}))};return this.enableScripting&&this.hasJSActions?(Me.addEventListener("updatefromsandbox",Et=>{const An={value(Gt){qe==null||qe();const Kt=Gt.detail.value,gn=new Set(Array.isArray(Kt)?Kt:[Kt]);for(const vn of Me.options)vn.selected=gn.has(vn.value);de.setValue(ae,{value:tt(!0)}),Wt=tt(!1)},multipleSelection(Gt){Me.multiple=!0},remove(Gt){const Kt=Me.options,gn=Gt.detail.remove;Kt[gn].selected=!1,Me.remove(gn),Kt.length>0&&Array.prototype.findIndex.call(Kt,xn=>xn.selected)===-1&&(Kt[0].selected=!0),de.setValue(ae,{value:tt(!0),items:Bt(Gt)}),Wt=tt(!1)},clear(Gt){for(;Me.length!==0;)Me.remove(0);de.setValue(ae,{value:null,items:[]}),Wt=tt(!1)},insert(Gt){const{index:Kt,displayValue:gn,exportValue:vn}=Gt.detail.insert,xn=Me.children[Kt],Dn=document.createElement("option");Dn.textContent=gn,Dn.value=vn,xn?xn.before(Dn):Me.append(Dn),de.setValue(ae,{value:tt(!0),items:Bt(Gt)}),Wt=tt(!1)},items(Gt){const{items:Kt}=Gt.detail;for(;Me.length!==0;)Me.remove(0);for(const gn of Kt){const{displayValue:vn,exportValue:xn}=gn,Dn=document.createElement("option");Dn.textContent=vn,Dn.value=xn,Me.append(Dn)}Me.options.length>0&&(Me.options[0].selected=!0),de.setValue(ae,{value:tt(!0),items:Bt(Gt)}),Wt=tt(!1)},indices(Gt){const Kt=new Set(Gt.detail.indices);for(const gn of Gt.target.options)gn.selected=Kt.has(gn.index);de.setValue(ae,{value:tt(!0)}),Wt=tt(!1)},editable(Gt){Gt.target.disabled=!Gt.detail.editable}};this._dispatchEventFromSandbox(An,Et)}),Me.addEventListener("input",Et=>{var Gt;const An=tt(!0);de.setValue(ae,{value:An}),Et.preventDefault(),(Gt=this.linkService.eventBus)==null||Gt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ae,name:"Keystroke",value:Wt,changeEx:An,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Me,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Et=>Et.target.value)):Me.addEventListener("input",function(Et){de.setValue(ae,{value:tt(!0)})}),this.data.combo&&this._setTextStyle(Me),this._setBackgroundColor(Me),this._setDefaultPropertiesFromJS(Me),this.container.append(Me),this.container}}class g extends U{constructor(de){const{data:ae,elements:Ae}=de;super(de,{isRenderable:U._hasPopupData(ae)}),this.elements=Ae}render(){this.container.classList.add("popupAnnotation");const de=new E({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),ae=[];for(const Ae of this.elements)Ae.popup=de,ae.push(Ae.data.id),Ae.addHighlightArea();return this.container.setAttribute("aria-controls",ae.map(Ae=>`${i.AnnotationPrefix}${Ae}`).join(",")),this.container}}class E{constructor({container:de,color:ae,elements:Ae,titleObj:Me,modificationDate:Ue,contentsObj:qe,richText:tt,parent:Wt,rect:Bt,parentRect:Et,open:An}){Fe(this,nt);Fe(this,be,null);Fe(this,Be,Pe(this,nt,zd).bind(this));Fe(this,ze,Pe(this,nt,lc).bind(this));Fe(this,Ke,Pe(this,nt,ac).bind(this));Fe(this,Xe,Pe(this,nt,ol).bind(this));Fe(this,Ze,null);Fe(this,xe,null);Fe(this,De,null);Fe(this,se,null);Fe(this,me,null);Fe(this,Te,null);Fe(this,Ce,!1);Fe(this,$e,null);Fe(this,et,null);Fe(this,Qe,null);Fe(this,Se,null);Fe(this,rt,!1);var Kt;Oe(this,xe,de),Oe(this,Se,Me),Oe(this,De,qe),Oe(this,Qe,tt),Oe(this,me,Wt),Oe(this,Ze,ae),Oe(this,et,Bt),Oe(this,Te,Et),Oe(this,se,Ae);const Gt=o.PDFDateString.toDateObject(Ue);Gt&&Oe(this,be,Wt.l10n.get("annotation_date_string",{date:Gt.toLocaleDateString(),time:Gt.toLocaleTimeString()})),this.trigger=Ae.flatMap(gn=>gn.getElementsToTriggerPopup());for(const gn of this.trigger)gn.addEventListener("click",T(this,Xe)),gn.addEventListener("mouseenter",T(this,Ke)),gn.addEventListener("mouseleave",T(this,ze)),gn.classList.add("popupTriggerArea");for(const gn of Ae)(Kt=gn.container)==null||Kt.addEventListener("keydown",T(this,Be));T(this,xe).hidden=!0,An&&Pe(this,nt,ol).call(this)}render(){if(T(this,$e))return;const{page:{view:de},viewport:{rawDims:{pageWidth:ae,pageHeight:Ae,pageX:Me,pageY:Ue}}}=T(this,me),qe=Oe(this,$e,document.createElement("div"));if(qe.className="popup",T(this,Ze)){const On=qe.style.outlineColor=i.Util.makeHexColor(...T(this,Ze));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?qe.style.backgroundColor=`color-mix(in srgb, ${On} 30%, white)`:qe.style.backgroundColor=i.Util.makeHexColor(...T(this,Ze).map(_r=>Math.floor(.7*(255-_r)+_r)))}const tt=document.createElement("span");tt.className="header";const Wt=document.createElement("h1");if(tt.append(Wt),{dir:Wt.dir,str:Wt.textContent}=T(this,Se),qe.append(tt),T(this,be)){const On=document.createElement("span");On.classList.add("popupDate"),T(this,be).then(hr=>{On.textContent=hr}),tt.append(On)}const Bt=T(this,De),Et=T(this,Qe);if(Et!=null&&Et.str&&(!(Bt!=null&&Bt.str)||Bt.str===Et.str))d.XfaLayer.render({xfaHtml:Et.html,intent:"richText",div:qe}),qe.lastChild.classList.add("richText","popupContent");else{const On=this._formatContents(Bt);qe.append(On)}let An=!!T(this,Te),Gt=An?T(this,Te):T(this,et);for(const On of T(this,se))if(!Gt||i.Util.intersect(On.data.rect,Gt)!==null){Gt=On.data.rect,An=!0;break}const Kt=i.Util.normalizeRect([Gt[0],de[3]-Gt[1]+de[1],Gt[2],de[3]-Gt[3]+de[1]]),vn=An?Gt[2]-Gt[0]+5:0,xn=Kt[0]+vn,Dn=Kt[1],{style:Gn}=T(this,xe);Gn.left=`${100*(xn-Me)/ae}%`,Gn.top=`${100*(Dn-Ue)/Ae}%`,T(this,xe).append(qe)}_formatContents({str:de,dir:ae}){const Ae=document.createElement("p");Ae.classList.add("popupContent"),Ae.dir=ae;const Me=de.split(/(?:\r\n?|\n)/);for(let Ue=0,qe=Me.length;Ue<qe;++Ue){const tt=Me[Ue];Ae.append(document.createTextNode(tt)),Ue<qe-1&&Ae.append(document.createElement("br"))}return Ae}forceHide(){Oe(this,rt,this.isVisible),T(this,rt)&&(T(this,xe).hidden=!0)}maybeShow(){T(this,rt)&&(Oe(this,rt,!1),T(this,xe).hidden=!1)}get isVisible(){return T(this,xe).hidden===!1}}be=new WeakMap,Be=new WeakMap,ze=new WeakMap,Ke=new WeakMap,Xe=new WeakMap,Ze=new WeakMap,xe=new WeakMap,De=new WeakMap,se=new WeakMap,me=new WeakMap,Te=new WeakMap,Ce=new WeakMap,$e=new WeakMap,et=new WeakMap,Qe=new WeakMap,Se=new WeakMap,rt=new WeakMap,nt=new WeakSet,zd=function(de){de.altKey||de.shiftKey||de.ctrlKey||de.metaKey||(de.key==="Enter"||de.key==="Escape"&&T(this,Ce))&&Pe(this,nt,ol).call(this)},ol=function(){Oe(this,Ce,!T(this,Ce)),T(this,Ce)?(Pe(this,nt,ac).call(this),T(this,xe).addEventListener("click",T(this,Xe)),T(this,xe).addEventListener("keydown",T(this,Be))):(Pe(this,nt,lc).call(this),T(this,xe).removeEventListener("click",T(this,Xe)),T(this,xe).removeEventListener("keydown",T(this,Be)))},ac=function(){T(this,$e)||this.render(),this.isVisible?T(this,Ce)&&T(this,xe).classList.add("focused"):(T(this,xe).hidden=!1,T(this,xe).style.zIndex=parseInt(T(this,xe).style.zIndex)+1e3)},lc=function(){T(this,xe).classList.remove("focused"),!(T(this,Ce)||!this.isVisible)&&(T(this,xe).hidden=!0,T(this,xe).style.zIndex=parseInt(T(this,xe).style.zIndex)-1e3)};class W extends U{constructor(de){super(de,{isRenderable:!0,ignoreBorder:!0}),this.textContent=de.data.textContent,this.textPosition=de.data.textPosition,this.annotationEditorType=i.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const de=document.createElement("div");de.classList.add("annotationTextContent"),de.setAttribute("role","comment");for(const ae of this.textContent){const Ae=document.createElement("span");Ae.textContent=ae,de.append(Ae)}this.container.append(de)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=W;class v extends U{constructor(ae){super(ae,{isRenderable:!0,ignoreBorder:!0});Fe(this,hn,null)}render(){this.container.classList.add("lineAnnotation");const ae=this.data,{width:Ae,height:Me}=w(ae.rect),Ue=this.svgFactory.create(Ae,Me,!0),qe=Oe(this,hn,this.svgFactory.createElement("svg:line"));return qe.setAttribute("x1",ae.rect[2]-ae.lineCoordinates[0]),qe.setAttribute("y1",ae.rect[3]-ae.lineCoordinates[1]),qe.setAttribute("x2",ae.rect[2]-ae.lineCoordinates[2]),qe.setAttribute("y2",ae.rect[3]-ae.lineCoordinates[3]),qe.setAttribute("stroke-width",ae.borderStyle.width||1),qe.setAttribute("stroke","transparent"),qe.setAttribute("fill","transparent"),Ue.append(qe),this.container.append(Ue),!ae.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return T(this,hn)}addHighlightArea(){this.container.classList.add("highlightArea")}}hn=new WeakMap;class D extends U{constructor(ae){super(ae,{isRenderable:!0,ignoreBorder:!0});Fe(this,bn,null)}render(){this.container.classList.add("squareAnnotation");const ae=this.data,{width:Ae,height:Me}=w(ae.rect),Ue=this.svgFactory.create(Ae,Me,!0),qe=ae.borderStyle.width,tt=Oe(this,bn,this.svgFactory.createElement("svg:rect"));return tt.setAttribute("x",qe/2),tt.setAttribute("y",qe/2),tt.setAttribute("width",Ae-qe),tt.setAttribute("height",Me-qe),tt.setAttribute("stroke-width",qe||1),tt.setAttribute("stroke","transparent"),tt.setAttribute("fill","transparent"),Ue.append(tt),this.container.append(Ue),!ae.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return T(this,bn)}addHighlightArea(){this.container.classList.add("highlightArea")}}bn=new WeakMap;class C extends U{constructor(ae){super(ae,{isRenderable:!0,ignoreBorder:!0});Fe(this,kn,null)}render(){this.container.classList.add("circleAnnotation");const ae=this.data,{width:Ae,height:Me}=w(ae.rect),Ue=this.svgFactory.create(Ae,Me,!0),qe=ae.borderStyle.width,tt=Oe(this,kn,this.svgFactory.createElement("svg:ellipse"));return tt.setAttribute("cx",Ae/2),tt.setAttribute("cy",Me/2),tt.setAttribute("rx",Ae/2-qe/2),tt.setAttribute("ry",Me/2-qe/2),tt.setAttribute("stroke-width",qe||1),tt.setAttribute("stroke","transparent"),tt.setAttribute("fill","transparent"),Ue.append(tt),this.container.append(Ue),!ae.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return T(this,kn)}addHighlightArea(){this.container.classList.add("highlightArea")}}kn=new WeakMap;class we extends U{constructor(ae){super(ae,{isRenderable:!0,ignoreBorder:!0});Fe(this,Ye,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const ae=this.data,{width:Ae,height:Me}=w(ae.rect),Ue=this.svgFactory.create(Ae,Me,!0);let qe=[];for(const Wt of ae.vertices){const Bt=Wt.x-ae.rect[0],Et=ae.rect[3]-Wt.y;qe.push(Bt+","+Et)}qe=qe.join(" ");const tt=Oe(this,Ye,this.svgFactory.createElement(this.svgElementName));return tt.setAttribute("points",qe),tt.setAttribute("stroke-width",ae.borderStyle.width||1),tt.setAttribute("stroke","transparent"),tt.setAttribute("fill","transparent"),Ue.append(tt),this.container.append(Ue),!ae.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return T(this,Ye)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ye=new WeakMap;class ve extends we{constructor(de){super(de),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Re extends U{constructor(de){super(de,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class _e extends U{constructor(ae){super(ae,{isRenderable:!0,ignoreBorder:!0});Fe(this,Ve,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=i.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const ae=this.data,{width:Ae,height:Me}=w(ae.rect),Ue=this.svgFactory.create(Ae,Me,!0);for(const qe of ae.inkLists){let tt=[];for(const Bt of qe){const Et=Bt.x-ae.rect[0],An=ae.rect[3]-Bt.y;tt.push(`${Et},${An}`)}tt=tt.join(" ");const Wt=this.svgFactory.createElement(this.svgElementName);T(this,Ve).push(Wt),Wt.setAttribute("points",tt),Wt.setAttribute("stroke-width",ae.borderStyle.width||1),Wt.setAttribute("stroke","transparent"),Wt.setAttribute("fill","transparent"),!ae.popupRef&&this.hasPopupData&&this._createPopup(),Ue.append(Wt)}return this.container.append(Ue),this.container}getElementsToTriggerPopup(){return T(this,Ve)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ve=new WeakMap,e.InkAnnotationElement=_e;class ge extends U{constructor(de){super(de,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ie extends U{constructor(de){super(de,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class fe extends U{constructor(de){super(de,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class re extends U{constructor(de){super(de,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Y extends U{constructor(de){super(de,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=Y;class I extends U{constructor(ae){var Ue;super(ae,{isRenderable:!0});Fe(this,Dt);Fe(this,Ne,null);const{filename:Ae,content:Me}=this.data.file;this.filename=(0,o.getFilenameFromUrl)(Ae,!0),this.content=Me,(Ue=this.linkService.eventBus)==null||Ue.dispatch("fileattachmentannotation",{source:this,filename:Ae,content:Me})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:ae,data:Ae}=this;let Me;Ae.hasAppearance||Ae.fillAlpha===0?Me=document.createElement("div"):(Me=document.createElement("img"),Me.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Ae.name)?"paperclip":"pushpin"}.svg`,Ae.fillAlpha&&Ae.fillAlpha<1&&(Me.style=`filter: opacity(${Math.round(Ae.fillAlpha*100)}%);`)),Me.addEventListener("dblclick",Pe(this,Dt,uc).bind(this)),Oe(this,Ne,Me);const{isMac:Ue}=i.FeatureTest.platform;return ae.addEventListener("keydown",qe=>{qe.key==="Enter"&&(Ue?qe.metaKey:qe.ctrlKey)&&Pe(this,Dt,uc).call(this)}),!Ae.popupRef&&this.hasPopupData?this._createPopup():Me.classList.add("popupTriggerArea"),ae.append(Me),ae}getElementsToTriggerPopup(){return T(this,Ne)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ne=new WeakMap,Dt=new WeakSet,uc=function(){var ae;(ae=this.downloadManager)==null||ae.openOrDownloadData(this.container,this.content,this.filename)};class S{constructor({div:de,accessibilityManager:ae,annotationCanvasMap:Ae,l10n:Me,page:Ue,viewport:qe}){Fe(this,pt);Fe(this,Pn,null);Fe(this,pe,null);Fe(this,We,new Map);this.div=de,Oe(this,Pn,ae),Oe(this,pe,Ae),this.l10n=Me,this.page=Ue,this.viewport=qe,this.zIndex=0,this.l10n||(this.l10n=f.NullL10n)}async render(de){const{annotations:ae}=de,Ae=this.div;(0,o.setLayerDimensions)(Ae,this.viewport);const Me=new Map,Ue={data:null,layer:Ae,linkService:de.linkService,downloadManager:de.downloadManager,imageResourcesPath:de.imageResourcesPath||"",renderForms:de.renderForms!==!1,svgFactory:new o.DOMSVGFactory,annotationStorage:de.annotationStorage||new a.AnnotationStorage,enableScripting:de.enableScripting===!0,hasJSActions:de.hasJSActions,fieldObjects:de.fieldObjects,parent:this,elements:null};for(const qe of ae){if(qe.noHTML)continue;const tt=qe.annotationType===i.AnnotationType.POPUP;if(tt){const Et=Me.get(qe.id);if(!Et)continue;Ue.elements=Et}else{const{width:Et,height:An}=w(qe.rect);if(Et<=0||An<=0)continue}Ue.data=qe;const Wt=V.create(Ue);if(!Wt.isRenderable)continue;if(!tt&&qe.popupRef){const Et=Me.get(qe.popupRef);Et?Et.push(Wt):Me.set(qe.popupRef,[Wt])}Wt.annotationEditorType>0&&T(this,We).set(Wt.data.id,Wt);const Bt=Wt.render();qe.hidden&&(Bt.style.visibility="hidden"),Pe(this,pt,Wd).call(this,Bt,qe.id)}Pe(this,pt,cc).call(this),await this.l10n.translate(Ae)}update({viewport:de}){const ae=this.div;this.viewport=de,(0,o.setLayerDimensions)(ae,{rotation:de.rotation}),Pe(this,pt,cc).call(this),ae.hidden=!1}getEditableAnnotations(){return Array.from(T(this,We).values())}getEditableAnnotation(de){return T(this,We).get(de)}}Pn=new WeakMap,pe=new WeakMap,We=new WeakMap,pt=new WeakSet,Wd=function(de,ae){var Me;const Ae=de.firstChild||de;Ae.id=`${i.AnnotationPrefix}${ae}`,this.div.append(de),(Me=T(this,Pn))==null||Me.moveElementInDOM(this.div,de,Ae,!1)},cc=function(){if(!T(this,pe))return;const de=this.div;for(const[ae,Ae]of T(this,pe)){const Me=de.querySelector(`[data-annotation-id="${ae}"]`);if(!Me)continue;const{firstChild:Ue}=Me;Ue?Ue.nodeName==="CANVAS"?Ue.replaceWith(Ae):Ue.before(Ae):Me.append(Ae)}T(this,pe).clear()},e.AnnotationLayer=S},(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function t(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}function i(a){return Math.max(0,Math.min(255,255*a))}class o{static CMYK_G([u,f,d,p]){return["G",1-Math.min(1,.3*u+.59*d+.11*f+p)]}static G_CMYK([u]){return["CMYK",0,0,0,1-u]}static G_RGB([u]){return["RGB",u,u,u]}static G_rgb([u]){return u=i(u),[u,u,u]}static G_HTML([u]){const f=t(u);return`#${f}${f}${f}`}static RGB_G([u,f,d]){return["G",.3*u+.59*f+.11*d]}static RGB_rgb(u){return u.map(i)}static RGB_HTML(u){return`#${u.map(t).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([u,f,d,p]){return["RGB",1-Math.min(1,u+p),1-Math.min(1,d+p),1-Math.min(1,f+p)]}static CMYK_rgb([u,f,d,p]){return[i(1-Math.min(1,u+p)),i(1-Math.min(1,d+p)),i(1-Math.min(1,f+p))]}static CMYK_HTML(u){const f=this.CMYK_RGB(u).slice(1);return this.RGB_HTML(f)}static RGB_CMYK([u,f,d]){const p=1-u,_=1-f,R=1-d,w=Math.min(p,_,R);return["CMYK",p,_,R,w]}}e.ColorConverters=o},(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=i;const t={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};t.print_progress_percent="{{progress}}%";function i(u,f){switch(u){case"find_match_count":u=`find_match_count[${f.total===1?"one":"other"}]`;break;case"find_match_count_limit":u=`find_match_count_limit[${f.limit===1?"one":"other"}]`;break}return t[u]||""}function o(u,f){return f?u.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(d,p)=>p in f?f[p]:"{{"+p+"}}"):u}const a={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(u,f=null,d=i(u,f)){return o(d,f)},async translate(u){}};e.NullL10n=a},(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var i=t(25);class o{static setupStorage(u,f,d,p,_){const R=p.getValue(f,{value:null});switch(d.name){case"textarea":if(R.value!==null&&(u.textContent=R.value),_==="print")break;u.addEventListener("input",w=>{p.setValue(f,{value:w.target.value})});break;case"input":if(d.attributes.type==="radio"||d.attributes.type==="checkbox"){if(R.value===d.attributes.xfaOn?u.setAttribute("checked",!0):R.value===d.attributes.xfaOff&&u.removeAttribute("checked"),_==="print")break;u.addEventListener("change",w=>{p.setValue(f,{value:w.target.checked?w.target.getAttribute("xfaOn"):w.target.getAttribute("xfaOff")})})}else{if(R.value!==null&&u.setAttribute("value",R.value),_==="print")break;u.addEventListener("input",w=>{p.setValue(f,{value:w.target.value})})}break;case"select":if(R.value!==null){u.setAttribute("value",R.value);for(const w of d.children)w.attributes.value===R.value?w.attributes.selected=!0:w.attributes.hasOwnProperty("selected")&&delete w.attributes.selected}u.addEventListener("input",w=>{const V=w.target.options,U=V.selectedIndex===-1?"":V[V.selectedIndex].value;p.setValue(f,{value:U})});break}}static setAttributes({html:u,element:f,storage:d=null,intent:p,linkService:_}){const{attributes:R}=f,w=u instanceof HTMLAnchorElement;R.type==="radio"&&(R.name=`${R.name}-${p}`);for(const[V,U]of Object.entries(R))if(U!=null)switch(V){case"class":U.length&&u.setAttribute(V,U.join(" "));break;case"dataId":break;case"id":u.setAttribute("data-element-id",U);break;case"style":Object.assign(u.style,U);break;case"textContent":u.textContent=U;break;default:(!w||V!=="href"&&V!=="newWindow")&&u.setAttribute(V,U)}w&&_.addLinkAttributes(u,R.href,R.newWindow),d&&R.dataId&&this.setupStorage(u,R.dataId,f,d)}static render(u){var X;const f=u.annotationStorage,d=u.linkService,p=u.xfaHtml,_=u.intent||"display",R=document.createElement(p.name);p.attributes&&this.setAttributes({html:R,element:p,intent:_,linkService:d});const w=[[p,-1,R]],V=u.div;if(V.append(R),u.viewport){const b=`matrix(${u.viewport.transform.join(",")})`;V.style.transform=b}_!=="richText"&&V.setAttribute("class","xfaLayer xfaFont");const U=[];for(;w.length>0;){const[b,K,Z]=w.at(-1);if(K+1===b.children.length){w.pop();continue}const oe=b.children[++w.at(-1)[1]];if(oe===null)continue;const{name:te}=oe;if(te==="#text"){const J=document.createTextNode(oe.value);U.push(J),Z.append(J);continue}const H=(X=oe==null?void 0:oe.attributes)!=null&&X.xmlns?document.createElementNS(oe.attributes.xmlns,te):document.createElement(te);if(Z.append(H),oe.attributes&&this.setAttributes({html:H,element:oe,storage:f,intent:_,linkService:d}),oe.children&&oe.children.length>0)w.push([oe,-1,H]);else if(oe.value){const J=document.createTextNode(oe.value);i.XfaText.shouldBuildText(te)&&U.push(J),H.append(J)}}for(const b of V.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:U}}static update(u){const f=`matrix(${u.viewport.transform.join(",")})`;u.div.style.transform=f,u.div.hidden=!1}}e.XfaLayer=o},(n,e,t)=>{var p,_,R,w,V,U,X,b,K,Z,oe,te,H,J,y,$d,Hd,qd,Gd,hc,Kd,dc,Xd,Yd,Qd,Jd,Zd,Ii,fc,al,ll,Zs,pc,ul,ce,ef,mc,tf,nf,_c,cl,eo;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var i=t(1),o=t(4),a=t(29),u=t(6),f=t(5);const Ze=class Ze extends o.AnnotationEditor{constructor(se){super({...se,name:"inkEditor"});Fe(this,y);Fe(this,p,0);Fe(this,_,0);Fe(this,R,this.canvasPointermove.bind(this));Fe(this,w,this.canvasPointerleave.bind(this));Fe(this,V,this.canvasPointerup.bind(this));Fe(this,U,this.canvasPointerdown.bind(this));Fe(this,X,new Path2D);Fe(this,b,!1);Fe(this,K,!1);Fe(this,Z,!1);Fe(this,oe,null);Fe(this,te,0);Fe(this,H,0);Fe(this,J,null);this.color=se.color||null,this.thickness=se.thickness||null,this.opacity=se.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(se){o.AnnotationEditor.initialize(se,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(se,me){switch(se){case i.AnnotationEditorParamsType.INK_THICKNESS:Ze._defaultThickness=me;break;case i.AnnotationEditorParamsType.INK_COLOR:Ze._defaultColor=me;break;case i.AnnotationEditorParamsType.INK_OPACITY:Ze._defaultOpacity=me/100;break}}updateParams(se,me){switch(se){case i.AnnotationEditorParamsType.INK_THICKNESS:Pe(this,y,$d).call(this,me);break;case i.AnnotationEditorParamsType.INK_COLOR:Pe(this,y,Hd).call(this,me);break;case i.AnnotationEditorParamsType.INK_OPACITY:Pe(this,y,qd).call(this,me);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,Ze._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,Ze._defaultColor||o.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ze._defaultOpacity*100)]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ze._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,this.color||Ze._defaultColor||o.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ze._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Pe(this,y,al).call(this),Pe(this,y,ll).call(this)),this.isAttachedToDOM||(this.parent.add(this),Pe(this,y,Zs).call(this)),Pe(this,y,eo).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,T(this,oe).disconnect(),Oe(this,oe,null),super.remove())}setParent(se){!this.parent&&se?this._uiManager.removeShouldRescale(this):this.parent&&se===null&&this._uiManager.addShouldRescale(this),super.setParent(se)}onScaleChanging(){const[se,me]=this.parentDimensions,Te=this.width*se,Ce=this.height*me;this.setDimensions(Te,Ce)}enableEditMode(){T(this,b)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",T(this,U)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",T(this,U)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){T(this,b)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Oe(this,b,!0),this.div.classList.add("disabled"),Pe(this,y,eo).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(se){this._focusEventsAllowed&&(super.focusin(se),this.enableEditMode())}canvasPointerdown(se){se.button!==0||!this.isInEditMode()||T(this,b)||(this.setInForeground(),se.preventDefault(),se.type!=="mouse"&&this.div.focus(),Pe(this,y,Kd).call(this,se.offsetX,se.offsetY))}canvasPointermove(se){se.preventDefault(),Pe(this,y,dc).call(this,se.offsetX,se.offsetY)}canvasPointerup(se){se.preventDefault(),Pe(this,y,fc).call(this,se)}canvasPointerleave(se){Pe(this,y,fc).call(this,se)}get isResizable(){return!this.isEmpty()&&T(this,b)}render(){if(this.div)return this.div;let se,me;this.width&&(se=this.x,me=this.y),super.render(),o.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Qe=>{var Se;return(Se=this.div)==null?void 0:Se.setAttribute("aria-label",Qe)});const[Te,Ce,$e,et]=Pe(this,y,Gd).call(this);if(this.setAt(Te,Ce,0,0),this.setDims($e,et),Pe(this,y,al).call(this),this.width){const[Qe,Se]=this.parentDimensions;this.setAspectRatio(this.width*Qe,this.height*Se),this.setAt(se*Qe,me*Se,this.width*Qe,this.height*Se),Oe(this,Z,!0),Pe(this,y,Zs).call(this),this.setDims(this.width*Qe,this.height*Se),Pe(this,y,Ii).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Pe(this,y,ll).call(this),this.div}setDimensions(se,me){const Te=Math.round(se),Ce=Math.round(me);if(T(this,te)===Te&&T(this,H)===Ce)return;Oe(this,te,Te),Oe(this,H,Ce),this.canvas.style.visibility="hidden";const[$e,et]=this.parentDimensions;this.width=se/$e,this.height=me/et,this.fixAndSetPosition(),T(this,b)&&Pe(this,y,pc).call(this,se,me),Pe(this,y,Zs).call(this),Pe(this,y,Ii).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(se,me,Te){var hn,bn,kn;if(se instanceof a.InkAnnotationElement)return null;const Ce=super.deserialize(se,me,Te);Ce.thickness=se.thickness,Ce.color=i.Util.makeHexColor(...se.color),Ce.opacity=se.opacity;const[$e,et]=Ce.pageDimensions,Qe=Ce.width*$e,Se=Ce.height*et,rt=Ce.parentScale,nt=se.thickness/2;Oe(Ce,b,!0),Oe(Ce,te,Math.round(Qe)),Oe(Ce,H,Math.round(Se));const{paths:mn,rect:fn,rotation:Rn}=se;for(let{bezier:Ye}of mn){Ye=Pe(hn=Ze,ce,tf).call(hn,Ye,fn,Rn);const Ve=[];Ce.paths.push(Ve);let Ne=rt*(Ye[0]-nt),Dt=rt*(Ye[1]-nt);for(let Pn=2,pe=Ye.length;Pn<pe;Pn+=6){const We=rt*(Ye[Pn]-nt),pt=rt*(Ye[Pn+1]-nt),Lt=rt*(Ye[Pn+2]-nt),un=rt*(Ye[Pn+3]-nt),kt=rt*(Ye[Pn+4]-nt),de=rt*(Ye[Pn+5]-nt);Ve.push([[Ne,Dt],[We,pt],[Lt,un],[kt,de]]),Ne=kt,Dt=de}const In=Pe(this,ce,ef).call(this,Ve);Ce.bezierPath2D.push(In)}const Ut=Pe(bn=Ce,y,_c).call(bn);return Oe(Ce,_,Math.max(o.AnnotationEditor.MIN_SIZE,Ut[2]-Ut[0])),Oe(Ce,p,Math.max(o.AnnotationEditor.MIN_SIZE,Ut[3]-Ut[1])),Pe(kn=Ce,y,pc).call(kn,Qe,Se),Ce}serialize(){if(this.isEmpty())return null;const se=this.getRect(0,0),me=o.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:i.AnnotationEditorType.INK,color:me,thickness:this.thickness,opacity:this.opacity,paths:Pe(this,y,nf).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,se),pageIndex:this.pageIndex,rect:se,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};p=new WeakMap,_=new WeakMap,R=new WeakMap,w=new WeakMap,V=new WeakMap,U=new WeakMap,X=new WeakMap,b=new WeakMap,K=new WeakMap,Z=new WeakMap,oe=new WeakMap,te=new WeakMap,H=new WeakMap,J=new WeakMap,y=new WeakSet,$d=function(se){const me=this.thickness;this.addCommands({cmd:()=>{this.thickness=se,Pe(this,y,eo).call(this)},undo:()=>{this.thickness=me,Pe(this,y,eo).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Hd=function(se){const me=this.color;this.addCommands({cmd:()=>{this.color=se,Pe(this,y,Ii).call(this)},undo:()=>{this.color=me,Pe(this,y,Ii).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},qd=function(se){se/=100;const me=this.opacity;this.addCommands({cmd:()=>{this.opacity=se,Pe(this,y,Ii).call(this)},undo:()=>{this.opacity=me,Pe(this,y,Ii).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Gd=function(){const{parentRotation:se,parentDimensions:[me,Te]}=this;switch(se){case 90:return[0,Te,Te,me];case 180:return[me,Te,me,Te];case 270:return[me,0,Te,me];default:return[0,0,me,Te]}},hc=function(){const{ctx:se,color:me,opacity:Te,thickness:Ce,parentScale:$e,scaleFactor:et}=this;se.lineWidth=Ce*$e/et,se.lineCap="round",se.lineJoin="round",se.miterLimit=10,se.strokeStyle=`${me}${(0,f.opacityToHex)(Te)}`},Kd=function(se,me){this.canvas.addEventListener("contextmenu",u.noContextMenu),this.canvas.addEventListener("pointerleave",T(this,w)),this.canvas.addEventListener("pointermove",T(this,R)),this.canvas.addEventListener("pointerup",T(this,V)),this.canvas.removeEventListener("pointerdown",T(this,U)),this.isEditing=!0,T(this,Z)||(Oe(this,Z,!0),Pe(this,y,Zs).call(this),this.thickness||(this.thickness=Ze._defaultThickness),this.color||(this.color=Ze._defaultColor||o.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ze._defaultOpacity)),this.currentPath.push([se,me]),Oe(this,K,!1),Pe(this,y,hc).call(this),Oe(this,J,()=>{Pe(this,y,Qd).call(this),T(this,J)&&window.requestAnimationFrame(T(this,J))}),window.requestAnimationFrame(T(this,J))},dc=function(se,me){const[Te,Ce]=this.currentPath.at(-1);if(this.currentPath.length>1&&se===Te&&me===Ce)return;const $e=this.currentPath;let et=T(this,X);if($e.push([se,me]),Oe(this,K,!0),$e.length<=2){et.moveTo(...$e[0]),et.lineTo(se,me);return}$e.length===3&&(Oe(this,X,et=new Path2D),et.moveTo(...$e[0])),Pe(this,y,Jd).call(this,et,...$e.at(-3),...$e.at(-2),se,me)},Xd=function(){if(this.currentPath.length===0)return;const se=this.currentPath.at(-1);T(this,X).lineTo(...se)},Yd=function(se,me){Oe(this,J,null),se=Math.min(Math.max(se,0),this.canvas.width),me=Math.min(Math.max(me,0),this.canvas.height),Pe(this,y,dc).call(this,se,me),Pe(this,y,Xd).call(this);let Te;if(this.currentPath.length!==1)Te=Pe(this,y,Zd).call(this);else{const Se=[se,me];Te=[[Se,Se.slice(),Se.slice(),Se]]}const Ce=T(this,X),$e=this.currentPath;this.currentPath=[],Oe(this,X,new Path2D);const et=()=>{this.allRawPaths.push($e),this.paths.push(Te),this.bezierPath2D.push(Ce),this.rebuild()},Qe=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Pe(this,y,al).call(this),Pe(this,y,ll).call(this)),Pe(this,y,eo).call(this))};this.addCommands({cmd:et,undo:Qe,mustExec:!0})},Qd=function(){if(!T(this,K))return;Oe(this,K,!1);const se=Math.ceil(this.thickness*this.parentScale),me=this.currentPath.slice(-3),Te=me.map(et=>et[0]),Ce=me.map(et=>et[1]);Math.min(...Te)-se,Math.max(...Te)+se,Math.min(...Ce)-se,Math.max(...Ce)+se;const{ctx:$e}=this;$e.save(),$e.clearRect(0,0,this.canvas.width,this.canvas.height);for(const et of this.bezierPath2D)$e.stroke(et);$e.stroke(T(this,X)),$e.restore()},Jd=function(se,me,Te,Ce,$e,et,Qe){const Se=(me+Ce)/2,rt=(Te+$e)/2,nt=(Ce+et)/2,mn=($e+Qe)/2;se.bezierCurveTo(Se+2*(Ce-Se)/3,rt+2*($e-rt)/3,nt+2*(Ce-nt)/3,mn+2*($e-mn)/3,nt,mn)},Zd=function(){const se=this.currentPath;if(se.length<=2)return[[se[0],se[0],se.at(-1),se.at(-1)]];const me=[];let Te,[Ce,$e]=se[0];for(Te=1;Te<se.length-2;Te++){const[fn,Rn]=se[Te],[Ut,hn]=se[Te+1],bn=(fn+Ut)/2,kn=(Rn+hn)/2,Ye=[Ce+2*(fn-Ce)/3,$e+2*(Rn-$e)/3],Ve=[bn+2*(fn-bn)/3,kn+2*(Rn-kn)/3];me.push([[Ce,$e],Ye,Ve,[bn,kn]]),[Ce,$e]=[bn,kn]}const[et,Qe]=se[Te],[Se,rt]=se[Te+1],nt=[Ce+2*(et-Ce)/3,$e+2*(Qe-$e)/3],mn=[Se+2*(et-Se)/3,rt+2*(Qe-rt)/3];return me.push([[Ce,$e],nt,mn,[Se,rt]]),me},Ii=function(){if(this.isEmpty()){Pe(this,y,ul).call(this);return}Pe(this,y,hc).call(this);const{canvas:se,ctx:me}=this;me.setTransform(1,0,0,1,0,0),me.clearRect(0,0,se.width,se.height),Pe(this,y,ul).call(this);for(const Te of this.bezierPath2D)me.stroke(Te)},fc=function(se){this.canvas.removeEventListener("pointerleave",T(this,w)),this.canvas.removeEventListener("pointermove",T(this,R)),this.canvas.removeEventListener("pointerup",T(this,V)),this.canvas.addEventListener("pointerdown",T(this,U)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",u.noContextMenu)},10),Pe(this,y,Yd).call(this,se.offsetX,se.offsetY),this.addToAnnotationStorage(),this.setInBackground()},al=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",o.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(se=>{var me;return(me=this.canvas)==null?void 0:me.setAttribute("aria-label",se)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ll=function(){Oe(this,oe,new ResizeObserver(se=>{const me=se[0].contentRect;me.width&&me.height&&this.setDimensions(me.width,me.height)})),T(this,oe).observe(this.div)},Zs=function(){if(!T(this,Z))return;const[se,me]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*se),this.canvas.height=Math.ceil(this.height*me),Pe(this,y,ul).call(this)},pc=function(se,me){const Te=Pe(this,y,cl).call(this),Ce=(se-Te)/T(this,_),$e=(me-Te)/T(this,p);this.scaleFactor=Math.min(Ce,$e)},ul=function(){const se=Pe(this,y,cl).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+se,this.translationY*this.scaleFactor+se)},ce=new WeakSet,ef=function(se){const me=new Path2D;for(let Te=0,Ce=se.length;Te<Ce;Te++){const[$e,et,Qe,Se]=se[Te];Te===0&&me.moveTo(...$e),me.bezierCurveTo(et[0],et[1],Qe[0],Qe[1],Se[0],Se[1])}return me},mc=function(se,me,Te){const[Ce,$e,et,Qe]=me;switch(Te){case 0:for(let Se=0,rt=se.length;Se<rt;Se+=2)se[Se]+=Ce,se[Se+1]=Qe-se[Se+1];break;case 90:for(let Se=0,rt=se.length;Se<rt;Se+=2){const nt=se[Se];se[Se]=se[Se+1]+Ce,se[Se+1]=nt+$e}break;case 180:for(let Se=0,rt=se.length;Se<rt;Se+=2)se[Se]=et-se[Se],se[Se+1]+=$e;break;case 270:for(let Se=0,rt=se.length;Se<rt;Se+=2){const nt=se[Se];se[Se]=et-se[Se+1],se[Se+1]=Qe-nt}break;default:throw new Error("Invalid rotation")}return se},tf=function(se,me,Te){const[Ce,$e,et,Qe]=me;switch(Te){case 0:for(let Se=0,rt=se.length;Se<rt;Se+=2)se[Se]-=Ce,se[Se+1]=Qe-se[Se+1];break;case 90:for(let Se=0,rt=se.length;Se<rt;Se+=2){const nt=se[Se];se[Se]=se[Se+1]-$e,se[Se+1]=nt-Ce}break;case 180:for(let Se=0,rt=se.length;Se<rt;Se+=2)se[Se]=et-se[Se],se[Se+1]-=$e;break;case 270:for(let Se=0,rt=se.length;Se<rt;Se+=2){const nt=se[Se];se[Se]=Qe-se[Se+1],se[Se+1]=et-nt}break;default:throw new Error("Invalid rotation")}return se},nf=function(se,me,Te,Ce){var rt,nt;const $e=[],et=this.thickness/2,Qe=se*me+et,Se=se*Te+et;for(const mn of this.paths){const fn=[],Rn=[];for(let Ut=0,hn=mn.length;Ut<hn;Ut++){const[bn,kn,Ye,Ve]=mn[Ut],Ne=se*bn[0]+Qe,Dt=se*bn[1]+Se,In=se*kn[0]+Qe,Pn=se*kn[1]+Se,pe=se*Ye[0]+Qe,We=se*Ye[1]+Se,pt=se*Ve[0]+Qe,Lt=se*Ve[1]+Se;Ut===0&&(fn.push(Ne,Dt),Rn.push(Ne,Dt)),fn.push(In,Pn,pe,We,pt,Lt),Rn.push(In,Pn),Ut===hn-1&&Rn.push(pt,Lt)}$e.push({bezier:Pe(rt=Ze,ce,mc).call(rt,fn,Ce,this.rotation),points:Pe(nt=Ze,ce,mc).call(nt,Rn,Ce,this.rotation)})}return $e},_c=function(){let se=1/0,me=-1/0,Te=1/0,Ce=-1/0;for(const $e of this.paths)for(const[et,Qe,Se,rt]of $e){const nt=i.Util.bezierBoundingBox(...et,...Qe,...Se,...rt);se=Math.min(se,nt[0]),Te=Math.min(Te,nt[1]),me=Math.max(me,nt[2]),Ce=Math.max(Ce,nt[3])}return[se,Te,me,Ce]},cl=function(){return T(this,b)?Math.ceil(this.thickness*this.parentScale):0},eo=function(se=!1){if(this.isEmpty())return;if(!T(this,b)){Pe(this,y,Ii).call(this);return}const me=Pe(this,y,_c).call(this),Te=Pe(this,y,cl).call(this);Oe(this,_,Math.max(o.AnnotationEditor.MIN_SIZE,me[2]-me[0])),Oe(this,p,Math.max(o.AnnotationEditor.MIN_SIZE,me[3]-me[1]));const Ce=Math.ceil(Te+T(this,_)*this.scaleFactor),$e=Math.ceil(Te+T(this,p)*this.scaleFactor),[et,Qe]=this.parentDimensions;this.width=Ce/et,this.height=$e/Qe,this.setAspectRatio(Ce,$e);const Se=this.translationX,rt=this.translationY;this.translationX=-me[0],this.translationY=-me[1],Pe(this,y,Zs).call(this),Pe(this,y,Ii).call(this),Oe(this,te,Ce),Oe(this,H,$e),this.setDims(Ce,$e);const nt=se?Te/this.scaleFactor/2:0;this.translate(Se-this.translationX-nt,rt-this.translationY-nt)},Fe(Ze,ce),Un(Ze,"_defaultColor",null),Un(Ze,"_defaultOpacity",1),Un(Ze,"_defaultThickness",1),Un(Ze,"_type","ink");let d=Ze;e.InkEditor=d},(n,e,t)=>{var d,p,_,R,w,V,U,X,b,K,Z,jo,Bo,hl,gc,rf,sf,yc,dl,of;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var i=t(1),o=t(4),a=t(6),u=t(29);const D=class D extends o.AnnotationEditor{constructor(ve){super({...ve,name:"stampEditor"});Fe(this,Z);Fe(this,d,null);Fe(this,p,null);Fe(this,_,null);Fe(this,R,null);Fe(this,w,null);Fe(this,V,null);Fe(this,U,null);Fe(this,X,null);Fe(this,b,!1);Fe(this,K,!1);Oe(this,R,ve.bitmapUrl),Oe(this,w,ve.bitmapFile)}static initialize(ve){o.AnnotationEditor.initialize(ve)}static get supportedTypes(){const ve=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,i.shadow)(this,"supportedTypes",ve.map(Re=>`image/${Re}`))}static get supportedTypesStr(){return(0,i.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(ve){return this.supportedTypes.includes(ve)}static paste(ve,Re){Re.pasteEditor(i.AnnotationEditorType.STAMP,{bitmapFile:ve.getAsFile()})}remove(){var ve,Re;T(this,p)&&(Oe(this,d,null),this._uiManager.imageManager.deleteId(T(this,p)),(ve=T(this,V))==null||ve.remove(),Oe(this,V,null),(Re=T(this,U))==null||Re.disconnect(),Oe(this,U,null)),super.remove()}rebuild(){if(!this.parent){T(this,p)&&Pe(this,Z,hl).call(this);return}super.rebuild(),this.div!==null&&(T(this,p)&&Pe(this,Z,hl).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(T(this,_)||T(this,d)||T(this,R)||T(this,w))}get isResizable(){return!0}render(){if(this.div)return this.div;let ve,Re;if(this.width&&(ve=this.x,Re=this.y),super.render(),this.div.hidden=!0,T(this,d)?Pe(this,Z,gc).call(this):Pe(this,Z,hl).call(this),this.width){const[_e,ge]=this.parentDimensions;this.setAt(ve*_e,Re*ge,this.width*_e,this.height*ge)}return this.div}static deserialize(ve,Re,_e){if(ve instanceof u.StampAnnotationElement)return null;const ge=super.deserialize(ve,Re,_e),{rect:ie,bitmapUrl:fe,bitmapId:re,isSvg:Y,accessibilityData:I}=ve;re&&_e.imageManager.isValidId(re)?Oe(ge,p,re):Oe(ge,R,fe),Oe(ge,b,Y);const[S,ee]=ge.pageDimensions;return ge.width=(ie[2]-ie[0])/S,ge.height=(ie[3]-ie[1])/ee,I&&(ge.altTextData=I),ge}serialize(ve=!1,Re=null){if(this.isEmpty())return null;const _e={annotationType:i.AnnotationEditorType.STAMP,bitmapId:T(this,p),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:T(this,b),structTreeParentId:this._structTreeParentId};if(ve)return _e.bitmapUrl=Pe(this,Z,dl).call(this,!0),_e.accessibilityData=this.altTextData,_e;const{decorative:ge,altText:ie}=this.altTextData;if(!ge&&ie&&(_e.accessibilityData={type:"Figure",alt:ie}),Re===null)return _e;Re.stamps||(Re.stamps=new Map);const fe=T(this,b)?(_e.rect[2]-_e.rect[0])*(_e.rect[3]-_e.rect[1]):null;if(!Re.stamps.has(T(this,p)))Re.stamps.set(T(this,p),{area:fe,serialized:_e}),_e.bitmap=Pe(this,Z,dl).call(this,!1);else if(T(this,b)){const re=Re.stamps.get(T(this,p));fe>re.area&&(re.area=fe,re.serialized.bitmap.close(),re.serialized.bitmap=Pe(this,Z,dl).call(this,!1))}return _e}};d=new WeakMap,p=new WeakMap,_=new WeakMap,R=new WeakMap,w=new WeakMap,V=new WeakMap,U=new WeakMap,X=new WeakMap,b=new WeakMap,K=new WeakMap,Z=new WeakSet,jo=function(ve,Re=!1){if(!ve){this.remove();return}Oe(this,d,ve.bitmap),Re||(Oe(this,p,ve.id),Oe(this,b,ve.isSvg)),Pe(this,Z,gc).call(this)},Bo=function(){Oe(this,_,null),this._uiManager.enableWaiting(!1),T(this,V)&&this.div.focus()},hl=function(){if(T(this,p)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(T(this,p)).then(Re=>Pe(this,Z,jo).call(this,Re,!0)).finally(()=>Pe(this,Z,Bo).call(this));return}if(T(this,R)){const Re=T(this,R);Oe(this,R,null),this._uiManager.enableWaiting(!0),Oe(this,_,this._uiManager.imageManager.getFromUrl(Re).then(_e=>Pe(this,Z,jo).call(this,_e)).finally(()=>Pe(this,Z,Bo).call(this)));return}if(T(this,w)){const Re=T(this,w);Oe(this,w,null),this._uiManager.enableWaiting(!0),Oe(this,_,this._uiManager.imageManager.getFromFile(Re).then(_e=>Pe(this,Z,jo).call(this,_e)).finally(()=>Pe(this,Z,Bo).call(this)));return}const ve=document.createElement("input");ve.type="file",ve.accept=D.supportedTypesStr,Oe(this,_,new Promise(Re=>{ve.addEventListener("change",async()=>{if(!ve.files||ve.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const _e=await this._uiManager.imageManager.getFromFile(ve.files[0]);Pe(this,Z,jo).call(this,_e)}Re()}),ve.addEventListener("cancel",()=>{this.remove(),Re()})}).finally(()=>Pe(this,Z,Bo).call(this))),ve.click()},gc=function(){const{div:ve}=this;let{width:Re,height:_e}=T(this,d);const[ge,ie]=this.pageDimensions,fe=.75;if(this.width)Re=this.width*ge,_e=this.height*ie;else if(Re>fe*ge||_e>fe*ie){const S=Math.min(fe*ge/Re,fe*ie/_e);Re*=S,_e*=S}const[re,Y]=this.parentDimensions;this.setDims(Re*re/ge,_e*Y/ie),this._uiManager.enableWaiting(!1);const I=Oe(this,V,document.createElement("canvas"));ve.append(I),ve.hidden=!1,Pe(this,Z,yc).call(this,Re,_e),Pe(this,Z,of).call(this),T(this,K)||(this.parent.addUndoableEditor(this),Oe(this,K,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},rf=function(ve,Re){var fe;const[_e,ge]=this.parentDimensions;this.width=ve/_e,this.height=Re/ge,this.setDims(ve,Re),(fe=this._initialOptions)!=null&&fe.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,T(this,X)!==null&&clearTimeout(T(this,X)),Oe(this,X,setTimeout(()=>{Oe(this,X,null),Pe(this,Z,yc).call(this,ve,Re)},200))},sf=function(ve,Re){const{width:_e,height:ge}=T(this,d);let ie=_e,fe=ge,re=T(this,d);for(;ie>2*ve||fe>2*Re;){const Y=ie,I=fe;ie>2*ve&&(ie=ie>=16384?Math.floor(ie/2)-1:Math.ceil(ie/2)),fe>2*Re&&(fe=fe>=16384?Math.floor(fe/2)-1:Math.ceil(fe/2));const S=new OffscreenCanvas(ie,fe);S.getContext("2d").drawImage(re,0,0,Y,I,0,0,ie,fe),re=S.transferToImageBitmap()}return re},yc=function(ve,Re){ve=Math.ceil(ve),Re=Math.ceil(Re);const _e=T(this,V);if(!_e||_e.width===ve&&_e.height===Re)return;_e.width=ve,_e.height=Re;const ge=T(this,b)?T(this,d):Pe(this,Z,sf).call(this,ve,Re),ie=_e.getContext("2d");ie.filter=this._uiManager.hcmFilter,ie.drawImage(ge,0,0,ge.width,ge.height,0,0,ve,Re)},dl=function(ve){if(ve){if(T(this,b)){const ge=this._uiManager.imageManager.getSvgUrl(T(this,p));if(ge)return ge}const Re=document.createElement("canvas");return{width:Re.width,height:Re.height}=T(this,d),Re.getContext("2d").drawImage(T(this,d),0,0),Re.toDataURL()}if(T(this,b)){const[Re,_e]=this.pageDimensions,ge=Math.round(this.width*Re*a.PixelsPerInch.PDF_TO_CSS_UNITS),ie=Math.round(this.height*_e*a.PixelsPerInch.PDF_TO_CSS_UNITS),fe=new OffscreenCanvas(ge,ie);return fe.getContext("2d").drawImage(T(this,d),0,0,T(this,d).width,T(this,d).height,0,0,ge,ie),fe.transferToImageBitmap()}return structuredClone(T(this,d))},of=function(){Oe(this,U,new ResizeObserver(ve=>{const Re=ve[0].contentRect;Re.width&&Re.height&&Pe(this,Z,rf).call(this,Re.width,Re.height)})),T(this,U).observe(this.div)},Un(D,"_type","stamp");let f=D;e.StampEditor=f}],__webpack_module_cache__={};function __w_pdfjs_require__(n){var e=__webpack_module_cache__[n];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n](t,t.exports,__w_pdfjs_require__),t.exports}var __webpack_exports__={};return(()=>{var n=__webpack_exports__;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(n,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}}),Object.defineProperty(n,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(n,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(n,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return u.AnnotationEditorUIManager}}),Object.defineProperty(n,"AnnotationLayer",{enumerable:!0,get:function(){return f.AnnotationLayer}}),Object.defineProperty(n,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(n,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(n,"DOMSVGFactory",{enumerable:!0,get:function(){return i.DOMSVGFactory}}),Object.defineProperty(n,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(n,"GlobalWorkerOptions",{enumerable:!0,get:function(){return d.GlobalWorkerOptions}}),Object.defineProperty(n,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(n,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(n,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(n,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(n,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(n,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(n,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(n,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(n,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(n,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(n,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(n,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(n,"SVGGraphics",{enumerable:!0,get:function(){return t.SVGGraphics}}),Object.defineProperty(n,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(n,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(n,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(n,"XfaLayer",{enumerable:!0,get:function(){return p.XfaLayer}}),Object.defineProperty(n,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(n,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(n,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(n,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(n,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(n,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(n,"isDataScheme",{enumerable:!0,get:function(){return i.isDataScheme}}),Object.defineProperty(n,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(n,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(n,"noContextMenu",{enumerable:!0,get:function(){return i.noContextMenu}}),Object.defineProperty(n,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(n,"renderTextLayer",{enumerable:!0,get:function(){return o.renderTextLayer}}),Object.defineProperty(n,"setLayerDimensions",{enumerable:!0,get:function(){return i.setLayerDimensions}}),Object.defineProperty(n,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(n,"updateTextLayer",{enumerable:!0,get:function(){return o.updateTextLayer}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return t.version}});var e=__w_pdfjs_require__(1),t=__w_pdfjs_require__(2),i=__w_pdfjs_require__(6),o=__w_pdfjs_require__(26),a=__w_pdfjs_require__(27),u=__w_pdfjs_require__(5),f=__w_pdfjs_require__(29),d=__w_pdfjs_require__(14),p=__w_pdfjs_require__(32)})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();pdfExports.GlobalWorkerOptions.workerSrc=new URL("/assets/pdf.worker-BgPpApnW.js",import.meta.url).toString();function ResumeAnalyzer(){const[n,e]=reactExports.useState(null),[t,i]=reactExports.useState(null),[o,a]=reactExports.useState({}),[u,f]=reactExports.useState(!1),d=V=>{e(V.target.files[0]),i(null),a({})},p=async V=>{const U=await V.arrayBuffer(),X=await pdfExports.getDocument({data:U}).promise;let b="";for(let K=1;K<=X.numPages;K++){const te=(await(await X.getPage(K)).getTextContent()).items.map(H=>H.str).join(" ");b+=te+`
`}return b},_=V=>{const U=V.split(/\n|\.|\u2022|\*/).map(te=>te.trim()).filter(Boolean),X=U.filter(te=>/python|java|c\+\+|react|node|sql|html|css|javascript/i.test(te)).slice(0,2),b=U.filter(te=>/project|built|developed|accuracy|model/i.test(te)).slice(0,2),K=U.find(te=>/b\.e|btech|cgpa|degree|college/i.test(te)),Z=U.find(te=>/intern|experience|worked|cyber/i.test(te));return[...X.map(te=>` ${te}`),...b.map(te=>` ${te}`),K&&` ${K}`,Z&&` ${Z}`].filter(Boolean).slice(0,6)},R=V=>{var U,X,b,K;return{email:((U=V.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/))==null?void 0:U[0])||"Not Found",phone:((X=V.match(/\+?\d[\d\s()-]{8,}/))==null?void 0:X[0])||"Not Found",linkedin:((b=V.match(/(https?:\/\/)?(www\.)?linkedin\.com\/in\/[^\s)]+/))==null?void 0:b[0])||"Not Found",github:((K=V.match(/(https?:\/\/)?(www\.)?github\.com\/[^\s)]+/))==null?void 0:K[0])||"Not Found"}},w=async()=>{if(!n||!auth.currentUser)return alert("Please upload a resume PDF.");try{f(!0);const V=await p(n),U=_(V),X=R(V);i(U),a(X),await addDoc(collection(db,"resumes"),{userId:auth.currentUser.uid,summary:U,contact:X,uploadedAt:new Date})}catch(V){console.error("PDF analysis failed:",V),alert(" Failed to analyze the PDF.")}finally{f(!1)}};return jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6 text-white min-h-screen flex flex-col items-center justify-center bg-transparent",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold mb-6 text-blue-300",children:" Resume Analyzer"}),jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col sm:flex-row items-center justify-center gap-4 mb-6",children:[jsxRuntimeExports.jsxs("label",{className:"w-full sm:w-auto flex items-center justify-center px-4 py-2 bg-zinc-800 text-white rounded-lg border border-zinc-600 cursor-pointer hover:bg-zinc-700 transition",children:[jsxRuntimeExports.jsx("span",{children:"Choose File"}),jsxRuntimeExports.jsx("input",{type:"file",accept:"application/pdf",onChange:d,className:"hidden"})]}),jsxRuntimeExports.jsx("button",{onClick:w,className:"bg-blue-600 px-6 py-2 rounded hover:bg-blue-700 transition disabled:opacity-50",disabled:!n||u,children:u?"Analyzing...":"Analyze Resume"})]}),Object.keys(o).length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-6 w-full bg-blue-100 dark:bg-blue-900/30 text-black dark:text-white p-4 rounded-xl shadow-lg border border-blue-300/40",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold mb-2",children:" Contact Info"}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Email:"})," ",o.email]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Phone:"})," ",o.phone]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"LinkedIn:"})," ",o.linkedin]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"GitHub:"})," ",o.github]})]}),t&&jsxRuntimeExports.jsxs("div",{className:"mt-6 w-full bg-blue-100 dark:bg-blue-900/30 text-black dark:text-white p-6 rounded-xl shadow-lg border border-blue-300/40",children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-semibold mb-4",children:" Summary"}),jsxRuntimeExports.jsx("ul",{className:"list-disc list-inside space-y-2",children:t.map((V,U)=>jsxRuntimeExports.jsx("li",{children:V},U))})]})]})}const stopwords$1=new Set(["the","and","with","for","you","that","are","will","this","your","our","have","has","from","not","all","any","but","can","should","been","more","than","per","each","their","who","able","must","an","of","a","to","in","on","by","as","is","or","be","at","we"]);function JDMatcher(){const[n,e]=reactExports.useState(""),[t,i]=reactExports.useState([]),[o,a]=reactExports.useState(!1),u=d=>{const p=d.toLowerCase().replace(/[^a-zA-Z0-9\s]/g,"").split(/\s+/).filter(R=>R.length>2&&!stopwords$1.has(R)),_={};return p.forEach(R=>{_[R]=(_[R]||0)+1}),Object.entries(_).sort((R,w)=>w[1]-R[1]).slice(0,15).map(R=>R[0])},f=async()=>{if(!n.trim()){alert("Please paste a job description.");return}if(!auth.currentUser){alert("Please login to extract keywords.");return}a(!0);const d=u(n);i(d);try{await addDoc(collection(db,"jd_keywords"),{userId:auth.currentUser.uid,jobText:n,keywords:d,createdAt:new Date})}catch(p){console.error("Error saving keywords:",p),alert("Failed to save keywords to database.")}a(!1)};return jsxRuntimeExports.jsx("div",{className:"max-w-3xl mx-auto p-6 min-h-screen flex flex-col justify-center items-center text-white",children:jsxRuntimeExports.jsxs("div",{className:"w-full bg-blue-950 bg-opacity-20 p-6 rounded-xl shadow-xl",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold mb-4 text-blue-400",children:" JD Keyword Extractor"}),jsxRuntimeExports.jsx("textarea",{rows:8,value:n,onChange:d=>e(d.target.value),placeholder:"Paste Job Description here...",className:"w-full p-3 border border-zinc-700 rounded mb-4 bg-zinc-900 text-white resize-none"}),jsxRuntimeExports.jsx("button",{onClick:f,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:o?"Extracting...":"Extract Keywords"}),t.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-6 bg-zinc-900 bg-opacity-70 p-4 rounded-lg",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-300",children:" Extracted Keywords:"}),jsxRuntimeExports.jsx("ul",{className:"list-disc list-inside text-blue-200",children:t.map((d,p)=>jsxRuntimeExports.jsx("li",{children:d},p))})]})]})})}pdfExports.GlobalWorkerOptions.workerSrc=new URL("/assets/pdf.worker-BgPpApnW.js",import.meta.url).toString();const stopwords=new Set(["the","and","with","for","you","that","are","will","this","your","our","have","has","from","not","all","any","but","can","should","been","more","than","per","each","their","who","able","must","an","of","a","to","in","on","by","as","is","or","be","at","we"]);function tokenize(n){return n.toLowerCase().replace(/[^a-zA-Z0-9\s]/g,"").split(/\s+/).filter(e=>e.length>2&&!stopwords.has(e))}function ResumeMatcher(){const[n,e]=reactExports.useState(null),[t,i]=reactExports.useState(""),[o,a]=reactExports.useState(null),[u,f]=reactExports.useState([]),[d,p]=reactExports.useState(!1),_=async w=>{const V=await w.arrayBuffer(),U=await pdfExports.getDocument({data:V}).promise;let X="";for(let b=1;b<=U.numPages;b++){const Z=await(await U.getPage(b)).getTextContent();X+=Z.items.map(oe=>oe.str).join(" ")+" "}return X},R=async()=>{if(!n||!t.trim())return alert("Please upload resume and enter job description.");if(!auth.currentUser)return alert("Please login to match resume.");try{p(!0);const w=await _(n),V=tokenize(w),U=tokenize(t),X=new Set(U),b=V.filter(oe=>X.has(oe)),K=[...new Set(b)],Z=Math.min(100,Math.round(K.length/X.size*180));a(Z),f(K),await addDoc(collection(db,"matches"),{userId:auth.currentUser.uid,jobDescription:t,matchedKeywords:K,matchScore:Z,createdAt:new Date})}catch(w){console.error("Resume match failed:",w),alert("Failed to process PDF. Try another file.")}finally{p(!1)}};return jsxRuntimeExports.jsxs("div",{className:"max-w-3xl mx-auto p-6 min-h-screen text-white flex flex-col justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold text-center text-blue-400 mb-8",children:" Resume Matcher"}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-950 bg-opacity-30 rounded-xl p-6 shadow-lg",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-4 mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block mb-1 text-sm font-semibold text-zinc-300",children:"Upload Resume (PDF):"}),jsxRuntimeExports.jsx("input",{type:"file",accept:".pdf",onChange:w=>e(w.target.files[0]),className:"w-full p-2 rounded border border-zinc-600 bg-zinc-800 text-white"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block mb-1 text-sm font-semibold text-zinc-300",children:"Paste Job Description:"}),jsxRuntimeExports.jsx("textarea",{rows:6,value:t,onChange:w=>i(w.target.value),placeholder:"Paste job description here...",className:"w-full p-3 rounded border border-zinc-600 bg-zinc-800 text-white resize-none"})]}),jsxRuntimeExports.jsx("button",{onClick:R,disabled:d,className:"w-full py-3 rounded bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 transition text-white font-semibold disabled:opacity-50",children:d?"Matching...":"Match Resume"})]}),o!==null&&!d&&jsxRuntimeExports.jsxs("div",{className:"mt-6 text-center",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold text-green-400",children:[" Match Score: ",o,"%"]}),jsxRuntimeExports.jsx("p",{className:"mt-4 text-sm text-zinc-400",children:"Matched Keywords:"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap justify-center gap-2 mt-2",children:u.map((w,V)=>jsxRuntimeExports.jsx("span",{className:"px-3 py-1 rounded-full bg-green-700 text-white text-xs font-medium",children:w},V))})]})]})]})}function AuthForm(){const[n,e]=reactExports.useState(""),[t,i]=reactExports.useState(""),[o,a]=reactExports.useState(!1),[u,f]=reactExports.useState(""),d=useNavigate(),p=async _=>{_.preventDefault(),f("");try{o?await createUserWithEmailAndPassword(auth,n,t):await signInWithEmailAndPassword(auth,n,t),d("/")}catch(R){console.error(R),R.code==="auth/invalid-email"?f("Invalid email address."):R.code==="auth/user-not-found"||R.code==="auth/wrong-password"?f("Email or password is incorrect."):R.code==="auth/email-already-in-use"?f("Email is already registered."):R.code==="auth/weak-password"?f("Password should be at least 6 characters."):f("An unexpected error occurred.")}};return jsxRuntimeExports.jsxs("div",{className:"max-w-sm mx-auto mt-20 bg-zinc-900 p-6 rounded-lg shadow-md text-white",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:o?"Sign Up":"Login"}),jsxRuntimeExports.jsxs("form",{onSubmit:p,className:"space-y-4",children:[jsxRuntimeExports.jsx("input",{type:"email",placeholder:"Email",value:n,onChange:_=>e(_.target.value),className:"w-full p-3 rounded bg-zinc-800 border border-zinc-600"}),jsxRuntimeExports.jsx("input",{type:"password",placeholder:"Password",value:t,onChange:_=>i(_.target.value),className:"w-full p-3 rounded bg-zinc-800 border border-zinc-600"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 py-3 rounded font-semibold",children:o?"Create Account":"Login"}),u&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-sm mt-2 text-center",children:u}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-center mt-4",children:[o?"Already have an account?":"New user?"," ",jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{a(!o),f("")},className:"text-blue-400 underline",children:o?"Login":"Sign Up"})]})]})]})}function NotFound(){return jsxRuntimeExports.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center text-center p-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold text-red-500 mb-4",children:"404"}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold mb-2 text-zinc-800 dark:text-white",children:"Page Not Found"}),jsxRuntimeExports.jsx("p",{className:"mb-6 text-zinc-600 dark:text-zinc-300",children:"The page youre looking for doesnt exist or has been moved."}),jsxRuntimeExports.jsx(Link,{to:"/",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition",children:"Go to Dashboard"})]})}function ProtectedRoute({children:n}){const[e,t]=useAuthState(auth);return t?jsxRuntimeExports.jsx("div",{className:"text-center mt-20 text-white text-lg",children:"Loading..."}):e?n:jsxRuntimeExports.jsx(Navigate,{to:"/"})}function AppRoutes(){const[n,e]=useAuthState(auth);return jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Home,{})}),!n&&jsxRuntimeExports.jsx(Route,{path:"/auth",element:jsxRuntimeExports.jsx(AuthForm,{})}),jsxRuntimeExports.jsx(Route,{path:"/dashboard",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(Dashboard,{})})}),jsxRuntimeExports.jsx(Route,{path:"/tracker",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(JobTracker,{})})}),jsxRuntimeExports.jsx(Route,{path:"/analyzer",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(ResumeAnalyzer,{})})}),jsxRuntimeExports.jsx(Route,{path:"/matcher",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(JDMatcher,{})})}),jsxRuntimeExports.jsx(Route,{path:"/resume-match",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(ResumeMatcher,{})})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(NotFound,{})})]})}function App(){return jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs("div",{className:"relative min-h-screen overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"subtle-bg"}),jsxRuntimeExports.jsx(Navbar,{}),jsxRuntimeExports.jsx(AppRoutes,{}),jsxRuntimeExports.jsx(Footer,{})]})})}ReactDOM.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
